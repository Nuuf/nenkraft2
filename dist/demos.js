/**
* @package     Nenkraft2
* @author      Gustav 'Nuuf' Åberg <gustavrein@gmail.com>
* @version     1.1.0
* @copyright   (C) 2018 Gustav 'Nuuf' Åberg
* @license     {@link https://github.com/Nuuf/nenkraft2/blob/master/LICENSE}
*/!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=19)}([function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"CCH1",function(){return I}),n.d(r,"CCH1Decipher",function(){return L});var i={};n.r(i),n.d(i,"GenerateSimpleBase64PNG",function(){return G}),n.d(i,"ImageFromDataURL",function(){return F}),n.d(i,"ParsedXMLToJSON",function(){return M}),n.d(i,"XMLToJSON",function(){return V}),n.d(i,"DownloadAsJSON",function(){return X});var o={};n.r(o),n.d(o,"Linear",function(){return z}),n.d(o,"QuadIn",function(){return K}),n.d(o,"QuadOut",function(){return J}),n.d(o,"QuadInOut",function(){return Q}),n.d(o,"SineIn",function(){return $}),n.d(o,"SineOut",function(){return Z}),n.d(o,"SineInOut",function(){return tt}),n.d(o,"CircIn",function(){return et}),n.d(o,"CircOut",function(){return nt}),n.d(o,"CircInOut",function(){return rt});var a={};n.r(a),n.d(a,"Result",function(){return bt}),n.d(a,"CollideRel",function(){return gt});var s={};n.r(s),n.d(s,"Result",function(){return xt}),n.d(s,"CollideRel",function(){return Et}),n.d(s,"ElasticResponse",function(){return _t});var u={};n.r(u),n.d(u,"Result",function(){return Nt}),n.d(u,"CollideRel",function(){return Gt}),n.d(u,"ReflectingResponse",function(){return Ft});var l={};n.r(l),n.d(l,"Result",function(){return Wt}),n.d(l,"CollideRel",function(){return qt}),n.d(l,"AxisSeparates",function(){return zt});var c={};n.r(c),n.d(c,"AABB2DvsAABB2D",function(){return a}),n.d(c,"CirclevsCircle",function(){return s}),n.d(c,"CirclevsLine",function(){return u}),n.d(c,"PolygonvsPolygon",function(){return l});var f={};n.r(f),n.d(f,"Rectangular",function(){return ee}),n.d(f,"Isosceles",function(){return ne}),n.d(f,"Cyclic",function(){return re}),n.d(f,"Equilateral",function(){return ie}),n.d(f,"Star",function(){return oe}),n.d(f,"Butterfly",function(){return ae}),n.d(f,"Rose",function(){return se}),n.d(f,"Supershape",function(){return ue});var h={};n.r(h),n.d(h,"AABB2D",function(){return ce}),n.d(h,"Circle",function(){return we}),n.d(h,"Line2D",function(){return Ce}),n.d(h,"Ray2D",function(){return Ce}),n.d(h,"Polygon2D",function(){return Ee}),n.d(h,"PolygonConstruction",function(){return f});var d={};n.r(d),n.d(d,"DEFAULT",function(){return Oe}),n.d(d,"SOURCE_OVER",function(){return Pe}),n.d(d,"SOURCE_IN",function(){return Re}),n.d(d,"SOURCE_OUT",function(){return De}),n.d(d,"SOURCE_ATOP",function(){return ke}),n.d(d,"DESTINATION_OVER",function(){return Ie}),n.d(d,"DESTINATION_IN",function(){return Le}),n.d(d,"DESTINATION_OUT",function(){return je}),n.d(d,"DESTINATION_ATOP",function(){return Be}),n.d(d,"LIGHTER",function(){return Ue}),n.d(d,"COPY",function(){return Ne}),n.d(d,"XOR",function(){return Ge}),n.d(d,"MULTIPLY",function(){return Fe}),n.d(d,"OVERLAY",function(){return Me}),n.d(d,"DARKEN",function(){return Ve}),n.d(d,"LIGHTEN",function(){return Xe}),n.d(d,"COLOR_DODGE",function(){return Ye}),n.d(d,"COLOR_BURN",function(){return He}),n.d(d,"HARD_LIGHT",function(){return We}),n.d(d,"SOFT_LIGHT",function(){return qe}),n.d(d,"DIFFERENCE",function(){return ze}),n.d(d,"EXCLUSION",function(){return Ke}),n.d(d,"HUE",function(){return Je}),n.d(d,"SATURATION",function(){return Qe}),n.d(d,"COLOR",function(){return $e}),n.d(d,"LUMINOSITY",function(){return Ze});var p={};n.r(p),n.d(p,"CAP_ROUND",function(){return tn}),n.d(p,"CAP_BUTT",function(){return en}),n.d(p,"CAP_SQUARE",function(){return nn}),n.d(p,"JOIN_BEVEL",function(){return rn}),n.d(p,"JOIN_ROUND",function(){return on}),n.d(p,"JOIN_MITER",function(){return an});var y={};n.r(y),n.d(y,"ALIGN_START",function(){return sn}),n.d(y,"ALIGN_END",function(){return un}),n.d(y,"ALIGN_CENTER",function(){return ln}),n.d(y,"ALIGN_LEFT",function(){return cn}),n.d(y,"ALIGN_RIGHT",function(){return fn}),n.d(y,"BASELINE_ALPHABETIC",function(){return hn}),n.d(y,"BASELINE_TOP",function(){return dn}),n.d(y,"BASELINE_HANGING",function(){return pn}),n.d(y,"BASELINE_MIDDLE",function(){return yn}),n.d(y,"BASELINE_IDEOGRAPHIC",function(){return vn}),n.d(y,"BASELINE_BOTTOM",function(){return mn});var v={};n.r(v),n.d(v,"Fill",function(){return gn}),n.d(v,"Stroke",function(){return An}),n.d(v,"Shadow",function(){return Cn}),n.d(v,"Text",function(){return xn}),n.d(v,"Pixel",function(){return En}),n.d(v,"GCO",function(){return d}),n.d(v,"LineConf",function(){return p}),n.d(v,"TextConf",function(){return y}),n.d(v,"All",function(){return _n}),n.d(v,"FFSa",function(){return On}),n.d(v,"SSa",function(){return Pn}),n.d(v,"FSa",function(){return Rn}),n.d(v,"SaT",function(){return Dn}),n.d(v,"P",function(){return kn});var m={};n.r(m),n.d(m,"AABB2D",function(){return Nn}),n.d(m,"Circle",function(){return Yn}),n.d(m,"Line2D",function(){return Jn}),n.d(m,"Ray2D",function(){return Jn}),n.d(m,"Polygon2D",function(){return nr}),n.d(m,"Pixel",function(){return vr});var b={};n.r(b),n.d(b,"Timer",function(){return Cr}),n.d(b,"Ticker",function(){return xr});var g={};n.r(g),n.d(g,"Uglify",function(){return Qr}),n.d(g,"ParseImports",function(){return $r}),n.d(g,"SNIPPETS",function(){return Zr}),n.d(g,"Parse",function(){return ti}),n.d(g,"TEXTURE_2D",function(){return ei}),n.d(g,"TEXTURE_2D_BATCH",function(){return ni}),n.d(g,"PIXEL_BATCH",function(){return ri}),n.d(g,"RECTANGLE",function(){return ii}),n.d(g,"CIRCLE",function(){return oi}),n.d(g,"LINE2D",function(){return ai}),n.d(g,"UN",function(){return si}),n.d(g,"RENDERTEXTURE_BLACK_WHITE",function(){return ui}),n.d(g,"RENDERTEXTURE_GRAYSCALE",function(){return li}),n.d(g,"RENDERTEXTURE_SEPIA",function(){return ci}),n.d(g,"RENDERTEXTURE_INVERT",function(){return fi}),n.d(g,"DynamicTEXTURE_2D",function(){return hi});var w={};n.r(w),n.d(w,"ImageLoader",function(){return wi}),n.d(w,"SpritesheetLoader",function(){return Oi}),n.d(w,"XHRLoader",function(){return Si});var A={};n.r(A),n.d(A,"GLProgramController",function(){return Ri}),n.d(A,"GLCircleProgramController",function(){return Ui}),n.d(A,"GLLine2DProgramController",function(){return Xi}),n.d(A,"GLPixelBatchProgramController",function(){return Ki}),n.d(A,"GLRectangleProgramController",function(){return eo}),n.d(A,"GLTexture2DBatchProgramController",function(){return so}),n.d(A,"GLTexture2DProgramController",function(){return po}),n.d(A,"GLDynamicTexture2DProgramController",function(){return wo}),n.d(A,"GLUnProgramController",function(){return Eo}),n.d(A,"GLRendertextureProgramController",function(){return ko});var S={};n.r(S),n.d(S,"ProgramController",function(){return A});var C={};n.r(C),n.d(C,"Option",function(){return Lo}),n.d(C,"Command",function(){return Bo}),n.d(C,"Registry",function(){return Mo});var T={};n.r(T),n.d(T,"Motion",function(){return Xo}),n.d(T,"Manager",function(){return Wo});var x={};n.r(x),n.d(x,"Particle2D",function(){return Xa}),n.d(x,"Oscillation",function(){return Qo}),n.d(x,"System",function(){return Qa});var E={};n.r(E),n.d(E,"Particle2D",function(){return x});var _={};n.r(_),n.d(_,"BasicTexture2D",function(){return bi}),n.d(_,"Spritesheet",function(){return Ei});var O={};n.r(O),n.d(O,"Animation",function(){return Ca}),n.d(O,"Controller",function(){return xa}),n.d(O,"Frame",function(){return Ti});var P={};n.r(P),n.d(P,"AABB2D",function(){return $a});var R={};n.r(R),n.d(R,"Draw",function(){return P});var D=n(2),k=n(3);function I(t,e){var n,r,i=t.split(""),o=[];e=void 0===e?1:e;for(var a=0;a<i.length;++a)n=((n=i[a]).charCodeAt(0)+e).toString(2),r=Object(D.RandomInteger)(1,9),o.push(r+"x"+n.replace(/1/g,r));return o.join(" ")}function L(t,e){var n,r=t.split(" "),i=[];e=void 0===e?1:e;for(var o=0;o<r.length;++o)n=(n=r[o]).slice(2-n.length),i.push(String.fromCharCode(parseInt(n.replace(/[2-9]/g,"1"),2)-e));return i.join("")}var j,B,U,N=Math.ceil;function G(t,e,n,r){var i=t();return null==j&&(j=document.createElement("canvas"),B=j.getContext("2d")),j.width=N(i.w),j.height=N(i.h),null!=e&&(j.width=e),null!=n&&(j.height=n),null!=r?(B.fillStyle=r,B.fillRect(0,0,j.width,j.height)):B.clearRect(0,0,j.width,j.height),B.setTransform(1,0,0,1,0,0),i.Draw(B),j.toDataURL("image/png")}function F(t,e,n,r){var i=new Image;return i.width=e,i.height=n,i.onload=r,i.src=t,i}function M(t,e){var n,r,i,o,a,s,u={},l=t.childNodes,c=l.length;if(1===t.nodeType){if((c=(r=t.attributes).length)>0)for(u.attributes={},n=0,i=r.item(n);n<c;i=r.item(++n))u.attributes[i.nodeName]=i.nodeValue}else 3===t.nodeType&&(/^\s*$/g.exec(t.nodeValue)||(u=t.nodeValue,!0===e&&(u=u.replace(/^\s+|\s+&|\n/gim,""))));if(null!=l)for(c=l.length,n=0,o=l.item(n);n<c;o=l.item(++n))void 0===u[o.nodeName]?u[o.nodeName]=M(o,e):(void 0===u[o.nodeName].push&&(s=u[o.nodeName],u[o.nodeName]=[],Object(D.IsObjectEmpty)(s)||u[o.nodeName].push(s)),a=M(o,e),Object(D.IsObjectEmpty)(a)||u[o.nodeName].push(a));return u["#text"]&&0===u["#text"].length&&delete u["#text"],u}function V(t,e){return null==U&&(U=new DOMParser),M(U.parseFromString(t,"text/xml"),e)}function X(t,e){var n="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t)),r=document.createElement("a");r.setAttribute("href",n),r.setAttribute("download",e+".json"),r.click()}var Y=Math.sin,H=Math.cos,W=Math.sqrt,q=Math.PI,z=function(t,e,n,r){return n*t/r+e},K=function(t,e,n,r){return n*(t/=r)*t+e},J=function(t,e,n,r){return-n*(t/=r)*(t-2)+e},Q=function(t,e,n,r){return(t/=.5*r)<1?.5*n*t*t+e:.5*-n*(--t*(t-2)-1)+e},$=function(t,e,n,r){return-n*H(t/r*(.5*q))+n+e},Z=function(t,e,n,r){return n*Y(t/r*(.5*q))+e},tt=function(t,e,n,r){return.5*-n*(H(q*t/r)-1)+e},et=function(t,e,n,r){return-n*(W(1-(t/=r)*t)-1)+e},nt=function(t,e,n,r){return t/=r,n*W(1- --t*t)+e},rt=function(t,e,n,r){return(t/=.5*r)<1?.5*-n*(W(1-t*t)-1)+e:.5*n*(W(1-(t-=2)*t)+1)+e};function it(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ot=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.objects=[],this.floodFunction=null,this.floodAmount=null,this.context=null,this.arguments=null}return function(t,e,n){e&&it(t.prototype,e),n&&it(t,n)}(t,[{key:"Store",value:function(t){this.objects.push(t)}},{key:"PreRetrieve",value:function(){0===this.objects.length&&this.Flood()}},{key:"Retrieve",value:function(){return this.PreRetrieve(),this.objects.pop()}},{key:"Flood",value:function(t,e,n){t&&(this.floodFunction=t),e&&(this.floodAmount=e),n&&(this.context=n);for(var r=0;r<this.floodAmount;++r)this.Store(this.floodFunction.call(this.context))}},{key:"Flush",value:function(){this.objects.length=0}},{key:"Clean",value:function(){var t=this.objects.length;this.Flush(),this.Flood(void 0,t)}}]),t}();function at(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var st=Math.ceil,ut=Math.round,lt=Math.abs,ct=Math.sqrt,ft=Math.atan2,ht=Math.cos,dt=Math.sin,pt=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=n}return function(t,e,n){e&&at(t.prototype,e),n&&at(t,n)}(t,[{key:"Copy",value:function(){return!0===vt?yt.Retrieve(this.x,this.y):new t(this.x,this.y)}},{key:"FromPool",value:function(e,n){return!0===vt?yt.Retrieve(e,n):new t(e,n)}},{key:"AbsoluteCopy",value:function(){var t=this.Copy();return t.Positive(),t}},{key:"SetV",value:function(t){return this.x=t.x,this.y=t.y,this}},{key:"Set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"SetSame",value:function(t){return this.x=t,this.y=t,this}},{key:"Is0",value:function(){return 0===this.x&&0===this.y}},{key:"AddVC",value:function(t){return this.Copy().AddV(t)}},{key:"AddV",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"Add",value:function(t,e){return this.x+=t,this.y+=e,this}},{key:"SubtractVC",value:function(t){return this.Copy().SubtractV(t)}},{key:"SubtractV",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"Subtract",value:function(t,e){return this.x-=t,this.y-=e,this}},{key:"MultiplyVC",value:function(t){return this.Copy().MultiplyV(t)}},{key:"MultiplyV",value:function(t){return this.x*=t.x,this.y*=t.y,this}},{key:"Multiply",value:function(t,e){return this.x*=t,this.y*=e,this}},{key:"DivideVC",value:function(t){return this.Copy().DivideV(t)}},{key:"DivideV",value:function(t){return this.x/=t.x,this.y/=t.y,this}},{key:"Divide",value:function(t,e){return this.x/=t,this.y/=e,this}},{key:"Normalize",value:function(){var t=this.GetMagnitude();return this.Divide(t,t)}},{key:"Positive",value:function(){return this.x=lt(this.x),this.y=lt(this.y),this}},{key:"Negative",value:function(){return this.x=-lt(this.x),this.y=-lt(this.y),this}},{key:"Invert",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"Rotate",value:function(t){var e=dt(t),n=ht(t),r=this.x,i=this.y;return this.x=r*n-i*e,this.y=r*e+i*n,this}},{key:"RotateAroundV",value:function(t,e){return this.SubtractV(t).Rotate(e).AddV(t)}},{key:"RotateAround",value:function(t,e,n){return this.SubtractV(t,e).Rotate(n).AddV(t,e)}},{key:"RotateAbsolute",value:function(t){return this.Rotate(t-this.GetAngle())}},{key:"RotateAbsoluteAroundV",value:function(t,e){return this.SubtractV(t).RotateAbsolute(e).AddV(t)}},{key:"RotateAbsoluteAround",value:function(t,e,n){return this.SubtractV(t,e).RotateAbsolute(n).AddV(t,e)}},{key:"PushFromV",value:function(t,e){var n=this.Copy();return n.SubtractV(t).Normalize().Multiply(e,e),this.AddV(n)}},{key:"PushFrom",value:function(t,e,n){var r=this.Copy();return r.SubtractV(t,e).Normalize().Multiply(n,n),this.AddV(r)}},{key:"GetWeightedAverageV",value:function(t,e){return this.FromPool(this.x*(1-e)+t.x*e,this.y*(1-e)+t.y*e)}},{key:"GetWeightedAverage",value:function(t,e,n){return this.FromPool(this.x*(1-n)+t*n,this.y*(1-n)+e*n)}},{key:"GetAngle",value:function(){return ft(this.y,this.x)}},{key:"GetAngleBetweenV",value:function(t){return ft(this.y-t.y,this.x-t.x)}},{key:"GetAngleBetween",value:function(t,e){return ft(this.y-e,this.x-t)}},{key:"GetDotV",value:function(t){return this.x*t.x+this.y*t.y}},{key:"GetDot",value:function(t,e){return this.x*t+this.y*e}},{key:"GetCrossV",value:function(t){return this.x*t.y+this.y*t.x}},{key:"GetCross",value:function(t,e){return this.x*e+this.y*t}},{key:"GetMagnitudeSquared",value:function(){return this.x*this.x+this.y*this.y}},{key:"GetMagnitude",value:function(){return ct(this.x*this.x+this.y*this.y)}},{key:"GetDistanceSquaredV",value:function(t){return this.Copy().SubtractV(t).GetMagnitudeSquared()}},{key:"GetDistanceSquared",value:function(t,e){return this.Copy().Subtract(t,e).GetMagnitudeSquared()}},{key:"GetDistanceV",value:function(t){return this.Copy().SubtractV(t).GetMagnitude()}},{key:"GetDistance",value:function(t,e){return this.Copy().Subtract(t,e).GetMagnitude()}},{key:"GetPerpendicularCCWV",value:function(t){return this.FromPool(-(t.y-this.y),t.x-this.x)}},{key:"GetPerpendicularCCW",value:function(t,e){return this.FromPool(-(e-this.y),t-this.x)}},{key:"GetPerpendicularCWV",value:function(t){return this.FromPool(t.y-this.y,-(t.x-this.x))}},{key:"GetPerpendicularCW",value:function(t,e){return this.FromPool(e-this.y,-(t-this.x))}},{key:"GetNormalAV",value:function(t){return this.GetPerpendicularCCWV(t).Normalize()}},{key:"GetNormalA",value:function(t,e){return this.GetPerpendicularCCW(t,e).Normalize()}},{key:"GetNormalBV",value:function(t){return this.GetPerpendicularCWV(t).Normalize()}},{key:"GetNormalB",value:function(t,e){return this.GetPerpendicularCW(t,e).Normalize()}},{key:"GetMidpointV",value:function(t){return this.Copy().AddV(t).Divide(2,2)}},{key:"GetMidpoint",value:function(t,e){return this.Copy().Add(t,e).Multiply(.5,.5)}},{key:"IsEqualToV",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"IsEqualTo",value:function(t,e){return this.x===t&&this.y===e}},{key:"GetProjectionOntoV",value:function(t){var e=this.GetDotV(t);if(0===e)return this.FromPool(0,0);var n=t.GetMagnitude(),r=e/(n*n);return t.Copy().Multiply(r,r)}},{key:"GetProjectionOnto",value:function(t,e){var n=this.Copy();n.Set(t,e);var r=this.GetDotV(n);if(0===r)return this.FromPool(0,0);var i=n.GetMagnitude(),o=r/(i*i);return n.Multiply(o,o),n}},{key:"GetReflectionV",value:function(t){var e=t.Copy(),n=this.GetDotV(e);return e.Multiply(2,2).Multiply(n,n),this.SubtractVC(e)}},{key:"GetReflection",value:function(t,e){var n=this.Copy();n.Set(t,e);var r=this.GetDotV(n);return n.Multiply(2,2).Multiply(r,r),this.SubtractVC(n)}},{key:"Store",value:function(){return yt.Store(this),this}},{key:"AddTo",value:function(t){for(var e=0;e<t.length;++e)t[e].AddV(this);return this}},{key:"Floor",value:function(){return this.x=0|this.x,this.y=0|this.y,this}},{key:"Ceil",value:function(){return this.x=st(this.x),this.y=st(this.y),this}},{key:"Round",value:function(){return this.x=ut(this.x),this.y=ut(this.y),this}},{key:"GetMinMaxDot",value:function(t){for(var e=1/0,n=-e,r=0,i=this.Copy(),o=0;o<t.length;++o)(r=t[o].GetDotV(this))>n&&(n=r),r<e&&(e=r);return i.Set(e,n),i}}],[{key:"SortMinMag",value:function(t,e){return t.GetMagnitudeSquared()-e.GetMagnitudeSquared()}},{key:"pool",get:function(){return yt}},{key:"USE_POOL",get:function(){return vt},set:function(t){vt=!!t}}]),t}(),yt=new ot,vt=!0;function mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}yt.Retrieve=function(t,e){return this.PreRetrieve(),this.objects.pop().Set(t,e)},yt.Flood(function(){return new pt(0,0)},1e3);var bt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new pt(0,0),this.occured=!1}return function(t,e,n){e&&mt(t.prototype,e),n&&mt(t,n)}(t,[{key:"Reset",value:function(){this.mtv.SetSame(0),this.occured=!1}}]),t}(),gt=function(t,e,n){var r=t.shape,i=r.w,o=r.h,a=t.anchor,s=e.shape,u=s.w,l=s.h,c=e.anchor;wt.SetV(r.tl).SubtractV(t.relative),At.SetV(s.tl).SubtractV(e.relative);var f=At.x+i,h=wt.x+u,d=At.y+o,p=wt.y+l;return void 0!=a&&(wt.x+=a.x*i,wt.y+=a.y*o),void 0!=c&&(At.x+=c.x*u,At.y+=c.y*l),wt.x<f&&At.x<h&&wt.y<d&&At.y<p&&(void 0!=n&&(St[0].Set(wt.x-f,0),St[1].Set(h-At.x,0),St[2].Set(0,wt.y-d),St[3].Set(0,p-At.y),St.sort(pt.SortMinMag),n.mtv.SetV(St[0]),n.occured=!0),!0)},wt=new pt(0,0),At=new pt(0,0),St=[new pt(0,0),new pt(0,0),new pt(0,0),new pt(0,0)];function Ct(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Tt=Math.sqrt,xt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new pt(0,0),this.poc={a:new pt(0,0),b:new pt(0,0),c:new pt(0,0)},this.mtd=0,this.delta=new pt(0,0),this.occured=!1}return function(t,e,n){e&&Ct(t.prototype,e),n&&Ct(t,n)}(t,[{key:"Reset",value:function(){this.poc.a.SetSame(0),this.poc.b.SetSame(0),this.poc.c.SetSame(0),this.mtv.SetSame(0),this.mtd=0,this.delta.SetSame(0),this.occured=!1}}]),t}(),Et=function(t,e,n){var r=t.shape,i=e.shape,o=r.radius,a=i.radius,s=o+a,u=t.anchor,l=e.anchor;Rt.SetV(t.relative),Dt.SetV(e.relative),jt.SetV(Dt).SubtractV(Rt);var c=jt.GetMagnitudeSquared();if(void 0!=u&&(Rt.x+=u.x*r.diameter,Rt.y+=u.y*r.diameter),void 0!=l&&(Dt.x+=l.x*i.diameter,Dt.y+=l.y*i.diameter),s*s>c){if(void 0!=n){var f=Tt(c),h=(r.radiusSquared-i.radiusSquared+c)/(f+f),d=Tt(r.radiusSquared-h*h)/f,p=-jt.y*d,y=jt.x*d;kt.Set(Rt.x+jt.x*h/f,Rt.y+jt.y*h/f),It.Set(kt.x+p,kt.y+y),Lt.Set(kt.x-p,kt.y-y),Rt.SubtractV(Dt).Divide(s,s);var v=f-o-a;n.poc.a.SetV(kt),n.poc.b.SetV(It),n.poc.c.SetV(Lt),n.mtv.SetV(Rt),n.mtd=v,n.delta.SetV(jt),n.occured=!0}return!0}return!1},_t=function(t,e,n){Ot.SetV(n.delta).Normalize(),Pt.SetV(n.mtv);var r=t.mass,i=e.mass,o=t.velocity,a=e.velocity,s=2*(o.GetDotV(Ot)-a.GetDotV(Ot))/(r+i);o.Set(o.x-s*i*Ot.x,o.y-s*i*Ot.y),a.Set(a.x+s*r*Ot.x,a.y+s*r*Ot.y),Pt.Multiply(n.mtd,n.mtd).Divide(2,2),t.relative.SubtractV(Pt),e.relative.AddV(Pt)},Ot=new pt(0,0),Pt=new pt(0,0),Rt=new pt(0,0),Dt=new pt(0,0),kt=new pt(0,0),It=new pt(0,0),Lt=new pt(0,0),jt=new pt(0,0);function Bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ut=Math.sqrt,Nt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new pt(0,0),this.cp=new pt(0,0),this.sOrE=0,this.occured=!1}return function(t,e,n){e&&Bt(t.prototype,e),n&&Bt(t,n)}(t,[{key:"Reset",value:function(){this.mtv.SetSame(0),this.cp.SetSame(0),this.sOrE=0,this.occured=!1}}]),t}(),Gt=function(t,e,n){var r=e.shape,i=t.shape,o=e.relative,a=t.relative;Mt.Set(r.s.x+o.x,r.s.y+o.y),Vt.Set(r.e.x+o.x,r.e.y+o.y);var s=Object(k.ClosestPointOnLine)(Mt,Vt,a);Xt.Set(a.x-s.x,a.y-s.y);var u=Xt.GetMagnitudeSquared();if(u<i.radiusSquared){if(n){var l=i.radius-Ut(u);Xt.Normalize().Multiply(l,l),n.mtv.SetV(Xt),n.cp.SetV(s),n.occured=!0,s===Mt?n.sOrE=1:s===Vt&&(n.sOrE=-1)}return!0}return!1},Ft=function(t,e,n){var r,i,o=e.shape,a=t.velocity,s=t.relative,u=n.cp;0!==n.sOrE?(r=u.SubtractVC(s)).Normalize():r=o.GetNormalA(),i=a.GetReflectionV(r),a.SetV(i),s.AddV(n.mtv)},Mt=new pt(0,0),Vt=new pt(0,0),Xt=new pt(0,0);function Yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ht=Math.abs,Wt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new pt(0,0),this.olAxis=new pt(0,0),this.mtd=1/0,this.occured=!1}return function(t,e,n){e&&Yt(t.prototype,e),n&&Yt(t,n)}(t,[{key:"Reset",value:function(){this.occured=!1,this.mtv.Set(0,0),this.mtd=1/0,this.olAxis.Set(0,0)}}]),t}(),qt=function(t,e,n){for(var r=0,i=t.shape,o=e.shape,a=i.normals,s=o.normals,u=a.length,l=s.length;r<u;++r)if(!0===zt(t,e,a[r],n))return!1;for(r=0;r<l;++r)if(!0===zt(t,e,s[r],n))return!1;return void 0!=n&&(n.mtv.SetV(n.olAxis),n.mtv.Multiply(n.mtd,n.mtd),n.occured=!0),!0},zt=function(t,e,n,r){var i=n.GetMinMaxDot(t.shape.vertices),o=n.GetMinMaxDot(e.shape.vertices),a=e.relative.SubtractVC(t.relative).GetDotV(n);if(o.Add(a,a),i.x>o.y||o.x>i.y)return!0;if(void 0!=r){var s=0,u=0,l=0,c=i.x,f=i.y,h=o.x,d=o.y;s=c<h?f<d?f-h:(u=f-h)<(l=d-c)?u:-l:f>d?c-d:(u=f-h)<(l=d-c)?u:-l;var p=Ht(s);p<r.mtd&&(r.mtd=p,r.olAxis.SetV(n),s<0&&r.olAxis.Invert())}return!1},Kt=Math.PI,Jt=Math.cos,Qt=Math.sin,$t=Math.abs,Zt=Math.pow,te=Math.exp,ee=function(t,e,n,r,i){var o=new pt(e,n),a=new pt(e+r,n),s=new pt(e+r,n+i),u=new pt(e,n+i);return t.Recreate([o,a,s,u]),t.ComputeBounds(),t.GetNormalsA(),t},ne=function(t,e,n,r,i){var o=new pt(e,n),a=new pt(e+.5*r,n+i),s=new pt(e-.5*r,n+i);return t.Recreate([o,a,s]),t.ComputeBounds(),t.GetNormalsA(),t},re=function(t,e,n,r,i){var o,a,s,u=0,l=i,c=2*Kt/l;for(t.Recreate([]);u<l;++u)o=Jt(s=c*u)*r,a=Qt(s)*r,t.AddVertex(new pt(e+o,n+a));return t.ComputeBounds(),t.GetNormalsA(),t},ie=function(t,e,n,r){var i,o,a=2.0943951023931953;return t.Recreate([]),i=r,o=0,t.AddVertex(new pt(e+i,n+o)),i=Jt(a)*r,o=Qt(a)*r,t.AddVertex(new pt(e+i,n+o)),i=Jt(2*a)*r,o=Qt(2*a)*r,t.AddVertex(new pt(e+i,n+o)),t.Rotate(-90*new Math.RADIAN),t.ComputeBounds(),t.GetNormalsA(),t},oe=function(t,e,n,r,i,o){var a,s,u,l,c=0,f=2*o,h=2*Math.PI/f;for(t.Recreate([]);c<f;++c)l=0==(1&c)?r:i,u=h*c,a=Math.cos(u)*l,s=Math.sin(u)*l,t.AddVertex(new pt(e+a,n+s));return t.ComputeBounds(),t.GetNormalsA(),t},ae=function t(e,n,r,i,o){var a,s,u,l=0,c=t.C;for(e.Recreate([]);l<i;++l)u=l*c._1*Kt/i,a=Jt(u)*(te(Jt(u))-c._2*Jt(c._3*u)-Zt(Qt(u/c._4),c._5))*o,s=Qt(u)*(te(Jt(u))-c._2*Jt(c._3*u)-Zt(Qt(u/c._4),c._5))*o,e.AddVertex(new pt(n+a,r+s));return e.ComputeBounds(),e.GetNormalsA(),e};ae.C={_1:24,_2:2,_3:4,_4:12,_5:5};var se=function(t,e,n,r,i,o,a){var s,u,l,c,f=0,h=o,d=2*Kt/h*a;for(t.Recreate([]);f<h;++f)c=Jt(i*(l=d*f))*r,s=Jt(l)*c,u=Qt(l)*c,t.AddVertex(new pt(e+s,n+u));return t.ComputeBounds(),t.GetNormalsA(),t},ue=function t(e,n,r,i,o,a,s,u,l){var c,f,h,d,p,y,v=0,m=o,b=t.C;for(s=null==s?1:s,u=null==u?1:u,l=null==l?1:l,e.Recreate([]);v<m;++v)p=Jt(a*(h=v*Kt*2/o)/4)/b._A,p=$t(p),p=Zt(p,u),y=Qt(a*h/4)/b._B,y=$t(y),y=Zt(y,l),d=Zt(p+y,1/s),0===$t(d)?(c=0,f=0):(d=1/d,c=Jt(h)*d*i,f=Qt(h)*d*i),e.AddVertex(new pt(n+c,r+f));return e.ComputeBounds(),e.GetNormalsA(),e};function le(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}ue.C={_A:1,_B:1};var ce=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tl=new pt(e,n),this.br=new pt(r,i),this.w=0,this.h=0,this.hw=0,this.hh=0,this.area=0,this.belongsTo=null,this.TYPE=ye,this.ComputeWH()}return function(t,e,n){e&&le(t.prototype,e),n&&le(t,n)}(t,[{key:"Set",value:function(t,e,n,r){this.tl.Set(t,e),this.br.Set(n,r),this.ComputeWH()}},{key:"SetC",value:function(t){this.Set(t.tl.x,t.tl.y,t.br.x,t.br.y)}},{key:"Scale",value:function(t,e){this.tl.Multiply(t,e),this.br.Multiply(t,e),this.ComputeWH()}},{key:"ScaleV",value:function(t){this.tl.MultiplyV(t),this.br.MultiplyV(t),this.ComputeWH()}},{key:"ComputeWH",value:function(){this.w=this.br.x-this.tl.x,this.h=this.br.y-this.tl.y,this.hw=.5*this.w,this.hh=.5*this.h,this.area=this.w*this.h}},{key:"IntersectsPoint",value:function(t){return!(t.x<this.tl.x||t.x>this.br.x||t.y<this.tl.y||t.y>this.br.y)}},{key:"ContainsPoint",value:function(t){return t.x>this.tl.x&&t.x<this.br.x&&t.y>this.tl.y&&t.y<this.br.y}},{key:"IntersectsAABB2D",value:function(t){var e=this.tl,n=this.br,r=t.tl,i=t.br;return!(r.x>=n.x||r.y>=n.y||i.x<=e.x||i.y<=e.y)}},{key:"ContainsAABB2D",value:function(t){if(t.area>this.area)return!1;var e=this.tl,n=this.br,r=t.tl,i=t.br;return r.x>=e.x&&r.y>=e.y&&i.x<=n.x&&i.y<=n.y}},{key:"GetQuadrant",value:function(e){var n=this.tl,r=this.br;switch(e){case fe:return new t(n.x,n.y,n.x+this.hw,n.y+this.hh);case he:return new t(n.x+this.hw,n.y,r.x,n.y+this.hh);case de:return new t(n.x,n.y+this.hh,n.x+this.hw,r.y);case pe:return new t(n.x+this.hw,n.y+this.hh,r.x,r.y);default:return null}}}],[{key:"TYPE",get:function(){return ye}}]),t}(),fe="TL",he="TR",de="BL",pe="BR",ye=1;function ve(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var me=Math.PI,be=Math.sin,ge=Math.cos,we=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.center=new pt(e,n),this.diameter=0,this.w=0,this.h=0,this.radiusSquared=0,this.radiusUnsquared=0,this.area=0,this.radius=r,this.belongsTo=null,this.TYPE=Ae}return function(t,e,n){e&&ve(t.prototype,e),n&&ve(t,n)}(t,[{key:"Set",value:function(t,e,n){this.center.Set(t,e),this.radius=n}},{key:"SetC",value:function(t){this.center.SetV(t),this.radius=t.radius}},{key:"Scale",value:function(t){this.radius*=t}},{key:"IntersectsCircle",value:function(t){var e=this.radius+t.radius;return e*e>=this.center.GetDistanceSquaredV(t.center)}},{key:"IntersectsPoint",value:function(t){return this.radiusSquared>=this.center.GetDistanceSquaredV(t)}},{key:"GenerateRandomPoints",value:function(t,e,n){var r=D.RandomFloat,i=new pt(this.x-this.radius,this.y-this.radius),o=new pt(this.x+this.radius,this.y+this.radius),a=[];n=!!n,!0===e&&(r=D.RandomInteger);for(var s=0;s<t;++s){for(var u=Nenkraft.Vector2D(r(i.x,o.x),r(i.y,o.y));this.IntersectsPoint(u)===n;)u.Set(r(i.x,o.x),r(i.y,o.y));a.push(u)}return a}},{key:"GeneratePerimeterPoints",value:function(t,e){var n=[];t*=e;for(var r=0;r<t;r+=e)n.push(Nenkraft.Vector2D(this.x+ge(Object(k.DegreesToRadians)(r))*this.radius,this.y+be(Object(k.DegreesToRadians)(r))*this.radius));return n}},{key:"x",get:function(){return this.center.x},set:function(t){this.center.x=t}},{key:"y",get:function(){return this.center.y},set:function(t){this.center.y=t}},{key:"radius",get:function(){return this.radiusUnsquared},set:function(t){this.radiusUnsquared=t,this.radiusSquared=t*t,this.diameter=this.w=this.h=2*t,this.area=me*t*t}}],[{key:"TYPE",get:function(){return Ae}}]),t}(),Ae=2;function Se(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ce=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.s=new pt(e,n),this.e=new pt(r,i),this.epsilon=1e3,this.belongsTo=null,this.TYPE=Te}return function(t,e,n){e&&Se(t.prototype,e),n&&Se(t,n)}(t,[{key:"Set",value:function(t,e,n,r){this.s.Set(t,e),this.e.Set(n,r)}},{key:"SetC",value:function(t){this.s.SetV(t.s),this.e.SetV(t.e)}},{key:"Stretch",value:function(t){var e=.5*t;this.s.PushFromV(this.e,e),this.e.PushFromV(this.s,e)}},{key:"Rotate",value:function(t,e,n){e=void 0==e?.5:e;var r=this.s.Copy();r.AddV(this.e),r.Multiply(e,void 0==n?e:n),this.s.RotateAroundV(r,t),this.e.RotateAroundV(r,t)}},{key:"Cut",value:function(t,e){null==e&&(e=[]);for(var n=0;n<t.length;++n)e.push(this.s.GetWeightedAverageV(this.e,t[n]));return e}},{key:"GetLength",value:function(){return this.s.GetDistanceV(this.e)}},{key:"GetLengthSquared",value:function(){return this.s.GetDistanceSquaredV(this.e)}},{key:"IntersectsPoint",value:function(t){var e=this.s,n=this.e,r=(t.y-e.y)*(n.x-e.x)-(t.x-e.x)*(n.y-e.y);if(Math.abs(r)>this.epsilon)return!1;var i=(t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y);return!(i<0)&&!(i>this.GetLengthSquared())}},{key:"IntersectsLine",value:function(t){return Object(k.LineLineIntersection)(this.s,this.e,t.s,t.e)}},{key:"GetClosestPointTo",value:function(t){return Object(k.ClosestPointOnLine)(this.s,this.e,t)}},{key:"GetNormalA",value:function(){return this.s.GetNormalAV(this.e)}},{key:"GetNormalB",value:function(){return this.s.GetNormalBV(this.e)}}]),t}(),Te=0;function xe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ee=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertices=[],this.normals=[],this.perimeterMidPoints=[],this.centroid=new pt(0,0),this.aabb=null,this.dirtyBounds=!0,this.belongsTo=null,this.TYPE=_e,null!=e&&this.AddVertices(e)}return function(t,e,n){e&&xe(t.prototype,e),n&&xe(t,n)}(t,[{key:"Copy",value:function(){for(var e=new t,n=this.vertices,r=0;r<n.length;++r)e.AddVertex(n[r].Copy());return e}},{key:"ExtractSegments",value:function(t){var e=this.vertices,n=e.length-1;null==t&&(t=[]);for(var r=0;r<n;++r)t.push(new Ce(e[r],e[r+1]));return t.push(new Ce(e[n],e[0])),t}},{key:"GenerateRandomPoints",value:function(t,e,n){this.ComputeBounds(),n=!!n;var r=D.RandomFloat,i=this.aabb.tl,o=this.aabb.br,a=[];!0===e&&(r=D.RandomInteger);for(var s=0;s<t;++s){for(var u=new pt(r(i.x,o.x),r(i.y,o.y));this.IntersectsPoint(u)===n;)u.Set(r(i.x,o.x),r(i.y,o.y));a.push(u)}return a}},{key:"AddVertex",value:function(t){this.vertices.push(t)}},{key:"AddVertices",value:function(t){if(t[0]instanceof pt)this.vertices.push.apply(this.vertices,t);else if("number"==typeof t[0])for(var e=0;e<t.length;e+=2)this.AddVertex(new pt(t[e],t[e+1]));else if(null!=t[0].x)for(e=0;e<t.length;++e)this.AddVertex(new pt(t[e].x,t[e].y))}},{key:"Recreate",value:function(t){this.vertices.length=0,void 0!=t&&this.vertices.push.apply(this.vertices,t)}},{key:"ComputeBounds",value:function(){var t,e=1/0,n=-e,r=e,i=-e,o=this.vertices;null===this.aabb&&(this.aabb=new ce(0,0,0,0));for(var a=0;a<o.length;++a)(t=o[a]).x<e&&(e=t.x),t.x>n&&(n=t.x),t.y<r&&(r=t.y),t.y>i&&(i=t.y);this.aabb.Set(e,r,n,i),this.dirtyBounds=!1}},{key:"Rotate",value:function(t,e,n,r){var i=0,o=this.aabb,a=o.tl.Copy(),s=this.vertices,u=s.length;for(!0===this.dirtyBounds&&!0===r?this.ComputeBounds():null===this.aabb&&this.ComputeBounds(),e=void 0===e?.5:e,a.AddV(o.br),a.Multiply(e,void 0===n?e:n);i<u;++i)s[i].RotateAroundV(a,t);this.dirtyBounds=!0}},{key:"GetControid",value:function(){var t=this.vertices,e=this.centroid;e.Set(0,0);for(var n=0;n<t.length;++n)e.AddV(t[n]);return e.Divide(t.length,t.length),e}},{key:"GetNormalsA",value:function(){var t=this.vertices,e=t.length-1,n=this.normals;n.length=0;for(var r=0;r<e;++r)n.push(t[r].GetNormalAV(t[r+1]));return n.push(t[e].GetNormalAV(t[0])),n}},{key:"GetNormalsA",value:function(){var t=this.vertices,e=t.length-1,n=this.normals;n.length=0;for(var r=0;r<e;++r)n.push(t[r].GetNormalBV(t[r+1]));return n.push(t[e].GetNormalBV(t[0])),n}},{key:"GetPerimeterMidPoints",value:function(){var t=this.vertices,e=t.length-1,n=this.perimeterMidPoints;n.length=0;for(var r=0;r<e;++r)n.push(t[r].GetMidPointV(t[r+1]));return n.push(t[e].GetMidPointV(t[0])),n}},{key:"IntersectsPoint",value:function(t){if(!0===this.dirtyBounds&&this.ComputeBounds(),!1===this.aabb.IntersectsPoint(t))return!1;for(var e,n,r=!1,i=this.vertices,o=t.x,a=t.y,s=0,u=i.length-1;s<i.length;u=s++)e=i[s],n=i[u],e.y>a!=n.y>a&&o<(n.x-e.x)*(a-e.y)/(n.y-e.y)+e.x&&(r=!r);return r}}]),t}(),_e=3,Oe="source-over",Pe="source-over",Re="source-in",De="source-out",ke="source-atop",Ie="destination-over",Le="destination-in",je="destination-out",Be="destination-atop",Ue="lighter",Ne="copy",Ge="xor",Fe="multiply",Me="overlay",Ve="darken",Xe="lighten",Ye="color-dodge",He="color-burn",We="hard-light",qe="soft-light",ze="difference",Ke="exclusion",Je="hue",Qe="saturation",$e="color",Ze="luminosity",tn="round",en="butt",nn="square",rn="bevel",on="round",an="miter",sn="start",un="end",ln="center",cn="left",fn="right",hn="alphabetic",dn="top",pn="hanging",yn="middle",vn="ideographic",mn="bottom";function bn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var gn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#36802d",this.applied=!0,Object(D.ApplyProperties)(this,e)}return function(t,e,n){e&&bn(t.prototype,e),n&&bn(t,n)}(t,[{key:"Apply",value:function(t){t.fillStyle=this.color}}]),t}();function wn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var An=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#c9df8a",this.lineCap=tn,this.lineJoin=on,this.lineWidth=2,this.miterLimit=10,this.applied=!0,Object(D.ApplyProperties)(this,e)}return function(t,e,n){e&&wn(t.prototype,e),n&&wn(t,n)}(t,[{key:"Apply",value:function(t){t.strokeStyle=this.color,t.lineCap=this.lineCap,t.lineJoin=this.lineJoin,t.lineWidth=this.lineWidth,t.miterLimit=this.miterLimit}}]),t}();function Sn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Cn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#234d20",this.blur=5,this.offsetX=0,this.offsetY=0,this.applied=!1,Object(D.ApplyProperties)(this,e)}return function(t,e,n){e&&Sn(t.prototype,e),n&&Sn(t,n)}(t,[{key:"Apply",value:function(t){t.shadowColor=this.color,t.shadowBlur=this.blur,t.shadowOffsetX=this.offsetX,t.shadowOffsetY=this.offsetY}}]),t}();function Tn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fillColor="#36802d",this.strokeColor="#36802d",this.fontSize=45,this.font=null,this.fontFamily="Arial",this.align=cn,this.baseline=dn,this.lineWidth=.5,this.applied=!0,Object(D.ApplyProperties)(this,e),this.ConcatFont()}return function(t,e,n){e&&Tn(t.prototype,e),n&&Tn(t,n)}(t,[{key:"Apply",value:function(t){t.fillStyle=this.fillColor,t.strokeStyle=this.strokeColor,t.font=this.font,t.textAlign=this.align,t.textBaseline=this.baseline,t.lineWidth=this.lineWidth}},{key:"ConcatFont",value:function(){this.font=this.fontSize+"px "+this.fontFamily}}]),t}();var En=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#c9df8a",this.size=1,Object(D.ApplyProperties)(this,e)},_n=function(t){return{fill:new gn(t?t.fill:null),stroke:new An(t?t.stroke:null),shadow:new Cn(t?t.shadow:null),text:new xn(t?t.text:null),pixel:new En(t?t.pixel:null)}},On=function(t){return{fill:new gn(t?t.fill:null),stroke:new An(t?t.stroke:null),shadow:new Cn(t?t.shadow:null)}},Pn=function(t){return{stroke:new An(t?t.stroke:null),shadow:new Cn(t?t.shadow:null)}},Rn=function(t){return{fill:new gn(t?t.fill:null),shadow:new Cn(t?t.shadow:null)}},Dn=function(t){return{shadow:new Cn(t?t.shadow:null),text:new xn(t?t.text:null)}},kn=function(t){return{pixel:new En(t?t.pixel:null)}};function In(t){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ln(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jn(t,e){return!e||"object"!==In(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bn(t){return(Bn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Un(t,e){return(Un=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nn=function(t){function e(t,n,r,i,o){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=jn(this,Bn(e).call(this,t,n,r,i))).programController=null,a.style=On(o),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Un(t,e)}(e,ce),function(t,e,n){e&&Ln(t.prototype,e),n&&Ln(t,n)}(e,[{key:"Draw",value:function(t){var e=this.tl,n=this.br,r=this.style;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(n.x,e.y),t.lineTo(n.x,n.y),t.lineTo(e.x,n.y),t.closePath(),!0===r.shadow.applied&&r.shadow.Apply(t),!0===r.fill.applied&&(r.fill.Apply(t),t.fill()),!0===r.stroke.applied&&(r.stroke.Apply(t),t.stroke())}},{key:"GLDraw",value:function(t,e){null!==this.programController&&this.programController.Execute(e.globalTransform.AsArray(!0),this.tl.x,this.tl.y,this.w,this.h)}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.fillColor&&null!==t.outlineColor&&null!==t.outline&&(t.fillColor.SetHex(this.style.fill.color),t.fillColor.Normalize(),t.outlineColor.SetHex(this.style.stroke.color),t.outlineColor.Normalize(),t.outline=this.style.stroke.lineWidth+.2),this}}]),e}();function Gn(t){return(Gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mn(t,e){return!e||"object"!==Gn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vn(t){return(Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xn(t,e){return(Xn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yn=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Mn(this,Vn(e).call(this,t,n,r))).programController=null,o.style=On(i),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xn(t,e)}(e,we),function(t,e,n){e&&Fn(t.prototype,e),n&&Fn(t,n)}(e,[{key:"Draw",value:function(t){var e=this.center,n=this.style;t.beginPath(),t.arc(e.x,e.y,this.radius,0,k.PII,!1),t.closePath(),!0===n.shadow.applied&&n.shadow.Apply(t),!0===n.fill.applied&&(n.fill.Apply(t),t.fill()),!0===n.stroke.applied&&(n.stroke.Apply(t),t.stroke())}},{key:"GLDraw",value:function(t,e){null!==this.programController&&this.programController.Execute(e.globalTransform.AsArray(!0),this.center.x,this.center.y,this.radius)}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.fillColor&&null!==t.outlineColor&&null!==t.outline&&(t.fillColor.SetHex(this.style.fill.color),t.fillColor.Normalize(),t.outlineColor.SetHex(this.style.stroke.color),t.outlineColor.Normalize(),t.outline=this.style.stroke.lineWidth+.2),this}}]),e}();function Hn(t){return(Hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qn(t,e){return!e||"object"!==Hn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zn(t){return(zn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kn(t,e){return(Kn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jn=function(t){function e(t,n,r,i,o){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=qn(this,zn(e).call(this,t,n,r,i))).programController=null,a.style=Pn(o),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kn(t,e)}(e,Ce),function(t,e,n){e&&Wn(t.prototype,e),n&&Wn(t,n)}(e,[{key:"Draw",value:function(t){var e=this.s,n=this.e,r=this.style;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(n.x,n.y),t.closePath(),!0===r.shadow.applied&&r.shadow.Apply(t),!0===r.stroke.applied&&(r.stroke.Apply(t),t.stroke())}},{key:"GLDraw",value:function(t,e){null!==this.programController&&this.programController.Execute(e.globalTransform.AsArray(!0),this.s,this.e)}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.color&&(t.color.SetHex(this.style.stroke.color),t.color.Normalize()),this}}]),e}();function Qn(t){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zn(t,e){return!e||"object"!==Qn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tr(t){return(tr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function er(t,e){return(er=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nr=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Zn(this,tr(e).call(this,t))).programController=null,r.style=On(n),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&er(t,e)}(e,Ee),function(t,e,n){e&&$n(t.prototype,e),n&&$n(t,n)}(e,[{key:"Draw",value:function(t){var e=this.vertices,n=this.style;t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var r=1;r<e.length;++r)t.lineTo(e[r].x,e[r].y);t.closePath(),!0===n.shadow.applied&&n.shadow.Apply(t),!0===n.fill.applied&&(n.fill.Apply(t),t.fill()),!0===n.stroke.applied&&(n.stroke.Apply(t),t.stroke())}}]),e}();function rr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ir=Math.max,or=Math.min,ar=Math.round,sr=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.channel=new Float32Array([null==e?0:e,null==n?0:n,null==r?0:r,null==i?1:i]),this.value="",this.currentConversion="",this.ComputeValueRGBA()}return function(t,e,n){e&&rr(t.prototype,e),n&&rr(t,n)}(t,[{key:"Copy",value:function(){var e=new t(this.channel[0],this.channel[1],this.channel[2],this.channel[3]);return e.value=this.value,e.currentConversion=this.currentConversion,e}},{key:"ComputeValueRGBA",value:function(){return this.value="rgba(".concat(this.channel.join(",").concat(")")),this.value}},{key:"ComputeValueHSLA",value:function(){return this.value="hsla("+this.channel[0]+","+this.channel[1]+"%,"+this.channel[2]+"%,"+this.channel[3]+")",this.value}},{key:"ComputeValueHex",value:function(){return this.value="#"+this.channel[0].toString(16)+this.channel[1].toString(16)+this.channel[2].toString(16),this.value}},{key:"ConvertToHSLA",value:function(t){var e=0,n=0,r=this.channel[0]/ur,i=this.channel[1]/ur,o=this.channel[2]/ur,a=ir(r,i,o),s=or(r,i,o),u=a-s,l=.5*(a+s);a!==s&&(n=l>.5?u/(2-a-s):u/(a+s),e=a===r?(i-o)/u+(i<o?6:0):a===i?(o-r)/u+2:(r-i)/u+4,e/=6),this.channel[0]=360*e,this.channel[1]=100*n,this.channel[2]=100*l,!0===t&&(this.channel[0]=ar(this.channel[0]),this.channel[1]=ar(this.channel[1]),this.channel[2]=ar(this.channel[2])),this.currentConversion="hsl",this.ComputeValueHSLA()}},{key:"ConvertToHEX",value:function(){}},{key:"SetRGB",value:function(t,e,n,r){this.channel[0]=Object(D.Clamp)(t,lr,ur),this.channel[1]=Object(D.Clamp)(e,lr,ur),this.channel[2]=Object(D.Clamp)(n,lr,ur),this.currentConversion="rgb",r||this.ComputeValueRGBA()}},{key:"SetRGBA",value:function(t,e,n,r){this.SetRGB(t,e,n,!0),this.channel[3]=Object(D.Clamp)(r,0,1),this.ComputeValueRGBA()}},{key:"SetHex",value:function(t){var e=(t=t.replace(/#/g,"")).match(/.{2}/g);null==(e=e.map(D.Base16ToBase10))[3]&&(e[3]=1),this.SetRGBA(e[0],e[1],e[2],e[3])}},{key:"IncreaseChannel",value:function(t,e){this.channel[t]+=e,"rgb"===this.currentConversion?this.ComputeValueRGBA():"hsl"===this.currentConversion&&this.ComputeValueHSLA()}},{key:"SetChannel",value:function(t,e){this.channel[t]=e,"rgb"===this.currentConversion?this.ComputeValueRGBA():"hsl"===this.currentConversion&&this.ComputeValueHSLA()}},{key:"Normalize",value:function(){this.channel[0]=cr*this.channel[0],this.channel[1]=cr*this.channel[1],this.channel[2]=cr*this.channel[2]}},{key:"r",get:function(){return this.channel[0]},set:function(t){this.channel[0]=t}},{key:"g",get:function(){return this.channel[1]},set:function(t){this.channel[1]=t}},{key:"b",get:function(){return this.channel[2]},set:function(t){this.channel[2]=t}},{key:"a",get:function(){return this.channel[3]},set:function(t){this.channel[3]=t}}]),t}(),ur=255,lr=0,cr=1/ur;function fr(t){return(fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function dr(t,e){return!e||"object"!==fr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pr(t){return(pr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yr(t,e){return(yr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vr=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=dr(this,pr(e).call(this,t,n))).style=kn(r),i.color=new sr,i.programController=null,i.bufferData=null,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yr(t,e)}(e,pt),function(t,e,n){e&&hr(t.prototype,e),n&&hr(t,n)}(e,[{key:"GLDraw",value:function(t,e){null!==this.programController&&this.programController.Execute(e.worldTransform.AsArray(!0),this.x,this.y)}},{key:"LinkProgramController",value:function(t){this.programController=t,this.LinkStyle()}},{key:"UseProgramController",value:function(t){this.programController=t}},{key:"LinkStyle",value:function(){var t=this.programController;null!==t&&null!==t.color&&(t.color.SetHex(this.style.pixel.color),t.color.Normalize())}},{key:"GetBufferData",value:function(){null==this.bufferData&&(this.bufferData=[]);var t=this.bufferData,e=this.color;return t[0]=this.x,t[1]=this.y,t[2]=e.r,t[3]=e.g,t[4]=e.b,t[5]=e.a,t[6]=this.style.pixel.size,t}},{key:"UpdateInBuffer",value:function(t,e){var n=this.color;t[e]=this.x,t[e+1]=this.y,t[e+2]=n.r,t[e+3]=n.g,t[e+4]=n.b,t[e+5]=n.a,t[e+6]=this.style.pixel.size}}]),e}();function mr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var br=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=n,this.holderContext=e,this.handle=r,this.removeOnNextCall=i}return function(t,e,n){e&&mr(t.prototype,e),n&&mr(t,n)}(t,[{key:"Execute",value:function(){this.handle.apply(this.context,arguments),!0===this.removeOnNextCall&&this.Remove()}},{key:"Remove",value:function(){this.holderContext.Remove(this.handle,this.context)}}]),t}();function gr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var wr=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.listeners=[],this.stopPropagation=!1,this.target=null,this.data=null}return function(t,e,n){e&&gr(t.prototype,e),n&&gr(t,n)}(t,[{key:"GetListenerIndex",value:function(t,e){var n,r=this.listeners;if(0===r.length)return-1;for(var i=0;i<r.length;++i)if((n=r[i]).context===e&&n.handle===t)return i;return-1}},{key:"Add",value:function(t,e,n){var r=new br(this,e,t,n);this.listeners.push(r)}},{key:"Remove",value:function(t,e){var n=this.GetListenerIndex(t,e);-1!==n&&this.listeners.fickleSplice(n)}},{key:"Dump",value:function(t){var e=this.listeners;if(void 0!==t)for(var n=0;n<e.length;++n)e[n].context===t&&e.splice(n);else e.length=0}},{key:"Dispatch",value:function(t,e){var n=this.listeners.slice();if(0!==n.length){this.stopPropagation=!1,this.target=t,this.data=e;for(var r=0;r<n.length&&(n[r].Execute(this),!0!==this.stopPropagation);++r);this.target=null,this.data=null}}}]),t}();function Ar(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Sr=Math.round,Cr=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.stopTime=Sr(null==e?0:e),this.time=0,this.isRunning=!1,this.canResume=!1,this.count=0,this.onStop=new wr,this.onFinish=new wr,this.onStart=new wr,this.onReset=new wr,this.onPause=new wr,this.onResume=new wr}return function(t,e,n){e&&Ar(t.prototype,e),n&&Ar(t,n)}(t,[{key:"Reset",value:function(){this.onReset.Dispatch(this,null),this.count=0,this.time=0,this.isRunning=!1,this.canResume=!1}},{key:"Start",value:function(t){this.stopTime=Sr(null==t?this.stopTime:t),this.stopTime>0&&(this.time=0,this.isRunning=!0,this.canResume=!1,this.onStart.Dispatch(this,{stopTime:this.stopTime}))}},{key:"Stop",value:function(){!0===this.isRunning&&(this.isRunning=!1,this.onStop.Dispatch(this,null))}},{key:"Pause",value:function(){!0===this.isRunning&&!1===this.canResume&&(this.isRunning=!1,this.canResume=!0,this.onPause.Dispatch(this,null))}},{key:"Resume",value:function(){!0===this.canResume&&(this.isRunning=!0,this.canResume=!1,this.onResume.Dispatch(this,null))}},{key:"Process",value:function(){this.time<this.stopTime&&!0===this.isRunning&&++this.time>=this.stopTime&&(this.isRunning=!1,this.count++,this.onFinish.Dispatch(this,null))}}]),t}();function Tr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xr=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.SetDesiredRate(n),this.onProcess=e,this.intervalId=null,this.afId=null,this.delta=0,this.then=0,this.now=0,this.desiredRate=0,this.supplyDelta=!0,r||this.StartAF()}return function(t,e,n){e&&Tr(t.prototype,e),n&&Tr(t,n)}(t,[{key:"Process",value:function(){this.onProcess(this.ComputeDelta())}},{key:"ProcessAF",value:function(){this.onProcess(this.ComputeDelta()),null!==this.afId&&(this.afId=requestAnimationFrame(this.ProcessAF))}},{key:"ComputeDelta",value:function(){return this.now=Date.now(),this.delta=this.now-this.then,this.then=this.now,this.delta}},{key:"GetTPS",value:function(){return Object(k.PrecisionRound)(1/this.delta*1e3,2)}},{key:"SetDesiredRate",value:function(t){this.desiredRate=void 0===t?16.66:1e3/t}},{key:"Start",value:function(t){if(null!==this.afId)return Or("%cTicker: RAF is running!","color:red;".concat(_r)),null;null!==this.intervalId?!0===t?(this.Stop(),this.intervalId=setInterval(this.Process.bind(this),this.desiredRate),Or("%cTicker: Starting interval!","color:#0F0;".concat(_r))):Or("%cTicker: Interval already running!","color:#F00;".concat(_r)):(this.intervalId=setInterval(this.Process.bind(this),this.desiredRate),Or("%cTicker: Starting interval!","color:#0F0;".concat(_r)))}},{key:"StartAF",value:function(t){if(null!==this.intervalId)return Or("%cTicker: Interval is running!","color:#F00;".concat(_r)),null;null!==this.afId?!0===t?(this.Stop(),this.ProcessAF=this.ProcessAF.bind(this),this.afId=requestAnimationFrame(this.ProcessAF),Or("%cTicker: Starting RAF!","color:#0F0;".concat(_r))):Or("%cTicker: RAF already running!","color:#F00;".concat(_r)):(this.ProcessAF=this.ProcessAF.bind(this),this.afId=requestAnimationFrame(this.ProcessAF),Or("%cTicker: Starting RAF!","color:#0F0;".concat(_r)))}},{key:"Stop",value:function(){null!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null,Or("%cTicker: Stopping interval!","color:cyan;".concat(_r))),null!==this.afId&&(cancelAnimationFrame(this.afId),this.afId=null,Or("%cTicker: Stopping RAF!","color:cyan;".concat(_r)))}}],[{key:"LOG",get:function(){return Er},set:function(t){(function(t){throw new Error('"'+t+'" is read-only')})("PS_LOG"),Er=!!t}}]),t}(),Er=!0,_r="background-color:#36802d;font-family:Arial;font-size:18px;font-weight:900;padding:5px;",Or=function(){!1!==Er&&console.log.apply(null,arguments)},Pr=n(8),Rr=n.n(Pr),Dr=n(9),kr=n.n(Dr),Ir=n(10),Lr=n.n(Ir),jr=n(11),Br=n.n(jr),Ur=n(12),Nr=n.n(Ur),Gr=n(13),Fr=n.n(Gr),Mr=n(14),Vr=n.n(Mr),Xr=n(15),Yr=n.n(Xr),Hr=n(16),Wr=n.n(Hr),qr=n(17),zr=n.n(qr),Kr=n(18),Jr=n.n(Kr),Qr=function(t){return t.replace(/\/\*[\s\S]*?\*\//g,"").replace(/[\r\t]/g," ").replace(/[ ]{2,}/g," ").replace(/[\n ]{2,}/g,"\n").replace(/\/\/.*/g,"").replace(/\s*(\=|\+|\-|\*|\/|\<|\>|\(|\)|\{|\}|\,|\:|\;|\?)\s*/g,"$1").trim()},$r=function(t){var e,n,r,i,o=t.match(/\((import .[\s\S]*?)\/\)/);if(null==o)return null;if((e=o[1].match(/\[([\s\S]*?)\]/))&&(o[1]=o[1].replace(e[0],""),e=JSON.parse(e[1])),r=o[1].match(/\'(.[\s\S]*?)\'/)[1],i=Zr[r],null!=e){if(null!=e.replace)for(n in e.replace)i=i.replace(new RegExp(n,"g"),e.replace[n]);if(null!=e.set)for(n in e.set){var a=i.match(new RegExp("("+n+"\\s*=\\s*.*?;)",""));if(a){var s=a[1].match(/=([\s\S]*?);/);s[1]=a[1].replace(s[1],e.set[n]),console.log(s),i=i.replace(a[1],s[1])}}}return{imp:o,snippet:i}},Zr={PI:Qr(n(25)),RADIAN:Qr(n(26)),RSEEDS:Qr(n(27)),VRSEEDS:Qr(n(28)),mod289:Qr(n(29)),permute:Qr(n(30)),rotate2d:Qr(n(31)),scale2d:Qr(n(32)),plot:Qr(n(33)),ridge:Qr(n(34)),random:Qr(n(35)),vrandom:Qr(n(36)),noise:Qr(n(37)),gnoise:Qr(n(38)),snoise:Qr(n(39)),fbm:Qr(n(40)),abs_fbm:Qr(n(41)),rot_fbm:Qr(n(42)),rmf:Qr(n(43)),aabb:Qr(n(44)),cruciform:Qr(n(45)),circle:Qr(n(46))},ti=function(t){var e,n,r="@vertex@",i="@fragment@";e=t.indexOf(r)+r.length,n=t.indexOf("@vertex-end@");var o=t.substring(e,n).replace(/\/\*[\s\S]*?\*\//g,"");e=t.indexOf(i)+i.length,n=t.indexOf("@fragment-end@");for(var a=t.substring(e,n).replace(/\/\*[\s\S]*?\*\//g,""),s=!0;!0===s;){s=!1;var u=$r(o);null!=u&&(o=o.replace(u.imp[0],u.snippet),s=!0);var l=$r(a);null!=l&&(a=a.replace(l.imp[0],l.snippet),s=!0)}return{vertex:Qr(o),fragment:Qr(a)}},ei=ti(Rr.a),ni=ti(kr.a),ri=ti(Lr.a),ii=ti(Br.a),oi=ti(Nr.a),ai=ti(Fr.a),si=ti(Vr.a),ui=ti(Yr.a),li=ti(Wr.a),ci=ti(zr.a),fi=ti(Jr.a),hi=function(t){var e,n=[];for(n.push("precision mediump float;"),e=0;e<t;++e)n.push("attribute vec2 aPosition"+e+";","attribute vec2 aTexCoord"+e+";");for(n.push("uniform mat3 uProjection;","uniform mat3 uTranslation;","uniform mat3 uTransformation;","uniform int uUnitId;","varying vec2 vTexCoord;","void main () {","if ( uUnitId == 0 ) {","gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition0, 1.0 ) ).xy, 0.0, 1.0 );","vTexCoord = ( uTransformation * vec3( aTexCoord0, 1.0 ) ).xy;","}"),e=1;e<t;++e)n.push("else if ( uUnitId == "+e+" ) {","gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition"+e+", 1.0 ) ).xy, 0.0, 1.0 );","vTexCoord = ( uTransformation * vec3( aTexCoord"+e+", 1.0 ) ).xy;","}");return n.push("}"),{vertex:n.join(""),fragment:ei.fragment}},di=n(4);function pi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var yi=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,this.items=[]}return function(t,e,n){e&&pi(t.prototype,e),n&&pi(t,n)}(t,[{key:"Store",value:function(t){var e=!1;return null==t?(console.warn("Item is null."),null):(null!=t.id&&""!==t.id?e=!this.Contains(t,t.id):t.data&&null!=t.data.id&&""!==t.data.id&&(e=!this.Contains(t,t.data.id)),!1===e?(console.warn("Invalid item. Check the item id. The item has not been stored"),!1):(this.items.push(t),!0))}},{key:"StoreSafe",value:function(t){return null!=this.type&&Object(di.a)(t,di.a.IS_INSTANCE_OF,this.type),Object(di.a)(t,di.a.IS_SAME_TYPE,vi),t.id?(Object(di.a)(t.id,di.a.IS_SAME_TYPE,mi),Object(di.a)(t.id,di.a.IS_NOT,"")):(Object(di.a)(t.data,di.a.IS_SAME_TYPE,vi),Object(di.a)(t.data.id,di.a.IS_SAME_TYPE,mi),Object(di.a)(t.data.id,di.a.IS_NOT,"")),this.Store(t)}},{key:"GetById",value:function(t){for(var e=this.items,n=e[0],r=0;r<e.length;n=e[++r])if(null!=n&&(n.id===t||null!=n.data&&n.data.id===t))return n;return null}},{key:"Contains",value:function(t,e){for(var n=this.items,r=n[0],i=0;i<n.length;r=n[++i])if(null!=r){if(r===t)return!0;if(r.id===e)return!0;if(null!=r.data&&r.data.id===e)return!0}return!1}}]),t}(),vi=Object.create(null),mi="string";var bi=function t(e,n,r,i,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.image=e,this.id=null,this.w=0,this.h=0,this.fw=0,this.fh=0,this.uniformId=0,this.id=null!=n?n:e.id,this.w=null!=r?r:e.naturalWidth,this.h=null!=i?i:e.naturalHeight,this.fw=null!=o?o:e.naturalWidth,this.fh=null!=a?a:e.naturalHeight};function gi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var wi=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.imageCache=new yi(Image),this.basicTextureCache=new yi(bi),this.onImageLoaded=new wr,this.onComplete=new wr,this.count=0,this.loading=!1,this.toLoad=null,this.createTexture=!1,null!=r&&this.onComplete.Add(r,this),null!=e&&this.Load(e,n)}return function(t,e,n){e&&gi(t.prototype,e),n&&gi(t,n)}(t,[{key:"Load",value:function(t,e){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),null!=e&&(this.createTextures=e),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))}},{key:"Haul",value:function(t){var e=this.toLoad[t];if(null!=e){var n=new Image;n.onload=this.OnLoad.bind(this),n.onerror=this.OnError.bind(this),n.src=e.src,n.id=e.id,n.data=Object.create(null),n.data.w=e.w,n.data.h=e.h,n.data.fw=e.fw,n.data.fh=e.fh}else this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{imageCache:this.imageCache,basicTextureCache:this.basicTextureCache})}},{key:"OnLoad",value:function(t){var e=t.currentTarget;e.onload=null,e.onerror=null,this.imageCache.StoreSafe(e),!0===this.createTextures&&this.basicTextureCache.StoreSafe(new bi(e,null,e.data.w,e.data.h,e.data.fw,e.data.fh)),this.onImageLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count)}},{key:"OnError",value:function(){throw new Error("Request failed")}},{key:"GetImageById",value:function(t){return this.imageCache.GetById(t)}},{key:"GetBasicTextureById",value:function(t){return this.basicTextureCache.GetById(t)}}]),t}();function Ai(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Si=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.XHRcache=new yi(XMLHttpRequest),this.dataCache=new yi,this.onXHRLoaded=new wr,this.onComplete=new wr,this.count=0,this.loading=!1,this.toLoad=null,null!=n&&this.onComplete.Add(n,this),null!=e&&this.Load(e)}return function(t,e,n){e&&Ai(t.prototype,e),n&&Ai(t,n)}(t,[{key:"Load",value:function(t){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))}},{key:"Haul",value:function(t){var e=this.toLoad[t];if(null!=e){var n=new XMLHttpRequest;switch(n.open("GET",e.src),e.type){case"json":n.onreadystatechange=this.OnLoadJSON.bind(this);break;default:n.onreadystatechange=this.OnLoadXML.bind(this)}n.onerror=this.OnError.bind(this),null!=n.data?n.data.id=e.id:n.data={id:e.id},n.send()}else this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{XHRcache:this.XHRcache,dataCache:this.dataCache})}},{key:"OnLoadXML",value:function(t){var e=t.currentTarget;200!==e.status&&null==e.responseText||4!==e.readyState||(e.onload=null,e.onerror=null,this.XHRcache.StoreSafe(e),this.dataCache.Store({id:e.data.id,data:V(e.responseText,!0)}),this.onXHRLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count),e.abort())}},{key:"OnLoadJSON",value:function(t){var e=t.currentTarget;200!==e.status&&null==e.responseText||4!==e.readyState||(e.onload=null,e.onerror=null,this.XHRcache.StoreSafe(e),this.dataCache.Store({id:e.data.id,data:JSON.parse(e.responseText)}),this.onXHRLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count),e.abort())}},{key:"OnError",value:function(t){throw console.error(t),new Error("Request failed")}},{key:"GetXHRById",value:function(t){return this.XHRcache.GetById(t)}},{key:"GetDataById",value:function(t){return this.dataCache.GetById(t).data}},{key:"GetClonedDataById",value:function(t){return Object(D.DeepClone)(this.GetDataById(t))}}]),t}();function Ci(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ti=function(){function t(e,n,r,i,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rate=o,this.timer=o,this.x=e,this.y=n,this.w=r,this.h=i,this.nextFrameIndex=null,this.id=null,null!=a&&(this.id=a)}return function(t,e,n){e&&Ci(t.prototype,e),n&&Ci(t,n)}(t,[{key:"Process",value:function(){return this.timer--<=0&&(this.Reset(),!0)}},{key:"Apply",value:function(t){t.ClipReconfigure(this.x,this.y,this.w,this.h)}},{key:"Reset",value:function(){this.timer=this.rate}}]),t}();function xi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ei=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.id,this.basicTexture=e,this.data=n,this.frameCache=new yi(Ti)}return function(t,e,n){e&&xi(t.prototype,e),n&&xi(t,n)}(t,[{key:"GenerateFrames",value:function(){for(var t,e,n,r=this.data,i=r.frames,o=r.meta.frameTags,a=0;a<i.length;++a)e=(t=i[a]).frame,n=o[a],this.frameCache.Store(new Ti(e.x,e.y,e.w,e.h,t.duration,n?n.name:null))}},{key:"GetFrameById",value:function(t){return this.frameCache.GetById(t)}}]),t}();function _i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Oi=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.spritesheetCache=new yi(Ei),this.xhrLoader=new Si,this.imageLoader=new wi,this.onComplete=new wr,this.onSpritesheetLoaded=new wr,this.count=0,this.loading=!1,this.toLoad=null,this.pairCount=0,this.tempBasicTexture=null,this.tempData=null,this.xhrLoader.onXHRLoaded.Add(this.OnPartXHRLoaded,this),this.imageLoader.onImageLoaded.Add(this.OnPartImageLoaded,this),null!=n&&this.onComplete.Add(n,this),null!=e&&this.Load(e)}return function(t,e,n){e&&_i(t.prototype,e),n&&_i(t,n)}(t,[{key:"Load",value:function(t){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))}},{key:"Haul",value:function(t){var e=this.toLoad[t];null!=e?(e.data.id=e.image.id=e.id,this.xhrLoader.Load([e.data]),this.imageLoader.Load([e.image],!0)):(this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{spritesheetCache:this.spritesheetCache}))}},{key:"OnPartLoaded",value:function(){if(2==++this.pairCount){var t=this.tempData.meta.size;this.tempBasicTexture.fw=t.w,this.tempBasicTexture.fh=t.h;var e=new Ei(this.tempBasicTexture,this.tempData);this.spritesheetCache.StoreSafe(e),this.pairCount=0,this.onSpritesheetLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count)}}},{key:"OnPartXHRLoaded",value:function(t){this.tempData=this.xhrLoader.GetDataById(t.target.data.id),this.OnPartLoaded()}},{key:"OnPartImageLoaded",value:function(t){this.tempBasicTexture=this.imageLoader.GetBasicTextureById(t.target.id),this.OnPartLoaded()}},{key:"GetSpritesheetById",value:function(t){return this.spritesheetCache.GetById(t)}}]),t}();function Pi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ri=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.data={},this.program=null,this.attributes=null,this.uniforms=null,null!=e&&null!=n&&this.Init(n.vertex,n.fragment)}return function(t,e,n){e&&Pi(t.prototype,e),n&&Pi(t,n)}(t,[{key:"Init",value:function(t,e){var n=this.gl,r=this.CreateShader(t,n.VERTEX_SHADER),i=this.CreateShader(e,n.FRAGMENT_SHADER),o=this.program=n.createProgram();if(n.attachShader(o,r),n.attachShader(o,i),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS)){var a=n.getProgramInfoLog(o);throw new Error("Program link failed:"+a)}n.detachShader(o,r),n.detachShader(o,i),n.deleteShader(r),n.deleteShader(i),this.attributes={},this.uniforms={}}},{key:"CreateShader",value:function(t,e){var n=this.gl,r=n.createShader(e);if(n.shaderSource(r,t),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS)){var i=n.getShaderInfoLog(r);throw new Error("Shader compilation failed:"+i)}return r}},{key:"AssignAttribute",value:function(t){this.attributes[t]=this.gl.getAttribLocation(this.program,t)}},{key:"AssignUniform",value:function(t){this.uniforms[t]=this.gl.getUniformLocation(this.program,t)}},{key:"Execute",value:function(){}}],[{key:"LAST_USED_CONTROLLER",get:function(){return Di},set:function(t){Di=t}}]),t}(),Di=null;function ki(t){return(ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ii(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Li(t,e){return!e||"object"!==ki(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ji(t){return(ji=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bi(t,e){return(Bi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ui=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Li(this,ji(e).call(this,t,oi))).essenceBuffer=null,n.vertices=null,n.fillColor=null,n.outlineColor=null,n.outline=5,n.Initialise(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bi(t,e)}(e,Ri),function(t,e,n){e&&Ii(t.prototype,e),n&&Ii(t,n)}(e,[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array(Object(k.TriRectArray)(0,0,1,1)),this.fillColor=new sr,this.outlineColor=new sr,t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uFillColor"),this.AssignUniform("uOutlineColor"),this.AssignUniform("uRadius"),this.AssignUniform("uOutline")}},{key:"Execute",value:function(t,e,n,r){var i=this.gl,o=this.attributes,a=this.uniforms,s=this.vertices,u=this.fillColor.channel,l=this.outlineColor.channel;Object(k.TriRectArray)(e-r,n-r,2*r,2*r,s),this!==Ri.LAST_USED_CONTROLLER&&(i.useProgram(this.program),Ri.LAST_USED_CONTROLLER=this),i.bindBuffer(i.ARRAY_BUFFER,this.essenceBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,s),i.enableVertexAttribArray(o.aPosition),i.vertexAttribPointer(o.aPosition,2,i.FLOAT,!1,0,0),i.uniformMatrix3fv(a.uProjection,!1,t),i.uniform4f(a.uFillColor,u[0],u[1],u[2],u[3]),i.uniform4f(a.uOutlineColor,l[0],l[1],l[2],l[3]),i.uniform1f(a.uOutline,this.outline),i.uniform1f(a.uRadius,r),i.drawArrays(i.TRIANGLE_STRIP,0,6)}}]),e}();function Ni(t){return(Ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Fi(t,e){return!e||"object"!==Ni(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mi(t){return(Mi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vi(t,e){return(Vi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xi=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Fi(this,Mi(e).call(this,t,ai))).essenceBuffer=null,n.vertices=null,n.color=null,n.Initialise(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vi(t,e)}(e,Ri),function(t,e,n){e&&Gi(t.prototype,e),n&&Gi(t,n)}(e,[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array([-1,0,1,0]),this.color=new sr,t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uColor")}},{key:"Execute",value:function(t,e,n){var r=this.gl,i=this.attributes,o=this.uniforms,a=this.vertices,s=this.color.channel;a[0]=e.x,a[1]=e.y,a[2]=n.x,a[3]=n.y,this!==Ri.LAST_USED_CONTROLLER&&(r.useProgram(this.program),Ri.LAST_USED_CONTROLLER=this),r.bindBuffer(r.ARRAY_BUFFER,this.essenceBuffer),r.bufferSubData(r.ARRAY_BUFFER,0,a),r.enableVertexAttribArray(i.aPosition),r.vertexAttribPointer(i.aPosition,2,r.FLOAT,!1,0,0),r.uniformMatrix3fv(o.uProjection,!1,t),r.uniform4f(o.uColor,s[0],s[1],s[2],s[3]),r.drawArrays(r.LINES,0,2)}}]),e}();function Yi(t){return(Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wi(t,e){return!e||"object"!==Yi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qi(t){return(qi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zi(t,e){return(zi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ki=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Wi(this,qi(e).call(this,t,ri))).dataBuffer=null,n.previousNumberOfElements=0,n.Initialise(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zi(t,e)}(e,Ri),function(t,e,n){e&&Hi(t.prototype,e),n&&Hi(t,n)}(e,[{key:"Initialise",value:function(){var t=this.gl;this.dataBuffer=t.createBuffer(),this.AssignAttribute("aProjection1"),this.AssignAttribute("aProjection2"),this.AssignAttribute("aProjection3"),this.AssignAttribute("aPosition"),this.AssignAttribute("aColor"),this.AssignAttribute("aPointSize")}},{key:"Execute",value:function(t,e){var n=this.gl,r=this.attributes;Ri.LAST_USED_CONTROLLER!==this&&(n.useProgram(this.program),Ri.LAST_USED_CONTROLLER=this),n.bindBuffer(n.ARRAY_BUFFER,this.dataBuffer),e!==this.previousNumberOfElements?n.bufferData(n.ARRAY_BUFFER,t,n.DYNAMIC_DRAW):n.bufferSubData(n.ARRAY_BUFFER,0,t),n.enableVertexAttribArray(r.aProjection1),n.vertexAttribPointer(r.aProjection1,3,n.FLOAT,!1,64,0),n.enableVertexAttribArray(r.aProjection2),n.vertexAttribPointer(r.aProjection2,3,n.FLOAT,!1,64,12),n.enableVertexAttribArray(r.aProjection3),n.vertexAttribPointer(r.aProjection3,3,n.FLOAT,!1,64,24),n.enableVertexAttribArray(r.aPosition),n.vertexAttribPointer(r.aPosition,2,n.FLOAT,!1,64,36),n.enableVertexAttribArray(r.aColor),n.vertexAttribPointer(r.aColor,4,n.FLOAT,!1,64,44),n.enableVertexAttribArray(r.aPointSize),n.vertexAttribPointer(r.aPointSize,1,n.FLOAT,!1,64,60),n.drawArrays(n.POINTS,0,e),this.previousNumberOfElements=e}}]),e}();function Ji(t){return(Ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $i(t,e){return!e||"object"!==Ji(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zi(t){return(Zi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function to(t,e){return(to=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var eo=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=$i(this,Zi(e).call(this,t,ii))).essenceBuffer=null,n.vertices=null,n.fillColor=null,n.outlineColor=null,n.outline=5,n.Initialise(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&to(t,e)}(e,Ri),function(t,e,n){e&&Qi(t.prototype,e),n&&Qi(t,n)}(e,[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array(Object(k.TriRectArray)(0,0,1,1)),this.fillColor=new sr,this.outlineColor=new sr,t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uFillColor"),this.AssignUniform("uOutlineColor"),this.AssignUniform("uSize"),this.AssignUniform("uOutline")}},{key:"Execute",value:function(t,e,n,r,i){var o=this.gl,a=this.attributes,s=this.uniforms,u=this.vertices,l=this.fillColor.channel,c=this.outlineColor.channel;Object(k.TriRectArray)(e,n,r,i,u),this!==Ri.LAST_USED_CONTROLLER&&(o.useProgram(this.program),Ri.LAST_USED_CONTROLLER=this),o.bindBuffer(o.ARRAY_BUFFER,this.essenceBuffer),o.bufferSubData(o.ARRAY_BUFFER,0,u),o.enableVertexAttribArray(a.aPosition),o.vertexAttribPointer(a.aPosition,2,o.FLOAT,!1,0,0),o.uniformMatrix3fv(s.uProjection,!1,t),o.uniform4f(s.uFillColor,l[0],l[1],l[2],l[3]),o.uniform4f(s.uOutlineColor,c[0],c[1],c[2],c[3]),o.uniform1f(s.uOutline,this.outline),o.uniform2f(s.uSize,r,i),o.drawArrays(o.TRIANGLE_STRIP,0,6)}}]),e}();function no(t){return(no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ro(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function io(t,e){return!e||"object"!==no(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function oo(t){return(oo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ao(t,e){return(ao=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var so=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=io(this,oo(e).call(this,t,ni))).originalTexture=null,n.texture=null,n.essenceBuffer=null,n.dataBuffer=null,n.indexBuffer=null,n.previousNumberOfElements=0,n.Initialise(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ao(t,e)}(e,Ri),function(t,e,n){e&&ro(t.prototype,e),n&&ro(t,n)}(e,[{key:"Initialise",value:function(){var t=this.gl;this.texture=t.createTexture(),this.essenceBuffer=t.createBuffer(),this.dataBuffer=t.createBuffer(),this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignAttribute("aProjection1"),this.AssignAttribute("aProjection2"),this.AssignAttribute("aProjection3"),this.AssignAttribute("aTranslation1"),this.AssignAttribute("aTranslation2"),this.AssignAttribute("aTranslation3"),this.AssignAttribute("aTransformation1"),this.AssignAttribute("aTransformation2"),this.AssignAttribute("aTransformation3"),this.AssignUniform("uImage")}},{key:"BindBasicTexture",value:function(t,e){var n=this.gl,r=Object(k.TriRectArray)(0,0,t.w,t.h);e=null!=e?e:n.LINEAR,this.aia=n.getExtension("ANGLE_instanced_arrays"),this.originalTexture=t,r.push.apply(r,Object(k.TriRectArray)(0,0,1,1)),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t.image),n.bindBuffer(n.ARRAY_BUFFER,this.essenceBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(r),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindTexture(n.TEXTURE_2D,null)}},{key:"Execute",value:function(t,e){var n=this.gl,r=this.aia,i=this.attributes,o=this.uniforms;this!==Ri.LAST_USED_CONTROLLER&&(n.useProgram(this.program),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.texture),n.uniform1i(o.uImage,0),n.bindBuffer(n.ARRAY_BUFFER,this.essenceBuffer),n.enableVertexAttribArray(i.aPosition),n.vertexAttribPointer(i.aPosition,2,n.FLOAT,!1,0,0),r.vertexAttribDivisorANGLE(i.aPosition,0),n.enableVertexAttribArray(i.aTexCoord),n.vertexAttribPointer(i.aTexCoord,2,n.FLOAT,!1,0,48),r.vertexAttribDivisorANGLE(i.aTexCoord,0),Ri.LAST_USED_CONTROLLER=this),n.bindBuffer(n.ARRAY_BUFFER,this.dataBuffer),e!==this.previousNumberOfElements?n.bufferData(n.ARRAY_BUFFER,t,n.DYNAMIC_DRAW):n.bufferSubData(n.ARRAY_BUFFER,0,t),n.enableVertexAttribArray(i.aProjection1),n.vertexAttribPointer(i.aProjection1,3,n.FLOAT,!1,108,0),r.vertexAttribDivisorANGLE(i.aProjection1,1),n.enableVertexAttribArray(i.aProjection2),n.vertexAttribPointer(i.aProjection2,3,n.FLOAT,!1,108,12),r.vertexAttribDivisorANGLE(i.aProjection2,1),n.enableVertexAttribArray(i.aProjection3),n.vertexAttribPointer(i.aProjection3,3,n.FLOAT,!1,108,24),r.vertexAttribDivisorANGLE(i.aProjection3,1),n.enableVertexAttribArray(i.aTranslation1),n.vertexAttribPointer(i.aTranslation1,3,n.FLOAT,!1,108,36),r.vertexAttribDivisorANGLE(i.aTranslation1,1),n.enableVertexAttribArray(i.aTranslation2),n.vertexAttribPointer(i.aTranslation2,3,n.FLOAT,!1,108,48),r.vertexAttribDivisorANGLE(i.aTranslation2,1),n.enableVertexAttribArray(i.aTranslation3),n.vertexAttribPointer(i.aTranslation3,3,n.FLOAT,!1,108,60),r.vertexAttribDivisorANGLE(i.aTranslation3,1),n.enableVertexAttribArray(i.aTransformation1),n.vertexAttribPointer(i.aTransformation1,3,n.FLOAT,!1,108,72),r.vertexAttribDivisorANGLE(i.aTransformation1,1),n.enableVertexAttribArray(i.aTransformation2),n.vertexAttribPointer(i.aTransformation2,3,n.FLOAT,!1,108,84),r.vertexAttribDivisorANGLE(i.aTransformation2,1),n.enableVertexAttribArray(i.aTransformation3),n.vertexAttribPointer(i.aTransformation3,3,n.FLOAT,!1,108,96),r.vertexAttribDivisorANGLE(i.aTransformation3,1),r.drawArraysInstancedANGLE(n.TRIANGLE_STRIP,0,6,e)}}]),e}();function uo(t){return(uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function co(t,e){return!e||"object"!==uo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fo(t){return(fo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ho(t,e){return(ho=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var po=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=co(this,fo(e).call(this,t,ei))).originalTexture=null,n.texture=null,n.essenceBuffer=null,n.Initialise(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ho(t,e)}(e,Ri),function(t,e,n){e&&lo(t.prototype,e),n&&lo(t,n)}(e,[{key:"Initialise",value:function(){var t=this.gl;this.texture=t.createTexture(),this.essenceBuffer=t.createBuffer(),this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignUniform("uImage"),this.AssignUniform("uProjection"),this.AssignUniform("uTranslation"),this.AssignUniform("uTransformation"),this.AssignUniform("uTint")}},{key:"BindBasicTexture",value:function(t,e){var n=this.gl,r=Object(k.TriRectArray)(0,0,t.w,t.h);e=null!=e?e:n.LINEAR,this.originalTexture=t,r.push.apply(r,Object(k.TriRectArray)(0,0,1,1)),n.bindTexture(n.TEXTURE_2D,this.texture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t.image),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e),n.bindBuffer(n.ARRAY_BUFFER,this.essenceBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(r),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindTexture(n.TEXTURE_2D,null)}},{key:"Execute",value:function(t,e,n,r){var i=this.gl,o=this.attributes,a=this.uniforms;this!==Ri.LAST_USED_CONTROLLER&&(i.useProgram(this.program),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.texture),i.bindBuffer(i.ARRAY_BUFFER,this.essenceBuffer),i.enableVertexAttribArray(o.aPosition),i.vertexAttribPointer(o.aPosition,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(o.aTexCoord),i.vertexAttribPointer(o.aTexCoord,2,i.FLOAT,!1,0,48),i.uniform1i(a.uImage,0),Ri.LAST_USED_CONTROLLER=this),i.uniform4fv(a.uTint,r),i.uniformMatrix3fv(a.uProjection,!1,t),i.uniformMatrix3fv(a.uTranslation,!1,e),i.uniformMatrix3fv(a.uTransformation,!1,n),i.drawArrays(i.TRIANGLE_STRIP,0,6)}}]),e}();function yo(t){return(yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mo(t,e){return!e||"object"!==yo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bo(t){return(bo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function go(t,e){return(go=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wo=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),.5*t.getParameter(t.MAX_VERTEX_ATTRIBS)<n&&console.error(.5*t.getParameter(t.MAX_VERTEX_ATTRIBS),"MAX"),(r=mo(this,bo(e).call(this,t,hi(n)))).units=n,r.originalTextures=[],r.textures=[],r.essenceBuffers=[],r.lastUsedUnit=0,r.Initialise(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&go(t,e)}(e,Ri),function(t,e,n){e&&vo(t.prototype,e),n&&vo(t,n)}(e,[{key:"Initialise",value:function(){for(var t=0;t<this.units;++t)this.AssignAttribute("aPosition"+t),this.AssignAttribute("aTexCoord"+t);this.AssignUniform("uImage"),this.AssignUniform("uUnitId"),this.AssignUniform("uProjection"),this.AssignUniform("uTranslation"),this.AssignUniform("uTransformation"),this.AssignUniform("uTint")}},{key:"BindBasicTexture",value:function(t,e,n){var r=this.gl,i=Object(k.TriRectArray)(0,0,t.w,t.h);(null==e||e<0||e>3)&&(e=0),n=null!=n?n:r.LINEAR,t.uniformId=e,this.originalTextures[e]=t,this.textures[e]=r.createTexture(),this.essenceBuffers[e]=r.createBuffer(),i.push.apply(i,Object(k.TriRectArray)(0,0,1,1)),r.bindTexture(r.TEXTURE_2D,this.textures[e]),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t.image),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n),r.bindBuffer(r.ARRAY_BUFFER,this.essenceBuffers[e]),r.bufferData(r.ARRAY_BUFFER,new Float32Array(i),r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,null),r.bindTexture(r.TEXTURE_2D,null)}},{key:"BindUnit",value:function(t,e,n,r){null!=this.textures[r]&&(t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,this.textures[r]),t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffers[r]),t.enableVertexAttribArray(n["aPosition"+r]),t.vertexAttribPointer(n["aPosition"+r],2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(n["aTexCoord"+r]),t.vertexAttribPointer(n["aTexCoord"+r],2,t.FLOAT,!1,0,48))}},{key:"Execute",value:function(t,e,n,r,i){var o=this.gl,a=this.attributes,s=this.uniforms;if(this!==Ri.LAST_USED_CONTROLLER){o.useProgram(this.program);for(var u=0;u<this.units;++u)this.BindUnit(o,s,a,u);o.uniform1i(s.uUnitId,i),o.uniform1i(s.uImage,i),Ri.LAST_USED_CONTROLLER=this,this.lastUsedUnit=i}else i!==this.lastUsedUnit&&(o.uniform1i(s.uUnitId,i),o.uniform1i(s.uImage,i),this.lastUsedUnit=i);o.uniform4fv(s.uTint,r),o.uniformMatrix3fv(s.uProjection,!1,t),o.uniformMatrix3fv(s.uTranslation,!1,e),o.uniformMatrix3fv(s.uTransformation,!1,n),o.drawArrays(o.TRIANGLE_STRIP,0,6)}}]),e}();function Ao(t){return(Ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function So(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Co(t,e){return!e||"object"!==Ao(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function To(t){return(To=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xo(t,e){return(xo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Eo=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Co(this,To(e).call(this,t,n))).essenceBuffer=null,r.vertices=null,r.Initialise(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xo(t,e)}(e,Ri),function(t,e,n){e&&So(t.prototype,e),n&&So(t,n)}(e,[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array(Object(k.TriRectArray)(0,0,1,1)),t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("a_v2Position"),this.AssignUniform("u_m3Projection"),this.AssignUniform("u_fTime"),this.AssignUniform("u_v2Resolution")}},{key:"Execute",value:function(t,e,n,r,i,o){var a=this.gl,s=this.attributes,u=this.uniforms,l=this.vertices;Object(k.TriRectArray)(e,n,r,i,l),this!==Ri.LAST_USED_CONTROLLER&&(a.useProgram(this.program),Ri.LAST_USED_CONTROLLER=this),a.bindBuffer(a.ARRAY_BUFFER,this.essenceBuffer),a.bufferSubData(a.ARRAY_BUFFER,0,l),a.enableVertexAttribArray(s.a_v2Position),a.vertexAttribPointer(s.a_v2Position,2,a.FLOAT,!1,0,0),a.uniformMatrix3fv(u.u_m3Projection,!1,t),a.uniform2f(u.u_v2Resolution,r,i),a.uniform1f(u.u_fTime,o),a.drawArrays(a.TRIANGLE_STRIP,0,6)}}]),e}();function _o(t){return(_o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Po(t,e){return!e||"object"!==_o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ro(t){return(Ro=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Do(t,e){return(Do=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ko=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Po(this,Ro(e).call(this,t,n))).essenceBuffer=null,r.frameBuffer=null,r.renderBuffer=null,r.texture=null,r.w=0,r.h=0,r.Initialise(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Do(t,e)}(e,Ri),function(t,e,n){e&&Oo(t.prototype,e),n&&Oo(t,n)}(e,[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.frameBuffer=t.createFramebuffer(),this.renderBuffer=t.createRenderbuffer(),this.texture=t.createTexture(),this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignUniform("uImage")}},{key:"Config",value:function(t,e,n){this.w=t,this.h=e;var r=this.gl,i=Object(k.TriRectArray)(-1,-1,2,2);n=null!=n?n:r.LINEAR,i.push.apply(i,Object(k.TriRectArray)(0,0,1,1)),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.w,this.h,0,r.RGBA,r.UNSIGNED_BYTE,null),r.bindRenderbuffer(r.RENDERBUFFER,this.renderBuffer),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,this.w,this.h),r.bindFramebuffer(r.FRAMEBUFFER,this.frameBuffer),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,this.texture,0),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,this.renderBuffer),r.bindBuffer(r.ARRAY_BUFFER,this.essenceBuffer),r.bufferData(r.ARRAY_BUFFER,new Float32Array(i),r.STATIC_DRAW),r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindRenderbuffer(r.RENDERBUFFER,null)}},{key:"Execute",value:function(){var t=this.gl,e=this.attributes;this!==Ri.LAST_USED_CONTROLLER&&(t.useProgram(this.program),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.texture),t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.enableVertexAttribArray(e.aPosition),t.vertexAttribPointer(e.aPosition,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(e.aTexCoord),t.vertexAttribPointer(e.aTexCoord,2,t.FLOAT,!1,0,48),t.uniform1i(this.uniforms.uImage,0),Ri.LAST_USED_CONTROLLER=this),t.drawArrays(t.TRIANGLE_STRIP,0,6)}}]),e}();function Io(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Lo=function(){function t(e,n,r,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.split(" "),this.handle=n,this.info=r,this.priority=i,this.breakIfExecuted=!!o,this.data={},this.command=null}return function(t,e,n){e&&Io(t.prototype,e),n&&Io(t,n)}(t,[{key:"Execute",value:function(t,e,n){return this.handle(t,e,n),this.breakIfExecuted}}]),t}();function jo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Bo=function(){function t(e,n,r,i,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.split(" "),this.handle=n,this.info=r,this.data={},this.options=null,this.registry=null,this.optionPrefix=null==a?Uo:a,this.dataSeparator="=",this.allOptionIds=null,this.fullInfo=null,this.continueToPrime=!!i,this.filterNull=!!o,this.jsonPrefix="(JSON)"}return function(t,e,n){e&&jo(t.prototype,e),n&&jo(t,n)}(t,[{key:"Execute",value:function(t,e,n){this.HandleData(t,e),!0===this.filterNull&&(t=t.filter(Go)),!0===this.HandleOptions(t,e,n)&&this.handle(t,e,n)}},{key:"AddOption",value:function(t,e,n,r,i,o){null!=(o=null==o?this.optionPrefix:o)&&(t=t.replace(/\S+/g,o+"$&")),null==this.options&&(this.options=[]),r=null==r?0:r;var a=this.options,s=a[0],u=new Lo(t,e,n,r,i);u.command=this;for(var l=0;l<a.length;s=a[++l])if(s.priority<=r)return a.splice(l,0,u),this.allOptionIds=this.GetAllOptionIds(),this;return this.options.push(u),this.allOptionIds=this.GetAllOptionIds(),this}},{key:"HandleData",value:function(t,e){var n,r=this.dataSeparator,i=No,o=this.jsonPrefix,a=o.length;i.push.apply(i,t);for(var s=i[0],u=0;u<i.length;s=i[++u])2===(n=s.split(r)).length&&(t[u]=null,n[0].substring(0,a)===o?e[n[0].substring(a)]=JSON.parse(n[1]):e[n[0]]=n[1]);i.length=0}},{key:"HandleOptions",value:function(t,e,n){if(0===t.length)return this.continueToPrime;var r=this.GetAndRemoveMatchingOptionIds(t);if(null==r)return this.continueToPrime;for(var i=0;i<r.length;++i)if(!0===this.GetOptionById(r[i]).Execute(t,e,n))return!1;return this.continueToPrime}},{key:"GetOptionById",value:function(t){for(var e=this.options,n=e[0],r=0;r<e.length;n=e[++r])if(-1!==n.id.indexOf(t))return n;return null}},{key:"GetAllOptionIds",value:function(){for(var t=this.options,e=[],n=0;n<t.length;++n)e.push.apply(e,t[n].id);return e}},{key:"GetAndRemoveMatchingOptionIds",value:function(t){var e,n=this.allOptionIds;if(null==n)return null;for(var r=[],i=0;i<n.length;++i)-1!==(e=t.indexOf(n[i]))&&r.push(t.fickleSplice(e));return r}},{key:"GenerateInfoString",value:function(){for(var t="COMMAND: "+this.id.join(", ")+" -> "+this.info+"\n",e=this.options,n=e[0],r=0;r<e.length;n=e[++r])t+="OPTION: "+n.id.join(", ")+" -> "+n.info+"\n";return t}}],[{key:"OPTION_PREFIX",get:function(){return Uo},set:function(t){Uo=t}}]),t}(),Uo="",No=[],Go=function(t){return null!=t};function Fo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Mo=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.commands=[],this.splitter=" "}return function(t,e,n){e&&Fo(t.prototype,e),n&&Fo(t,n)}(t,[{key:"AddCommand",value:function(t){if(null==t.registry)return this.commands.push(t),t.registry=this,t}},{key:"RemoveCommand",value:function(t){var e=this.commands,n=e.indexOf(t);if(-1!==n)return t.registry=null,e.fickleSplice(n)}},{key:"GetCommandById",value:function(t){for(var e=this.commands,n=e[0],r=0;r<e.length;n=e[++r])if(n)for(var i=0;i<n.id.length;++i)if(n.id[i]===t)return n;return null}},{key:"Parse",value:function(t,e){var n=String(t).split(this.splitter),r=n.shift(),i=this.GetCommandById(r);return i?(i.Execute(n,{},e),null):r}}]),t}();function Vo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Xo=function(){function t(e,n,r,i,a,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.target=n,this.propertyString=r,this.value=i,this.duration=a,this.easing=o[null==s?Yo:s],this.time=0,this.startValue=0,this.change=0,this.property=null,this.properyObject=null,this.running=!1,this.onStart=new wr,this.onEnd=new wr,this.onStop=new wr,this.onReconfigure=new wr,this.onReset=new wr}return function(t,e,n){e&&Vo(t.prototype,e),n&&Vo(t,n)}(t,[{key:"Start",value:function(){var t=this.propertyString.split(".");this.property=t[t.length-1],this.propertyObject=Object(D.Nested)(this.target,this.propertyString,!0),this.startValue=this.propertyObject[this.property],this.change=this.value-this.startValue,this.time=0,this.running=!0,this.onStart.Dispatch(this,null)}},{key:"Stop",value:function(){this.property=null,this.propertyObject=null,this.startValue=0,this.change=0,this.time=0,this.running=!1,this.onStop.Dispatch(this,null)}},{key:"Process",value:function(){!0===this.running&&(this.propertyObject[this.property]=this.easing(this.time,this.startValue,this.change,this.duration),++this.time>=this.duration&&(this.running=!1,this.propertyObject[this.property]=this.value,this.onEnd.Dispatch(this,null)))}},{key:"Reconfigure",value:function(t,e,n,r){null!=t&&(this.propertyString=t),this.value=e,this.duration=n,this.easing=o[null==r?Yo:r],this.onReconfigure.Dispatch(this,null)}},{key:"NewValue",value:function(t){this.value=t,this.Start()}},{key:"Reset",value:function(){if(null==this.propertyObject||null==this.property)return!1;this.propertyObject[this.property]=this.startValue,this.property=null,this.propertyObject=null,this.startValue=0,this.change=0,this.time=0,this.running=!1,this.onReset.Dispatch(this,null)}}]),t}(),Yo="Linear";function Ho(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Wo=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.motions=[],this.target=e}return function(t,e,n){e&&Ho(t.prototype,e),n&&Ho(t,n)}(t,[{key:"Create",value:function(t,e,n,r,i){if(null==this.GetMotionById(t)){var o=new Xo(t,this.target,e,n,r,i);return this.motions.push(o),o}return null}},{key:"Add",value:function(t){null==this.GetMotionById(t.id)&&this.motions.push(t)}},{key:"Start",value:function(t){var e=this.GetMotionById(t);return null!==e&&e.Start(),e}},{key:"StartMultiple",value:function(t){t=t.split(" ");for(var e=0;e<t.length;++e)this.Start(t[e])}},{key:"Stop",value:function(t){var e=this.GetMotionById(t);return null!==e&&e.Stop(),e}},{key:"StopMultiple",value:function(t){t=t.split(" ");for(var e=0;e<t.length;++e)this.Stop(t[e])}},{key:"Reset",value:function(t){var e=this.GetMotionByid(t);return null!==e&&e.Reset(),e}},{key:"ResetMultiple",value:function(t){t=t.split(" ");for(var e=0;e<t.length;++e)this.Reset(t[e])}},{key:"Process",value:function(){for(var t=this.motions,e=0;e<t.length;++e)t[e].Process()}},{key:"GetMotionById",value:function(t){for(var e=this.motions,n=0;n<e.length;++n)if(e[n].id===t)return e[n];return null}}]),t}();function qo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ko(t,e,n){return e&&zo(t.prototype,e),n&&zo(t,n),t}var Jo=function(){function t(e,n,r){qo(this,t),this.Set(e,n,r)}return Ko(t,[{key:"Set",value:function(t,e,n){this.from=t,this.to=e,this.amplitude=n,this.active=!0}},{key:"Inactivate",value:function(){this.active=!1}}]),t}(),Qo=function(){function t(){qo(this,t),this.velocityX=null,this.velocityY=null,this.torque=null,this.accelerationX=null,this.accelerationY=null,this.spin=null,this.growthX=null,this.growthY=null,this.gravityX=null,this.gravityY=null,this.active=!0}return Ko(t,[{key:"CreateOscillatingObject",value:function(t,e,n,r){if(null!==this[t])throw new Error("Invalid key");this[t]=new Jo(e,n,r)}},{key:"SetOscillatingObject",value:function(t,e,n,r){var i=this[t];if(null==i)return this.CreateOscillatingObject(t,e,n,r);i.Set(e,n,r)}},{key:"Nullify",value:function(t){null!=this[t]&&this[t].Inactivate()}}]),t}();function $o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Zo=Math.cos,ta=Math.sin,ea=Math.atan2,na=Math.sqrt,ra=Math.abs,ia=Math.PI,oa=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.array=new Float32Array(9),this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}return function(t,e,n){e&&$o(t.prototype,e),n&&$o(t,n)}(t,[{key:"Identity",value:function(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}},{key:"Copy",value:function(){var e=new t;return e.Set(this.a,this.b,this.c,this.d,this.e,this.f),e}},{key:"Set",value:function(t,e,n,r,i,o){return this.a=t,this.b=e,this.c=n,this.d=r,this.e=i,this.f=o,this}},{key:"SetTransform",value:function(t,e,n,r,i,o,a,s,u){t=null==t?0:t,e=null==e?0:e,n=null==n?1:n,r=null==r?1:r,i=null==i?0:i,o=null==o?0:o,a=null==a?0:a,s=null==s?0:s,u=null==u?0:u;var l=ta(i),c=Zo(i),f=-ta(o),h=Zo(o),d=ta(a),p=Zo(a),y=c*n,v=l*n,m=-l*r,b=c*r;return this.a=p*y+d*m,this.b=p*v+d*b,this.c=f*y+h*m,this.d=f*v+h*b,this.e=t+s*y+u*m,this.f=e+s*v+u*b,this}},{key:"Translate",value:function(t,e){this.e+=t,this.f+=e}},{key:"TranslateTo",value:function(t,e){this.e=t,this.f=e}},{key:"ApplyTranslation",value:function(t,e){this.e=t*this.a+e*this.c+this.e,this.f=t*this.b+e*this.d+this.f}},{key:"ApplyScale",value:function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e}},{key:"Scale",value:function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e}},{key:"Rotate",value:function(t){var e=Math.sin(t),n=Math.cos(t),r=this.a,i=this.c,o=this.e;this.a=r*n-this.b*e,this.b=r*e+this.b*n,this.c=i*n-this.d*e,this.d=i*e+this.d*n,this.e=o*n-this.f*e,this.f=o*e+this.f*n}},{key:"Decompose",value:function(t){var e=this.a,n=this.b,r=this.c,i=this.d,o=-ea(-r,i),a=ea(n,e);ra(o+a)<aa?(t.rotation=a,e<0&&i>=0&&(t.rotation+=ia),t.skew.SetSame(0)):t.skew.Set(o,a),t.scale.Set(na(e*e+n*n),na(r*r+i*i)),t.position.Set(this.e,this.f)}},{key:"ApplyToContext",value:function(t){t.setTransform(this.a,this.b,this.c,this.d,this.e,this.f)}},{key:"AsArray",value:function(t){var e=this.array;return!0===t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.e,e[7]=this.f,e[8]=1):(e[0]=this.a,e[1]=this.c,e[2]=this.e,e[3]=this.b,e[4]=this.d,e[5]=this.f,e[6]=0,e[7]=0,e[8]=1),e}}]),t}(),aa=1e-5;function sa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ua=Math.cos,la=Math.sin,ca=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.position=new pt(e,n),this.scale=new pt(1,1),this.skew=new pt(0,0),this.pivot=new pt(0,0),this.localTransform=new oa,this.globalTransform=new oa,this.rotation=0,this.skewCX=1,this.skewSX=0,this.skewCY=0,this.skewSY=1}return function(t,e,n){e&&sa(t.prototype,e),n&&sa(t,n)}(t,[{key:"SetMatrix",value:function(t){t.Decompose(this),this.UpdateSkew()}},{key:"UpdateLocal",value:function(){var t=this.localTransform,e=this.position,n=this.scale,r=this.pivot;t.a=this.skewCX*n.x,t.b=this.skewSX*n.x,t.c=this.skewCY*n.y,t.d=this.skewSY*n.y,t.e=e.x-r.x*t.a+r.y*t.c,t.f=e.y-r.y*t.b+r.y*t.d}},{key:"UpdateGlobal",value:function(t){var e=this.localTransform,n=this.globalTransform,r=this.position,i=this.scale,o=this.pivot;e.a=this.skewCX*i.x,e.b=this.skewSX*i.x,e.c=this.skewCY*i.y,e.d=this.skewSY*i.y,e.e=r.x-o.x*e.a+o.y*e.c,e.f=r.y-o.y*e.b+o.y*e.d,n.a=e.a*t.a+e.b*t.c,n.b=e.a*t.b+e.b*t.d,n.c=e.c*t.a+e.d*t.c,n.d=e.c*t.b+e.d*t.d,n.e=e.e*t.a+e.f*t.c+t.e,n.f=e.e*t.b+e.f*t.d+t.f}},{key:"UpdateSkew",value:function(){var t=this.skew,e=this.rotation;this.skewCX=ua(e+t.y),this.skewSX=la(e+t.y),this.skewCY=-la(e-t.x),this.skewSY=ua(e-t.x)}},{key:"ApplyGlobal",value:function(t){this.globalTransform.ApplyToContext(t)}}]),t}();function fa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ha=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.transform=new ca(e,n),this.data={},this.parent=null,this.w=0,this.h=0,this.bounds=null,this.boundsDirty=!0,this.globalPosition=null}return function(t,e,n){e&&fa(t.prototype,e),n&&fa(t,n)}(t,[{key:"UpdateTransform",value:function(){null!=this.parent?this.transform.UpdateGlobal(this.parent.transform.globalTransform):this.transform.UpdateGlobal(da.globalTransform)}},{key:"GetGlobalPosition",value:function(){var t=this.transform.globalTransform;return null===this.globalPosition?this.globalPosition=new pt(t.e,t.f):this.globalPosition.Set(t.e,t.f),this.globalPosition}},{key:"ComputeBounds",value:function(t){var e=0,n=0;return null!=t&&(e=this.width*t.x,n=this.height*t.y),null===this.bounds?(this.bounds=new ce(this.x-e,this.y-n,this.x+this.width-e,this.y+this.height-n),this.bounds.belongsTo=this):this.bounds.Set(this.x-e,this.y-n,this.x+this.width-e,this.y+this.height-n),this.boundsDirty=!1,this.bounds}},{key:"rotation",get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t,this.transform.UpdateSkew()}},{key:"scale",get:function(){return this.transform.scale}},{key:"position",get:function(){return this.transform.position}},{key:"pivot",get:function(){return this.transform.pivot}},{key:"x",get:function(){return this.transform.position.x},set:function(t){this.transform.position.x=t}},{key:"y",get:function(){return this.transform.position.y},set:function(t){this.transform.position.y=t}},{key:"width",get:function(){return this.w*this.scale.x},set:function(t){this.w=t}},{key:"height",get:function(){return this.h*this.scale.y},set:function(t){this.h=t}}]),t}(),da=new ca;function pa(t){return(pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ya(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function va(t,e){return!e||"object"!==pa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ma(t){return(ma=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ba(t,e){return(ba=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ga=Math.abs,wa=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=va(this,ma(e).call(this,t,n))).children=[],r.render=!0,r.display=!0,r.transformShouldUpdate=!0,r.transformAutomaticUpdate=!0,r.motionManager=null,r.isBatchParent=!1,r.childDataBuffer=null,r.bufferData=null,r.programController=null,r.bufferStartIndex=0,r.bufferEndIndex=0,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ba(t,e)}(e,ha),function(t,e,n){e&&ya(t.prototype,e),n&&ya(t,n)}(e,[{key:"PreDraw",value:function(){}},{key:"GLPreDraw",value:function(){}},{key:"PostDraw",value:function(){}},{key:"GLPostDraw",value:function(){}},{key:"Draw",value:function(t){this.PreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.children.length>0&&!0===this.display&&this.DrawChildren(t)),this.PostDraw(t)}},{key:"GLDraw",value:function(t){this.GLPreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren():this.GLDrawChildren(t))),this.GLPostDraw(t)}},{key:"RequestTransformUpdate",value:function(){this.transformShouldUpdate=!0}},{key:"DrawChildren",value:function(t){for(var e=this.children,n=0;n<e.length;++n)e[n].Draw(t)}},{key:"GLDrawChildren",value:function(t){for(var e=this.children,n=0;n<e.length;++n)e[n].GLDraw(t)}},{key:"GLBatchDrawChildren",value:function(){null!=this.childDataBuffer&&null!=this.programController&&this.programController.Execute(this.childDataBuffer,this.children.length)}},{key:"ComputeBatchBuffer",value:function(t){for(var e,n,r=this.children,i=[],o=0;o<r.length;++o)e=r[o],n=null!=t?t(e):e.GetBufferData(),e.bufferStartIndex=i.length,e.bufferEndIndex=i.length+n.length,i.push.apply(i,n);this.childDataBuffer=new Float32Array(i)}},{key:"UpdateInBuffer",value:function(){throw new Error(Aa)}},{key:"GetBufferData",value:function(){throw new Error(Aa)}},{key:"AddChild",value:function(t){var e=t.parent;return null!==e&&e.RemoveChild(t),this.children.push(t),t.parent=this,t}},{key:"AddChildren",value:function(){var t=arguments;Object(D.IsArray)(t[0])&&(t=t[0]);for(var e=0;e<t.length;++e)this.AddChild(t[e])}},{key:"AddSibling",value:function(t){var e=this.parent;return null!==e&&e.AddChild(t),t}},{key:"RemoveChild",value:function(t){var e=this.children,n=e.indexOf(t);if(-1!==n)return t.parent=null,e.fickleSplice(n)}},{key:"RemoveChildren",value:function(){var t,e,n=arguments;Object(D.IsArray)(r[0])&&(function(t){throw new Error('"'+t+'" is read-only')}("children"),r=r[0]);for(var r=this.children,i=[],o=0;o<n.length;++o)t=n[o],-1!==(e=r.indexOf(t))&&(i.push(r.fickleSplice(e)),t.parent=null);return i}},{key:"Swap",value:function(t){if(null!==this.parent){var e=this.parent.children,n=e.indexOf(this);if(-1!==n){-1===t&&(t=e.length-1);var r=e[t];e[t]=this,e[n]=r}}}},{key:"SendToFront",value:function(){this.Swap(-1)}},{key:"SendToBack",value:function(){this.Swap(0)}},{key:"Dump",value:function(){for(var t=this.children,e=0;e<t.length;++e)t[e].parent=null;t.length=0}},{key:"Destroy",value:function(){this.Dump(),null!==this.parent&&this.parent.RemoveChild(this)}},{key:"AttachTo",value:function(t){t.AddChild(this)}},{key:"Detach",value:function(){return null!==this.parent?this.parent.RemoveChild(this):null}},{key:"GetChildClosestTo",value:function(t,e){var n,r,i,o=1/0,a=this.children;if(0!==a.length){for(var s=0;s<a.length;++s)n=a[s],void 0!==e&&!1===e(n)||(r=ga(n.position.GetDistanceSquared(t.x,t.y)))<o&&(o=r,i=n);return i}return null}},{key:"GetChildFurthestFrom",value:function(t,e){var n,r,i,o=0,a=this.children;if(0!==a.length){for(var s=0;s<a.length;++s)n=a[s],void 0!==e&&!1===e(n)||(r=ga(n.position.GetDistanceSquared(t.x,t.y)))>o&&(o=r,i=n);return i}return null}},{key:"UseAsBatchParent",value:function(t){this.isBatchParent=!0,this.programController=t}}]),e}();wa.prototype.Mount=wa.prototype.AddChildren;var Aa="Cannot access buffer data directly on Container2D!";function Sa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ca=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.frames=[],this.controller=e,this.sprite=e.sprite,this.id=n,this.onEnd=new wr,this.onStop=new wr,this.onStart=new wr,this.currentFrame=0,this.currentFrameIndex=0,this.playing=!1,this.rate=60,this.timer=0,this.reverse=!1,this.overrideFrameRate=!1,this.loop=!1,this.autoFrame=!0,null!=r&&(this.rate=r)}return function(t,e,n){e&&Sa(t.prototype,e),n&&Sa(t,n)}(t,[{key:"CreateFrame",value:function(t,e,n,r,i){i=null==i?this.rate:i,this.frames.push(new Ti(t,e,n,r,i))}},{key:"AddFrame",value:function(t){(null==t.rate||t.rate<=0)&&(t.rate=this.rate),this.frames.push(t)}},{key:"GenerateFrames",value:function(t,e,n,r,i,o){var a,s=n/r;o=null==o?{}:o;for(var u=0;u<i;++u)a=o[u],this.CreateFrame(u%s*t,(u/s|0)*e,t,e,a)}},{key:"SetFrame",value:function(t){t=null==t?0:t;var e=this.frames[t];void 0!==e&&(this.currentFrame=e,this.currentFrameIndex=t,this.currentFrame.Apply(this.sprite))}},{key:"GetFrameById",value:function(t,e){for(var n=this.frames,r=0;r<n.length;++r)if(n[r].id===t)return!0===e?r:n[r]}},{key:"SetFrameById",value:function(t){var e=this.GetFrameById(t,!0);this.SetFrame(e)}},{key:"Start",value:function(t){null==t&&this.autoFrame&&(t=this.reverse?this.frames.length-1:0),this.SetFrame(t),this.ResetAllFrames(),this.timer=this.rate,this.playing=!0,this.onStart.Dispatch()}},{key:"Stop",value:function(){this.playing=!1,this.onStop.Dispatch()}},{key:"Process",value:function(){!0===this.playing&&(!0===this.overrideFrameRate?--this.timer<=0&&(this.timer=this.rate,this.NextFrame()):!0===this.currentFrame.Process()&&this.NextFrame())}},{key:"NextFrame",value:function(){var t=!1,e=this.frames,n=e.length;!1===this.reverse?++this.currentFrameIndex:--this.currentFrameIndex,this.currentFrameIndex>=n?(!0===this.loop?this.currentFrameIndex=0:this.currentFrameIndex=n-1,t=!0):this.currentFrameIndex<0&&(!0===this.loop?this.currentFrameIndex=n-1:this.currentFrameIndex=0,t=!0),this.currentFrame=e[this.currentFrameIndex],this.currentFrame.Apply(this.sprite),!0===t&&(this.onEnd.Dispatch(),!1===this.loop&&this.Stop())}},{key:"Clear",value:function(){this.frames=[],this.currentFrame=null,this.playing=!1,this.currentFrameIndex=0,this.timer=this.rate}},{key:"Reset",value:function(){this.SetFrame(0),this.ResetAllFrames(),this.timer=this.rate,this.playing=!1}},{key:"ResetAllFrames",value:function(){for(var t=this.frames,e=0;e<t.length;++e)t[e].Reset()}}]),t}();function Ta(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xa=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.animations=[],this.sprite=null,this.currentAnimation=null,null!=e&&(this.sprite=e)}return function(t,e,n){e&&Ta(t.prototype,e),n&&Ta(t,n)}(t,[{key:"CreateAnimation",value:function(t,e){var n=new Ca(this,t,e);return this.animations.push(n),n}},{key:"AddAnimation",value:function(t){t.controller=this,this.animations.push(t)}},{key:"GetAnimationById",value:function(t){for(var e=this.animations,n=e[0],r=0;r<e.length;n=e[++r])if(n&&n.id===t)return n;return null}},{key:"PlayAnimation",value:function(t,e){var n=this.GetAnimationById(t);null!==n&&(this.currentAnimation=n,n.Start(e))}},{key:"StopCurrentAnimation",value:function(){null!==this.currentAnimation&&this.currentAnimation.Stop()}},{key:"Process",value:function(){null!==this.currentAnimation&&this.currentAnimation.Process()}}]),t}();function Ea(t){return(Ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Oa(t,e){return!e||"object"!==Ea(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pa(t){return(Pa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ra(t,e){return(Ra=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Da=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Oa(this,Pa(e).call(this,t,n))).anchor=new pt(0,0),i.SetPath(r),i.alpha=1,i.gco=Oe,i.interactive=!0,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ra(t,e)}(e,wa),function(t,e,n){e&&_a(t.prototype,e),n&&_a(t,n)}(e,[{key:"Draw",value:function(t){if(this.PreDraw(t),!0===this.render){!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyGlobal(t);var e=this.path;e&&e.Draw&&!0===this.display&&(t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,e.Draw(t)),this.children.length>0&&this.DrawChildren(t)}}},{key:"GLDraw",value:function(t){if(this.GLPreDraw(t),!0===this.render){!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1));var e=this.path;e&&e.GLDraw&&!0===this.display&&e.GLDraw(t,this.transform),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren(t):this.GLDrawChildren(t))}}},{key:"GetBufferData",value:function(){this.UpdateTransform();var t=this.transform.globalTransform.AsArray(!0);null==this.bufferData&&(this.bufferData=[]);var e=this.bufferData;return e.length=0,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this.path&&this.path.GetBufferData&&e.push.apply(e,this.path.GetBufferData()),e}},{key:"UpdateInBuffer",value:function(){this.UpdateTransform();var t=this.transform.globalTransform.AsArray(!0),e=this.parent.childDataBuffer,n=this.bufferStartIndex;e[n]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=t[3],e[n+4]=t[4],e[n+5]=t[5],e[n+6]=t[6],e[n+7]=t[7],e[n+8]=t[8],this.path&&this.path.UpdateInBuffer&&this.path.UpdateInBuffer(e,n+9)}},{key:"IntersectsPoint",value:function(t){return!1!==this.interactive&&(ka.SetV(t),ka.SubtractV(this.position),this.path.IntersectsPoint(ka))}},{key:"SetPath",value:function(t){void 0!==t&&(void 0!==t.w&&void 0!==t.h?(this.w=t.w,this.h=t.h):void 0!==t.GetLength?this.w=this.h=t.GetLength():void 0!==t.diameter?this.w=this.h=t.diameter:void 0!==t.aabb&&(this.w=t.aabb.w,this.h=t.aabb.h),this.path=t)}}]),e}(),ka=new pt(0,0);function Ia(t){return(Ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function La(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ja(t,e){return!e||"object"!==Ia(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ba(t){return(Ba=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ua(t,e){return(Ua=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Na=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=ja(this,Ba(e).call(this,t,n))).anchor=new pt(0,0),o.clip=new ce(0,0,0,0),o.shape=new ce(0,0,0,0),o.textureTransformation=new oa,o.textureTranslation=new oa,o.originalShape=new ce(0,0,0,0),o.tint=new sr(1,1,1,1),o.texture=null,o.gco=Oe,o.interactive=!0,o.programController=null,o.animationController=null,r instanceof po?(o.programController=r,o.SetTexture(r.originalTexture)):r instanceof wo?(o.programController=r,null!=i?o.SetTexture(r.originalTextures[i]):o.SetTexture(r.originalTextures[0])):null==r?o.SetTexture(Fa):o.SetTexture(r),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ua(t,e)}(e,wa),function(t,e,n){e&&La(t.prototype,e),n&&La(t,n)}(e,[{key:"Draw",value:function(t){if(this.PreDraw(t),!0===this.render){if(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyGlobal(t),!0===this.display){var e=this.clip,n=e.tl,r=e.br,i=this.anchor;t.globalAlpha=this.tint.channel[3],t.globalCompositeOperation=this.gco,t.drawImage(this.texture.image,n.x,n.y,r.x,r.y,-this.w*i.x,-this.h*i.y,this.w,this.h)}this.children.length>0&&this.DrawChildren(t)}}},{key:"GLDraw",value:function(t){this.GLPreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),!0===this.display&&null!==this.programController&&this.programController.Execute(this.transform.globalTransform.AsArray(!0),this.textureTranslation.AsArray(!0),this.textureTransformation.AsArray(!0),this.tint.channel,this.texture.uniformId),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren(t):this.GLDrawChildren(t)))}},{key:"GetBufferData",value:function(){this.UpdateTransform(),this.UpdateTextureTransform();var t=this.transform.globalTransform.AsArray(!0),e=this.textureTranslation.AsArray(!0),n=this.textureTransformation.AsArray(!0);null==this.bufferData&&(this.bufferData=[]);var r=this.bufferData;return r.length=0,r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=e[0],r[10]=e[1],r[11]=e[2],r[12]=e[3],r[13]=e[4],r[14]=e[5],r[15]=e[6],r[16]=e[7],r[17]=e[8],r[18]=n[0],r[19]=n[1],r[20]=n[2],r[21]=n[3],r[22]=n[4],r[23]=n[5],r[24]=n[6],r[25]=n[7],r[26]=n[8],r}},{key:"UpdateInBuffer",value:function(){this.UpdateTransform(),this.UpdateTextureTransform();var t=this.transform.globalTransform.AsArray(!0),e=this.textureTranslation.AsArray(!0),n=this.textureTransformation.AsArray(!0),r=this.parent.childDataBuffer,i=this.bufferStartIndex;r[i]=t[0],r[i+1]=t[1],r[i+2]=t[2],r[i+3]=t[3],r[i+4]=t[4],r[i+5]=t[5],r[i+6]=t[6],r[i+7]=t[7],r[i+8]=t[8],r[i+9]=e[0],r[i+10]=e[1],r[i+11]=e[2],r[i+12]=e[3],r[i+13]=e[4],r[i+14]=e[5],r[i+15]=e[6],r[i+16]=e[7],r[i+17]=e[8],r[i+18]=n[0],r[i+19]=n[1],r[i+20]=n[2],r[i+21]=n[3],r[i+22]=n[4],r[i+23]=n[5],r[i+24]=n[6],r[i+25]=n[7],r[i+26]=n[8]}},{key:"UpdateTextureTransform",value:function(){this.textureTranslation.TranslateTo(-this.w*this.anchor.x,-this.h*this.anchor.y),this.textureTransformation.TranslateTo(this.w/this.texture.fw*this.clip.tl.x/this.w,this.h/this.texture.fh*this.clip.tl.y/this.h)}},{key:"UpdateShape",value:function(t){null!=t&&(this.originalShape=t),this.shape.SetC(this.originalShape),this.shape.Scale(this.scale.x,this.scale.y)}},{key:"SetTexture",value:function(t){this.texture=t,this.ClipReconfigure(0,0,t.w,t.h),this.shape.SetC(this.clip),this.originalShape.SetC(this.shape)}},{key:"ClipReconfigure",value:function(t,e,n,r){var i=n/this.texture.fw,o=r/this.texture.fh,a=this.width,s=this.height;this.clip.Set(t,e,n,r),this.w=n,this.h=r,0!==a&&0!==s&&(this.width=a,this.height=s),this.textureTranslation.SetTransform(-n*this.anchor.x,-r*this.anchor.y,i,o),this.textureTransformation.SetTransform(i*this.clip.tl.x/n,o*this.clip.tl.y/r,i,o)}},{key:"CreateAnimation",value:function(t){null===this.animationController&&(this.animationController=new xa(this));var e=this.animationController.CreateAnimation(t.id,t.rate);if(null!=t.spritesheet)for(var n=0;n<t.frames.length;++n)e.AddFrame(t.spritesheet.GetFrameById(t.frames[n]));return e}},{key:"IntersectsPoint",value:function(t){return!1!==this.interactive&&(Ga.SetV(t),Ga.SubtractV(this.position),Ga.Add(this.width*this.anchor.x,this.height*this.anchor.y),this.shape.IntersectsPoint(Ga))}},{key:"width",get:function(){return this.w*this.scale.x},set:function(t){this.scale.x=t/this.w}},{key:"height",get:function(){return this.h*this.scale.y},set:function(t){this.scale.y=t/this.h}},{key:"alpha",get:function(){return this.tint.channel[3]},set:function(t){this.tint.channel[3]=t}}],[{key:"BUILD_DEFAULT_TEXTURE",value:function(t){if(!0===Ma)throw new Error("Function can only be called once!");Fa=new bi(F(G(function(){var t=new nr([0,0,64,0,64,64,0,64,0,0,32,32,64,0,32,32,64,64,32,32,0,64]);return t.ComputeBounds(),t.style.stroke.lineWidth=3,new Da(0,0,t)}),64,64,t),"__DEFAULT_SPRITE_TEXTURE__",64,64,64,64),Ma=!0}},{key:"DEFAULT_TEXTURE",get:function(){return Fa}}]),e}(),Ga=new pt(0,0),Fa=null,Ma=!1;function Va(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Xa=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.velocity=new pt(0,0),this.torque=0,this.spin=0,this.growth=new pt(1,1),this.acceleration=new pt(1,1),this.initialScale=new pt(1,1),this.fade=!1,this.deflate=!1,this.gravity=new pt(0,0),this.lifespan=0,this.lifespanTotal=0,this.dead=!1,this.entity=null,this.system=null,this.oscillation=null,this.oscillationOffset=0,this.Renew(e,n)}return function(t,e,n){e&&Va(t.prototype,e),n&&Va(t,n)}(t,[{key:"Process",value:function(){if(!0!==this.dead)if(this.lifespan++<this.lifespanTotal){var t=this.entity,e=this.velocity,n=1-this.lifespan/this.lifespanTotal,r=this.oscillation;if(e.AddV(this.gravity).MultiplyV(this.acceleration),0!==this.torque&&e.Rotate(this.torque),t.position.AddV(e),!0===this.fade&&(t.alpha=n),!0===this.deflate?t.scale.Set(n*this.initialScale.x,n*this.initialScale.y):t.scale.MultiplyV(this.growth),t.rotation+=this.spin,null!==r&&!0===r.active){var i=this.lifespan+this.oscillationOffset;null!=r.torque&&!0===r.torque.active&&(this.torque=Object(k.Oscillate)(i,r.torque.from,r.torque.to,r.torque.amplitude)),null!=r.spin&&!0===r.spin.active&&(this.spin=Object(k.Oscillate)(i,r.spin.from,r.spin.to,r.spin.amplitude)),null!=r.velocityX&&!0===r.velocityX.active&&(this.velocity.x=Object(k.Oscillate)(i,r.velocityX.from,r.velocityX.to,r.velocityX.amplitude)),null!=r.velocityY&&!0===r.velocityY.active&&(this.velocity.y=Object(k.Oscillate)(i,r.velocityY.from,r.velocityY.to,r.velocityY.amplitude)),null!=r.gravityX&&!0===r.gravityX.active&&(this.gravity.x=Object(k.Oscillate)(i,r.gravityX.from,r.gravityX.to,r.gravityX.amplitude)),null!=r.gravityY&&!0===r.gravityY.active&&(this.gravity.y=Object(k.Oscillate)(i,r.gravityY.from,r.gravityY.to,r.gravityY.amplitude)),null!=r.accelerationX&&!0===r.accelerationX.active&&(this.acceleration.x=Object(k.Oscillate)(i,r.accelerationX.from,r.accelerationX.to,r.accelerationX.amplitude)),null!=r.accelerationY&&!0===r.accelerationY.active&&(this.acceleration.y=Object(k.Oscillate)(i,r.accelerationY.from,r.accelerationY.to,r.accelerationY.amplitude)),null!=r.growthX&&!0===r.growthX.active&&(this.growth.x=Object(k.Oscillate)(i,r.growthX.from,r.growthX.to,r.growthX.amplitude)),null!=r.growthY&&!0===r.growthY.active&&(this.growth.y=Object(k.Oscillate)(i,r.growthY.from,r.growthY.to,r.growthY.amplitude))}}else this.dead=!0,this.entity.display=!1}},{key:"Renew",value:function(t,e){if(null!=t){this.dead=!1;var n=this.entity;if(null==t.texture)throw new Error("No texture or controller provided!");if(null===n?(n=this.entity=new Na(0,0,t.texture,t.unitId),null!=t.anchor&&(n.anchor.SetV(t.anchor),n.UpdateTextureTransform())):this.ResetEntity(t.unitId),null!=t.frames&&(t.frames[Object(D.RandomInteger)(0,t.frames.length-1)].Apply(n),n.scale.SetSame(1),n.UpdateTextureTransform()),this.RenewVector(t.position,n.position,e,0,0),this.RenewVector(t.velocity,this.velocity,e,0,0),this.RenewVector(t.gravity,this.gravity,e,0,0),this.RenewVector(t.acceleration,this.acceleration,e,1,1),this.RenewVector(t.growth,this.growth,e,1,1),this.RenewVector(t.scale,n.scale,e,1,1),this.RenewVector(t.scale,this.initialScale,e,1,1),null!=t.rotation?n.rotation=Object(D.MinMaxOrValue)(t.rotation):n.rotation=0,null!=t.lifespan?this.SetLifespan(t.lifespan):this.SetLifespan(0),null!=t.torque?this.torque=Object(D.MinMaxOrValue)(t.torque):this.torque=0,null!=t.spin?this.spin=Object(D.MinMaxOrValue)(t.spin):this.spin=0,null!=t.fade?this.fade=t.fade:this.fade=!1,null!=t.deflate?this.deflate=t.deflate:this.deflate=!1,null!=t.oscillation){var r=t.oscillation,i=this.oscillation;null===i&&(i=this.oscillation=new Qo),i.active=!0,null!=r.offset?this.oscillationOffset=Object(D.MinMaxOrValue)(r.offset):this.oscillationOffset=0,null!=r.torque?i.SetOscillatingObject("torque",r.torque.from,r.torque.to,r.torque.amplitude):i.Nullify("torque"),null!=r.spin?i.SetOscillatingObject("spin",r.spin.from,r.spin.to,r.spin.amplitude):i.Nullify("spin"),null!=r.velocity&&(null!=r.velocity.x?i.SetOscillatingObject("velocityX",r.velocity.x.from,r.velocity.x.to,r.velocity.x.amplitude):i.Nullify("velocityX"),null!=r.velocity.y?i.SetOscillatingObject("velocityY",r.velocity.y.from,r.velocity.y.to,r.velocity.y.amplitude):i.Nullify("velocityY")),null!=r.gravity&&(null!=r.gravity.x?i.SetOscillatingObject("gravityX",r.gravity.x.from,r.gravity.x.to,r.gravity.x.amplitude):i.Nullify("gravityX"),null!=r.gravity.y?i.SetOscillatingObject("gravityY",r.gravity.y.from,r.gravity.y.to,r.gravity.y.amplitude):i.Nullify("gravityY")),null!=r.acceleration&&(null!=r.acceleration.x?i.SetOscillatingObject("accelerationX",r.acceleration.x.from,r.acceleration.x.to,r.acceleration.x.amplitude):i.Nullify("accelerationX"),null!=r.acceleration.y?i.SetOscillatingObject("accelerationY",r.acceleration.y.from,r.acceleration.y.to,r.acceleration.y.amplitude):i.Nullify("accelerationY")),null!=r.growth&&(null!=r.growth.x?i.SetOscillatingObject("growthX",r.growth.x.from,r.growth.x.to,r.growth.x.amplitude):i.Nullify("growthX"),null!=r.growth.y?i.SetOscillatingObject("growthY",r.growth.y.from,r.growth.y.to,r.growth.y.amplitude):i.Nullify("growthY"))}else null!==this.oscillation&&(this.oscillation.active=!1)}}},{key:"RenewVector",value:function(t,e,n,r,i){null!=t?null!=t.points?null!=t.moduloWrapper?(null!=t.indexGap&&(n+=t.indexGap),e.SetV(t.points[n%t.moduloWrapper])):e.SetV(Object(D.RandomInArray)(t.points)):null!=t.xy?e.SetSame(Object(D.MinMaxOrValue)(t.xy)):(null!=t.x?e.x=Object(D.MinMaxOrValue)(t.x):e.x=r,null!=t.y?e.y=Object(D.MinMaxOrValue)(t.y):e.y=i):e.Set(r,i)}},{key:"SetLifespan",value:function(t){this.lifespan=0,this.lifespanTotal=Object(D.MinMaxOrValue)(t)}},{key:"ResetEntity",value:function(t){var e=this.entity;null!=t&&e.SetTexture(e.programController["originalTexture"+t]),e.scale.SetSame(1),e.alpha=1,e.display=!0,e.rotation=0}},{key:"Destroy",value:function(t){return(!0!==t||!1!==this.dead)&&(null!==this.system&&this.system.RemoveParticle(this),Ha&&Ya.Store(this),!0)}}],[{key:"USE_POOL",get:function(){return Ha},set:function(t){Ha=!!t}},{key:"Pool",get:function(){return Ya}}]),t}(),Ya=new ot,Ha=!0;function Wa(t){return(Wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function za(t){return(za=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ka(t,e){return(Ka=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ja(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}Ya.Retrieve=function(t,e){this.PreRetrieve();var n=this.objects.pop();return n.Renew(t,e),n},Ya.Flood(function(){return new Xa},1e3);var Qa=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=function(t,e){return!e||"object"!==Wa(e)&&"function"!=typeof e?Ja(t):e}(this,za(e).call(this,t,n))).particles=[],r.deletionTimer=new Cr(60),r.deletionTimer.onFinish.Add(r.HandleParticleDeletion,Ja(Ja(r))),r.deletionTimer.Start(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ka(t,e)}(e,wa),function(t,e,n){e&&qa(t.prototype,e),n&&qa(t,n)}(e,[{key:"Process",value:function(){this.HandleParticles(),this.deletionTimer.Process()}},{key:"HandleParticles",value:function(){for(var t=this.particles,e=0;e<t.length;++e)t[e].Process()}},{key:"HandleParticleDeletion",value:function(){for(var t=this.particles,e=t[0],n=0;n<t.length;e=t[++n])e&&e.Destroy(!0)&&n--;this.deletionTimer.Start()}},{key:"AddParticle",value:function(t){return t.system=this,this.AddChild(t.entity),this.particles.push(t),t}},{key:"RemoveParticle",value:function(t){var e=this.particles,n=e.indexOf(t);if(-1!==n)return t.system=null,this.RemoveChild(t.entity),e.fickleSplice(n)}},{key:"Emit",value:function(t){for(var e=0;e<t.amount;++e)!0===Xa.USE_POOL?this.AddParticle(Xa.Pool.Retrieve(t,e)):this.AddParticle(new Xa(t,e))}}]),e}(),$a=function(t,e,n){t.setTransform(1,0,0,1,0,0),t.globalAlpha=.25,t.strokeStyle="rgba(255, 0, 255, 1)",t.fillStyle="rgba(0, 255, 0, 1)",null!=n&&(null!=n.alpha&&(t.globalAlpha=n.alpha),null!=n.strokeStyle&&(t.strokeStyle=n.strokeStyle),null!=n.fillStyle&&(t.fillStyle=n.fillStyle)),t.lineWidth=2,t.beginPath(),t.moveTo(e.tl.x,e.tl.y),t.lineTo(e.br.x,e.tl.y),t.lineTo(e.br.x,e.br.y),t.lineTo(e.tl.x,e.br.y),t.closePath(),null!=n?(null==n.noStroke&&t.stroke(),null==n.noFill&&t.fill()):(t.stroke(),t.fill())};function Za(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ts=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=0}return function(t,e,n){e&&Za(t.prototype,e),n&&Za(t,n)}(t,[{key:"Add",value:function(t){this.value|=t}},{key:"Remove",value:function(t){this.value=this.value&~t}},{key:"Compare",value:function(t){return 0!=(this.value&t)}},{key:"Holds",value:function(t){return(this.value&t)===t}},{key:"Toggle",value:function(t){this.value^=t}}]),t}();function es(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ns=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.NONE=0,this.next=1}return function(t,e,n){e&&es(t.prototype,e),n&&es(t,n)}(t,[{key:"Add",value:function(t){void 0===this[t=t.toUpperCase()]&&(this[t]=this.next,this.next=this.next<<1)}}]),t}(),rs=n(7);function is(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var os=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.orders=[],this.classUsed=null,this.amount=1,this.locked=!1}return function(t,e,n){e&&is(t.prototype,e),n&&is(t,n)}(t,[{key:"Many",value:function(t){return this.amount=t,this}},{key:"Bind",value:function(t,e){return e&&(this.orders.length=0),this.orders.push(t),this}},{key:"Make",value:function(t){var e=this.amount,n=Object(D.CreateIteratorArgs)(arguments,"@","i");if(!0===this.locked)throw new Error('"Make" called twice before end!');this.locked=!0,this.orders.length=0,this.classUsed=t;for(var r=0;r<e;++r)as(arguments,n,r),this.orders.push(new(Function.prototype.bind.apply(t,arguments)));return this}},{key:"Call",value:function(t,e,n){var r,i,o,a=this.orders,s=Object(D.IsArray)(e),u="string"==typeof t,l=a[0];!0===s&&(o=Object(D.CreateIteratorArgs)(e,"@","i"));for(var c=0;c<a.length;l=a[++c])!0===s&&(i=e.slice(),Object(D.ReplaceArgumentWithObjectValue)(l,i,"$"),as(i,o,c)),!1===u&&null!=n?("$"===n[0]&&(n=n.slice(1),console.warn("No need for '$' on property arguments")),Object(D.Nested)(l,n,!1,!0,t.apply(null,i))):!1===u?t.apply(null,i):(r=Object(D.Nested)(l,t,!0),Object(D.Nested)(l,t).apply(r,i));return this}},{key:"Cast",value:function(t,e){for(var n=this.orders,r="string"==typeof e,i=0;i<n.length;++i)!0===r&&"$"===e[0]&&(e=Object(D.Nested)(n[i],e)),Object(D.Nested)(n[i],t,!1,!0,e);return this}},{key:"Done",value:function(){return this.amount=1,this.locked=!1,this.orders[0]}},{key:"Mass",value:function(){return this.amount=1,this.locked=!1,this.orders}},{key:"Ship",value:function(t){this.amount=1,this.locked=!1;var e=!0===t?this.orders.slice():this.orders[0];return this.orders.length=0,e}}]),t}(),as=function(t,e,n){if(null!=e)for(var r=0,i=e[r];r<e.length;i=e[++r])if(-1!==i.iteratorIndex)if(i.mod&&i.val)switch(i.mod){case"+":t[i.iteratorIndex]=n+parseInt(i.val);break;case"*":t[i.iteratorIndex]=n*parseInt(i.val);break;case"-":t[i.iteratorIndex]=n-parseInt(i.val);break;case"/":t[i.iteratorIndex]=n/parseInt(i.val);break;case"%":t[i.iteratorIndex]=n%parseInt(i.val);break;default:throw new Error("Bad mod!")}else t[i.iteratorIndex]=n},ss=n(5);function us(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ls=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=e,this.w=n,this.h=r,this.aspectRatio=Object(k.SimplifyAspectRatio)(n,r),this.onChange=new wr,this.mode=i,this.stage=null,this.rootContainer=null,this.currentWidth=0,this.currentHeight=0,e.setAttribute("width",n),e.setAttribute("height",r),this.___bound___OnWindowRsize=this.OnWindowResize.bind(this),window.addEventListener("resize",this.___bound___OnWindowRsize)}return function(t,e,n){e&&us(t.prototype,e),n&&us(t,n)}(t,[{key:"OnWindowResize",value:function(){this[this.mode]()}},{key:"Trigger",value:function(){return this.OnWindowResize(),this}},{key:"Reconfigure",value:function(t,e,n){return this.w=t,this.h=e,this.mode=n,this}},{key:"BindStage",value:function(t){return this.stage=t,this}},{key:"BindRootContainer",value:function(t){return this.rootContainer=t,this}},{key:"SetCurrent",value:function(t,e){this.canvas.setAttribute("width",t),this.canvas.setAttribute("height",e),this.currentWidth=t,this.currentHeight=e,null!==this.stage&&(this.stage.w=t,this.stage.h=e,this.stage.mouse&&this.stage.mouse.scale.Set(t/this.w,e/this.h),this.stage.touch&&this.stage.touch.scale.Set(t/this.w,e/this.h),!0===this.stage.usingWebGL&&this.stage.GLConfig()),null!==this.rootContainer&&this.rootContainer.scale.Set(t/this.w,e/this.h)}},{key:"FillScreen",value:function(){this.SetCurrent(window.innerWidth,window.innerHeight)}},{key:"KeepAspectRatio",value:function(){var t=window.innerWidth,e=t/this.aspectRatio[0]*this.aspectRatio[1];this.SetCurrent(t,e)}},{key:"KeepAspectRatioMIN",value:function(){var t,e=window.innerWidth;e<=this.w&&(e=this.w),t=e/this.aspectRatio[0]*this.aspectRatio[1],this.SetCurrent(e,t)}},{key:"KeepAspectRatioMAX",value:function(){var t,e=window.innerWidth;e>=this.w&&(e=this.w),t=e/this.aspectRatio[0]*this.aspectRatio[1],this.SetCurrent(e,t)}},{key:"KeepAspectRatioFIT",value:function(){var t=window.innerWidth,e=t/this.aspectRatio[0]*this.aspectRatio[1];e>=window.innerHeight&&(t=(e=window.innerHeight)/this.aspectRatio[1]*this.aspectRatio[0]),this.SetCurrent(t,e)}},{key:"Destroy",value:function(){window.removeEventListener("resize",this.___bound___OnWindowRsize)}}],[{key:"FILL_SCREEN",get:function(){return cs}},{key:"KEEP_ASPECT_RATIO",get:function(){return fs}},{key:"KEEP_ASPECT_RATIO_MIN",get:function(){return hs}},{key:"KEEP_ASPECT_RATIO_MAX",get:function(){return ds}},{key:"KEEP_ASPECT_RATIO_FIT",get:function(){return ps}}]),t}(),cs="FillScreen",fs="KeepAspectRatio",hs="KeepAspectRatioMIN",ds="KeepAspectRatioMAX",ps="KeepAspectRatioFIT";function ys(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var vs=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nodes={},this.objects=[],this.convergence=[],this.objectCap=0,this.levelCap=0,this.level=0,this.aabb=null,this.hasSplit=!1,this.Set(e,n,r,i)}return function(t,e,n){e&&ys(t.prototype,e),n&&ys(t,n)}(t,[{key:"Set",value:function(t,e,n,r){return this.aabb=t,this.level=e,this.objectCap=n,this.levelCap=r,this}},{key:"FromPool",value:function(e,n,r,i){return!0===Ss?As.Retrieve(e,n,r,i):new t(e,n,r,i)}},{key:"Store",value:function(){As.Store(this)}},{key:"Add",value:function(t){var e=0,n="",r=this.objects,i=this.nodes;if(!0!==this.hasSplit||null===(n=this.Marking(t))){if(r.push(t),this.level<this.levelCap&&r.length>this.objectCap)for(!1===this.hasSplit&&this.Split();e<r.length;)null!==(n=this.Marking(r[e]))?i[n].Add(r.fickleSplice(e)):++e}else i[n].Add(t)}},{key:"Converge",value:function(t){var e="",n=this.nodes,r=this.convergence;return r.length=0,r.push.apply(r,this.objects),!0===this.hasSplit&&(null!==(e=this.Marking(t))?r.push.apply(r,n[e].Converge(t)):(r.push.apply(r,n[ms].Converge(t)),r.push.apply(r,n[bs].Converge(t)),r.push.apply(r,n[gs].Converge(t)),r.push.apply(r,n[ws].Converge(t)))),r}},{key:"Split",value:function(){var t=this.level+1,e=this.objectCap,n=this.levelCap,r=this.nodes,i=this.aabb;r[ms]=this.FromPool(i.GetQuadrant(ms),t,e,n),r[bs]=this.FromPool(i.GetQuadrant(bs),t,e,n),r[gs]=this.FromPool(i.GetQuadrant(gs),t,e,n),r[ws]=this.FromPool(i.GetQuadrant(ws),t,e,n),this.hasSplit=!0}},{key:"Dump",value:function(){var t=this.nodes;this.objects.length=0,!0===this.hasSplit&&(t[ms].Dump(),t[bs].Dump(),t[gs].Dump(),t[ws].Dump(),!0===Ss&&(t[ms].Store(),t[bs].Store(),t[gs].Store(),t[ws].Store())),this.nodes={},this.hasSplit=!1}},{key:"Marking",value:function(t){var e=this.nodes;return!0===e[ms].aabb.ContainsAABB2D(t)?ms:!0===e[bs].aabb.ContainsAABB2D(t)?bs:!0===e[gs].aabb.ContainsAABB2D(t)?gs:!0===e[ws].aabb.ContainsAABB2D(t)?ws:null}},{key:"ConcatNodes",value:function(t){var e=this.nodes;return void 0===t&&(t=[]),t.push(this),!1===this.hasSplit?t:(e[ms].ConcatNodes(t),e[bs].ConcatNodes(t),e[gs].ConcatNodes(t),e[ws].ConcatNodes(t),t)}}],[{key:"pool",get:function(){return As}},{key:"USE_POOL",get:function(){return Ss},set:function(t){Ss=!!t}}]),t}(),ms="TL",bs="TR",gs="BL",ws="BR",As=new ot,Ss=!0;function Cs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}As.Retrieve=function(t,e,n,r){return this.PreRetrieve(),this.objects.pop().Set(t,e,n,r)},As.Flood(function(){return new vs(null,0,0,0)},500);var Ts=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.element.setAttribute("tabindex","1"),this.element.focus(),this.___bound___OnKeyDown=this.OnKeyDown.bind(this),this.___bound___OnKeyUp=this.OnKeyUp.bind(this),this.element.addEventListener("keydown",this.___bound___OnKeyDown),this.element.addEventListener("keyup",this.___bound___OnKeyUp),this.onDown=new wr,this.onUp=new wr}return function(t,e,n){e&&Cs(t.prototype,e),n&&Cs(t,n)}(t,[{key:"OnKeyDown",value:function(t){t.preventDefault(),t.stopPropagation(),this.onDown.Dispatch(this.element,t)}},{key:"OnKeyUp",value:function(t){t.preventDefault(),t.stopPropagation(),this.onUp.Dispatch(this.element,t)}},{key:"Destroy",value:function(){this.element.removeEventListener("keydown",this.___bound___OnKeyDown),this.element.removeEventListener("keyup",this.___bound___OnKeyUp)}}]),t}();function xs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Es=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.position=new pt,this.scale=new pt(1,1),this.offset=new pt(n,r),this.eventData={position:this.position,native:null},this.offsets=[],this.___bound___OnMove=this.OnMove.bind(this),this.___bound___OnDown=this.OnDown.bind(this),this.___bound___OnUp=this.OnUp.bind(this),this.___bound___OnLeave=this.OnLeave.bind(this),this.___bound___OnWheel=this.OnWheel.bind(this),this.element.addEventListener("mousemove",this.___bound___OnMove),this.element.addEventListener("mousedown",this.___bound___OnDown),this.element.addEventListener("mouseup",this.___bound___OnUp),this.element.addEventListener("mouseleave",this.___bound___OnLeave),this.element.addEventListener("wheel",this.___bound___OnWheel,{passive:!0}),this.onMove=new wr,this.onDown=new wr,this.onUp=new wr,this.onLeave=new wr,this.onWheel=new wr}return function(t,e,n){e&&xs(t.prototype,e),n&&xs(t,n)}(t,[{key:"OnMove",value:function(t){return this.CalculatePosition(t.pageX,t.pageY),this.eventData.native=t,this.onMove.Dispatch(this.element,this.eventData),!1}},{key:"OnDown",value:function(t){t.stopPropagation(),t.preventDefault(),this.CalculatePosition(t.pageX,t.pageY),this.eventData.native=t,this.onDown.Dispatch(this.element,this.eventData)}},{key:"OnUp",value:function(t){t.stopPropagation(),t.preventDefault(),this.CalculatePosition(t.pageX,t.pageY),this.eventData.native=t,this.onUp.Dispatch(this.element,this.eventData)}},{key:"OnLeave",value:function(t){t.stopPropagation(),this.CalculatePosition(t.pageX,t.pageY),this.eventData.native=t,this.onLeave.Dispatch(this.element,this.eventData)}},{key:"OnWheel",value:function(t){t.stopPropagation(),this.CalculatePosition(t.pageX,t.pageY),this.eventData.native=t,this.onWheel.Dispatch(this.element,this.eventData)}},{key:"CalculatePosition",value:function(t,e){var n=this.offsets,r=this.position;r.Set(t,e).Subtract(this.element.offsetLeft,this.element.offsetTop).SubtractV(this.offset).DivideV(this.scale);for(var i=0;i<n.length;++i)r.SubtractV(n[i])}},{key:"AddOffset",value:function(t){return this.offsets.push(t),this}},{key:"Destroy",value:function(){this.element.removeEventListener("mousemove",this.___bound___OnMove),this.element.removeEventListener("mousedown",this.___bound___OnDown),this.element.removeEventListener("mouseup",this.___bound___OnUp),this.element.removeEventListener("mouseleave",this.___bound___OnLeave),this.element.removeEventListener("wheel",this.___bound___OnWheel)}}],[{key:"x",get:function(){return this.position.x}},{key:"y",get:function(){return this.position.y}}]),t}();function _s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Os=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.position=new pt,this.scale=new pt(1,1),this.offset=new pt(n,r),this.eventData={position:this.position,native:null},this.___bound___OnMove=this.OnMove.bind(this),this.___bound___OnStart=this.OnStart.bind(this),this.___bound___OnEnd=this.OnEnd.bind(this),this.___bound___OnCancel=this.OnCancel.bind(this),this.element.addEventListener("touchmove",this.___bound___OnMove),this.element.addEventListener("touchstart",this.___bound___OnStart),this.element.addEventListener("touchend",this.___bound___OnEnd),this.element.addEventListener("touchcancel",this.___bound___OnCancel),this.onMove=new wr,this.onStart=new wr,this.onEnd=new wr,this.onCancel=new wr}return function(t,e,n){e&&_s(t.prototype,e),n&&_s(t,n)}(t,[{key:"OnMove",value:function(t){return t.preventDefault(),t.stopPropagation(),this.CalculatePosition(t.touches.item(0).pageX,t.touches.item(0).pageY),this.eventData.native=t,this.onMove.Dispatch(this.element,this.eventData),!1}},{key:"OnStart",value:function(t){t.preventDefault(),t.stopPropagation(),this.CalculatePosition(t.touches.item(0).pageX,t.touches.item(0).pageY),this.eventData.native=t,this.onStart.Dispatch(this.element,this.eventData)}},{key:"OnEnd",value:function(t){t.stopPropagation(),this.eventData.native=t,this.onEnd.Dispatch(this.element,this.eventData)}},{key:"OnCancel",value:function(t){t.stopPropagation(),this.eventData.native=t,this.onCancel.Dispatch(this.element,this.eventData)}},{key:"CalculatePosition",value:function(t,e){var n=this.position;n.Set(t,e),n.Subtract(this.element.offsetLeft,this.element.offsetTop),n.SubtractV(this.offset),n.DivideV(this.scale)}},{key:"Destroy",value:function(){this.element.removeEventListener("touchmove",this.___bound___OnMove),this.element.removeEventListener("touchstart",this.___bound___OnStart),this.element.removeEventListener("touchend",this.___bound___OnEnd),this.element.removeEventListener("touchcancel",this.___bound___OnCancel)}}],[{key:"x",get:function(){return this.position.x}},{key:"y",get:function(){return this.position.y}}]),t}();function Ps(t){return(Ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ds(t){return(Ds=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ks(t,e){return(ks=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Is(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var Ls=function(t){function e(t){var n;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=function(t,e){return!e||"object"!==Ps(e)&&"function"!=typeof e?Is(t):e}(this,Ds(e).call(this,t.x,t.y)),"string"==typeof t.canvas&&(t.canvas=document.getElementById(t.canvas)),n.canvas=t.canvas,n.w=t.canvas.width,n.h=t.canvas.height,n.id=null,n.backgroundColor="rgba(10,20,30,1)",n.clear=!0,n.fill=!0,n.usingWebGL=!1,n.positionReconfiguration=new pt(t.x,t.y),n.canvasManager=null,n.mouse=null,n.touch=null,n.ticker=null,null==t.mode||"webgl2"!==t.mode.toLowerCase()&&"webgl"!==t.mode.toLowerCase())n.rc=t.canvas.getContext("2d"),console.log("%cCanvas 2D!","color:#f0f7da;background-color:#234d20;font-family:Arial;font-size:18px;font-weight:900;padding:5px;"),!0!==t.noTicker&&(n.ticker=new xr(n.Process.bind(Is(Is(n))),60,t.halt));else{if(n.gl=t.canvas.getContext(t.mode.toLowerCase(),{antialias:t.antialias,powerPreference:t.powerPreference,preserveDrawingBuffer:!0}),null!=n.gl?console.log("%cWebGL!","color:#f0f7da;background-color:#234d20;font-family:Arial;font-size:18px;font-weight:900;padding:5px;"):(n.gl=t.canvas.getContext("experimental-webgl"),null!=n.gl&&console.warn("Experimental WebGL!")),null==n.gl)throw new Error("WebGL is not supported!");n.gl.clearColor(.0392156862745098,.0784313725490196,.11764705882352941,1),n.usingWebGL=!0,!0!==t.noTicker&&(n.ticker=new xr(n.GLProcess.bind(Is(Is(n))),60,t.halt)),n.GLConfig(n.gl)}return null!=t.backgroundColor&&(n.backgroundColor=t.backgroundColor),!1===t.clear&&(n.clear=!1),!1===t.fill&&(n.fill=!1),null!=t.id&&(n.id=t.id),n.onProcess=new wr,!0!==t.noMouse&&(n.mouse=new Es(t.canvas,t.x,t.y)),!0!==t.noKeyboard&&(n.keyboard=new Ts(t.canvas)),!0!==t.noTouch&&(n.touch=new Os(t.canvas,t.x,t.y)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ks(t,e)}(e,wa),function(t,e,n){e&&Rs(t.prototype,e),n&&Rs(t,n)}(e,[{key:"PreDraw",value:function(t){t.setTransform(1,0,0,1,0,0),t.globalAlpha=1,t.globalCompositeOperation=Oe,!0===this.fill?(t.fillStyle=this.backgroundColor,t.fillRect(0,0,this.w,this.h)):!0===this.clear&&t.clearRect(0,0,this.w,this.h)}},{key:"GLConfig",value:function(t){null==t&&(t=this.gl),this.position.SetSame(0),this.scale.Set(2/this.w,-2/this.h),this.position.Add(-1,1),this.position.Add(this.positionReconfiguration.x*this.scale.x,this.positionReconfiguration.y*this.scale.y),this.UpdateTransform(),t.viewport(0,0,this.w,this.h),t.enable(t.BLEND),t.disable(t.DEPTH_TEST),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)}},{key:"GLPreDraw",value:function(t){!0===this.clear&&t.clear(t.COLOR_BUFFER_BIT)}},{key:"GLPostDraw",value:function(t){t.flush()}},{key:"Process",value:function(t){this.Draw(this.rc),this.onProcess.Dispatch(this,t)}},{key:"GLProcess",value:function(t){this.GLDraw(this.gl),this.onProcess.Dispatch(this,t)}},{key:"MixedProcess",value:function(t){!0===this.usingWebGL?this.GLDraw(this.gl):this.Draw(this.rc),this.onProcess.Dispatch(this,t)}},{key:"SetFramebuffer",value:function(t,e){null==t&&(t=this.gl),null==e?(t.viewport(0,0,this.w,this.h),t.bindFramebuffer(t.FRAMEBUFFER,null)):(t.viewport(0,0,e.w,e.h),t.bindFramebuffer(t.FRAMEBUFFER,e.frameBuffer),t.clear(t.COLOR_BUFFER_BIT))}},{key:"Destroy",value:function(){this.Dump(),this.keyboard.Destroy(),this.mouse.Destroy(),this.touch.Destroy(),null!=this.ticker&&this.ticker.Stop()}}]),e}();function js(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Bs=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.stages=[],this.currentStage=null,this.onlyCurrent=!1,this.options=null,this.ticker=new xr(this.Process.bind(this),60,e.halt),this.SetOptions(e)}return function(t,e,n){e&&js(t.prototype,e),n&&js(t,n)}(t,[{key:"SetOptions",value:function(t){null!=t&&(this.options=t)}},{key:"CreateStage2D",value:function(t){var e,n=document.createElement("canvas");"string"==typeof t&&(e=t,t=null),null==t&&(t=this.options),null==t&&(t={}),null!==e&&(t.id=e),null!=t.width&&(n.width=t.width),null!=t.height&&(n.height=t.height),null!=t.className&&(n.className=t.className),null==t.rootNode&&(t.rootNode=document.body),t.rootNode.appendChild(n),t.canvas=n,t.noTicker=!0,t.halt=!0;var r=new Ls(t);return t.id=null,t.canvas=null,this.stages.push(r),r}},{key:"GetStages",value:function(){for(var t=this.stages,e=[],n=0;n<t.length;++n)for(var r=0;r<arguments.length;++r)t[n].id===arguments[r]&&e.push(t[n]);return e}},{key:"Process",value:function(t){for(var e=this.stages,n=0;n<e.length;++n)e[n].MixedProcess(t)}},{key:"Destroy",value:function(){for(var t=this.stages,e=0;e<t.length;++e)t[e].Destroy();this.ticker.Stop()}}]),t}();function Us(t){return(Us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ns(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Gs(t,e){return!e||"object"!==Us(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fs(t){return(Fs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ms(t,e){return(Ms=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vs=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Gs(this,Fs(e).call(this,t,n,null==r?Xs:r,i))).pattern=null,o.patternOffset=new pt(0,0),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ms(t,e)}(e,Na),function(t,e,n){e&&Ns(t.prototype,e),n&&Ns(t,n)}(e,[{key:"Draw",value:function(t){this.PreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyGlobal(t),!0===this.display&&null!==this.pattern&&(t.globalAlpha=this.tint.channel[3],t.globalCompositeOperation=this.gco,t.fillStyle=this.pattern,t.beginPath(),t.rect(0,0,this.w,this.h),t.closePath(),t.translate(this.patternOffset.x,this.patternOffset.y),t.fill()),this.children.length>0&&this.DrawChildren(t))}},{key:"GeneratePattern",value:function(t,e,n){null==this.programController?(this.pattern=t.createPattern(this.texture.image,null),this.w=e,this.h=n,this.scale.SetSame(1)):(this.width=e,this.height=n,this.textureTransformation.SetTransform(0,0,this.scale.x,this.scale.y))}},{key:"OffsetPattern",value:function(t,e){this.patternOffset.Add(t,e),this.textureTransformation.Translate(-t/this.w,-e/this.h)}},{key:"SetPatternOffset",value:function(t,e){this.patternOffset.Set(t,e),this.textureTransformation.TranslateTo(-t/this.w,-e/this.h)}},{key:"GetPatternOffset",value:function(){return this.patternOffset}}],[{key:"BUILD_DEFAULT_TEXTURE",value:function(t){if(!0===Ys)throw new Error("Function can only be called once!");Xs=new bi(F(G(function(){var t=new nr([0,0,64,0,64,64,0,64,0,0,32,32,64,0,32,32,64,64,32,32,0,64]);return t.ComputeBounds(),t.style.stroke.lineWidth=3,new Da(0,0,t)}),64,64,t),"__DEFAULT_TILESPRITE_TEXTURE__",64,64,64,64),Ys=!0}},{key:"DEFAULT_TEXTURE",get:function(){return Xs}}]),e}(),Xs=null,Ys=!1;function Hs(t){return(Hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ws(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qs(t,e){return!e||"object"!==Hs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zs(t){return(zs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ks(t,e){return(Ks=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Js=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=qs(this,zs(e).call(this,t,n))).id=parseInt(r.id),i.cx=parseInt(r.x),i.cy=parseInt(r.y),i.w=parseInt(r.width),i.h=parseInt(r.height),i.xoffset=parseInt(r.xoffset),i.yoffset=parseInt(r.yoffset),i.xadvance=parseInt(r.xadvance),i.yadvance=0,i.kernings=[],i.translation=new oa,i.transformation=new oa,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ks(t,e)}(e,ha),function(t,e,n){e&&Ws(t.prototype,e),n&&Ws(t,n)}(e,[{key:"Draw",value:function(t,e){t.drawImage(e,this.cx,this.cy,this.width,this.height,this.position.x,this.position.y,this.width,this.height)}},{key:"GLDrawAuto",value:function(t,e,n){this.UpdateMatrices(),t.Execute(this.transform.globalTransform.AsArray(!0),this.translation.AsArray(!0),this.transformation.AsArray(!0),e,n)}},{key:"GLDraw",value:function(t,e,n){t.Execute(this.transform.globalTransform.AsArray(!0),this.translation.AsArray(!0),this.transformation.AsArray(!0),e,n)}},{key:"ApplyKernings",value:function(t){for(var e,n=0;n<t.length;++n)e=t[n].attributes,parseInt(e.first)===this.id&&this.kernings.push(parseInt(e.first),parseInt(e.second),parseInt(e.amount))}},{key:"Crunch",value:function(t){if(this.position.SetSame(0),null!=t&&(this.x=t.x+t.xadvance,this.y=this.yadvance=t.yadvance,t.kernings&&t.kernings.length>0&&this.kernings.length>0))for(var e=this.kernings,n=0;n<e.length;n+=3)if(e[n+1]===t.id){this.x+=e[n+2];break}this.position.Add(this.xoffset,this.yoffset)}},{key:"UpdateMatrices",value:function(){if(null!=this.parent){var t=this.parent.texture,e=this.width/t.fw,n=this.height/t.fh;this.UpdateTransform(),this.translation.SetTransform(0,0,e,n),this.transformation.SetTransform(e*this.cx/this.width,n*this.cy/this.height,e,n)}}}]),e}();function Qs(t){return(Qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zs(t,e){return!e||"object"!==Qs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tu(t){return(tu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function eu(t,e){return(eu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nu=function(t){function e(t,n,r,i,o,a){var s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(s=Zs(this,tu(e).call(this,t,n,r,a))).fontData=i,s.lineHeight=i.font.common.attributes.lineHeight,s.chars=[],s.maxWidth=1024,s.text="",s.autoUpdateChars=!0,null!=o&&(s.text=o),s.ComputeText(),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&eu(t,e)}(e,Na),function(t,e,n){e&&$s(t.prototype,e),n&&$s(t,n)}(e,[{key:"Draw",value:function(t){this.PreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyGlobal(t),!0===this.display&&(t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,this.DrawText(t)),this.children.length>0&&this.DrawChildren(t))}},{key:"GLDraw",value:function(t){this.GLPreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),!0===this.display&&null!==this.programController&&this.GLDrawText(t),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren(t):this.GLDrawChildren(t)))}},{key:"DrawText",value:function(t){for(var e=this.chars,n=this.texture.image,r=0;r<e.length;++r)e[r].Draw(t,n)}},{key:"GLDrawText",value:function(){var t=this.chars;if(!0===this.autoUpdateChars)for(var e=0;e<t.length;++e)t[e].GLDrawAuto(this.programController,this.tint.channel,this.texture.uniformId);else for(e=0;e<t.length;++e)t[e].GLDraw(this.programController,this.tint.channel,this.texture.uniformId)}},{key:"ComputeText",value:function(){var t,e,n,r=0,i=0,o=!1,a=0,s=0,u=0,l=0,c=this.chars,f=this.text;this.UpdateTransform(),c.length=0,this.fontData.font.kernings&&(t=this.fontData.font.kernings.kerning);for(var h=0;h<f.length;++h){var d=f.charCodeAt(h);n=c[h-1-i],10!==d?(e=new Js(0,0,this.GetCharDataById(d)),null!=t&&e.ApplyKernings(t),e.Crunch(n),u=e.position.x+e.width,l=e.position.y+e.height,(u>this.maxWidth||!0===o)&&(e.position.SetSame(0),e.yadvance=this.lineHeight*++r,e.position.Add(e.xoffset,e.yoffset+e.yadvance),o=!1),u>a&&(a=u),l>s&&(s=l),e.parent=this,e.UpdateMatrices(),c.push(e)):(i++,o=!0)}this.w=a,this.h=s}},{key:"UpdateChars",value:function(){for(var t=this.chars,e=0;e<t.length;++e)t[e].UpdateMatrices()}},{key:"GetCharDataById",value:function(t){for(var e=this.fontData.font.chars.char,n=0;n<e.length;++n)if(parseInt(e[n].attributes.id)===t)return e[n].attributes}},{key:"UpdateInBuffer",value:function(){throw new Error(ru)}},{key:"GetBufferData",value:function(){throw new Error(ru)}}]),e}(),ru="Cannot access buffer data directly on BitmapText!";function iu(t){return(iu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ou(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function au(t,e){return!e||"object"!==iu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function su(t){return(su=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function uu(t,e){return(uu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var lu=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=au(this,su(e).call(this,t,n))).text=r,o.style=Dn(i),o.maxWidth=void 0,o.alpha=1,o.gco=Oe,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&uu(t,e)}(e,wa),function(t,e,n){e&&ou(t.prototype,e),n&&ou(t,n)}(e,[{key:"Draw",value:function(t){if(this.PreDraw(t),!0===this.render){if(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyGlobal(t),!0===this.display){var e=this.style;!0===e.shadow.applied&&e.shadow.Apply(t),!0===e.text.applied&&(e.text.Apply(t),t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,t.fillText(this.text,0,0,this.maxWidth),t.strokeText(this.text,0,0,this.maxWidth))}this.children.length>0&&this.DrawChildren(t)}}},{key:"IntersectsPoint",value:function(){return!1}}]),e}();function cu(t){return(cu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hu(t,e){return!e||"object"!==cu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function du(t){return(du=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pu(t,e){return(pu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yu=Math.cos,vu=Math.sin,mu=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=hu(this,du(e).call(this,0,0))).focus=t,r.target=n,r.velocity=new pt(0,0),r.force=new pt(1,1),r.stopRadiusSq=1e3,r.EPSILON=2e-4,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pu(t,e)}(e,wa),function(t,e,n){e&&fu(t.prototype,e),n&&fu(t,n)}(e,[{key:"Process",value:function(){var t=this.target;if(null!=t){gu.SetV(t.position),gu.Invert(),gu.AddV(this.focus),bu.SetV(this.position).SubtractV(gu);var e=bu.GetMagnitudeSquared();if(e<this.stopRadiusSq)return;e*=this.EPSILON;var n=bu.GetAngle();this.velocity.Set(e*yu(n),e*vu(n)).MultiplyV(this.force),this.position.SubtractV(this.velocity)}}},{key:"SetTarget",value:function(t){return this.target=t,this}}]),e}(),bu=new pt(0,0),gu=new pt(0,0);function wu(t){return(wu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Au(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Su(t,e){return!e||"object"!==wu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Cu(t){return(Cu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tu(t,e){return(Tu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xu=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Su(this,Cu(e).call(this,t,n))).programController=r,i.transformShouldUpdate=!1,i.transformAutomaticUpdate=!1,i.w=128,i.h=128,i.time=0,i.timeInc=.1,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tu(t,e)}(e,ha),function(t,e,n){e&&Au(t.prototype,e),n&&Au(t,n)}(e,[{key:"GLPreDraw",value:function(){}},{key:"GLDraw",value:function(t){this.GLPreDraw(t),!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1));var e=this.bounds;this.programController.Execute(this.transform.globalTransform.AsArray(!0),e.tl.x,e.tl.y,e.w,e.h,this.time),this.time+=this.timeInc}}]),e}();n.d(e,"Math",function(){return k}),n.d(e,"Assert",function(){return di.a}),n.d(e,"Pool",function(){return ot}),n.d(e,"FlagList",function(){return ts}),n.d(e,"FlagEnum",function(){return ns}),n.d(e,"Cache",function(){return yi}),n.d(e,"Glob",function(){return rs.a}),n.d(e,"Maker",function(){return os}),n.d(e,"Color",function(){return sr}),n.d(e,"Utility",function(){return D}),n.d(e,"Cipher",function(){return r}),n.d(e,"BrowserUtility",function(){return i}),n.d(e,"Style",function(){return v}),n.d(e,"Time",function(){return b}),n.d(e,"CharacterSets",function(){return ss.a}),n.d(e,"CanvasManager",function(){return ls}),n.d(e,"Vector2D",function(){return pt}),n.d(e,"Matrix2D",function(){return oa}),n.d(e,"Transform2D",function(){return ca}),n.d(e,"QuadtreeNode",function(){return vs}),n.d(e,"Ease",function(){return o}),n.d(e,"Collision",function(){return c}),n.d(e,"Geom",function(){return h}),n.d(e,"Path",function(){return m}),n.d(e,"CoreEntity2D",function(){return ha}),n.d(e,"Container2D",function(){return wa}),n.d(e,"Stage2D",function(){return Ls}),n.d(e,"Stadium",function(){return Bs}),n.d(e,"Graphic2D",function(){return Da}),n.d(e,"Sprite",function(){return Na}),n.d(e,"Tilesprite",function(){return Vs}),n.d(e,"Char",function(){return Js}),n.d(e,"BitmapText",function(){return nu}),n.d(e,"Text",function(){return lu}),n.d(e,"Camera2D",function(){return mu}),n.d(e,"GLEntity2D",function(){return xu}),n.d(e,"Shader",function(){return g}),n.d(e,"Load",function(){return w}),n.d(e,"Controller",function(){return S}),n.d(e,"CP",function(){return C}),n.d(e,"Motion",function(){return T}),n.d(e,"Particle",function(){return E}),n.d(e,"Texture",function(){return _}),n.d(e,"Animator",function(){return O}),n.d(e,"Debug",function(){return R}),n(23)},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(t,e){var n=document.getElementById("buttons"),r=document.createElement("input"),i=document.getElementById("back-button");r.setAttribute("value",t),r.setAttribute("type","button"),r.addEventListener("click",function(){n.style.display="none",i.onclick=a,e(o)}),n.appendChild(r);var o={canvas:null,stage:null,stadium:null,ticker:null};function a(){o.canvas&&o.canvas.parentNode.removeChild(o.canvas),o.stage&&o.stage.Destroy(),o.stadium&&(o.stadium.stages.forEach(function(t){t.canvas.parentNode.removeChild(t.canvas)}),o.stadium.Destroy()),o.canvasManager&&o.canvasManager.Destroy(),o.ticker&&o.ticker.Stop(),i.onclick=null,n.style.display=null}}},function(t,e,n){"use strict";n.r(e),n.d(e,"RandomInteger",function(){return u}),n.d(e,"RandomFloat",function(){return l}),n.d(e,"IsInteger",function(){return c}),n.d(e,"IsFloat",function(){return f}),n.d(e,"IsArray",function(){return h}),n.d(e,"ThisOrThat",function(){return d}),n.d(e,"Sign",function(){return p}),n.d(e,"Clamp",function(){return y}),n.d(e,"InverseClamp",function(){return v}),n.d(e,"FlipACoin",function(){return m}),n.d(e,"GenerateSequence",function(){return b}),n.d(e,"RandomInArray",function(){return g}),n.d(e,"MinMaxOrValue",function(){return w}),n.d(e,"UUID",function(){return A}),n.d(e,"ApplyProperties",function(){return S}),n.d(e,"Nested",function(){return C}),n.d(e,"ArrayGetRandom",function(){return T}),n.d(e,"ArrayShuffle",function(){return x}),n.d(e,"Base16ToBase10",function(){return E}),n.d(e,"Base2ToBase10",function(){return _}),n.d(e,"IsObjectEmpty",function(){return O}),n.d(e,"DeepClone",function(){return P}),n.d(e,"CreateIteratorArgs",function(){return R}),n.d(e,"ReplaceArgumentWithObjectValue",function(){return D}),n.d(e,"PRINT_VERSION",function(){return k});var r=n(3),i=n(5);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a=n(24).version,s=Math.random;function u(t,e){return s()*(e-t+1)+t|0}function l(t,e){return s()*(e-t)+t}function c(t){return Number(t)===t&&t%1==0}function f(t){return Number(t)===t&&t%1!=0}function h(t){return"[object Array]"===Object.prototype.toString.call(t)}function d(t,e){return s()>.5?t:e}function p(t,e){return 0===t?!0===e?1:0:t>0?1:-1}function y(t,e,n){return t<e?e:t>n?n:t}function v(t,e,n){return t<e?n:t>n?e:t}function m(t,e){return 1===u(1,2)?t:e}function b(t,e,n,i){for(var o=[],a=0;a<e;a+=n)o.push(Object(r.PrecisionRound)(a,i));return o}function g(t){return t[u(0,t.length-1)]}function w(t,e){return null!=t.min&&null!=t.max?l(t.min,t.max):null!=t.values&&t.values.length>0?g(t.values):null!=e&&t[e].length>0?g(t[e]):t}function A(t,e,n,r){var o,a,s="",l=t/e,f=i.a[n];t=null==t?32:t,e=null==e?4:e,n=null==n?0:n,r=null==r?"-":r;for(var h=0;h<t;++h)0!==(a=h/l)&&c(a)?s+=r:(o=u(1,f.length-1),s+=f.charAt(o));return s}function S(t,e){var n;if(void 0!==e)for(n in e)void 0!==t[n]&&(t[n]=e[n])}function C(t,e,n,r,i,o){var a;if("string"==typeof e&&(o=null==o?".":o,e=e.split(o)),e.length>1){if(void 0!==t[a=e.shift()])return C(t[a],e,n,r,i,o)}else{if(void 0!==t[a=e.shift()])return!0===r?void(t[a]=i):!0===n?t:t[a];if(!0===r)return void(t[a]=i)}}function T(t,e){for(var n=[],r={},i=t.length,o=0;o<e;++o){var a=s()*i|0;void 0===r[a]?(r[a]=null,n.push(t[a])):o--}return n}function x(t){for(var e,n,r=t.length-1;r-- >=0;)n=s()*r|0,e=t[r],t[r]=t[n],t[n]=e}function E(t){return parseInt(t,16)}function _(t){return parseInt(t,2)}function O(t){var e;for(e in t)if(t.hasOwnProperty(e))return!1;return JSON.stringify(t)===JSON.stringify({})}function P(t){var e,n=null,r=!1;if("function"==typeof t)throw new TypeError("Object was of type: function. Not acceptable.");if(h(t))n=[],r=!0;else{if("object"!==o(t))return t;n={}}if(r)for(var i=0;i<t.length;++i)n[i]=P(t[i]);else for(e in t)t.hasOwnProperty(e)&&(n[e]=P(t[e]));return n}function R(t,e,n){for(var r,i,o,a,s=[],u=0;u<t.length;++u)"string"==typeof(r=t[u])&&0===r.indexOf(e)&&r.indexOf(n)===e.length&&(-1!==(a=r.indexOf("|"))?(i=r.slice(r.indexOf("(")+1,a),o=r.slice(a+1,r.indexOf(")")),s.push({mod:i,val:o,iteratorIndex:u})):s.push({iteratorIndex:u}));return s}function D(t,e,n){for(var r,i=0;i<e.length;++i)"string"==typeof(r=e[i])&&0===r.indexOf(n)&&(e[i]=C(t,r.slice(n.length)))}function k(t){t?console.log("nenkraft2 server version "+a):console.log("%cnenkraft2 %cversion %c"+a,"color:#f0f7da;background-color:#234d20;font-family:Arial;font-size:18px;font-weight:900;padding:5px;","color:#f0f7da;background-color:#36802d;font-family:Arial;font-size:18px;font-weight:900;padding:5px;","color:#f0f7da;background-color:#77ab59;font-family:Arial;font-size:18px;font-weight:900;padding:5px;")}},function(t,e,n){"use strict";n.r(e),n.d(e,"PII",function(){return l}),n.d(e,"PI5",function(){return c}),n.d(e,"DEGREES_TO_RADIANS",function(){return f}),n.d(e,"RADIANS_TO_DEGRESS",function(){return h}),n.d(e,"RADIAN",function(){return d}),n.d(e,"DegreesToRadians",function(){return p}),n.d(e,"RadiansToDegress",function(){return y}),n.d(e,"PrecisionRound",function(){return v}),n.d(e,"Spread",function(){return m}),n.d(e,"AttractRepel",function(){return b}),n.d(e,"Oscillate",function(){return g}),n.d(e,"LineLineIntersection",function(){return w}),n.d(e,"ClosestPointOnLine",function(){return A}),n.d(e,"LikeASquareGrid",function(){return S}),n.d(e,"TriRectArray",function(){return C}),n.d(e,"GreatestCommonDivisor",function(){return T}),n.d(e,"SimplifyAspectRatio",function(){return x}),n.d(e,"IntegerNotation",function(){return E});var r=Math.PI,i=Math.sin,o=Math.cos,a=Math.pow,s=Math.round,u=Math.ceil,l=2*r,c=.5*r,f=r/180,h=180/r,d=f;function p(t){return t*f}function y(t){return t*h}function v(t,e){if(null==e)return t;var n=a(10,e);return s(n*t)/n}function m(t,e,n,r){return t-n*(e-1)*.5+r*n}function b(t,e,n,r,a){var s=e.SubtractVC(t);if(s.GetMagnitudeSquared()<r*r){var u=s.GetAngle();n.Add(o(u)*a,i(u)*a)}}function g(t,e,n,r){var o=.5*(n-e);return e+o+i(p(t*r))*o}function w(t,e,n,r){var i=e.SubtractVC(t),o=r.SubtractVC(n),a=-o.x*i.y+i.x*o.y,s=t.x-n.x,u=t.y-n.y,l=(-i.y*s+i.x*u)/a,c=(o.x*u-o.y*s)/a;return o.Store(),l>=0&&l<=1&&c>=0&&c<=1&&(i.Set(t.x+c*i.x,t.y+c*i.y),i)}function A(t,e,n){var r=e.SubtractVC(t),i=((n.x-t.x)*r.x+(n.y-t.y)*r.y)/r.GetMagnitudeSquared();return i<0?t:i>1?e:(r.Set(t.x+i*r.x,t.y+i*r.y),r)}function S(t,e,n,r){for(var i=e/n|0,o=0;o<t.length;++o)t[o].Set(o%i*n,(o/i|0)*r)}function C(t,e,n,r,i){return null!=i?(i[0]=t,i[1]=e,i[2]=t+n,i[3]=e,i[4]=t,i[5]=e+r,i[6]=t,i[7]=e+r,i[8]=t+n,i[9]=e,i[10]=t+n,i[11]=e+r,i):[t,e,t+n,e,t,e+r,t,e+r,t+n,e,t+n,e+r]}function T(t,e){return 0===e?t:T(e,t%e)}function x(t,e,n){var r=T(t,e),i=null==n?[]:n;return i[0]=t/r,i[1]=e/r,i}function E(t,e,n){var r=t%e,i=t/e;return u(0===r?i+1:i)+n+(1+r)}},function(t,e,n){"use strict";(function(t){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e,n,a){if(void 0==a||"function"!=typeof t.Assert)switch(e){case i.IS:return void function(t,e,n){var r=!1;t!==e&&(r=!0);o(r,t,e,n)}(t,n,e);case i.IS_NOT:return void function(t,e,n){var r=!1;t===e&&(r=!0);o(r,t,e,n)}(t,n,e);case i.IS_SAME_TYPE:return void function(t,e,n){var i=!1;Array.isArray(t)||Array.isArray(e)?!Array.isArray(t)!=!Array.isArray(e)&&(i=!0):null===t||null===e?t!==e&&(i=!0):r(t)!==r(e)?i=!0:"number"!=typeof t&&"number"!=typeof e||(isNaN(t)||isNaN(e))&&t!==e&&(i=!0);o(i,t,e,n)}(t,n,e);case i.IS_NOT_SAME_TYPE:return void function(t,e,n){var i=!1;Array.isArray(t)||Array.isArray(e)?Array.isArray(t)&&Array.isArray(e)&&(i=!0):null===t||null===e?e===t&&(i=!0):r(t)===r(e)?i=!0:"number"!=typeof t&&"number"!=typeof e||(isNaN(t)||isNaN(e))&&isNaN(t)&&isNaN(e)&&(i=!0);o(i,t,e,n)}(t,n,e);case i.IS_INSTANCE_OF:return void function(t,e,n){var r=!1;t instanceof e||(r=!0);o(r,t,e.name,n)}(t,n,e);case i.IS_NOT_INSTANCE_OF:return void function(t,e,n){var r=!1;t instanceof e&&(r=!0);o(r,t,e.name,n)}(t,n,e);case i.IS_LESS_THAN:return void function(t,e,n){var r=!1;t>=e&&(r=!0);o(r,t,e,n)}(t,n,e);case i.IS_GREATER_THAN:return void function(t,e,n){var r=!1;t<=e&&(r=!0);o(r,t,e,n)}(t,n,e);case i.IS_LESS_THAN_OR_EQUAL:return void function(t,e,n){var r=!1;t>e&&(r=!0);o(r,t,e,n)}(t,n,e);case i.IS_GREATER_THAN_OR_EQUAL:return void function(t,e,n){var r=!1;t<e&&(r=!0);o(r,t,e,n)}(t,n,e);default:throw new Error("No comparison: "+e)}else t.Assert(e,n)}function o(t,e,n,r){if(t)throw function(t,e,n){switch(n){case i.IS:n=i.IS_NOT;break;case i.IS_NOT:n=i.IS;break;case i.IS_SAME_TYPE:n=i.IS_NOT_SAME_TYPE;break;case i.IS_NOT_SAME_TYPE:n=i.IS_SAME_TYPE;break;case i.IS_INSTANCE_OF:n=i.IS_NOT_INSTANCE_OF;break;case i.IS_NOT_INSTANCE_OF:n=i.IS_INSTANCE_OF;break;case i.IS_LESS_THAN:n=i.IS_GREATER_THAN_OR_EQUAL;break;case i.IS_GREATER_THAN:n=i.IS_LESS_THAN_OR_EQUAL;break;case i.IS_LESS_THAN_OR_EQUAL:n=i.IS_GREATER_THAN;break;case i.IS_GREATER_THAN_OR_EQUAL:n=i.IS_LESS_THAN;break;default:throw new Error("Unexpected error")}console.error(t,n,e)}(e,n,r),new Error("Assertion failed: "+r);i.LOG&&window&&function(t,e,n){console.log("%c<<||-?START?-||>>","background-color: black; color: #0FF; padding: 0px 25px;"),console.log("%cAssertion success: ","background-color: #333; color: #0F0; padding: 0px 25px;"),console.log(t),console.log(n),console.log(e),console.log("%c>>||-?END?-||<<","background-color: black; color: #FF0; padding: 0px 25px;")}(e,n,r)}n.d(e,"a",function(){return i}),i.IS="I",i.IS_NOT="IN",i.IS_SAME_TYPE="IST",i.IS_NOT_SAME_TYPE="INST",i.IS_INSTANCE_OF="IIO",i.IS_NOT_INSTANCE_OF="INIO",i.IS_LESS_THAN="ILT",i.IS_GREATER_THAN="IGT",i.IS_LESS_THAN_OR_EQUAL="ILTOE",i.IS_GREATER_THAN_OR_EQUAL="IGTOE",i.Assign=function(e){if(window&&!e?e=window:t&&!e&&(e=t),!e)throw new Error("No global namespace");e.IS=i.IS,e.IS_NOT=i.IS_NOT,e.IS_SAME_TYPE=i.IS_SAME_TYPE,e.IS_NOT_SAME_TYPE=i.IS_NOT_SAME_TYPE,e.IS_INSTANCE_OF=i.IS_INSTANCE_OF,e.IS_NOT_INSTANCE_OF=i.IS_NOT_INSTANCE_OF,e.IS_LESS_THAN=i.IS_LESS_THAN,e.IS_GREATER_THAN=i.IS_GREATER_THAN,e.IS_LESS_THAN_OR_EQUAL=i.IS_LESS_THAN_OR_EQUAL,e.IS_GREATER_THAN_OR_EQUAL=i.IS_GREATER_THAN_OR_EQUAL},i.LOG=!1}).call(this,n(6))},function(t,e,n){"use strict";e.a=["0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz!?#$%@&","0123456789","ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","ABCDEFGHJIKLMNOPQRSTUWVXYZ","abcdefghijklmnopqrstuwvxyz","0123456789abcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZ"]},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return a});var r=n(2);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.functions={},this.values={},this.constants={},this.components={},this.objects={},this.lists={}}return function(t,e,n){e&&o(t.prototype,e),n&&o(t,n)}(e,[{key:"Define",value:function(t,e,n){this.Mark(t,e),this.Set(t,e,n)}},{key:"Mark",value:function(t,e){if("string"!=typeof t)throw new Error("Type needs to be a string!");if("string"!=typeof e)throw new Error("Id needs to be a string!");if(null==this[t])throw new Error("Type does not exist");if((t===l||t===c)&&void 0!==this[t][e])throw new Error("Constants cannot be reassigned!");this[t][e]=null}},{key:"Get",value:function(t,n){if("string"!=typeof t)throw new Error("Type needs to be a string!");if("string"!=typeof n)throw new Error("Id needs to be a string!");if(null==this[t])throw new Error("Type does not exist");if(!1===e.AllowGetNullUndefined&&null==this[t][n])throw new Error("Null or undefined!");return this[t][n]}},{key:"Set",value:function(t,e,n){if("string"!=typeof t)throw new Error("Type needs to be a string!");if("string"!=typeof e)throw new Error("Id needs to be a string!");switch(t){case s:if("function"!=typeof n)throw new Error("Needs to be a function!");if(null!==this.functions[e])throw new Error("No mark!");this.functions[e]=n;break;case u:if(n instanceof Object)throw new Error("Objects are not allowed!");if(null!==this.values[e])throw new Error("No mark!");this.values[e]=n;break;case l:if(n instanceof Object)throw new Error("Objects are not allowed!");if(null!==this.constants[e])throw new Error("No mark!");Object.defineProperty(this.constants,e,{writable:!1,configurable:!1,value:n});break;case c:if("function"!=typeof n)throw new Error("Needs to be a function!");if(null!==this.components[e])throw new Error("No mark!");Object.defineProperty(this.components,e,{writable:!1,configurable:!1,value:n});break;case f:if("object"!==i(n))throw new Error("Needs to be an object");if(!0===Object(r.IsArray)(n))throw new Error("Arrays are not allowed!");if(null!==this.objects[e])throw new Error("No mark!");this.objects[e]=n;break;case h:if(!1===Object(r.IsArray)(n))throw new Error("Needs to be an array!");if(null!==this.lists[e])throw new Error("No mark!");this.lists[e]=n;break;default:throw new Error("Unrecognized type!")}}}],[{key:"Assign",value:function(e){if(window&&!e?e=window:t&&!e&&(e=t),!e)throw new Error("No global namespace");e.FUNC=s,e.VAL=u,e.CONST=l,e.COMP=c,e.OBJ=f,e.LIST=h}},{key:"Create",value:function(n){var r=r||null;if(null==r){if(null==t)throw new Error("Neither window nor global exists!");if(void 0!==t[n])throw new Error("global."+n+" already exists!");t[n]=new e}else{if(void 0!==r[n])throw new Error("window."+n+" already exists!");r[n]=new e}}},{key:"FUNCTION",get:function(){return s}},{key:"VALUE",get:function(){return u}},{key:"CONSTANT",get:function(){return l}},{key:"COMPONENT",get:function(){return c}},{key:"OBJECT",get:function(){return f}},{key:"LIST",get:function(){return h}},{key:"AllowGetNullUndefined",get:function(){return d},set:function(t){(function(t){throw new Error('"'+t+'" is read-only')})("PS_AllowGetNullUndefined"),d=!!t}}]),e}(),s="functions",u="values",l="constants",c="components",f="objects",h="lists",d=!1}).call(this,n(6))},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nuniform mat3 uProjection;\r\nuniform mat3 uTranslation;\r\nuniform mat3 uTransformation;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vTexCoord = ( uTransformation * vec3( aTexCoord, 1.0 ) ).xy;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\nuniform vec4 uTint;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  gl_FragColor = TEX( uImage, vTexCoord ) * uTint;\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nattribute vec3 aProjection1;\r\nattribute vec3 aProjection2;\r\nattribute vec3 aProjection3;\r\n\r\nattribute vec3 aTranslation1;\r\nattribute vec3 aTranslation2;\r\nattribute vec3 aTranslation3;\r\n\r\nattribute vec3 aTransformation1;\r\nattribute vec3 aTransformation2;\r\nattribute vec3 aTransformation3;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  mat3 projection = mat3( aProjection1, aProjection2, aProjection3 );\r\n  mat3 translation = mat3( aTranslation1, aTranslation2, aTranslation3 );\r\n  mat3 transformation = mat3( aTransformation1, aTransformation2, aTransformation3 );\r\n  gl_Position = vec4( ( projection * translation * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vTexCoord = ( transformation * vec3( aTexCoord, 1.0 ) ).xy;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  gl_FragColor = TEX( uImage, vTexCoord );\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec3 aProjection1;\r\nattribute vec3 aProjection2;\r\nattribute vec3 aProjection3;\r\nattribute vec2 aPosition;\r\nattribute vec4 aColor;\r\nattribute float aPointSize;\r\n\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  mat3 projection = mat3( aProjection1, aProjection2, aProjection3 );\r\n  gl_Position = vec4( ( projection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  gl_PointSize = aPointSize;\r\n  vColor = aColor;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  gl_FragColor = vColor;\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform vec2 uSize;\r\nuniform float uOutline;\r\n\r\nvarying vec2 vPosition;\r\nvarying float vBorderX;\r\nvarying float vNegBorderX;\r\nvarying float vBorderY;\r\nvarying float vNegBorderY;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vPosition = aPosition;\r\n  vBorderX = -uSize.x * 0.5 + uOutline;\r\n  vNegBorderX = uSize.x * 0.5 - uOutline;\r\n  vBorderY = -uSize.y * 0.5 + uOutline;\r\n  vNegBorderY = uSize.y * 0.5 - uOutline;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform lowp vec4 uFillColor;\r\nuniform lowp vec4 uOutlineColor;\r\n\r\nvarying vec2 vPosition;\r\nvarying float vBorderX;\r\nvarying float vNegBorderX;\r\nvarying float vBorderY;\r\nvarying float vNegBorderY;\r\n\r\nvoid main() {\r\n  if (\r\n    vPosition.x > vBorderX &&\r\n    vPosition.x < vNegBorderX && \r\n    vPosition.y > vBorderY && \r\n    vPosition.y < vNegBorderY\r\n  ) {\r\n    gl_FragColor = uFillColor;\r\n  } else {\r\n    gl_FragColor = uOutlineColor;\r\n  }\r\n  \r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\n\r\nvarying vec2 vPosition;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vPosition = aPosition;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform lowp vec4 uFillColor;\r\nuniform lowp vec4 uOutlineColor;\r\nuniform float uRadius;\r\nuniform float uOutline;\r\n\r\nvarying vec2 vPosition;\r\n\r\nvoid main() {\r\n  float d = dot( vPosition, vPosition );\r\n  float rs = uRadius * uRadius;\r\n  float ors = uRadius - uOutline;\r\n  ors = ors * ors;\r\n  if ( d < rs && d > ors ) {\r\n    gl_FragColor = uOutlineColor;\r\n  } else if ( d < rs ) {\r\n    gl_FragColor = uFillColor;\r\n  }\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform lowp vec4 uColor;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform lowp vec4 uColor;\r\n\r\nvoid main() {\r\n  gl_FragColor = uColor;\r\n}\r\n@fragment-end@"},function(t,e){t.exports='/**\r\n* @author Gustav \'Nuuf\' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision highp float;\r\n\r\nattribute vec2 a_v2Position;\r\n\r\nuniform mat3 u_m3Projection;\r\n\r\nvarying vec2 v_v2Position;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( u_m3Projection * vec3( a_v2Position, 1.0 ) ).xy, 0.0, 1.0 );\r\n  v_v2Position = a_v2Position;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n\r\n(import \'RADIAN\' /)\r\n\r\nprecision highp float;\r\n\r\nuniform float u_fTime;\r\nuniform vec2 u_v2Resolution;\r\n\r\nvarying vec2 v_v2Position;\r\n\r\n(import \'rotate2d\' /)\r\n(import \'mod289\' /)\r\n(import \'permute\' /)\r\n(import \'snoise\' /)\r\n(import \'ridge\' /)\r\n(import \'rmf\' [\r\n  {\r\n    "set": {\r\n      "OFFSET": "1.0 + 0.1 * abs( sin( u_fTime ) )",\r\n      "OCTAVES": "19"\r\n    }\r\n  }\r\n] /)\r\n(import \'rmf\' [\r\n  {\r\n    "replace": {\r\n      "rmf": "rmf2"\r\n    },\r\n    "set": {\r\n      "OFFSET": "0.5 + 0.1 * abs( sin( u_fTime ) )",\r\n      "OCTAVES": "3"\r\n    }\r\n  }\r\n] /)\r\n\r\nvoid main() {\r\n\r\n  vec2 pos = v_v2Position / u_v2Resolution;\r\n  float sp = 4.0 * u_fTime;\r\n\r\n  pos *= -1.0; \r\n\r\n\r\n  pos.y += u_fTime / 2.0;\r\n  \r\n  // pos += 0.5;\r\n\r\n  vec3 color = vec3( 0.0, rmf2( pos * 20.0 ) * rmf( pos * 0.4 ), 0.0 );\r\n\r\n  color = mix( color * rmf( pos * 20.0 ), vec3( 0.9, 0.0, 0.9 ), 0.2 );\r\n\r\n  gl_FragColor = vec4( color, 1.0 );\r\n  \r\n}\r\n\r\n@fragment-end@'},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( aPosition, 1.0, 1.0 );\r\n    vTexCoord = aTexCoord;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  vec4 color = TEX( uImage, vTexCoord );\r\n  gl_FragColor = vec4( vec3( step( 1.0, color.r + color.g + color.b / 3.0 ) ), color.a );\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( aPosition, 1.0, 1.0 );\r\n    vTexCoord = aTexCoord;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  vec4 color = TEX( uImage, vTexCoord );\r\n  gl_FragColor = vec4( vec3( color.r + color.g + color.b / 3.0 ), color.a );\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( aPosition, 1.0, 1.0 );\r\n    vTexCoord = aTexCoord;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  vec4 color = TEX( uImage, vTexCoord );\r\n  gl_FragColor = vec4( vec3(\r\n    ( color.r * 0.393 ) + ( color.g * 0.769 ) + ( color.b * 0.189 ),\r\n    ( color.r * 0.349 ) + ( color.g * 0.686 ) + ( color.b * 0.168 ),\r\n    ( color.r * 0.272 ) + ( color.g * 0.534 ) + ( color.b * 0.131 )\r\n  ), color.a );\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( aPosition, 1.0, 1.0 );\r\n    vTexCoord = aTexCoord;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  vec4 color = TEX( uImage, vTexCoord );\r\n  gl_FragColor = vec4( vec3(\r\n    1.0 - color.r,\r\n    1.0 - color.g,\r\n    1.0 - color.b\r\n  ), color.a );\r\n}\r\n@fragment-end@"},function(t,e,n){t.exports=n(20)},function(t,e,n){n(21);var r=n(0);console.log(r,r.Shader.UN),r.Utility.PRINT_VERSION(),r.Sprite.BUILD_DEFAULT_TEXTURE(function(){r.Tilesprite.BUILD_DEFAULT_TEXTURE(function(){var t=new r.Load.XHRLoader,e=new r.Load.ImageLoader,i=new r.Load.SpritesheetLoader,o=0;function a(){if(!(o<3)){var r=[];window.testData={xhrloader:t,imgloader:e,ssloader:i};var a=n(47);a.keys().forEach(function(t){r.push(a(t))});for(var s=0,u=r.length;s<u;++s)r[s].default()}}t.Load([{id:"fontdataxml",src:"./assets/xhr/font.fnt",type:"xml"},{id:"fontdatajson",src:"./assets/xhr/font.json",type:"json"},{id:"fontNoK",src:"./assets/xhr/fontNoK.xml",type:"xml"},{id:"particleExplosion",src:"./assets/xhr/particle-explosion.json",type:"json"}]),e.Load([{id:"fontimg",src:"./assets/images/font.png"},{id:"fontNoK",src:"./assets/images/fontNoK.png"},{id:"1to8",src:"./assets/images/1to8.png"},{id:"4dots",src:"./assets/images/4dots.png"},{id:"colors",src:"./assets/images/colors.png"},{id:"glass-of-blueberryjuice",src:"./assets/images/glass-of-blueberryjuice.png"},{id:"raindrop",src:"./assets/images/raindrop.png"},{id:"smudge",src:"./assets/images/smudge.png"}],!0),i.Load([{id:"sheet-default",image:{src:"./../assets/images/invaders/invaders-sheet.png"},data:{src:"./../assets/xhr/invaders.json",type:"json"}}]),t.onComplete.Add(function(t){console.log(t.data),console.log(JSON.stringify(t.data.dataCache.items[0].data)===JSON.stringify(t.data.dataCache.items[1].data)),o++,a()}),e.onComplete.Add(function(t){console.log(t.data),o++,a()}),i.onComplete.Add(function(t){console.log(t.data),o++,a()})})})},function(t,e,n){},,function(t,e){Array.prototype.indexPop=function(t){var e=this.length-1;if(e>1&&t<=e&&t>=0){var n=this[e];return this[e]=this[t],this[t]=n,this.pop()}return this.pop()},Array.prototype.indexShift=function(t){if(this.length>1&&t<=this.length-1&&t>=0){var e=this[0];return this[0]=this[t],this[t]=e,this.shift()}return this.shift()},Array.prototype.popSplice=function(t){var e=this.length-1;if(!(e<1)){for(var n=this[t];t<e;)this[t]=this[t+1],t++;return this.pop(),n}},Array.prototype.shiftSplice=function(t){if(!(this.length<1)){for(var e=this[t];t>0;)this[t]=this[t-1],t--;return this.shift(),e}},Array.prototype.fickleSplice=function(t){return t>.5*this.length|0?this.popSplice(t):this.shiftSplice(t)}},function(t){t.exports={name:"nenkraft2",version:"1.1.0",description:"A small rendering tool",main:"./bundle-fe/nk2.js",devDependencies:{"@babel/core":"^7.0.0","@babel/preset-env":"^7.0.0","babel-loader":"^8.0.2","copy-webpack-plugin":"^4.5.2","css-loader":"^1.0.0",eslint:"^5.5.0","file-loader":"^2.0.0","html-loader":"^0.5.5","html-webpack-plugin":"^3.2.0","mini-css-extract-plugin":"^0.4.2","raw-loader":"^0.5.1",rimraf:"^2.6.2",webpack:"^4.17.2","webpack-cli":"^3.1.0","webpack-dev-server":"^3.1.8"},dependencies:{},scripts:{"build-prod":"webpack --env production --mode production","build-bundle-fe":"webpack --env bundle-fe --mode production","build-bundle-be":"webpack --env bundle-be --mode production",start:"webpack-dev-server --env development --mode development","clear-bundle-fe":"rimraf bundle-fe/dist","clear-bundle-be":"rimraf bundle-be/dist","clear-dist":"rimraf dist",ce:"rimraf dist bundle-fe/dist bundle-be/dist",be:"npm run ce && npm run build-prod && npm run build-bundle-be && npm run build-bundle-fe","lint-f":"eslint src demos --fix",lint:"eslint src demos"},keywords:["2d","rendering","command","vector","game","graphic","tween","animation","collision","canvas","web","webgl","utilities"],author:"nuuf",license:"MIT"}},function(t,e){t.exports="#define PI 3.141592653589793\r\n"},function(t,e){t.exports="#define RADIAN 0.017453292519943295"},function(t,e){t.exports="#define RSEED1 46.1964987\r\n#define RSEED2 71.7294374\r\n#define RSEED3 94638.4836"},function(t,e){t.exports="#define VRSEED1 127.1\r\n#define VRSEED2 311.7\r\n#define VRSEED3 269.5\r\n#define VRSEED4 183.3\r\n#define VRSEED5 43758.5453123"},function(t,e){t.exports="float mod289( float n ) {\r\n     return ( n - floor( n * ( 1.0 / 289.0 ) ) * 289.0 );\r\n}\r\nvec2 mod289( vec2 p ) {\r\n     return ( p - floor( p * ( 1.0 / 289.0 ) ) * 289.0 );\r\n}\r\nvec3 mod289( vec3 p ) {\r\n     return ( p - floor( p * ( 1.0 / 289.0 ) ) * 289.0 );\r\n}"},function(t,e){t.exports="float permute( float n ) { \r\n    return ( mod289( ( ( n * 34.0 ) +1.0 ) * n ) );\r\n}\r\nvec2 permute( vec2 p ) { \r\n    return ( mod289( ( ( p * 34.0 ) +1.0 ) * p ) );\r\n}\r\nvec3 permute( vec3 p ) { \r\n    return ( mod289( ( ( p * 34.0 ) +1.0 ) * p ) );\r\n}"},function(t,e){t.exports="mat2 rotate2d ( float a ) {\r\n    float ca = cos( a );\r\n    float sa = sin( a );\r\n    return mat2( ca, sa, -sa, ca );\r\n}"},function(t,e){t.exports="mat2 scale2d ( vec2 scl ) {\r\n    return mat2( scl.x, 0.0, 0.0, scl.y );\r\n}"},function(t,e){t.exports="float plot ( float n, float pct, float prec ) {\r\n    return (\r\n        smoothstep( pct - prec, pct, n ) -\r\n        smoothstep( pct, pct + prec, n )\r\n    );\r\n}"},function(t,e){t.exports="float ridge( float h, float offset ) {\r\n    h = abs( h );\r\n    h = offset - h;\r\n    h *= h;\r\n    return h;\r\n}"},function(t,e){t.exports="float random( float n ) {\r\n    return ( fract( sin( n ) * RSEED3 ) );\r\n}\r\nfloat random( vec2 p ) {\r\n    return ( fract( sin( dot( p, vec2( RSEED1, RSEED2 ) ) ) * RSEED3 ) );\r\n}\r\n"},function(t,e){t.exports="vec2 vrandom( vec2 p ) {\r\n    p = vec2( \r\n        dot( p, vec2( VRSEED1, VRSEED2 ) ),\r\n        dot( p, vec2( VRSEED3, VRSEED4 ) )\r\n    );\r\n    return ( -1.0 + 2.0 * fract( sin ( p ) * VRSEED5 ) );\r\n}"},function(t,e){t.exports="float noise( float n ) {\r\n    float fl = floor( n );\r\n    return( mix( random( fl ), random( fl + 1.0 ), fract( n ) ) );\r\n}\r\nfloat noise ( vec2 p ) {\r\n    vec2 fl = floor( p );\r\n    vec2 fr = fract( p );\r\n    float a = random( fl );\r\n    float b = random( fl + vec2( 1.0, 0.0 ) );\r\n    float c = random( fl + vec2( 0.0, 1.0 ) );\r\n    float d = random( fl + vec2( 1.0, 1.0 ) );\r\n    vec2 sm = fr * fr * ( 3.0 - 2.0 * fr );\r\n    return ( \r\n        mix( a, b, sm.x ) + \r\n        ( c -a ) * sm.y * \r\n        ( 1.0 - sm.x ) + \r\n        ( d - b ) * sm.x * sm.y\r\n    );\r\n}"},function(t,e){t.exports="float gnoise( vec2 p ) {\r\n    vec2 fl = floor( p );\r\n    vec2 fr = fract( p );\r\n    vec2 sm = fr * fr * ( 3.0 - 2.0 * fr );\r\n    return ( mix( \r\n            mix( \r\n                dot( vrandom( fl ), fr ), \r\n                dot( vrandom( fl + vec2( 1.0, 0.0 ) ), fr - vec2( 1.0, 0.0 ) ), sm.x\r\n            ),\r\n            mix( \r\n                dot( vrandom( fl + vec2( 0.0, 1.0 ) ), fr - vec2( 0.0, 1.0 ) ), \r\n                dot( vrandom( fl + vec2( 1.0, 1.0 ) ), fr - vec2( 1.0, 1.0 ) ), sm.x\r\n            ),\r\n            sm.y\r\n        )\r\n    );\r\n}"},function(t,e){t.exports="float snoise( vec2 v ) {\r\n    vec4 C = vec4(\r\n        0.211324865405187,\r\n        0.366025403784439,\r\n        -0.577350269189626,\r\n        0.024390243902439\r\n    );\r\n    vec2 i  = floor( v + dot( v, C.yy ) );\r\n    vec2 x0 = v - i + dot( i, C.xx );\r\n    vec2 i1 = vec2( 0.0 );\r\n    i1 = ( x0.x > x0.y ) ? vec2( 1.0, 0.0 ) : vec2( 0.0, 1.0 );\r\n    vec2 x1 = x0.xy + C.xx - i1;\r\n    vec2 x2 = x0.xy + C.zz;\r\n    i = mod289( i );\r\n    vec3 p = permute(\r\n        permute( i.y + vec3( 0.0, i1.y, 1.0 ) ) + i.x + vec3( 0.0, i1.x, 1.0 )\r\n    );\r\n    vec3 m = max( \r\n        0.5 - vec3(\r\n            dot( x0, x0 ),\r\n            dot( x1, x1 ),\r\n            dot( x2, x2 )\r\n        ),\r\n    0.0);\r\n    m = m * m ;\r\n    m = m * m ;\r\n    vec3 x = 2.0 * fract( p * C.www ) - 1.0;\r\n    vec3 h = abs( x ) - 0.5;\r\n    vec3 ox = floor( x + 0.5 );\r\n    vec3 a0 = x - ox;\r\n    m *= 1.79284291400159 - 0.85373472095314 * ( a0 * a0 + h * h );\r\n    vec3 g = vec3( 0.0 );\r\n    g.x  = a0.x  * x0.x  + h.x  * x0.y;\r\n    g.yz = a0.yz * vec2( x1.x, x2.x ) + h.yz * vec2( x1.y, x2.y );\r\n    return ( 130.0 * dot( m, g ) );\r\n}"},function(t,e){t.exports="float fbm ( vec2 p ) {\r\n    float v = 0.0;\r\n    float AMP = 0.5;\r\n    float MULT = 2.0;\r\n    float AMP_MULT = 0.5;\r\n    const int OCTAVES = 3;\r\n    for ( int i = 0; i < OCTAVES; ++i ) {\r\n        v += AMP * NOISE( p );\r\n        AMP *= AMP_MULT;\r\n        p *= MULT;\r\n    }\r\n    return v;\r\n}"},function(t,e){t.exports="float abs_fbm ( vec2 p ) {\r\n    float v = 0.0;\r\n    float AMP = 0.5;\r\n    float LACUNARITY = 2.0;\r\n    float GAIN = 0.5;\r\n    const int OCTAVES = 3;\r\n    for ( int i = 0; i < OCTAVES; ++i ) {\r\n        v += AMP * abs( NOISE( p ) );\r\n        AMP *= GAIN;\r\n        p *= LACUNARITY;\r\n    }\r\n    return v;\r\n}"},function(t,e){t.exports="float rot_fbm_3 ( vec2 p, float a ) {\r\n    float v = 0.0;\r\n    vec2 s = vec2( 100.0 );\r\n    mat2 r = rotate2d( a );\r\n    v += 0.500000 * NOISE( p ); p = p * r * 2.0043 + s;\r\n    v += 0.250000 * NOISE( p ); p = p * r * 2.0310 + s;\r\n    v += 0.125000 * NOISE( p );\r\n    return v;\r\n}"},function(t,e){t.exports="float rmf ( vec2 p ) {\r\n    float LACUNARITY = 2.0;\r\n    float GAIN = 0.5;\r\n    float OFFSET = 0.9;\r\n    float v = 0.0;\r\n    float f = 1.0;\r\n    float AMP = 0.5;\r\n    float prev = 1.0;\r\n    const int OCTAVES = 3;\r\n    for ( int i = 0; i < OCTAVES; ++i ) {\r\n        float n = ridge( snoise( p * f ), OFFSET );\r\n        v += ( n * AMP ) + ( n * AMP * prev );\r\n        prev = n;\r\n        f *= LACUNARITY;\r\n        AMP *= GAIN;\r\n    }\r\n    return v;\r\n}"},function(t,e){t.exports="float aabb( vec2 pos, vec2 size, float blur ){\r\n    size = 0.5 - size * 0.5;\r\n    vec2 dim = smoothstep( size, size + blur, pos ) *\r\n               smoothstep( size - blur, size, 1.0 - pos - blur );\r\n    return dim.x * dim.y;\r\n}"},function(t,e){t.exports="float cruciform( vec2 pos, float size, float armSize, float blur ) {\r\n  return aabb( pos, vec2( size, armSize ), blur ) +\r\n         aabb( pos, vec2( armSize, size ), blur );\r\n}"},function(t,e){t.exports="float circle( vec2 pos, float r, float blur ) {\r\n  return ( 1.0 - smoothstep( r - blur, r, dot( pos , pos ) * 4.0 ) );\r\n}"},function(t,e,n){var r={"./playground/pg.un.demo":48,"./solid/01.sprite.demo":49,"./solid/02.graphic2d.demo":50,"./solid/03.container2d.demo":51,"./solid/04.bitmap-text.demo":52,"./solid/05.stage2d.demo":53,"./solid/06.stadium.demo":54,"./solid/07.canvas-manager.demo":55,"./solid/08.camera2d.demo":56,"./solid/09.basic-setup.demo":57,"./solid/10.tilesprite.demo":58,"./solid/11.text.demo":59,"./solid/12.geom.demo":60,"./solid/13.collision-aabb2d.demo":61,"./solid/14.collision-circle.demo":62,"./solid/15.collision-polygon2d.demo":63,"./solid/16.collision-line2d-circle.demo":64,"./solid/17.create-texture.demo":65,"./solid/18.animation.demo":66,"./solid/19.quadtree.demo":67,"./solid/20.ray-casting.demo":68,"./solid/21.particle-system.demo":69,"./solid/22.webgl-animation.demo":70,"./solid/23.webgl-circle.demo":71,"./solid/24.webgl-rectangle.demo":72,"./solid/25.webgl-line2d.demo":73,"./solid/26.webgl-pixelbatch.demo":74,"./solid/27.webgl-texture2dbatch.demo":75,"./solid/28.webgl-bitmap-text.demo":76,"./solid/29.webgl-tilesprite.demo":77,"./solid/30.stresstest.demo":78,"./solid/31.webgl-stresstest.demo":79,"./solid/32.utilities.demo":80,"./solid/33.motion.demo":81,"./solid/34.interaction.demo":82,"./solid/35.webgl-rendertexture.demo":83};function i(t){var e=o(t);return n(e)}function o(t){var e=r[t];if(!(e+1)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return e}i.keys=function(){return Object.keys(r)},i.resolve=o,t.exports=i,i.id=47},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("PGUNDEMO",function(t){var e=600,n=400,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,x:0,y:0,halt:!1,mode:"WebGL"},a=t.stage=new i.Stage2D(o),s=new i.Container2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.Container2D(300,200);a.gl.clearColor(.9,.9,.9,1),u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();for(var c=new i.Controller.ProgramController.GLUnProgramController(a.gl,i.Shader.UN),f=1;f--;){var h=new i.GLEntity2D(0,0,c);h.transformAutomaticUpdate=!0,h.transformShouldUpdate=!0;h.w=h.h=384,h.w=e,h.h=n,h.timeInc=.05/12,h.ComputeBounds({x:.5,y:.5}),h.position.Set(i.Utility.RandomInteger(-300,300),i.Utility.RandomInteger(-200,200)),h.position.Set(0,0),l.AddChild(h)}a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("Sprite",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new i.Sprite(r,o);s.anchor.SetSame(.5),s.Draw(a.getContext("2d"))})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("Graphic2D",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new i.Path.Circle(0,0,50);new i.Graphic2D(r,o,s).Draw(a.getContext("2d"))})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("Container2D",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new i.Sprite(r,o);s.anchor.SetSame(.5);var u=new i.Container2D(0,0);u.AddChild(s),u.Draw(a.getContext("2d"))})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("BitmapText",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute",a.style.backgroundColor="white";var s=a.getContext("2d"),u=new i.BitmapText(0,0,window.testData.imgloader.GetBasicTextureById("fontNoK"),window.testData.xhrloader.GetDataById("fontNoK"),"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.");u.scale.SetSame(.6),u.x=r-.5*u.width,u.y=o-.5*u.height,u.Draw(s)})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("Stage2D",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s={canvas:a,x:r,y:o,halt:!0},u=t.stage=new i.Stage2D(s);u.ticker.StartAF(),u.onProcess.Add(function(){console.log("tick"),u.onProcess.Dump()})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("Stadium",function(t){var e={className:"mcnvs",width:600,height:400,mode:"2d",x:0,y:0,fill:!1},n=t.stadium=new i.Stadium(e);function r(){this.children.forEach(o)}function o(t){t.position.AddV(t.data.velocity),t.data.velocity.Rotate(t.data.torque)}n.CreateStage2D("stage1"),n.CreateStage2D("stage2"),n.CreateStage2D("stage3"),n.CreateStage2D("stage4"),n.GetStages("stage1","stage2","stage3").forEach(function(t){for(var e=10;e--;){var n=t.AddChild(new i.Graphic2D(i.Utility.RandomFloat(100,500),i.Utility.RandomFloat(50,350),new i.Path.Circle(0,0,i.Utility.RandomInteger(10,50))));n.data.velocity=new i.Vector2D(i.Utility.RandomFloat(-1,1),i.Utility.RandomFloat(-1,1)),n.data.torque=i.Utility.RandomFloat(-i.Math.RADIAN,i.Math.RADIAN)}t.onProcess.Add(r,t)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("CanvasManager",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,x:960,y:540,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.Container2D(0,0);(t.canvasManager=new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT)).BindStage(a).BindRootContainer(s).Trigger()})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("Camera2D",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s={canvas:a,x:r,y:o,halt:!0},u=t.stage=new i.Stage2D(s),l=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),c=new i.Container2D(0,0),f=new i.Sprite(0,0);u.AddChild(l).AddChild(c).AddChild(f),u.mouse.AddOffset(l),u.ticker.StartAF(),u.onProcess.Add(function(){l.Process()}),u.mouse.onDown.Add(function(t){l.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("BasicSetup",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1},r=t.stage=new i.Stage2D(n),o=new i.Container2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.Container2D(300,200),u=new i.Sprite(0,0);a.force.SetSame(5),u.anchor.SetSame(.5),r.AddChild(o).AddChild(a).AddChild(s).AddChild(u),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger(),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("Tilesprite",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=a.getContext("2d"),u=new i.Tilesprite(r,o,i.Tilesprite.DEFAULT_TEXTURE);u.GeneratePattern(s,640,640),u.x=r-.5*u.width,u.y=o-.5*u.height,u.Draw(s)})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("Text",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute",a.style.backgroundColor="white";var s=a.getContext("2d"),u=new i.Text(r,o,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.");u.style.text.align=i.Style.TextConf.ALIGN_CENTER,u.style.text.baseline=i.Style.TextConf.BASELINE_MIDDLE,u.style.text.lineWidth=.3,u.style.text.font="40px Arial",u.Draw(s)})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("Geom",function(t){var e=window.innerWidth,n=window.innerHeight,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o=r.getContext("2d"),a=new i.Path.Circle(0,0,50),s=new i.Path.AABB2D(0,0,100,100),u=new i.Path.Polygon2D,l=new i.Path.Line2D(0,0,100,100),c=new i.Path.Polygon2D,f=new i.Path.Polygon2D;i.Geom.PolygonConstruction.Butterfly(u,0,0,1e3,50),i.Geom.PolygonConstruction.Star(c,0,0,100,50,5),i.Geom.PolygonConstruction.Rose(f,0,0,100,7/9,1e3,9);var h=new i.Graphic2D(100,100,a),d=new i.Graphic2D(200,100,s),p=new i.Graphic2D(350,100,l),y=new i.Graphic2D(600,200,u),v=new i.Graphic2D(100,300,c),m=new i.Graphic2D(400,400,f);h.Draw(o),d.Draw(o),p.Draw(o),y.Draw(o),v.Draw(o),m.Draw(o)})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("CollisionAABB2D",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,x:0,y:0,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.Container2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.Container2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u);var c=i.Collision.AABB2DvsAABB2D.CollideRel,f=new i.Collision.AABB2DvsAABB2D.Result,h=l.AddChild(new i.Graphic2D(0,100,new i.Path.AABB2D(0,0,50,50))),d=l.AddChild(new i.Graphic2D(0,0,new i.Path.AABB2D(0,0,400,100))),p={shape:h.path,relative:h.position},y={shape:d.path,relative:d.position},v=new i.Vector2D(0,0),m=new i.Vector2D(0,0),b=null;a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){for(var e=l.children.length,n=t.data.position;e--;)if(l.children[e].IntersectsPoint(n)){v.SetV(n),b=l.children[e],m.SetV(b.position),t.stopPropagation=!0,b.SendToFront();break}b||u.target.position.SetV(n)}),a.mouse.onMove.Add(function(t){if(b){var e=t.data.position;b.position.SetV(e).AddV(m).SubtractV(v),f.Reset(),c(p,y,f),f.occured&&p.relative.AddV(f.mtv)}},a),a.mouse.onUp.Add(function(){b&&(b=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("CollisionCircle",function(t){var e=5760,n=3240,r=2880,o=1620,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s={canvas:a,x:0,y:0,halt:!1},u=t.stage=new i.Stage2D(s),l=new i.Container2D(0,0),c=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),f=new i.Container2D(r,o);c.force.SetSame(5),u.AddChild(l).AddChild(c).AddChild(f);for(var h=new i.CanvasManager(a,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT),d=[],p=i.Collision.CirclevsCircle.CollideRel,y=i.Collision.CirclevsCircle.ElasticResponse,v=new i.Collision.CirclevsCircle.Result,m=50;m--;){var b=i.Utility.RandomInteger(50,125),g=new i.Path.Circle(0,0,b),w=new i.Graphic2D(i.Utility.RandomFloat(-r,r),i.Utility.RandomFloat(-o,o),g);w.data.body={shape:g,relative:w.position,mass:b,velocity:new i.Vector2D(i.Utility.RandomInteger(-30,30),i.Utility.RandomInteger(-30,30))},d.push(w.data.body),f.AddChild(w)}h.BindStage(u).BindRootContainer(l).Trigger(),u.mouse.AddOffset(f).AddOffset(c),u.onProcess.Add(function(){c.Process();for(var t,e,n=0,i=0,a=d.length;n<a;++n)for((t=d[n]).relative.AddV(t.velocity),t.relative.x>r?(t.relative.x=r,t.velocity.x=-t.velocity.x):t.relative.x<-r&&(t.relative.x=-r,t.velocity.x=-t.velocity.x),t.relative.y>o?(t.relative.y=o,t.velocity.y=-t.velocity.y):t.relative.y<-o&&(t.relative.y=-o,t.velocity.y=-t.velocity.y),i=0;i<a;++i)t!==(e=d[i])&&(v.Reset(),p(t,e,v),v.occured&&y(t,e,v))}),u.mouse.onDown.Add(function(t){c.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("CollisionPolygon2D",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,x:0,y:0,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.Container2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.Container2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l);for(var c=new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT),f=[],h=i.Collision.PolygonvsPolygon.CollideRel,d=new i.Collision.PolygonvsPolygon.Result,p=new i.Vector2D(0,0),y=new i.Vector2D(0,0),v=null,m=100;m--;){var b=new i.Path.Polygon2D;i.Geom.PolygonConstruction.Cyclic(b,0,0,i.Utility.RandomInteger(30,60),i.Utility.RandomInteger(3,6));var g=new i.Graphic2D(0,0,b);g.data.body={shape:b,relative:g.position},f.push(g.data.body),l.AddChild(g)}c.BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process();for(var t,e,n=0,r=0,i=f.length;n<i;++n)for(t=f[n],r=0;r<i;++r)t!==(e=f[r])&&(d.Reset(),h(t,e,d),d.occured&&(v?(t.relative!==v.position&&t.relative.SubtractV(d.mtv),e.relative!==v.position&&e.relative.AddV(d.mtv)):(d.mtv.Multiply(.5,.5),t.relative.SubtractV(d.mtv),e.relative.AddV(d.mtv))))}),a.mouse.onDown.Add(function(t){for(var e=l.children.length,n=t.data.position;e--;)if(l.children[e].IntersectsPoint(n)){p.SetV(n),v=l.children[e],y.SetV(v.position),t.stopPropagation=!0,v.SendToFront();break}v||u.target.position.SetV(n)}),a.mouse.onMove.Add(function(t){if(v){var e=t.data.position;v.position.SetV(e).AddV(y).SubtractV(p)}},a),a.mouse.onUp.Add(function(){v&&(v=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("CollisionLine2DCircle",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1},r=t.stage=new i.Stage2D(n),o=new i.Container2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.Container2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();for(var u=[],l=[],c=50;c--;){var f=new i.Path.Circle(0,0,i.Utility.RandomInteger(5,8)),h=new i.Graphic2D(0,0,f);h.data.body={shape:f,relative:h.position,velocity:new i.Vector2D(i.Utility.RandomFloat(-4,4),i.Utility.RandomFloat(-4,4))},s.AddChild(h),u.push(h.data.body)}for(var d=50;d--;){var p=new i.Path.Line2D(0,0,i.Utility.RandomInteger(10,25),i.Utility.RandomInteger(10,25)),y=new i.Graphic2D(i.Utility.RandomInteger(-300,300),i.Utility.RandomInteger(-200,200),p);p.Rotate(i.Math.RADIAN*i.Utility.RandomInteger(0,360)),y.data.body={shape:p,relative:y.position},s.AddChild(y),l.push(y.data.body)}var v=i.Collision.CirclevsLine.CollideRel,m=i.Collision.CirclevsLine.ReflectingResponse,b=new i.Collision.CirclevsLine.Result;r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){var t,e;a.Process();for(var n=0;n<u.length;++n){(t=u[n]).relative.AddV(t.velocity),t.relative.y<-200&&(t.relative.y=-200,t.velocity.y*=-1),t.relative.y>200&&(t.relative.y=200,t.velocity.y*=-1),t.relative.x<-300&&(t.relative.x=-300,t.velocity.x*=-1),t.relative.x>300&&(t.relative.x=300,t.velocity.x*=-1);for(var r=0;r<l.length;++r)e=l[r],b.Reset(),v(t,e,b),b.occured&&m(t,e,b)}}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("CreateTexture",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new Image;s.onload=function(){var t=new i.Sprite(r,o,new i.Texture.BasicTexture2D(s));t.anchor.Set(.5,.5),t.Draw(a.getContext("2d"))},s.src=i.BrowserUtility.GenerateSimpleBase64PNG(function(){var t=new i.Path.Polygon2D;return i.Geom.PolygonConstruction.Supershape(t,0,0,100,100,6,.3,.3,.3),new i.Graphic2D(Math.abs(t.aabb.tl.x),Math.abs(t.aabb.tl.y),t)},null,null,"white")})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("Animation",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1},r=t.stage=new i.Stage2D(n),o=new i.Container2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.Container2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.Sprite(0,0,window.testData.imgloader.GetBasicTextureById("1to8"));u.anchor.SetSame(.5),s.AddChild(u);var l=(u.animationController=new i.Animator.Controller(u)).CreateAnimation("play",25);u.width=64,u.height=64,l.GenerateFrames(64,64,512,64,8,{5:10,3:8,1:6}),l.reverse=!0,l.loop=!0,l.Start(),l.onEnd.Add(function(){console.log("end")}),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process(),l.Process()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("Quadtree",function(t){var e=window.innerWidth,n=window.innerHeight,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,x:0,y:0,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.Geom.AABB2D(0,0,e,n),u=new i.QuadtreeNode(s,0,4,5),l=[],c=[];a.onProcess.Add(function(){l.forEach(function(t){i.Debug.Draw.AABB2D(a.rc,t.aabb)})}),a.mouse.onDown.Add(function(t){var e=new i.Graphic2D(t.data.position.x,t.data.position.y,new i.Path.AABB2D(0,0,10,10));e.ComputeBounds(e.anchor),a.AddChild(e),c.push(e),u.Dump(),c.forEach(function(t){u.Add(t.bounds)}),l.length=0,u.ConcatNodes(l)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("RayCasting",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,x:0,y:0,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.Container2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.Container2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();for(var c=[],f=[],h=100;h--;){var d=new i.Path.Polygon2D;i.Geom.PolygonConstruction.Cyclic(d,i.Utility.RandomInteger(-e,e),i.Utility.RandomInteger(-n,n),i.Utility.RandomInteger(30,60),i.Utility.RandomInteger(3,8)),d.Rotate(i.Utility.RandomFloat(0,i.Math.PII));var p=new i.Graphic2D(0,0,d);c.push(p)}for(var y=180,v=2*Math.PI/y;y--;){var m=v*y,b=new i.Path.Ray2D(0,0,0,0);b.style.stroke.lineWidth=1;var g=new i.Graphic2D(0,0,b);g.interactive=!1,g.data.angle=m,g.data.r=360,f.push(g)}l.Mount(c.concat(f)),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process(),f.forEach(function(t){t.path.s.SetV(a.mouse.position),t.path.e.SetV(t.path.s),t.path.e.Add(t.data.r,t.data.r),t.path.e.RotateAroundV(t.path.s,t.data.angle)});for(var t,e,n,r,o=0,s=0,l=0,h=0,d=f[o],p=f.length,y=c.length,v=0;o<p;d=f[++o])for(t=c[s=0];s<y;t=c[++s])for(l=0,h=(v=t.path.vertices.length)-1;l<v;h=l++)e=t.path.vertices[l],n=t.path.vertices[h],(r=i.Math.LineLineIntersection(d.path.s,d.path.e,e,n))&&(f[o].path.e.SetV(r),r.Store(),r=null)}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("ParticleSystem",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,x:0,y:0,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.Container2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.Container2D(960,540),c=new i.Particle.Particle2D.System(0,0),f=window.testData.xhrloader.GetClonedDataById("particleExplosion"),h=new i.Time.Timer(10),d=new i.Geom.Polygon2D;i.Geom.PolygonConstruction.Cyclic(d,0,0,400,72);var p=d.Copy();p.vertices.forEach(function(t){t.Invert(),t.Multiply(.1,.1)}),h.onFinish.Add(function(){c.Emit(f),h.Start()}),h.Start(),f.texture=i.Sprite.DEFAULT_TEXTURE,f.position={points:d.vertices,moduloWrapper:d.vertices.length},f.velocity={points:p.vertices,moduloWrapper:p.vertices.length},u.force.SetSame(.1),a.AddChild(s).AddChild(u).AddChild(l).AddChild(c),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process(),c.Process(),h.Process()}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("WebGLAnimation",function(t){var e=400/3,n=t.canvas=document.createElement("canvas");document.body.appendChild(n),n.setAttribute("width",200),n.setAttribute("height",e),n.style.display="initial",n.style.position="absolute";var r={canvas:n,x:0,y:0,halt:!1,mode:"WebGL2",antialias:!0},o=t.stage=new i.Stage2D(r),a=new i.Container2D(0,0),s=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),u=new i.Container2D(100,66.66666666666667);s.force.SetSame(5),o.AddChild(a).AddChild(s).AddChild(u),new i.CanvasManager(n,200,e,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(o).BindRootContainer(a).Trigger(),o.mouse.AddOffset(u).AddOffset(s);var l=new i.Controller.ProgramController.GLDynamicTexture2DProgramController(o.gl,2);l.BindBasicTexture(i.Sprite.DEFAULT_TEXTURE,0),l.BindBasicTexture(window.testData.imgloader.GetBasicTextureById("1to8"),1);var c=new i.Sprite(0,0,l,1),f=new i.Sprite(0,0,l,0);c.anchor.SetSame(.5),f.anchor.SetSame(.5),f.UpdateTextureTransform(),f.alpha=.5,u.AddChildren(c,f);var h=(c.animationController=new i.Animator.Controller(c)).CreateAnimation("play",25);c.width=64,c.height=64,h.GenerateFrames(64,64,512,64,8,{5:10,3:8,1:6}),h.loop=!0,h.Start(),o.onProcess.Add(function(){s.Process(),h.Process()}),o.mouse.onDown.Add(function(t){s.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("WebGLCircle",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,x:0,y:0,halt:!1,mode:"WebGL"},a=t.stage=new i.Stage2D(o),s=new i.Container2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.Container2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();for(var c=new i.Controller.ProgramController.GLCircleProgramController(a.gl),f=1e3;f--;){var h=new i.Path.Circle(0,0,50);h.style.stroke.lineWidth=1,h.LinkProgramController(c);var d=new i.Graphic2D(i.Utility.RandomInteger(-960,960),i.Utility.RandomInteger(-540,540),h);l.Mount(d)}a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("WebGLRectangle",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.Container2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.Container2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.Controller.ProgramController.GLRectangleProgramController(r.gl),l=new i.Path.AABB2D(-100,-100,100,100);l.style.stroke.lineWidth=1,l.LinkProgramController(u);var c=new i.Graphic2D(0,0,l);s.Mount(c),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process(),c.rotation+=i.Math.RADIAN}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("WebGLLine2D",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.Container2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.Container2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.Controller.ProgramController.GLLine2DProgramController(r.gl),l=new i.Path.Line2D(-100,-100,100,100);l.style.stroke.lineWidth=1,l.LinkProgramController(u);var c=new i.Graphic2D(0,0,l);s.Mount(c),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process(),c.rotation+=i.Math.RADIAN}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("WebGLPixelBatch",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.Container2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.Container2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.Container2D(0,0),l=new i.Controller.ProgramController.GLPixelBatchProgramController(r.gl);s.AddChild(u),u.UseAsBatchParent(l);for(var c=2e4;c--;){var f=new i.Path.Pixel(0,0);f.color.r=0,f.color.g=Math.random(),f.color.b=.8,f.color.a=i.Utility.RandomFloat(.1,.6),f.style.pixel.size=i.Utility.RandomFloat(1,2);var h=new i.Graphic2D(0,0,f);h.data.velocity=new i.Vector2D(i.Utility.RandomFloat(-2,2),i.Utility.RandomFloat(-2,2)),h.data.torque=i.Utility.RandomFloat(20*-i.Math.RADIAN,20*i.Math.RADIAN),u.Mount(h),h.UpdateTransform()}u.ComputeBatchBuffer(),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){var t;a.Process();for(var e=0;e<u.children.length;++e)(t=u.children[e]).data.velocity.Rotate(t.data.torque),t.position.AddV(t.data.velocity),t.UpdateInBuffer()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("WebGLTexture2DBatch",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.Container2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.Container2D(300,200),u=new i.Sprite(0,0);a.force.SetSame(5),u.anchor.SetSame(.5),r.AddChild(o).AddChild(a).AddChild(s).AddChild(u),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var l=new i.Container2D(0,0),c=new i.Controller.ProgramController.GLTexture2DBatchProgramController(r.gl);c.BindBasicTexture(window.testData.imgloader.GetBasicTextureById("colors")),s.AddChild(l),l.UseAsBatchParent(c);for(var f=5e3;f--;){var h=new i.Sprite(0,0,c.originalTexture);h.w=64,h.h=64,h.scale.SetSame(.05),h.anchor.SetSame(.5),h.animationController=new i.Animator.Controller(h);var d=h.animationController.CreateAnimation("animation",60);d.GenerateFrames(64,64,1024,64,16),d.SetFrame(i.Utility.RandomInteger(0,15)),h.data.velocity=new i.Vector2D(i.Utility.RandomFloat(-2,2),i.Utility.RandomFloat(-2,2)),h.data.torque=i.Utility.RandomFloat(20*-i.Math.RADIAN,20*i.Math.RADIAN),l.Mount(h),h.UpdateTransform()}l.ComputeBatchBuffer(),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){var t;a.Process();for(var e=0;e<l.children.length;++e)(t=l.children[e]).data.velocity.Rotate(t.data.torque),t.position.AddV(t.data.velocity),t.UpdateInBuffer()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("WebGLBitmapText",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.Container2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.Container2D(300,200);r.gl.clearColor(1,1,1,1),a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.Controller.ProgramController.GLTexture2DProgramController(r.gl);u.BindBasicTexture(window.testData.imgloader.GetBasicTextureById("fontimg"));var l=new i.BitmapText(0,0,u,window.testData.xhrloader.GetDataById("fontdataxml"),"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.");l.scale.SetSame(.3),l.x=.5*-l.width,l.y=.5*-l.height,s.AddChild(l),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("WebGLTilesprite",function(t){var e=960,n=540,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,x:0,y:0,halt:!1,mode:"WebGL"},a=t.stage=new i.Stage2D(o),s=new i.Container2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.Container2D(480,270);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();var c=new i.Controller.ProgramController.GLTexture2DProgramController(a.gl);c.BindBasicTexture(i.Tilesprite.DEFAULT_TEXTURE);var f=new i.Tilesprite(-240,-135,c);f.GeneratePattern(null,480,270),l.AddChild(f),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process(),f.OffsetPattern(1,1)}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("Stresstest",function(t){var e=window.innerWidth,n=window.innerHeight,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o=r.getContext("2d"),a=new i.Container2D(0,0),s=t.ticker=new i.Time.Ticker(function(){o.setTransform(1,0,0,1,0,0),o.fillStyle="rgba(0,0,0,1)",o.fillRect(0,0,e,n),a.Draw(o),d.Process()},1e3,!0),u=20,l=0,c=35,f=[],h=new i.Pool,d=new i.Time.Timer;h.Flood(function(){var t=new i.Sprite(Math.random()*e,Math.random()*n);return t.transformAutomaticUpdate=!1,t},2e4),d.onFinish.Add(function(){var t=c;for(c=c<3?3:c--;t--;)a.AddChild(h.Retrieve());if(s.GetTPS()>40||l++<20)this.Start(1);else{var e=a.children.length;console.log(e,s.GetTPS()),a.children.forEach(function(t){h.Store(t)}),a.Dump(),l=0,f.push(e),--u>0?this.Start(120):(f.sort(function(t,e){return t-e}),console.log(f,"\nMIN: "+f[0],"MED: "+f[Math.round(f.length/2)],"MAX: "+f[f.length-1]))}},d),s.Start(),d.Start(120)})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("WebGLStresstest",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=a.getContext("webgl2"),u=new i.Container2D(0,0),l=t.ticker=new i.Time.Ticker(function(){s.viewport(0,0,e,n),s.clear(s.COLOR_BUFFER_BIT),s.enable(s.BLEND),s.disable(s.DEPTH_TEST),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),u.GLDraw(s),y.Process(),s.flush()},1e3,!0),c=20,f=0,h=35,d=[],p=new i.Pool(i.Sprite),y=new i.Time.Timer,v=new i.Controller.ProgramController.GLTexture2DProgramController(s);v.BindBasicTexture(i.Sprite.DEFAULT_TEXTURE,s.NEAREST),u.scale.Set(2/e,-2/n),u.position.Add(0,0),u.UpdateTransform(),p.Flood(function(){var t=new i.Sprite(Math.random()*e-r,Math.random()*n-o,v);return t.transformAutomaticUpdate=!1,t},2e4),y.onFinish.Add(function(){var t=h;for(h=h<3?3:h--;t--;)u.AddChild(p.Retrieve());if(l.GetTPS()>40||f++<20)this.Start(1);else{var e=u.children.length;console.log(e,l.GetTPS()),u.children.forEach(function(t){p.Store(t)}),u.Dump(),f=0,d.push(e),--c>0?this.Start(120):(d.sort(function(t,e){return t-e}),console.log(d,"\nMIN: "+d[0],"MED: "+d[Math.round(d.length/2)],"MAX: "+d[d.length-1]))}},y),l.Start(),y.Start(120)})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.default=function(){Object(r.a)("Utilities",function(t){var e=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mem1=e,this.mem2=n,this.mem3=null,this.mem4=null,this.deep={deeper:{deepest:0}}}return function(t,e,n){e&&o(t.prototype,e),n&&o(t,n)}(t,[{key:"Some",value:function(t){this.mem3=t,this.mem4=this.mem1+this.mem2}}]),t}(),n=new i.Maker;console.log(n.Many(15).Make(e,"@i(*|2)","@i(%|3)").Call(Math.random,null,"deep.deeper.deepest").Call("Some",["@i"]).Call(console.log,["$deep.deeper.deepest"]).Ship(!0)),console.log(n),i.Glob.Create("myGlob");var r=window.myGlob;r.Define(i.Glob.CONSTANT,"myConstant","someValue"),r.Define(i.Glob.FUNCTION,"myFunction",function(){}),r.Define(i.Glob.VALUE,"myValue","someValue");try{r.Mark(i.Glob.CONSTANT,"myConstant")}catch(t){console.error(t)}r.Mark(i.Glob.OBJECT,"myObject");try{r.Set(i.Glob.OBJECT,"myObject",0)}catch(t){console.error(t)}r.Set(i.Glob.OBJECT,"myObject",{}),console.log(r),window.myGlob=void 0,i.Assert.LOG=!0,i.Assert(0,i.Assert.IS_SAME_TYPE,1),i.Assert("myString",i.Assert.IS,"myString"),i.Assert(10,i.Assert.IS_GREATER_THAN,9);try{i.Assert(10,i.Assert.IS_LESS_THAN,9)}catch(t){console.error(t)}try{i.Assert([],i.Assert.IS_SAME_TYPE,Object)}catch(t){console.error(t)}i.Assert([],i.Assert.IS_INSTANCE_OF,Object);var a=new i.CP.Registry;i.CP.Command.OPTION_PREFIX="--",a.AddCommand(new i.CP.Command("myCommand mycmd",function(t,e,n){console.log(t,e,n,"prime")},"some info about this command",!0,!0).AddOption("anOption anopt",function(t,e,n){console.log(t,e,n,"priorty 0")},"some info about this option",0,!1).AddOption("op2",function(){console.log("op2 called.","priorty 99")},"brrrr",99,!1)),console.log(a),a.Parse('myCommand --anopt someData=myData someString --op2 (JSON)myJsonData={"someJsonData":"value"}',{someStatic:"data"}),null!=a.Parse("what?")&&console.error("Unknown command");var s=a.Parse("hmmm...");s&&console.error(s,"- is not a recognized command")})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}e.default=function(){Object(r.a)("Motion",function(t){var e=function(t){function e(t,n,a){var u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(u=function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?l(t):e}(this,s(e).call(this,0,0,new i.Path.Line2D(t.x,t.y,n.x,n.y)))).path.style.stroke.color=new i.Color(i.Utility.RandomInteger(u.w,200),i.Utility.RandomInteger(u.w,150),i.Utility.RandomInteger(0,20),1).value,u.path.style.stroke.lineWidth=u.w/12,a.AddChild(l(l(u))),u.x=i.Utility.RandomFloat(-c,c),u.y=i.Utility.RandomFloat(0,r),u.rotation=i.Utility.RandomInteger(0,i.Math.PII),u.rotation=i.Utility.ThisOrThat(u.rotation,-u.rotation);var f=u.motionManager=new i.Motion.Manager(l(l(u)));return f.Create("moveX","x",0,120,"SineInOut"),f.Create("moveY","y",0,120,"SineInOut"),f.Create("rotate","rotation",0,120,"SineInOut"),f.StartMultiple("moveX moveY rotate"),u.w>12&&u.Grow(),u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(e,i["Graphic2D"]),function(t,e,n){e&&a(t.prototype,e),n&&a(t,n)}(e,[{key:"Grow",value:function(){var t=this.path.e.SubtractVC(this.path.s),n=t.Copy();t.Rotate(50*i.Math.RADIAN+i.Utility.RandomFloat(20*-i.Math.RADIAN,20*i.Math.RADIAN)),n.Rotate(50*-i.Math.RADIAN+i.Utility.RandomFloat(20*-i.Math.RADIAN,20*i.Math.RADIAN)),t.Multiply(.67,.67),n.Multiply(.67,.67),t.AddV(this.path.e),n.AddV(this.path.e),new e(this.path.e,t,this.parent),new e(this.path.e,n,this.parent)}}]),e}(),n=1920,r=1080,c=960,f=t.canvas=document.createElement("canvas");document.body.appendChild(f),f.setAttribute("width",n),f.setAttribute("height",r),f.style.display="initial",f.style.position="absolute";var h={canvas:f,x:0,y:0,halt:!1},d=t.stage=new i.Stage2D(h),p=new i.Container2D(0,0),y=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),v=new i.Container2D(c,r);v.scale.Set(1,-1),y.force.SetSame(5),d.AddChild(p).AddChild(y).AddChild(v),new i.CanvasManager(f,n,r,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(d).BindRootContainer(p).Trigger(),d.mouse.AddOffset(v).AddOffset(y),new e(new i.Vector2D(0,0),new i.Vector2D(0,300),v);var m=new i.Time.Timer(130);m.onFinish.Add(function(){d.ticker.Stop()}),m.Start(),d.onProcess.Add(function(){y.Process(),v.children.forEach(function(t){t.motionManager.Process()}),m.Process()}),d.mouse.onDown.Add(function(t){y.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("Interaction",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1},r=t.stage=new i.Stage2D(n),o=new i.Container2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.Container2D(300,200),u=new i.Sprite(0,0),l=new i.Graphic2D(-100,-100,new i.Path.Circle(0,0,50)),c=new i.Graphic2D(100,100,new i.Path.Line2D(-100,0,100,0)),f=new i.Vector2D(0,0),h=new i.Vector2D(0,0),d=null;c.path.Rotate(23/180*Math.PI),a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s).AddChildren(u,l,c),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger(),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process()}),r.mouse.onDown.Add(function(t){for(var e=s.children.length,n=t.data.position;e--;)if(s.children[e].IntersectsPoint(n)){f.SetV(n),d=s.children[e],h.SetV(d.position),t.stopPropagation=!0,d.SendToFront();break}d||a.target.position.SetV(n)}),r.mouse.onMove.Add(function(t){if(d){var e=t.data.position;d.position.SetV(e).AddV(h).SubtractV(f)}},r),r.mouse.onUp.Add(function(){d&&(d=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n(0);e.default=function(){Object(r.a)("Rendertexture",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,x:0,y:0,halt:!1,mode:"WebGL2"},a=t.stage=new i.Stage2D(o),s=new i.Container2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.Container2D(960,540),c=new i.Container2D(960,540),f=new i.Controller.ProgramController.GLTexture2DProgramController(a.gl);f.BindBasicTexture(i.Sprite.DEFAULT_TEXTURE);var h=new i.Controller.ProgramController.GLRendertextureProgramController(a.gl,i.Shader.RENDERTEXTURE_INVERT);h.Config(e,n,a.gl.LINEAR);var d=new i.Sprite(0,0,f),p=new i.Sprite(0,0,f);d.anchor.SetSame(.5),p.anchor.SetSame(.5),d.alpha=.5,d.UpdateTextureTransform(),p.UpdateTextureTransform(),a.gl.clearColor(.3,.3,.3,1),s.GLPreDraw=function(t){a.SetFramebuffer(t,h)},s.GLPostDraw=function(){a.SetFramebuffer(),h.Execute()},u.force.SetSame(5),a.AddChild(s).AddChild(u).Mount(l,c),l.Mount(d),c.Mount(p),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u);var y=0;a.onProcess.Add(function(){u.Process(),d.x=128*Math.cos(y),d.y=128*Math.sin(y),y+=i.Math.RADIAN}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}}]);