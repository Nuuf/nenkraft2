/**
* @package     Nenkraft2
* @author      Gustav 'Nuuf' Åberg <gustavrein@gmail.com>
* @version     1.3.8
* @copyright   (C) 2018 Gustav 'Nuuf' Åberg
* @license     {@link https://github.com/Nuuf/nenkraft2/blob/master/LICENSE}
*/!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=22)}([function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"CCH1",function(){return G}),n.d(r,"CCH1Decipher",function(){return V});var i={};n.r(i),n.d(i,"GenerateSimpleBase64PNG",function(){return X}),n.d(i,"ImageFromDataURL",function(){return H}),n.d(i,"ParsedXMLToJSON",function(){return Y}),n.d(i,"XMLToJSON",function(){return W}),n.d(i,"DownloadAsJSON",function(){return q});var o={};n.r(o),n.d(o,"Linear",function(){return $}),n.d(o,"QuadIn",function(){return Z}),n.d(o,"QuadOut",function(){return tt}),n.d(o,"QuadInOut",function(){return et}),n.d(o,"SineIn",function(){return nt}),n.d(o,"SineOut",function(){return rt}),n.d(o,"SineInOut",function(){return it}),n.d(o,"CircIn",function(){return ot}),n.d(o,"CircOut",function(){return at}),n.d(o,"CircInOut",function(){return st});var a={};n.r(a),n.d(a,"Result",function(){return ct}),n.d(a,"CollideRel",function(){return ht});var s={};n.r(s),n.d(s,"Line2DLine2DCollision",function(){return yt});var u={};n.r(u),n.d(u,"Result",function(){return bt}),n.d(u,"CollideRel",function(){return gt});var l={};n.r(l),n.d(l,"Result",function(){return _t}),n.d(l,"CollideRel",function(){return Ot}),n.d(l,"ElasticResponse",function(){return Rt});var c={};n.r(c),n.d(c,"Result",function(){return Mt}),n.d(c,"CollideRel",function(){return Xt}),n.d(c,"ReflectingResponse",function(){return Ht});var h={};n.r(h),n.d(h,"Result",function(){return Jt}),n.d(h,"CollideRel",function(){return Qt}),n.d(h,"AxisSeparates",function(){return $t});var f={};n.r(f),n.d(f,"AABB2DvsAABB2D",function(){return a}),n.d(f,"Line2DvsLine2D",function(){return s}),n.d(f,"AABB2DvsLine2D",function(){return u}),n.d(f,"CirclevsCircle",function(){return l}),n.d(f,"CirclevsLine2D",function(){return c}),n.d(f,"Polygon2DvsPolygon2D",function(){return h});var d={};n.r(d),n.d(d,"Rectangular",function(){return oe}),n.d(d,"Isosceles",function(){return ae}),n.d(d,"Cyclic",function(){return se}),n.d(d,"Equilateral",function(){return ue}),n.d(d,"Star",function(){return le}),n.d(d,"Butterfly",function(){return ce}),n.d(d,"Rose",function(){return he}),n.d(d,"Supershape",function(){return fe});var p={};n.r(p),n.d(p,"AABB2D",function(){return pe}),n.d(p,"Circle",function(){return Te}),n.d(p,"Line2D",function(){return Pe}),n.d(p,"Ray2D",function(){return Pe}),n.d(p,"Polygon2D",function(){return Re}),n.d(p,"PolygonConstruction",function(){return d});var y={};n.r(y),n.d(y,"DEFAULT",function(){return ke}),n.d(y,"SOURCE_OVER",function(){return Ie}),n.d(y,"SOURCE_IN",function(){return Le}),n.d(y,"SOURCE_OUT",function(){return je}),n.d(y,"SOURCE_ATOP",function(){return Be}),n.d(y,"DESTINATION_OVER",function(){return Ge}),n.d(y,"DESTINATION_IN",function(){return Ve}),n.d(y,"DESTINATION_OUT",function(){return Ne}),n.d(y,"DESTINATION_ATOP",function(){return Fe}),n.d(y,"LIGHTER",function(){return Ue}),n.d(y,"COPY",function(){return Me}),n.d(y,"XOR",function(){return Xe}),n.d(y,"MULTIPLY",function(){return He}),n.d(y,"OVERLAY",function(){return Ye}),n.d(y,"DARKEN",function(){return We}),n.d(y,"LIGHTEN",function(){return qe}),n.d(y,"COLOR_DODGE",function(){return ze}),n.d(y,"COLOR_BURN",function(){return Ke}),n.d(y,"HARD_LIGHT",function(){return Je}),n.d(y,"SOFT_LIGHT",function(){return Qe}),n.d(y,"DIFFERENCE",function(){return $e}),n.d(y,"EXCLUSION",function(){return Ze}),n.d(y,"HUE",function(){return tn}),n.d(y,"SATURATION",function(){return en}),n.d(y,"COLOR",function(){return nn}),n.d(y,"LUMINOSITY",function(){return rn});var v={};n.r(v),n.d(v,"CAP_ROUND",function(){return on}),n.d(v,"CAP_BUTT",function(){return an}),n.d(v,"CAP_SQUARE",function(){return sn}),n.d(v,"JOIN_BEVEL",function(){return un}),n.d(v,"JOIN_ROUND",function(){return ln}),n.d(v,"JOIN_MITER",function(){return cn});var m={};n.r(m),n.d(m,"ALIGN_START",function(){return hn}),n.d(m,"ALIGN_END",function(){return fn}),n.d(m,"ALIGN_CENTER",function(){return dn}),n.d(m,"ALIGN_LEFT",function(){return pn}),n.d(m,"ALIGN_RIGHT",function(){return yn}),n.d(m,"BASELINE_ALPHABETIC",function(){return vn}),n.d(m,"BASELINE_TOP",function(){return mn}),n.d(m,"BASELINE_HANGING",function(){return bn}),n.d(m,"BASELINE_MIDDLE",function(){return gn}),n.d(m,"BASELINE_IDEOGRAPHIC",function(){return wn}),n.d(m,"BASELINE_BOTTOM",function(){return An});var b={};n.r(b),n.d(b,"Fill",function(){return Cn}),n.d(b,"Stroke",function(){return xn}),n.d(b,"Shadow",function(){return Pn}),n.d(b,"Text",function(){return On}),n.d(b,"Pixel",function(){return Rn}),n.d(b,"GCO",function(){return y}),n.d(b,"LineConf",function(){return v}),n.d(b,"TextConf",function(){return m}),n.d(b,"All",function(){return Dn}),n.d(b,"FFSa",function(){return kn}),n.d(b,"SSa",function(){return In}),n.d(b,"FSa",function(){return Ln}),n.d(b,"SaT",function(){return jn}),n.d(b,"P",function(){return Bn});var g={};n.r(g),n.d(g,"AABB2D",function(){return Mn}),n.d(g,"Circle",function(){return zn}),n.d(g,"Line2D",function(){return tr}),n.d(g,"Ray2D",function(){return tr}),n.d(g,"Polygon2D",function(){return ar}),n.d(g,"Pixel",function(){return wr});var w={};n.r(w),n.d(w,"Timer",function(){return Pr}),n.d(w,"Ticker",function(){return Or});var A={};n.r(A),n.d(A,"Uglify",function(){return ei}),n.d(A,"ParseImports",function(){return ni}),n.d(A,"SNIPPETS",function(){return ri}),n.d(A,"Parse",function(){return ii}),n.d(A,"TEXTURE_2D",function(){return oi}),n.d(A,"TEXTURE_2D_BATCH",function(){return ai}),n.d(A,"PIXEL_BATCH",function(){return si}),n.d(A,"RECTANGLE",function(){return ui}),n.d(A,"CIRCLE",function(){return li}),n.d(A,"LINE2D",function(){return ci}),n.d(A,"UN",function(){return hi}),n.d(A,"RENDERTEXTURE_BLACK_WHITE",function(){return fi}),n.d(A,"RENDERTEXTURE_GRAYSCALE",function(){return di}),n.d(A,"RENDERTEXTURE_SEPIA",function(){return pi}),n.d(A,"RENDERTEXTURE_INVERT",function(){return yi}),n.d(A,"DynamicTEXTURE_2D",function(){return vi});var S={};n.r(S),n.d(S,"ImageLoader",function(){return Ti}),n.d(S,"SpritesheetLoader",function(){return ki}),n.d(S,"TilesetLoader",function(){return ji}),n.d(S,"XHRLoader",function(){return Ei}),n.d(S,"LoaderCombiner",function(){return Gi});var C={};n.r(C),n.d(C,"GLProgramController",function(){return Ni}),n.d(C,"GLCircleProgramController",function(){return Wi}),n.d(C,"GLLine2DProgramController",function(){return $i}),n.d(C,"GLPixelBatchProgramController",function(){return io}),n.d(C,"GLRectangleProgramController",function(){return co}),n.d(C,"GLTexture2DBatchProgramController",function(){return mo}),n.d(C,"GLTexture2DProgramController",function(){return Co}),n.d(C,"GLDynamicTexture2DProgramController",function(){return Oo}),n.d(C,"GLUnProgramController",function(){return jo}),n.d(C,"GLRendertextureProgramController",function(){return Uo});var T={};n.r(T),n.d(T,"ProgramController",function(){return C});var x={};n.r(x),n.d(x,"Option",function(){return Xo}),n.d(x,"Command",function(){return Yo}),n.d(x,"Registry",function(){return Jo});var E={};n.r(E),n.d(E,"Motion",function(){return $o}),n.d(E,"Manager",function(){return ea});var P={};n.r(P),n.d(P,"Particle2D",function(){return As}),n.d(P,"Oscillation",function(){return sa}),n.d(P,"System",function(){return Os});var _={};n.r(_),n.d(_,"Particle2D",function(){return P});var O={};n.r(O),n.d(O,"BasicTexture2D",function(){return Si}),n.d(O,"Spritesheet",function(){return Ri}),n.d(O,"Tileset",function(){return Ii});var R={};n.r(R),n.d(R,"Animation",function(){return es}),n.d(R,"Controller",function(){return rs}),n.d(R,"Frame",function(){return _i});var D={};n.r(D),n.d(D,"AABB2D",function(){return Rs});var k={};n.r(k),n.d(k,"Draw",function(){return D});var I={};n.r(I),n.d(I,"RectanglePacker",function(){return ks});var L={};n.r(L),n.d(L,"Keyboard",function(){return js}),n.d(L,"Mouse",function(){return Gs}),n.d(L,"Touch",function(){return Ns});var j=n(3),B=n(4);function G(t,e){var n,r,i=t.split(""),o=[];e=void 0===e?1:e;for(var a=0;a<i.length;++a)n=((n=i[a]).charCodeAt(0)+e).toString(2),r=Object(j.RandomInteger)(1,9),o.push(r+"x"+n.replace(/1/g,r));return o.join(" ")}function V(t,e){var n,r=t.split(" "),i=[];e=void 0===e?1:e;for(var o=0;o<r.length;++o)n=(n=r[o]).slice(2-n.length),i.push(String.fromCharCode(parseInt(n.replace(/[2-9]/g,"1"),2)-e));return i.join("")}var N,F,U,M=Math.ceil;function X(t,e,n,r){var i=t();return null==N&&(N=document.createElement("canvas"),F=N.getContext("2d")),N.width=M(i.w),N.height=M(i.h),null!=e&&(N.width=e),null!=n&&(N.height=n),null!=r?(F.fillStyle=r,F.fillRect(0,0,N.width,N.height)):F.clearRect(0,0,N.width,N.height),F.setTransform(1,0,0,1,0,0),i.Render(F),N.toDataURL("image/png")}function H(t,e,n,r){var i=new Image;return i.width=e,i.height=n,i.onload=r,i.src=t,i}function Y(t,e){var n,r,i,o,a,s,u={},l=t.childNodes,c=l.length;if(1===t.nodeType){if((c=(r=t.attributes).length)>0)for(u.attributes={},n=0,i=r.item(n);n<c;i=r.item(++n))u.attributes[i.nodeName]=i.nodeValue}else 3===t.nodeType&&(/^\s*$/g.exec(t.nodeValue)||(u=t.nodeValue,!0===e&&(u=u.replace(/^\s+|\s+&|\n/gim,""))));if(null!=l)for(c=l.length,n=0,o=l.item(n);n<c;o=l.item(++n))void 0===u[o.nodeName]?u[o.nodeName]=Y(o,e):(void 0===u[o.nodeName].push&&(s=u[o.nodeName],u[o.nodeName]=[],Object(j.IsObjectEmpty)(s)||u[o.nodeName].push(s)),a=Y(o,e),Object(j.IsObjectEmpty)(a)||u[o.nodeName].push(a));return u["#text"]&&0===u["#text"].length&&delete u["#text"],u}function W(t,e){return null==U&&(U=new DOMParser),Y(U.parseFromString(t,"text/xml"),e)}function q(t,e){var n="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t)),r=document.createElement("a");r.setAttribute("href",n),r.setAttribute("download",e+".json"),r.click()}var z=Math.sin,K=Math.cos,J=Math.sqrt,Q=Math.PI,$=function(t,e,n,r){return n*t/r+e},Z=function(t,e,n,r){return n*(t/=r)*t+e},tt=function(t,e,n,r){return-n*(t/=r)*(t-2)+e},et=function(t,e,n,r){return(t/=.5*r)<1?.5*n*t*t+e:.5*-n*(--t*(t-2)-1)+e},nt=function(t,e,n,r){return-n*K(t/r*(.5*Q))+n+e},rt=function(t,e,n,r){return n*z(t/r*(.5*Q))+e},it=function(t,e,n,r){return.5*-n*(K(Q*t/r)-1)+e},ot=function(t,e,n,r){return-n*(J(1-(t/=r)*t)-1)+e},at=function(t,e,n,r){return t/=r,n*J(1- --t*t)+e},st=function(t,e,n,r){return(t/=.5*r)<1?.5*-n*(J(1-t*t)-1)+e:.5*n*(J(1-(t-=2)*t)+1)+e},ut=n(1);function lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ct=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new ut.a(0,0),this.occured=!1}var e,n,r;return e=t,(n=[{key:"Reset",value:function(){this.mtv.SetSame(0),this.occured=!1}}])&&lt(e.prototype,n),r&&lt(e,r),t}(),ht=function(t,e,n){var r=t.shape,i=r.w,o=r.h,a=t.anchor,s=e.shape,u=s.w,l=s.h,c=e.anchor;ft.SetV(r.tl).SubtractV(t.relative),dt.SetV(s.tl).SubtractV(e.relative);var h=dt.x+i,f=ft.x+u,d=dt.y+o,p=ft.y+l;return null!=a&&(ft.x+=a.x*i,ft.y+=a.y*o),null!=c&&(dt.x+=c.x*u,dt.y+=c.y*l),ft.x<h&&dt.x<f&&ft.y<d&&dt.y<p&&(null!=n&&(pt[0].Set(ft.x-h,0),pt[1].Set(f-dt.x,0),pt[2].Set(0,ft.y-d),pt[3].Set(0,p-dt.y),pt.sort(ut.a.SortMinMag),n.mtv.SetV(pt[0]),n.occured=!0),!0)},ft=new ut.a(0,0),dt=new ut.a(0,0),pt=[new ut.a(0,0),new ut.a(0,0),new ut.a(0,0),new ut.a(0,0)];function yt(t,e,n,r,i){i.SetV(e).SubtractV(t),vt.SetV(r).SubtractV(n);var o=-vt.x*i.y+i.x*vt.y,a=t.x-n.x,s=t.y-n.y,u=(-i.y*a+i.x*s)/o,l=(vt.x*s-vt.y*a)/o;return u>=0&&u<=1&&l>=0&&l<=1?(i.Set(t.x+l*i.x,t.y+l*i.y),!0):(i.SetSame(0),!1)}var vt=new ut.a(0,0);function mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var bt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.poc={a:new ut.a(0,0),b:new ut.a(0,0),c:new ut.a(0,0),d:new ut.a(0,0)},this.top=!1,this.right=!1,this.bottom=!1,this.left=!1}var e,n,r;return e=t,(n=[{key:"Reset",value:function(){this.poc.a.SetSame(0),this.poc.b.SetSame(0),this.poc.c.SetSame(0),this.poc.d.SetSame(0),this.top=!1,this.right=!1,this.bottom=!1,this.left=!1}}])&&mt(e.prototype,n),r&&mt(e,r),t}(),gt=function(t,e,n){wt.SetV(t.shape.tl).AddV(t.relative),At.SetV(t.shape.br).AddV(t.relative),St.SetV(e.shape.s).AddV(e.relative),Ct.SetV(e.shape.e).AddV(e.relative),Tt.Set(wt.x+(At.x-wt.x),wt.y),xt.Set(wt.x,wt.y+(At.y-wt.y)),n.top=yt(St,Ct,wt,Tt,n.poc.a),n.right=yt(St,Ct,At,Tt,n.poc.b),n.bottom=yt(St,Ct,At,xt,n.poc.c),n.left=yt(St,Ct,wt,xt,n.poc.d)},wt=new ut.a(0,0),At=new ut.a(0,0),St=new ut.a(0,0),Ct=new ut.a(0,0),Tt=new ut.a(0,0),xt=new ut.a(0,0);function Et(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Pt=Math.sqrt,_t=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new ut.a(0,0),this.poc={a:new ut.a(0,0),b:new ut.a(0,0),c:new ut.a(0,0)},this.mtd=0,this.delta=new ut.a(0,0),this.occured=!1}var e,n,r;return e=t,(n=[{key:"Reset",value:function(){this.poc.a.SetSame(0),this.poc.b.SetSame(0),this.poc.c.SetSame(0),this.mtv.SetSame(0),this.mtd=0,this.delta.SetSame(0),this.occured=!1}}])&&Et(e.prototype,n),r&&Et(e,r),t}(),Ot=function(t,e,n){var r=t.shape,i=e.shape,o=r.radius,a=i.radius,s=o+a,u=t.anchor,l=e.anchor;It.SetV(t.relative),Lt.SetV(e.relative),Vt.SetV(Lt).SubtractV(It);var c=Vt.GetMagnitudeSquared();if(null!=u&&(It.x+=u.x*r.diameter,It.y+=u.y*r.diameter),null!=l&&(Lt.x+=l.x*i.diameter,Lt.y+=l.y*i.diameter),s*s>c){if(null!=n){var h=Pt(c),f=(r.radiusSquared-i.radiusSquared+c)/(h+h),d=Pt(r.radiusSquared-f*f)/h,p=-Vt.y*d,y=Vt.x*d;jt.Set(It.x+Vt.x*f/h,It.y+Vt.y*f/h),Bt.Set(jt.x+p,jt.y+y),Gt.Set(jt.x-p,jt.y-y),It.SubtractV(Lt).Divide(s,s);var v=h-o-a;n.poc.a.SetV(jt),n.poc.b.SetV(Bt),n.poc.c.SetV(Gt),n.mtv.SetV(It),n.mtd=v,n.delta.SetV(Vt),n.occured=!0}return!0}return!1},Rt=function(t,e,n){Dt.SetV(n.delta).Normalize(),kt.SetV(n.mtv);var r=t.mass,i=e.mass,o=t.velocity,a=e.velocity,s=2*(o.GetDotV(Dt)-a.GetDotV(Dt))/(r+i);o.Set(o.x-s*i*Dt.x,o.y-s*i*Dt.y),a.Set(a.x+s*r*Dt.x,a.y+s*r*Dt.y),kt.Multiply(n.mtd,n.mtd).Divide(2,2),t.relative.SubtractV(kt),e.relative.AddV(kt)},Dt=new ut.a(0,0),kt=new ut.a(0,0),It=new ut.a(0,0),Lt=new ut.a(0,0),jt=new ut.a(0,0),Bt=new ut.a(0,0),Gt=new ut.a(0,0),Vt=new ut.a(0,0),Nt=n(7);function Ft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ut=Math.sqrt,Mt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new ut.a(0,0),this.cp=new ut.a(0,0),this.sOrE=0,this.occured=!1}var e,n,r;return e=t,(n=[{key:"Reset",value:function(){this.mtv.SetSame(0),this.cp.SetSame(0),this.sOrE=0,this.occured=!1}}])&&Ft(e.prototype,n),r&&Ft(e,r),t}(),Xt=function(t,e,n){var r=e.shape,i=t.shape,o=e.relative,a=t.relative;Yt.Set(r.s.x+o.x,r.s.y+o.y),Wt.Set(r.e.x+o.x,r.e.y+o.y);var s=Object(Nt.ClosestPoint2DOnLine2D)(Yt,Wt,a);qt.Set(a.x-s.x,a.y-s.y);var u=qt.GetMagnitudeSquared();if(u<i.radiusSquared){if(n){var l=i.radius-Ut(u);qt.Normalize().Multiply(l,l),n.mtv.SetV(qt),n.cp.SetV(s),n.occured=!0,s===Yt?n.sOrE=1:s===Wt&&(n.sOrE=-1)}return!0}return!1},Ht=function(t,e,n){var r,i,o=e.shape,a=t.velocity,s=t.relative,u=n.cp;0!==n.sOrE?(r=u.SubtractVC(s)).Normalize():r=o.GetNormalA(),i=a.GetReflectionV(r),a.SetV(i),s.AddV(n.mtv)},Yt=new ut.a(0,0),Wt=new ut.a(0,0),qt=new ut.a(0,0);function zt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Kt=Math.abs,Jt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new ut.a(0,0),this.olAxis=new ut.a(0,0),this.mtd=1/0,this.occured=!1}var e,n,r;return e=t,(n=[{key:"Reset",value:function(){this.occured=!1,this.mtv.Set(0,0),this.mtd=1/0,this.olAxis.Set(0,0)}}])&&zt(e.prototype,n),r&&zt(e,r),t}(),Qt=function(t,e,n){for(var r=0,i=t.shape,o=e.shape,a=i.normals,s=o.normals,u=a.length,l=s.length;r<u;++r)if(!0===$t(t,e,a[r],n))return!1;for(r=0;r<l;++r)if(!0===$t(t,e,s[r],n))return!1;return null!=n&&(n.mtv.SetV(n.olAxis),n.mtv.Multiply(n.mtd,n.mtd),n.occured=!0),!0},$t=function(t,e,n,r){var i=n.GetMinMaxDot(t.shape.vertices),o=n.GetMinMaxDot(e.shape.vertices),a=e.relative.SubtractVC(t.relative).GetDotV(n);if(o.Add(a,a),i.x>o.y||o.x>i.y)return!0;if(null!=r){var s=0,u=0,l=0,c=i.x,h=i.y,f=o.x,d=o.y;s=c<f?h<d?h-f:(u=h-f)<(l=d-c)?u:-l:h>d?c-d:(u=h-f)<(l=d-c)?u:-l;var p=Kt(s);p<r.mtd&&(r.mtd=p,r.olAxis.SetV(n),s<0&&r.olAxis.Invert())}return!1},Zt=Math.PI,te=Math.cos,ee=Math.sin,ne=Math.abs,re=Math.pow,ie=Math.exp,oe=function(t,e,n,r,i){var o=new ut.a(e,n),a=new ut.a(e+r,n),s=new ut.a(e+r,n+i),u=new ut.a(e,n+i);return t.Recreate([o,a,s,u]),t.ComputeBounds(),t.GetNormalsA(),t},ae=function(t,e,n,r,i){var o=new ut.a(e,n),a=new ut.a(e+.5*r,n+i),s=new ut.a(e-.5*r,n+i);return t.Recreate([o,a,s]),t.ComputeBounds(),t.GetNormalsA(),t},se=function(t,e,n,r,i){var o,a,s,u=0,l=i,c=2*Zt/l;for(t.Recreate([]);u<l;++u)o=te(s=c*u)*r,a=ee(s)*r,t.AddVertex(new ut.a(e+o,n+a));return t.ComputeBounds(),t.GetNormalsA(),t},ue=function(t,e,n,r){var i,o,a=2.0943951023931953;return t.Recreate([]),i=r,o=0,t.AddVertex(new ut.a(e+i,n+o)),i=te(a)*r,o=ee(a)*r,t.AddVertex(new ut.a(e+i,n+o)),i=te(2*a)*r,o=ee(2*a)*r,t.AddVertex(new ut.a(e+i,n+o)),t.Rotate(-90*new Math.RADIAN),t.ComputeBounds(),t.GetNormalsA(),t},le=function(t,e,n,r,i,o){var a,s,u,l,c=0,h=2*o,f=2*Math.PI/h;for(t.Recreate([]);c<h;++c)l=0==(1&c)?r:i,u=f*c,a=Math.cos(u)*l,s=Math.sin(u)*l,t.AddVertex(new ut.a(e+a,n+s));return t.ComputeBounds(),t.GetNormalsA(),t},ce=function t(e,n,r,i,o){var a,s,u,l=0,c=t.C;for(e.Recreate([]);l<i;++l)u=l*c._1*Zt/i,a=te(u)*(ie(te(u))-c._2*te(c._3*u)-re(ee(u/c._4),c._5))*o,s=ee(u)*(ie(te(u))-c._2*te(c._3*u)-re(ee(u/c._4),c._5))*o,e.AddVertex(new ut.a(n+a,r+s));return e.ComputeBounds(),e.GetNormalsA(),e};ce.C={_1:24,_2:2,_3:4,_4:12,_5:5};var he=function(t,e,n,r,i,o,a){var s,u,l,c,h=0,f=o,d=2*Zt/f*a;for(t.Recreate([]);h<f;++h)c=te(i*(l=d*h))*r,s=te(l)*c,u=ee(l)*c,t.AddVertex(new ut.a(e+s,n+u));return t.ComputeBounds(),t.GetNormalsA(),t},fe=function t(e,n,r,i,o,a,s,u,l){var c,h,f,d,p,y,v=0,m=o,b=t.C;for(s=null==s?1:s,u=null==u?1:u,l=null==l?1:l,e.Recreate([]);v<m;++v)p=te(a*(f=v*Zt*2/o)/4)/b._A,p=ne(p),p=re(p,u),y=ee(a*f/4)/b._B,y=ne(y),y=re(y,l),d=re(p+y,1/s),0===ne(d)?(c=0,h=0):(d=1/d,c=te(f)*d*i,h=ee(f)*d*i),e.AddVertex(new ut.a(n+c,r+h));return e.ComputeBounds(),e.GetNormalsA(),e};function de(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}fe.C={_A:1,_B:1};var pe=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tl=new ut.a(e,n),this.br=new ut.a(r,i),this.w=0,this.h=0,this.hw=0,this.hh=0,this.area=0,this.belongsTo=null,this.TYPE=ge,this.ComputeWH()}var e,n,r;return e=t,r=[{key:"TYPE",get:function(){return ge}}],(n=[{key:"Set",value:function(t,e,n,r){return this.tl.Set(t,e),this.br.Set(n,r),this.ComputeWH()}},{key:"SetC",value:function(t){return this.Set(t.tl.x,t.tl.y,t.br.x,t.br.y),this}},{key:"SetXYWH",value:function(t,e,n,r){return this.Set(t,e,t+n,e+r)}},{key:"Scale",value:function(t,e,n){return!1!==n&&this.tl.Multiply(t,e),this.br.Multiply(t,e),this.ComputeWH()}},{key:"ScaleV",value:function(t,e){return!1!==e&&this.tl.MultiplyV(t),this.br.MultiplyV(t),this.ComputeWH()}},{key:"ComputeWH",value:function(){return this.w=this.br.x-this.tl.x,this.h=this.br.y-this.tl.y,this.hw=.5*this.w,this.hh=.5*this.h,this.area=this.w*this.h,this}},{key:"IntersectsPoint2D",value:function(t){return!(t.x<this.tl.x||t.x>this.br.x||t.y<this.tl.y||t.y>this.br.y)}},{key:"ContainsPoint",value:function(t){return!(t.x<=this.tl.x||t.x>=this.br.x||t.y<=this.tl.y||t.y>=this.br.y)}},{key:"IntersectsAABB2D",value:function(t){return!(t.tl.x>=this.br.x||t.tl.y>=this.br.y||t.br.x<=this.tl.x||t.br.y<=this.tl.y)}},{key:"ContainsAABB2D",value:function(t){return!(t.area>this.area)&&(t.tl.x>this.tl.x&&t.tl.y>this.tl.y&&t.br.x<this.br.x&&t.br.y<this.br.y)}},{key:"GetQuadrant",value:function(e){var n=this.tl,r=this.br;switch(e){case ye:return new t(n.x,n.y,n.x+this.hw,n.y+this.hh);case ve:return new t(n.x+this.hw,n.y,r.x,n.y+this.hh);case me:return new t(n.x,n.y+this.hh,n.x+this.hw,r.y);case be:return new t(n.x+this.hw,n.y+this.hh,r.x,r.y);default:return null}}}])&&de(e.prototype,n),r&&de(e,r),t}(),ye="TL",ve="TR",me="BL",be="BR",ge=1;function we(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ae=Math.PI,Se=Math.sin,Ce=Math.cos,Te=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.center=new ut.a(e,n),this.diameter=0,this.w=0,this.h=0,this.radiusSquared=0,this.radiusUnsquared=0,this.area=0,this.radius=r,this.belongsTo=null,this.TYPE=xe}var e,n,r;return e=t,r=[{key:"TYPE",get:function(){return xe}}],(n=[{key:"Set",value:function(t,e,n){this.center.Set(t,e),this.radius=n}},{key:"SetC",value:function(t){this.center.SetV(t),this.radius=t.radius}},{key:"Scale",value:function(t){this.radius*=t}},{key:"IntersectsCircle",value:function(t){var e=this.radius+t.radius;return e*e>=this.center.GetDistanceSquaredV(t.center)}},{key:"ContainsCircle",value:function(t){return this.radius-t.radius>this.center.GetDistanceV(t.center)}},{key:"IntersectsPoint2D",value:function(t){return this.radiusSquared>=this.center.GetDistanceSquaredV(t)}},{key:"GenerateRandomPoints",value:function(t,e,n){var r=j.RandomFloat,i=new ut.a(this.x-this.radius,this.y-this.radius),o=new ut.a(this.x+this.radius,this.y+this.radius),a=[];n=!!n,!0===e&&(r=j.RandomInteger);for(var s=0;s<t;++s){for(var u=new ut.a(r(i.x,o.x),r(i.y,o.y));this.IntersectsPoint2D(u)===n;)u.Set(r(i.x,o.x),r(i.y,o.y));a.push(u)}return a}},{key:"GeneratePerimeterPoints",value:function(t,e){var n=[];t*=e;for(var r=0;r<t;r+=e)n.push(new ut.a(this.x+Ce(Object(B.DegreesToRadians)(r))*this.radius,this.y+Se(Object(B.DegreesToRadians)(r))*this.radius));return n}},{key:"x",get:function(){return this.center.x},set:function(t){this.center.x=t}},{key:"y",get:function(){return this.center.y},set:function(t){this.center.y=t}},{key:"radius",get:function(){return this.radiusUnsquared},set:function(t){this.radiusUnsquared=t,this.radiusSquared=t*t,this.diameter=this.w=this.h=2*t,this.area=Ae*t*t}}])&&we(e.prototype,n),r&&we(e,r),t}(),xe=2;function Ee(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Pe=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.s=new ut.a(e,n),this.e=new ut.a(r,i),this.epsilon=1e3,this.belongsTo=null,this.TYPE=_e}var e,n,r;return e=t,(n=[{key:"Set",value:function(t,e,n,r){this.s.Set(t,e),this.e.Set(n,r)}},{key:"SetC",value:function(t){this.s.SetV(t.s),this.e.SetV(t.e)}},{key:"Stretch",value:function(t){var e=.5*t;this.s.PushFromV(this.e,e),this.e.PushFromV(this.s,e)}},{key:"Rotate",value:function(t,e,n){e=null==e?.5:e;var r=this.s.Copy();r.AddV(this.e),r.Multiply(e,null==n?e:n),this.s.RotateAroundV(r,t),this.e.RotateAroundV(r,t)}},{key:"Cut",value:function(t,e){null==e&&(e=[]);for(var n=0;n<t.length;++n)e.push(this.s.GetWeightedAverageV(this.e,t[n]));return e}},{key:"GetLength",value:function(){return this.s.GetDistanceV(this.e)}},{key:"GetLengthSquared",value:function(){return this.s.GetDistanceSquaredV(this.e)}},{key:"IntersectsPoint2D",value:function(t){var e=this.s,n=this.e,r=(t.y-e.y)*(n.x-e.x)-(t.x-e.x)*(n.y-e.y);if(Math.abs(r)>this.epsilon)return!1;var i=(t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y);return!(i<0)&&!(i>this.GetLengthSquared())}},{key:"IntersectsLine2D",value:function(t){return Object(Nt.Line2DLine2DIntersection)(this.s,this.e,t.s,t.e)}},{key:"GetClosestPoint2DTo",value:function(t){return Object(Nt.ClosestPoint2DOnLine2D)(this.s,this.e,t)}},{key:"GetNormalA",value:function(){return this.s.GetNormalAV(this.e)}},{key:"GetNormalB",value:function(){return this.s.GetNormalBV(this.e)}}])&&Ee(e.prototype,n),r&&Ee(e,r),t}(),_e=0;function Oe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Re=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertices=[],this.normals=[],this.perimeterMidPoints=[],this.centroid=new ut.a(0,0),this.aabb=null,this.dirtyBounds=!0,this.belongsTo=null,this.TYPE=De,null!=e&&this.AddVertices(e)}var e,n,r;return e=t,(n=[{key:"Copy",value:function(){for(var e=new t,n=this.vertices,r=0;r<n.length;++r)e.AddVertex(n[r].Copy());return e}},{key:"ExtractSegments",value:function(t){var e=this.vertices,n=e.length-1;null==t&&(t=[]);for(var r=0;r<n;++r)t.push(new Pe(e[r],e[r+1]));return t.push(new Pe(e[n],e[0])),t}},{key:"GenerateRandomPoints",value:function(t,e,n){this.ComputeBounds(),n=!!n;var r=j.RandomFloat,i=this.aabb.tl,o=this.aabb.br,a=[];!0===e&&(r=j.RandomInteger);for(var s=0;s<t;++s){for(var u=new ut.a(r(i.x,o.x),r(i.y,o.y));this.IntersectsPoint2D(u)===n;)u.Set(r(i.x,o.x),r(i.y,o.y));a.push(u)}return a}},{key:"AddVertex",value:function(t){this.vertices.push(t)}},{key:"AddVertices",value:function(t){if(t[0]instanceof ut.a)this.vertices.push.apply(this.vertices,t);else if("number"==typeof t[0])for(var e=0;e<t.length;e+=2)this.AddVertex(new ut.a(t[e],t[e+1]));else if(null!=t[0].x)for(e=0;e<t.length;++e)this.AddVertex(new ut.a(t[e].x,t[e].y))}},{key:"Recreate",value:function(t){this.vertices.length=0,null!=t&&this.vertices.push.apply(this.vertices,t)}},{key:"ComputeBounds",value:function(){var t,e=1/0,n=-e,r=e,i=-e,o=this.vertices;null===this.aabb&&(this.aabb=new pe(0,0,0,0));for(var a=0;a<o.length;++a)(t=o[a]).x<e&&(e=t.x),t.x>n&&(n=t.x),t.y<r&&(r=t.y),t.y>i&&(i=t.y);this.aabb.Set(e,r,n,i),this.dirtyBounds=!1}},{key:"Rotate",value:function(t,e,n,r){var i=0,o=this.aabb,a=o.tl.Copy(),s=this.vertices,u=s.length;for(!0===this.dirtyBounds&&!0===r?this.ComputeBounds():null===this.aabb&&this.ComputeBounds(),e=void 0===e?.5:e,a.AddV(o.br),a.Multiply(e,void 0===n?e:n);i<u;++i)s[i].RotateAroundV(a,t);this.dirtyBounds=!0}},{key:"GetControid",value:function(){var t=this.vertices,e=this.centroid;e.Set(0,0);for(var n=0;n<t.length;++n)e.AddV(t[n]);return e.Divide(t.length,t.length),e}},{key:"GetNormalsA",value:function(){var t=this.vertices,e=t.length-1,n=this.normals;n.length=0;for(var r=0;r<e;++r)n.push(t[r].GetNormalAV(t[r+1]));return n.push(t[e].GetNormalAV(t[0])),n}},{key:"GetNormalsA",value:function(){var t=this.vertices,e=t.length-1,n=this.normals;n.length=0;for(var r=0;r<e;++r)n.push(t[r].GetNormalBV(t[r+1]));return n.push(t[e].GetNormalBV(t[0])),n}},{key:"GetPerimeterMidPoints",value:function(){var t=this.vertices,e=t.length-1,n=this.perimeterMidPoints;n.length=0;for(var r=0;r<e;++r)n.push(t[r].GetMidPointV(t[r+1]));return n.push(t[e].GetMidPointV(t[0])),n}},{key:"IntersectsPoint2D",value:function(t){if(!0===this.dirtyBounds&&this.ComputeBounds(),!1===this.aabb.IntersectsPoint2D(t))return!1;for(var e,n,r=!1,i=this.vertices,o=t.x,a=t.y,s=0,u=i.length-1;s<i.length;u=s++)e=i[s],n=i[u],e.y>a!=n.y>a&&o<(n.x-e.x)*(a-e.y)/(n.y-e.y)+e.x&&(r=!r);return r}}])&&Oe(e.prototype,n),r&&Oe(e,r),t}(),De=3,ke="source-over",Ie="source-over",Le="source-in",je="source-out",Be="source-atop",Ge="destination-over",Ve="destination-in",Ne="destination-out",Fe="destination-atop",Ue="lighter",Me="copy",Xe="xor",He="multiply",Ye="overlay",We="darken",qe="lighten",ze="color-dodge",Ke="color-burn",Je="hard-light",Qe="soft-light",$e="difference",Ze="exclusion",tn="hue",en="saturation",nn="color",rn="luminosity",on="round",an="butt",sn="square",un="bevel",ln="round",cn="miter",hn="start",fn="end",dn="center",pn="left",yn="right",vn="alphabetic",mn="top",bn="hanging",gn="middle",wn="ideographic",An="bottom";function Sn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Cn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#36802d",this.applied=!0,Object(j.ApplyProperties)(this,e)}var e,n,r;return e=t,(n=[{key:"Apply",value:function(t){t.fillStyle=this.color}}])&&Sn(e.prototype,n),r&&Sn(e,r),t}();function Tn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#c9df8a",this.lineCap=on,this.lineJoin=ln,this.lineWidth=2,this.miterLimit=10,this.applied=!0,Object(j.ApplyProperties)(this,e)}var e,n,r;return e=t,(n=[{key:"Apply",value:function(t){t.strokeStyle=this.color,t.lineCap=this.lineCap,t.lineJoin=this.lineJoin,t.lineWidth=this.lineWidth,t.miterLimit=this.miterLimit}}])&&Tn(e.prototype,n),r&&Tn(e,r),t}();function En(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Pn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#234d20",this.blur=5,this.offsetX=0,this.offsetY=0,this.applied=!1,Object(j.ApplyProperties)(this,e)}var e,n,r;return e=t,(n=[{key:"Apply",value:function(t){t.shadowColor=this.color,t.shadowBlur=this.blur,t.shadowOffsetX=this.offsetX,t.shadowOffsetY=this.offsetY}}])&&En(e.prototype,n),r&&En(e,r),t}();function _n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var On=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fillColor="#36802d",this.strokeColor="#36802d",this.fontSize=45,this.font=null,this.fontFamily="Arial",this.align=pn,this.baseline=mn,this.lineWidth=.5,this.applied=!0,Object(j.ApplyProperties)(this,e),this.ConcatFont()}var e,n,r;return e=t,(n=[{key:"Apply",value:function(t){t.fillStyle=this.fillColor,t.strokeStyle=this.strokeColor,t.font=this.font,t.textAlign=this.align,t.textBaseline=this.baseline,t.lineWidth=this.lineWidth}},{key:"ConcatFont",value:function(){this.font=this.fontSize+"px "+this.fontFamily}}])&&_n(e.prototype,n),r&&_n(e,r),t}();var Rn=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#c9df8a",this.size=1,Object(j.ApplyProperties)(this,e)},Dn=function(t){return{fill:new Cn(t?t.fill:null),stroke:new xn(t?t.stroke:null),shadow:new Pn(t?t.shadow:null),text:new On(t?t.text:null),pixel:new Rn(t?t.pixel:null)}},kn=function(t){return{fill:new Cn(t?t.fill:null),stroke:new xn(t?t.stroke:null),shadow:new Pn(t?t.shadow:null)}},In=function(t){return{stroke:new xn(t?t.stroke:null),shadow:new Pn(t?t.shadow:null)}},Ln=function(t){return{fill:new Cn(t?t.fill:null),shadow:new Pn(t?t.shadow:null)}},jn=function(t){return{shadow:new Pn(t?t.shadow:null),text:new On(t?t.text:null)}},Bn=function(t){return{pixel:new Rn(t?t.pixel:null)}};function Gn(t){return(Gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Nn(t,e){return!e||"object"!==Gn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fn(t){return(Fn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Un(t,e){return(Un=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mn=function(t){function e(t,n,r,i,o){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=Nn(this,Fn(e).call(this,t,n,r,i))).programController=null,a.style=kn(o),a}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Un(t,e)}(e,pe),n=e,(r=[{key:"Render",value:function(t){var e=this.tl,n=this.br,r=this.style;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(n.x,e.y),t.lineTo(n.x,n.y),t.lineTo(e.x,n.y),t.closePath(),!0===r.shadow.applied&&r.shadow.Apply(t),!0===r.fill.applied&&(r.fill.Apply(t),t.fill()),!0===r.stroke.applied&&(r.stroke.Apply(t),t.stroke())}},{key:"GLRender",value:function(t,e){null!==this.programController&&this.programController.Execute(e.globalTransform.AsArray(!0),this.tl.x,this.tl.y,this.w,this.h)}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.fillColor&&null!==t.outlineColor&&null!==t.outline&&(t.fillColor.SetHex(this.style.fill.color),t.fillColor.Normalize(),t.outlineColor.SetHex(this.style.stroke.color),t.outlineColor.Normalize(),t.outline=this.style.stroke.lineWidth+.2),this}}])&&Vn(n.prototype,r),i&&Vn(n,i),e}();function Xn(t){return(Xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yn(t,e){return!e||"object"!==Xn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wn(t){return(Wn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qn(t,e){return(qn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zn=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Yn(this,Wn(e).call(this,t,n,r))).programController=null,o.style=kn(i),o}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qn(t,e)}(e,Te),n=e,(r=[{key:"Render",value:function(t){var e=this.style;t.beginPath(),t.arc(this.x,this.y,this.radius,0,B.PII,!1),t.closePath(),!0===e.shadow.applied&&e.shadow.Apply(t),!0===e.fill.applied&&(e.fill.Apply(t),t.fill()),!0===e.stroke.applied&&(e.stroke.Apply(t),t.stroke())}},{key:"GLRender",value:function(t,e){null!==this.programController&&this.programController.Execute(e.globalTransform.AsArray(!0),this.x,this.y,this.radius)}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.fillColor&&null!==t.outlineColor&&null!==t.outline&&(t.fillColor.SetHex(this.style.fill.color),t.fillColor.Normalize(),t.outlineColor.SetHex(this.style.stroke.color),t.outlineColor.Normalize(),t.outline=this.style.stroke.lineWidth+.2),this}}])&&Hn(n.prototype,r),i&&Hn(n,i),e}();function Kn(t){return(Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qn(t,e){return!e||"object"!==Kn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $n(t){return($n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zn(t,e){return(Zn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var tr=function(t){function e(t,n,r,i,o){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=Qn(this,$n(e).call(this,t,n,r,i))).programController=null,a.style=In(o),a}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zn(t,e)}(e,Pe),n=e,(r=[{key:"Render",value:function(t){var e=this.s,n=this.e,r=this.style;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(n.x,n.y),t.closePath(),!0===r.shadow.applied&&r.shadow.Apply(t),!0===r.stroke.applied&&(r.stroke.Apply(t),t.stroke())}},{key:"GLRender",value:function(t,e){null!==this.programController&&this.programController.Execute(e.globalTransform.AsArray(!0),this.s,this.e)}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.color&&(t.color.SetHex(this.style.stroke.color),t.color.Normalize()),this}}])&&Jn(n.prototype,r),i&&Jn(n,i),e}();function er(t){return(er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rr(t,e){return!e||"object"!==er(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ir(t){return(ir=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function or(t,e){return(or=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ar=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=rr(this,ir(e).call(this,t))).programController=null,r.style=kn(n),r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&or(t,e)}(e,Re),n=e,(r=[{key:"Render",value:function(t){var e=this.vertices,n=this.style;t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var r=1;r<e.length;++r)t.lineTo(e[r].x,e[r].y);t.closePath(),!0===n.shadow.applied&&n.shadow.Apply(t),!0===n.fill.applied&&(n.fill.Apply(t),t.fill()),!0===n.stroke.applied&&(n.stroke.Apply(t),t.stroke())}}])&&nr(n.prototype,r),i&&nr(n,i),e}();function sr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ur=Math.max,lr=Math.min,cr=Math.round,hr=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.channel=new Float32Array([null==e?0:e,null==n?0:n,null==r?0:r,null==i?1:i]),this.value="",this.currentConversion="rgb",this.ComputeValueRGBA()}var e,n,r;return e=t,(n=[{key:"Copy",value:function(){var e=new t(this.channel[0],this.channel[1],this.channel[2],this.channel[3]);return e.value=this.value,e.currentConversion=this.currentConversion,e}},{key:"ComputeValueRGBA",value:function(){return this.value="rgba(".concat(this.channel.join(",").concat(")")),this.value}},{key:"ComputeValueHSLA",value:function(){return this.value="hsla("+this.channel[0]+","+this.channel[1]+"%,"+this.channel[2]+"%,"+this.channel[3]+")",this.value}},{key:"ComputeValueHex",value:function(){return this.value="#"+this.channel[0].toString(16)+this.channel[1].toString(16)+this.channel[2].toString(16),this.value}},{key:"ConvertToHSLA",value:function(t){var e=0,n=0,r=this.channel[0]/fr,i=this.channel[1]/fr,o=this.channel[2]/fr,a=ur(r,i,o),s=lr(r,i,o),u=a-s,l=.5*(a+s);a!==s&&(n=l>.5?u/(2-a-s):u/(a+s),e=a===r?(i-o)/u+(i<o?6:0):a===i?(o-r)/u+2:(r-i)/u+4,e/=6),this.channel[0]=360*e,this.channel[1]=100*n,this.channel[2]=100*l,!0===t&&(this.channel[0]=cr(this.channel[0]),this.channel[1]=cr(this.channel[1]),this.channel[2]=cr(this.channel[2])),this.currentConversion="hsl",this.ComputeValueHSLA()}},{key:"SetRGB",value:function(t,e,n,r){this.channel[0]=Object(j.Clamp)(t,dr,fr),this.channel[1]=Object(j.Clamp)(e,dr,fr),this.channel[2]=Object(j.Clamp)(n,dr,fr),this.currentConversion="rgb",r||this.ComputeValueRGBA()}},{key:"SetRGBA",value:function(t,e,n,r){this.SetRGB(t,e,n,!0),this.channel[3]=Object(j.Clamp)(r,0,1),this.ComputeValueRGBA()}},{key:"SetHex",value:function(t){var e=(t=t.replace(/#/g,"")).match(/.{2}/g);null==(e=e.map(j.Base16ToBase10))[3]&&(e[3]=1),this.SetRGBA(e[0],e[1],e[2],e[3])}},{key:"IncreaseChannel",value:function(t,e){this.channel[t]+=e,"rgb"===this.currentConversion?this.ComputeValueRGBA():"hsl"===this.currentConversion&&this.ComputeValueHSLA()}},{key:"SetChannel",value:function(t,e){this.channel[t]=e,"rgb"===this.currentConversion?this.ComputeValueRGBA():"hsl"===this.currentConversion&&this.ComputeValueHSLA()}},{key:"Normalize",value:function(){this.channel[0]=pr*this.channel[0],this.channel[1]=pr*this.channel[1],this.channel[2]=pr*this.channel[2]}},{key:"r",get:function(){return this.channel[0]},set:function(t){this.channel[0]=t}},{key:"g",get:function(){return this.channel[1]},set:function(t){this.channel[1]=t}},{key:"b",get:function(){return this.channel[2]},set:function(t){this.channel[2]=t}},{key:"a",get:function(){return this.channel[3]},set:function(t){this.channel[3]=t}}])&&sr(e.prototype,n),r&&sr(e,r),t}(),fr=255,dr=0,pr=1/fr;function yr(t){return(yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mr(t,e){return!e||"object"!==yr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function br(t){return(br=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gr(t,e){return(gr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wr=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=mr(this,br(e).call(this,t,n))).style=Bn(r),i.color=new hr,i.programController=null,i.bufferData=null,i}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gr(t,e)}(e,ut["a"]),n=e,(r=[{key:"GLRender",value:function(t,e){null!==this.programController&&this.programController.Execute(e.worldTransform.AsArray(!0),this.x,this.y)}},{key:"LinkProgramController",value:function(t){this.programController=t,this.LinkStyle()}},{key:"UseProgramController",value:function(t){this.programController=t}},{key:"LinkStyle",value:function(){var t=this.programController;null!==t&&null!==t.color&&(t.color.SetHex(this.style.pixel.color),t.color.Normalize())}},{key:"GetBufferData",value:function(){null==this.bufferData&&(this.bufferData=[]);var t=this.bufferData,e=this.color;return t[0]=this.x,t[1]=this.y,t[2]=e.r,t[3]=e.g,t[4]=e.b,t[5]=e.a,t[6]=this.style.pixel.size,t}},{key:"UpdateInBuffer",value:function(t,e){var n=this.color;t[e]=this.x,t[e+1]=this.y,t[e+2]=n.r,t[e+3]=n.g,t[e+4]=n.b,t[e+5]=n.a,t[e+6]=this.style.pixel.size}}])&&vr(n.prototype,r),i&&vr(n,i),e}();function Ar(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Sr=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=n,this.holderContext=e,this.handle=r,this.removeOnNextCall=i}var e,n,r;return e=t,(n=[{key:"Execute",value:function(){this.handle.apply(this.context,arguments),!0===this.removeOnNextCall&&this.Remove()}},{key:"Remove",value:function(){this.holderContext.Remove(this.handle,this.context)}}])&&Ar(e.prototype,n),r&&Ar(e,r),t}();function Cr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Tr=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.listeners=[],this.stopPropagation=!1,this.target=null,this.data=null}var e,n,r;return e=t,(n=[{key:"GetListenerIndex",value:function(t,e){var n,r=this.listeners;if(0===r.length)return-1;for(var i=0;i<r.length;++i)if((n=r[i]).context===e&&n.handle===t)return i;return-1}},{key:"Add",value:function(t,e,n){var r=new Sr(this,e,t,n);this.listeners.push(r)}},{key:"Remove",value:function(t,e){var n=this.GetListenerIndex(t,e);-1!==n&&this.listeners.fickleSplice(n)}},{key:"Dump",value:function(t){var e=this.listeners;if(void 0!==t)for(var n=0;n<e.length;++n)e[n].context===t&&e.splice(n);else e.length=0}},{key:"Dispatch",value:function(t,e){var n=this.listeners.slice();if(0!==n.length){this.stopPropagation=!1,this.target=t,this.data=e;for(var r=0;r<n.length&&(n[r].Execute(this),!0!==this.stopPropagation);++r);this.target=null,this.data=null}}}])&&Cr(e.prototype,n),r&&Cr(e,r),t}();function xr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Er=Math.round,Pr=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.stopTime=Er(null==e?0:e),this.time=0,this.isRunning=!1,this.canResume=!1,this.count=0,this.onStop=new Tr,this.onFinish=new Tr,this.onStart=new Tr,this.onReset=new Tr,this.onPause=new Tr,this.onResume=new Tr}var e,n,r;return e=t,(n=[{key:"Reset",value:function(){this.onReset.Dispatch(this,null),this.count=0,this.time=0,this.isRunning=!1,this.canResume=!1}},{key:"Start",value:function(t){this.stopTime=Er(null==t?this.stopTime:t),this.stopTime>0&&(this.time=0,this.isRunning=!0,this.canResume=!1,this.onStart.Dispatch(this,{stopTime:this.stopTime}))}},{key:"Stop",value:function(){!0===this.isRunning&&(this.isRunning=!1,this.onStop.Dispatch(this,null))}},{key:"Pause",value:function(){!0===this.isRunning&&!1===this.canResume&&(this.isRunning=!1,this.canResume=!0,this.onPause.Dispatch(this,null))}},{key:"Resume",value:function(){!0===this.canResume&&(this.isRunning=!0,this.canResume=!1,this.onResume.Dispatch(this,null))}},{key:"Process",value:function(){this.time<this.stopTime&&!0===this.isRunning&&++this.time>=this.stopTime&&(this.isRunning=!1,this.count++,this.onFinish.Dispatch(this,null))}}])&&xr(e.prototype,n),r&&xr(e,r),t}();function _r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Or=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.SetDesiredRate(n),this.onProcess=e,this.intervalId=null,this.afId=null,this.delta=0,this.then=0,this.now=0,this.desiredRate=0,this.supplyDelta=!0,r||this.StartAF()}var e,n,r;return e=t,r=[{key:"LOG",get:function(){return Rr},set:function(t){(function(t){throw new Error('"'+t+'" is read-only')})("PS_LOG"),Rr=!!t}}],(n=[{key:"Process",value:function(){this.onProcess(this.ComputeDelta())}},{key:"ProcessAF",value:function(){this.onProcess(this.ComputeDelta()),null!==this.afId&&(this.afId=requestAnimationFrame(this.ProcessAF))}},{key:"ComputeDelta",value:function(){return this.now=Date.now(),this.delta=this.now-this.then,this.then=this.now,this.delta}},{key:"GetTPS",value:function(){return Object(B.PrecisionRound)(1/this.delta*1e3,2)}},{key:"SetDesiredRate",value:function(t){this.desiredRate=void 0===t?16.66:1e3/t}},{key:"Start",value:function(t){if(null!==this.afId)return kr("%cTicker: RAF is running!","color:red;".concat(Dr)),null;null!==this.intervalId?!0===t?(this.Stop(),this.intervalId=setInterval(this.Process.bind(this),this.desiredRate),kr("%cTicker: Starting interval!","color:#0F0;".concat(Dr))):kr("%cTicker: Interval already running!","color:#F00;".concat(Dr)):(this.intervalId=setInterval(this.Process.bind(this),this.desiredRate),kr("%cTicker: Starting interval!","color:#0F0;".concat(Dr)))}},{key:"StartAF",value:function(t){if(null!==this.intervalId)return kr("%cTicker: Interval is running!","color:#F00;".concat(Dr)),null;null!==this.afId?!0===t?(this.Stop(),this.ProcessAF=this.ProcessAF.bind(this),this.afId=requestAnimationFrame(this.ProcessAF),kr("%cTicker: Starting RAF!","color:#0F0;".concat(Dr))):kr("%cTicker: RAF already running!","color:#F00;".concat(Dr)):(this.ProcessAF=this.ProcessAF.bind(this),this.afId=requestAnimationFrame(this.ProcessAF),kr("%cTicker: Starting RAF!","color:#0F0;".concat(Dr)))}},{key:"Stop",value:function(){null!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null,kr("%cTicker: Stopping interval!","color:cyan;".concat(Dr))),null!==this.afId&&(cancelAnimationFrame(this.afId),this.afId=null,kr("%cTicker: Stopping RAF!","color:cyan;".concat(Dr)))}}])&&_r(e.prototype,n),r&&_r(e,r),t}(),Rr=!0,Dr="background-color:#36802d;font-family:Arial;font-size:18px;font-weight:900;padding:5px;",kr=function(){!1!==Rr&&console.log.apply(null,arguments)},Ir=n(11),Lr=n.n(Ir),jr=n(12),Br=n.n(jr),Gr=n(13),Vr=n.n(Gr),Nr=n(14),Fr=n.n(Nr),Ur=n(15),Mr=n.n(Ur),Xr=n(16),Hr=n.n(Xr),Yr=n(17),Wr=n.n(Yr),qr=n(18),zr=n.n(qr),Kr=n(19),Jr=n.n(Kr),Qr=n(20),$r=n.n(Qr),Zr=n(21),ti=n.n(Zr),ei=function(t){return t.replace(/\/\*[\s\S]*?\*\//g,"").replace(/[\r\t]/g," ").replace(/[ ]{2,}/g," ").replace(/[\n ]{2,}/g,"\n").replace(/\/\/.*/g,"").replace(/\s*(\=|\+|\-|\*|\/|\<|\>|\(|\)|\{|\}|\,|\:|\;|\?)\s*/g,"$1").trim()},ni=function(t){var e,n,r,i,o=t.match(/\((import .[\s\S]*?)\/\)/);if(null==o)return null;if((e=o[1].match(/\[([\s\S]*?)\]/))&&(o[1]=o[1].replace(e[0],""),e=JSON.parse(e[1])),r=o[1].match(/\'(.[\s\S]*?)\'/)[1],i=ri[r],null!=e){if(null!=e.replace)for(n in e.replace)i=i.replace(new RegExp(n,"g"),e.replace[n]);if(null!=e.set)for(n in e.set){var a=i.match(new RegExp("("+n+"\\s*=\\s*.*?;)",""));if(a){var s=a[1].match(/=([\s\S]*?);/);s[1]=a[1].replace(s[1],e.set[n]),i=i.replace(a[1],s[1])}}}return{imp:o,snippet:i}},ri={PI:ei(n(27)),RADIAN:ei(n(28)),RSEEDS:ei(n(29)),VRSEEDS:ei(n(30)),mod289:ei(n(31)),permute:ei(n(32)),rotate2d:ei(n(33)),scale2d:ei(n(34)),plot:ei(n(35)),ridge:ei(n(36)),pixelate:ei(n(37)),random:ei(n(38)),vrandom:ei(n(39)),noise:ei(n(40)),gnoise:ei(n(41)),snoise:ei(n(42)),fbm:ei(n(43)),abs_fbm:ei(n(44)),rot_fbm:ei(n(45)),rmf:ei(n(46)),aabb:ei(n(47)),cruciform:ei(n(48)),circle:ei(n(49))},ii=function(t){var e,n,r="@vertex@",i="@fragment@";e=t.indexOf(r)+r.length,n=t.indexOf("@vertex-end@");var o=t.substring(e,n).replace(/\/\*[\s\S]*?\*\//g,"");e=t.indexOf(i)+i.length,n=t.indexOf("@fragment-end@");for(var a=t.substring(e,n).replace(/\/\*[\s\S]*?\*\//g,""),s=!0;!0===s;){s=!1;var u=ni(o);null!=u&&(o=o.replace(u.imp[0],u.snippet),s=!0);var l=ni(a);null!=l&&(a=a.replace(l.imp[0],l.snippet),s=!0)}return{vertex:ei(o),fragment:ei(a)}},oi=ii(Lr.a),ai=ii(Br.a),si=ii(Vr.a),ui=ii(Fr.a),li=ii(Mr.a),ci=ii(Hr.a),hi=ii(Wr.a),fi=ii(zr.a),di=ii(Jr.a),pi=ii($r.a),yi=ii(ti.a),vi=function(t){var e,n=[];for(n.push("precision mediump float;"),e=0;e<t;++e)n.push("attribute vec2 aPosition"+e+";","attribute vec2 aTexCoord"+e+";");for(n.push("uniform mat3 uProjection;","uniform mat3 uTranslation;","uniform mat3 uTransformation;","uniform int uUnitId;","varying vec2 vTexCoord;","void main () {","if ( uUnitId == 0 ) {","gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition0, 1.0 ) ).xy, 0.0, 1.0 );","vTexCoord = ( uTransformation * vec3( aTexCoord0, 1.0 ) ).xy;","}"),e=1;e<t;++e)n.push("else if ( uUnitId == "+e+" ) {","gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition"+e+", 1.0 ) ).xy, 0.0, 1.0 );","vTexCoord = ( uTransformation * vec3( aTexCoord"+e+", 1.0 ) ).xy;","}");return n.push("}"),{vertex:n.join(""),fragment:oi.fragment}},mi=n(5);function bi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var gi=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,this.items=[]}var e,n,r;return e=t,(n=[{key:"Store",value:function(t){var e=!1;return null==t?(console.warn("Item is null."),null):(null!=t.id&&""!==t.id?e=!this.Contains(t,t.id):t.data&&null!=t.data.id&&""!==t.data.id&&(e=!this.Contains(t,t.data.id)),!1===e?(console.warn("Invalid item. Check the item id. The item has not been stored"),!1):(this.items.push(t),!0))}},{key:"StoreSafe",value:function(t){return null!=this.type&&Object(mi.a)(t,mi.a.IS_INSTANCE_OF,this.type),Object(mi.a)(t,mi.a.IS_SAME_TYPE,wi),t.id?(Object(mi.a)(t.id,mi.a.IS_SAME_TYPE,Ai),Object(mi.a)(t.id,mi.a.IS_NOT,"")):(Object(mi.a)(t.data,mi.a.IS_SAME_TYPE,wi),Object(mi.a)(t.data.id,mi.a.IS_SAME_TYPE,Ai),Object(mi.a)(t.data.id,mi.a.IS_NOT,"")),this.Store(t)}},{key:"GetById",value:function(t){for(var e=this.items,n=e[0],r=0;r<e.length;n=e[++r])if(null!=n&&(n.id===t||null!=n.data&&n.data.id===t))return n;return null}},{key:"Contains",value:function(t,e){for(var n=this.items,r=n[0],i=0;i<n.length;r=n[++i])if(null!=r){if(r===t)return!0;if(r.id===e)return!0;if(null!=r.data&&r.data.id===e)return!0}return!1}}])&&bi(e.prototype,n),r&&bi(e,r),t}(),wi=Object.create(null),Ai="string";var Si=function t(e,n,r,i,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.image=e,this.id=null,this.w=0,this.h=0,this.fw=0,this.fh=0,this.uniformId=0,this.id=null!=n?n:e.id,this.w=null!=r?r:e.naturalWidth,this.h=null!=i?i:e.naturalHeight,this.fw=null!=o?o:e.naturalWidth,this.fh=null!=a?a:e.naturalHeight};function Ci(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ti=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.imageCache=new gi(Image),this.basicTextureCache=new gi(Si),this.onImageLoaded=new Tr,this.onComplete=new Tr,this.onError=new Tr,this.count=0,this.loading=!1,this.toLoad=null,this.createTextures=!1,null!=r&&this.onComplete.Add(r,this,!0),null!=e&&this.Load(e,n)}var e,n,r;return e=t,(n=[{key:"Load",value:function(t,e){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),null!=e&&(this.createTextures=e),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))}},{key:"Haul",value:function(t){var e=this.toLoad[t];if(null!=e){var n=new Image;n.onload=this.OnLoad.bind(this),n.onerror=this.OnError.bind(this),n.src=e.src,n.id=e.id,n.data=Object.create(null),n.data.w=e.w,n.data.h=e.h,n.data.fw=e.fw,n.data.fh=e.fh}else this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{imageCache:this.imageCache,basicTextureCache:this.basicTextureCache})}},{key:"OnLoad",value:function(t){var e=t.currentTarget;e.onload=null,e.onerror=null,this.imageCache.StoreSafe(e),!0===this.createTextures&&this.basicTextureCache.StoreSafe(new Si(e,null,e.data.w,e.data.h,e.data.fw,e.data.fh)),this.onImageLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count)}},{key:"OnError",value:function(t){this.onError.Dispatch(null,t)}},{key:"GetImageById",value:function(t){return this.imageCache.GetById(t)}},{key:"GetBasicTextureById",value:function(t){return this.basicTextureCache.GetById(t)}}])&&Ci(e.prototype,n),r&&Ci(e,r),t}();function xi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ei=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.XHRcache=new gi(XMLHttpRequest),this.dataCache=new gi,this.onXHRLoaded=new Tr,this.onComplete=new Tr,this.onNetworkError=new Tr,this.onLoadError=new Tr,this.count=0,this.loading=!1,this.toLoad=null,null!=n&&this.onComplete.Add(n,this,!0),null!=e&&this.Load(e)}var e,n,r;return e=t,(n=[{key:"Load",value:function(t){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))}},{key:"Haul",value:function(t){var e=this.toLoad[t];if(null!=e){var n=new XMLHttpRequest;switch(n.open("GET",e.src),e.type){case"json":n.onreadystatechange=this.OnLoadJSON.bind(this);break;default:n.onreadystatechange=this.OnLoadXML.bind(this)}n.onerror=this.OnNetworkError.bind(this),null!=n.data?n.data.id=e.id:n.data={id:e.id},n.send()}else this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{XHRcache:this.XHRcache,dataCache:this.dataCache})}},{key:"OnLoadXML",value:function(t){var e=t.currentTarget;200!==e.status&&null==e.responseText||4!==e.readyState?404!==e.status&&500!==e.status&&0!==e.status||this.onLoadError.Dispatch(e):(e.onload=null,e.onerror=null,this.XHRcache.StoreSafe(e),this.dataCache.Store({id:e.data.id,data:W(e.responseText,!0)}),this.onXHRLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count),e.abort())}},{key:"OnLoadJSON",value:function(t){var e=t.currentTarget;200!==e.status&&null==e.responseText||4!==e.readyState?404!==e.status&&500!==e.status&&0!==e.status||this.onLoadError.Dispatch(e):(e.onload=null,e.onerror=null,this.XHRcache.StoreSafe(e),this.dataCache.Store({id:e.data.id,data:JSON.parse(e.responseText)}),this.onXHRLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count),e.abort())}},{key:"OnNetworkError",value:function(t){this.onNetworkError.Dispatch(null,t)}},{key:"GetXHRById",value:function(t){return this.XHRcache.GetById(t)}},{key:"GetDataById",value:function(t){return this.dataCache.GetById(t).data}},{key:"GetClonedDataById",value:function(t){return Object(j.DeepClone)(this.GetDataById(t))}}])&&xi(e.prototype,n),r&&xi(e,r),t}();function Pi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _i=function(){function t(e,n,r,i,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rate=o,this.timer=o,this.x=e,this.y=n,this.w=r,this.h=i,this.nextFrameIndex=null,this.id=null,null!=a&&(this.id=a)}var e,n,r;return e=t,(n=[{key:"Process",value:function(){return this.timer--<=0&&(this.Reset(),!0)}},{key:"Apply",value:function(t){t.ClipReconfigure(this.x,this.y,this.w,this.h)}},{key:"FullApply",value:function(t){this.Apply(t),t.w=this.w,t.h=this.h,t.scale.SetSame(1)}},{key:"Reset",value:function(){this.timer=this.rate}}])&&Pi(e.prototype,n),r&&Pi(e,r),t}();function Oi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ri=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.id,this.basicTexture=e,this.data=n,this.frameCache=new gi(_i)}var e,n,r;return e=t,(n=[{key:"GenerateFrames",value:function(){for(var t,e,n,r=this.data,i=r.frames,o=r.meta.frameTags,a=0;a<i.length;++a)e=(t=i[a]).frame,n=o[a],this.frameCache.Store(new _i(e.x,e.y,e.w,e.h,t.duration,n?n.name:i[a].filename))}},{key:"GetFrameById",value:function(t){return this.frameCache.GetById(t)}}])&&Oi(e.prototype,n),r&&Oi(e,r),t}();function Di(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ki=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.spritesheetCache=new gi(Ri),this.xhrLoader=new Ei,this.imageLoader=new Ti,this.onComplete=new Tr,this.onSpritesheetLoaded=new Tr,this.count=0,this.loading=!1,this.toLoad=null,this.pairCount=0,this.tempBasicTexture=null,this.tempData=null,this.xhrLoader.onXHRLoaded.Add(this.OnPartXHRLoaded,this),this.imageLoader.onImageLoaded.Add(this.OnPartImageLoaded,this),null!=n&&this.onComplete.Add(n,this,!0),null!=e&&this.Load(e)}var e,n,r;return e=t,(n=[{key:"Load",value:function(t){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))}},{key:"Haul",value:function(t){var e=this.toLoad[t];null!=e?(e.data.id=e.image.id=e.id,this.xhrLoader.Load([e.data]),this.imageLoader.Load([e.image],!0)):(this.count=0,this.loading=!1,this.toLoad=null,this.tempBasicTexture=null,this.tempData=null,this.xhrLoader.onXHRLoaded.Dump(),this.imageLoader.onImageLoaded.Dump(),this.onComplete.Dispatch(this,{spritesheetCache:this.spritesheetCache}))}},{key:"OnPartLoaded",value:function(){if(2==++this.pairCount){var t=new Ri(this.tempBasicTexture,this.tempData);this.spritesheetCache.StoreSafe(t),this.pairCount=0,this.onSpritesheetLoaded.Dispatch(t,{count:this.count}),this.Haul(++this.count)}}},{key:"OnPartXHRLoaded",value:function(t){this.tempData=this.xhrLoader.GetDataById(t.target.data.id),this.OnPartLoaded()}},{key:"OnPartImageLoaded",value:function(t){this.tempBasicTexture=this.imageLoader.GetBasicTextureById(t.target.id),this.OnPartLoaded()}},{key:"GetSpritesheetById",value:function(t){return this.spritesheetCache.GetById(t)}}])&&Di(e.prototype,n),r&&Di(e,r),t}();var Ii=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.id,this.basicTexture=e,this.data=n};function Li(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ji=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tilesetCache=new gi(Ii),this.xhrLoader=new Ei,this.imageLoader=new Ti,this.onComplete=new Tr,this.onTilesetLoaded=new Tr,this.count=0,this.loading=!1,this.toLoad=null,this.pairCount=0,this.tempBasicTexture=null,this.tempData=null,this.xhrLoader.onXHRLoaded.Add(this.OnPartXHRLoaded,this),this.imageLoader.onImageLoaded.Add(this.OnPartImageLoaded,this),null!=n&&this.onComplete.Add(n,this,!0),null!=e&&this.Load(e)}var e,n,r;return e=t,(n=[{key:"Load",value:function(t){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))}},{key:"Haul",value:function(t){var e=this.toLoad[t];null!=e?(e.data.id=e.image.id=e.id,this.xhrLoader.Load([e.data]),this.imageLoader.Load([e.image],!0)):(this.count=0,this.loading=!1,this.toLoad=null,this.tempBasicTexture=null,this.tempData=null,this.xhrLoader.onXHRLoaded.Dump(),this.imageLoader.onImageLoaded.Dump(),this.onComplete.Dispatch(this,{tilesetCache:this.tilesetCache}))}},{key:"OnPartLoaded",value:function(){if(2==++this.pairCount){var t=new Ii(this.tempBasicTexture,this.tempData);this.tilesetCache.StoreSafe(t),this.pairCount=0,this.onTilesetLoaded.Dispatch(t,{count:this.count}),this.Haul(++this.count)}}},{key:"OnPartXHRLoaded",value:function(t){this.tempData=this.xhrLoader.GetDataById(t.target.data.id),this.OnPartLoaded()}},{key:"OnPartImageLoaded",value:function(t){this.tempBasicTexture=this.imageLoader.GetBasicTextureById(t.target.id),this.OnPartLoaded()}},{key:"GetTilesetById",value:function(t){return this.tilesetCache.GetById(t)}}])&&Li(e.prototype,n),r&&Li(e,r),t}();function Bi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Gi=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.loaders=e,this.count=0,this.onComplete=new Tr}var e,n,r;return e=t,(n=[{key:"Load",value:function(){for(var t=this.loaders,e=t[0],n=0;n<t.length;e=t[++n])e.loader.onComplete.Add(this.OnLoaderComplete,this,!0),e.loader.Load.apply(e.loader,e.args)}},{key:"OnLoaderComplete",value:function(){if(++this.count===this.loaders.length){for(var t=this.loaders,e=t[0],n=0;n<t.length;e=t[++n])t[n]=e.loader;this.onComplete.Dispatch()}}}])&&Bi(e.prototype,n),r&&Bi(e,r),t}();function Vi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ni=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.data={},this.program=null,this.attributes=null,this.uniforms=null,null!=e&&null!=n&&this.Init(n.vertex,n.fragment)}var e,n,r;return e=t,r=[{key:"LAST_USED_CONTROLLER",get:function(){return Fi},set:function(t){Fi=t}}],(n=[{key:"Init",value:function(t,e){var n=this.gl,r=this.CreateShader(t,n.VERTEX_SHADER),i=this.CreateShader(e,n.FRAGMENT_SHADER),o=this.program=n.createProgram();if(n.attachShader(o,r),n.attachShader(o,i),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS)){var a=n.getProgramInfoLog(o);throw new Error("Program link failed:"+a)}n.detachShader(o,r),n.detachShader(o,i),n.deleteShader(r),n.deleteShader(i),this.attributes={},this.uniforms={}}},{key:"CreateShader",value:function(t,e){var n=this.gl,r=n.createShader(e);if(n.shaderSource(r,t),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS)){var i=n.getShaderInfoLog(r);throw new Error("Shader compilation failed:"+i)}return r}},{key:"AssignAttribute",value:function(t){this.attributes[t]=this.gl.getAttribLocation(this.program,t)}},{key:"AssignUniform",value:function(t){this.uniforms[t]=this.gl.getUniformLocation(this.program,t)}},{key:"Execute",value:function(){}}])&&Vi(e.prototype,n),r&&Vi(e,r),t}(),Fi=null;function Ui(t){return(Ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xi(t,e){return!e||"object"!==Ui(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hi(t){return(Hi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yi(t,e){return(Yi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wi=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Xi(this,Hi(e).call(this,t,li))).essenceBuffer=null,n.vertices=null,n.fillColor=null,n.outlineColor=null,n.outline=5,n.Initialise(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yi(t,e)}(e,Ni),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array(Object(B.TriRectArray)(0,0,1,1)),this.fillColor=new hr,this.outlineColor=new hr,t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uFillColor"),this.AssignUniform("uOutlineColor"),this.AssignUniform("uRadius"),this.AssignUniform("uOutline")}},{key:"Execute",value:function(t,e,n,r){var i=this.gl,o=this.attributes,a=this.uniforms,s=this.vertices,u=this.fillColor.channel,l=this.outlineColor.channel;Object(B.TriRectArray)(e-r,n-r,2*r,2*r,s),this!==Ni.LAST_USED_CONTROLLER&&(i.useProgram(this.program),Ni.LAST_USED_CONTROLLER=this),i.bindBuffer(i.ARRAY_BUFFER,this.essenceBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,s),i.enableVertexAttribArray(o.aPosition),i.vertexAttribPointer(o.aPosition,2,i.FLOAT,!1,0,0),i.uniformMatrix3fv(a.uProjection,!1,t),i.uniform4f(a.uFillColor,u[0],u[1],u[2],u[3]),i.uniform4f(a.uOutlineColor,l[0],l[1],l[2],l[3]),i.uniform1f(a.uOutline,this.outline),i.uniform1f(a.uRadius,r),i.drawArrays(i.TRIANGLE_STRIP,0,6)}}])&&Mi(n.prototype,r),i&&Mi(n,i),e}();function qi(t){return(qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ki(t,e){return!e||"object"!==qi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ji(t){return(Ji=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qi(t,e){return(Qi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $i=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ki(this,Ji(e).call(this,t,ci))).essenceBuffer=null,n.vertices=null,n.color=null,n.Initialise(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qi(t,e)}(e,Ni),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array([-1,0,1,0]),this.color=new hr,t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uColor")}},{key:"Execute",value:function(t,e,n){var r=this.gl,i=this.attributes,o=this.uniforms,a=this.vertices,s=this.color.channel;a[0]=e.x,a[1]=e.y,a[2]=n.x,a[3]=n.y,this!==Ni.LAST_USED_CONTROLLER&&(r.useProgram(this.program),Ni.LAST_USED_CONTROLLER=this),r.bindBuffer(r.ARRAY_BUFFER,this.essenceBuffer),r.bufferSubData(r.ARRAY_BUFFER,0,a),r.enableVertexAttribArray(i.aPosition),r.vertexAttribPointer(i.aPosition,2,r.FLOAT,!1,0,0),r.uniformMatrix3fv(o.uProjection,!1,t),r.uniform4f(o.uColor,s[0],s[1],s[2],s[3]),r.drawArrays(r.LINES,0,2)}}])&&zi(n.prototype,r),i&&zi(n,i),e}();function Zi(t){return(Zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function to(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function eo(t,e){return!e||"object"!==Zi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function no(t){return(no=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ro(t,e){return(ro=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var io=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=eo(this,no(e).call(this,t,si))).dataBuffer=null,n.previousNumberOfElements=0,n.Initialise(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ro(t,e)}(e,Ni),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.dataBuffer=t.createBuffer(),this.AssignAttribute("aProjection1"),this.AssignAttribute("aProjection2"),this.AssignAttribute("aProjection3"),this.AssignAttribute("aPosition"),this.AssignAttribute("aColor"),this.AssignAttribute("aPointSize")}},{key:"Execute",value:function(t,e){var n=this.gl,r=this.attributes;Ni.LAST_USED_CONTROLLER!==this&&(n.useProgram(this.program),Ni.LAST_USED_CONTROLLER=this),n.bindBuffer(n.ARRAY_BUFFER,this.dataBuffer),e!==this.previousNumberOfElements?n.bufferData(n.ARRAY_BUFFER,t,n.DYNAMIC_DRAW):n.bufferSubData(n.ARRAY_BUFFER,0,t);n.enableVertexAttribArray(r.aProjection1),n.vertexAttribPointer(r.aProjection1,3,n.FLOAT,!1,64,0),n.enableVertexAttribArray(r.aProjection2),n.vertexAttribPointer(r.aProjection2,3,n.FLOAT,!1,64,12),n.enableVertexAttribArray(r.aProjection3),n.vertexAttribPointer(r.aProjection3,3,n.FLOAT,!1,64,24),n.enableVertexAttribArray(r.aPosition),n.vertexAttribPointer(r.aPosition,2,n.FLOAT,!1,64,36),n.enableVertexAttribArray(r.aColor),n.vertexAttribPointer(r.aColor,4,n.FLOAT,!1,64,44),n.enableVertexAttribArray(r.aPointSize),n.vertexAttribPointer(r.aPointSize,1,n.FLOAT,!1,64,60),n.drawArrays(n.POINTS,0,e),this.previousNumberOfElements=e}}])&&to(n.prototype,r),i&&to(n,i),e}();function oo(t){return(oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ao(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function so(t,e){return!e||"object"!==oo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function uo(t){return(uo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lo(t,e){return(lo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var co=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=so(this,uo(e).call(this,t,ui))).essenceBuffer=null,n.vertices=null,n.fillColor=null,n.outlineColor=null,n.outline=5,n.Initialise(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lo(t,e)}(e,Ni),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array(Object(B.TriRectArray)(0,0,1,1)),this.fillColor=new hr,this.outlineColor=new hr,t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uFillColor"),this.AssignUniform("uOutlineColor"),this.AssignUniform("uSize"),this.AssignUniform("uOutline")}},{key:"Execute",value:function(t,e,n,r,i){var o=this.gl,a=this.attributes,s=this.uniforms,u=this.vertices,l=this.fillColor.channel,c=this.outlineColor.channel;Object(B.TriRectArray)(e,n,r,i,u),this!==Ni.LAST_USED_CONTROLLER&&(o.useProgram(this.program),Ni.LAST_USED_CONTROLLER=this),o.bindBuffer(o.ARRAY_BUFFER,this.essenceBuffer),o.bufferSubData(o.ARRAY_BUFFER,0,u),o.enableVertexAttribArray(a.aPosition),o.vertexAttribPointer(a.aPosition,2,o.FLOAT,!1,0,0),o.uniformMatrix3fv(s.uProjection,!1,t),o.uniform4f(s.uFillColor,l[0],l[1],l[2],l[3]),o.uniform4f(s.uOutlineColor,c[0],c[1],c[2],c[3]),o.uniform1f(s.uOutline,this.outline),o.uniform2f(s.uSize,r,i),o.drawArrays(o.TRIANGLE_STRIP,0,6)}}])&&ao(n.prototype,r),i&&ao(n,i),e}();function ho(t){return(ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function po(t,e){return!e||"object"!==ho(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function yo(t){return(yo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vo(t,e){return(vo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mo=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=po(this,yo(e).call(this,t,ai))).originalTexture=null,n.texture=null,n.essenceBuffer=null,n.dataBuffer=null,n.indexBuffer=null,n.previousNumberOfElements=0,n.Initialise(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vo(t,e)}(e,Ni),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.texture=t.createTexture(),this.essenceBuffer=t.createBuffer(),this.dataBuffer=t.createBuffer(),this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignAttribute("aProjection1"),this.AssignAttribute("aProjection2"),this.AssignAttribute("aProjection3"),this.AssignAttribute("aTranslation1"),this.AssignAttribute("aTranslation2"),this.AssignAttribute("aTranslation3"),this.AssignAttribute("aTransformation1"),this.AssignAttribute("aTransformation2"),this.AssignAttribute("aTransformation3"),this.AssignUniform("uImage")}},{key:"BindBasicTexture",value:function(t,e){var n=this.gl,r=Object(B.TriRectArray)(0,0,t.w,t.h);e=null!=e?e:n.LINEAR,this.aia=n.getExtension("ANGLE_instanced_arrays"),this.originalTexture=t,r.push.apply(r,Object(B.TriRectArray)(0,0,1,1)),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t.image),n.bindBuffer(n.ARRAY_BUFFER,this.essenceBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(r),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindTexture(n.TEXTURE_2D,null)}},{key:"Execute",value:function(t,e){var n=this.gl,r=this.aia,i=this.attributes,o=this.uniforms;this!==Ni.LAST_USED_CONTROLLER&&(n.useProgram(this.program),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.texture),n.uniform1i(o.uImage,0),n.bindBuffer(n.ARRAY_BUFFER,this.essenceBuffer),n.enableVertexAttribArray(i.aPosition),n.vertexAttribPointer(i.aPosition,2,n.FLOAT,!1,0,0),r.vertexAttribDivisorANGLE(i.aPosition,0),n.enableVertexAttribArray(i.aTexCoord),n.vertexAttribPointer(i.aTexCoord,2,n.FLOAT,!1,0,48),r.vertexAttribDivisorANGLE(i.aTexCoord,0),Ni.LAST_USED_CONTROLLER=this),n.bindBuffer(n.ARRAY_BUFFER,this.dataBuffer),e!==this.previousNumberOfElements?n.bufferData(n.ARRAY_BUFFER,t,n.DYNAMIC_DRAW):n.bufferSubData(n.ARRAY_BUFFER,0,t),n.enableVertexAttribArray(i.aProjection1),n.vertexAttribPointer(i.aProjection1,3,n.FLOAT,!1,108,0),r.vertexAttribDivisorANGLE(i.aProjection1,1),n.enableVertexAttribArray(i.aProjection2),n.vertexAttribPointer(i.aProjection2,3,n.FLOAT,!1,108,12),r.vertexAttribDivisorANGLE(i.aProjection2,1),n.enableVertexAttribArray(i.aProjection3),n.vertexAttribPointer(i.aProjection3,3,n.FLOAT,!1,108,24),r.vertexAttribDivisorANGLE(i.aProjection3,1),n.enableVertexAttribArray(i.aTranslation1),n.vertexAttribPointer(i.aTranslation1,3,n.FLOAT,!1,108,36),r.vertexAttribDivisorANGLE(i.aTranslation1,1),n.enableVertexAttribArray(i.aTranslation2),n.vertexAttribPointer(i.aTranslation2,3,n.FLOAT,!1,108,48),r.vertexAttribDivisorANGLE(i.aTranslation2,1),n.enableVertexAttribArray(i.aTranslation3),n.vertexAttribPointer(i.aTranslation3,3,n.FLOAT,!1,108,60),r.vertexAttribDivisorANGLE(i.aTranslation3,1),n.enableVertexAttribArray(i.aTransformation1),n.vertexAttribPointer(i.aTransformation1,3,n.FLOAT,!1,108,72),r.vertexAttribDivisorANGLE(i.aTransformation1,1),n.enableVertexAttribArray(i.aTransformation2),n.vertexAttribPointer(i.aTransformation2,3,n.FLOAT,!1,108,84),r.vertexAttribDivisorANGLE(i.aTransformation2,1),n.enableVertexAttribArray(i.aTransformation3),n.vertexAttribPointer(i.aTransformation3,3,n.FLOAT,!1,108,96),r.vertexAttribDivisorANGLE(i.aTransformation3,1),r.drawArraysInstancedANGLE(n.TRIANGLE_STRIP,0,6,e)}}])&&fo(n.prototype,r),i&&fo(n,i),e}();function bo(t){return(bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function go(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wo(t,e){return!e||"object"!==bo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ao(t){return(Ao=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function So(t,e){return(So=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Co=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=wo(this,Ao(e).call(this,t,oi))).originalTexture=null,n.texture=null,n.essenceBuffer=null,n.Initialise(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&So(t,e)}(e,Ni),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.texture=t.createTexture(),this.essenceBuffer=t.createBuffer(),this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignUniform("uImage"),this.AssignUniform("uProjection"),this.AssignUniform("uTranslation"),this.AssignUniform("uTransformation"),this.AssignUniform("uTint")}},{key:"BindBasicTexture",value:function(t,e){var n=this.gl,r=Object(B.TriRectArray)(0,0,t.w,t.h);e=null!=e?e:n.LINEAR,this.originalTexture=t,r.push.apply(r,Object(B.TriRectArray)(0,0,1,1)),n.bindTexture(n.TEXTURE_2D,this.texture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t.image),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e),n.bindBuffer(n.ARRAY_BUFFER,this.essenceBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(r),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindTexture(n.TEXTURE_2D,null)}},{key:"Execute",value:function(t,e,n,r){var i=this.gl,o=this.attributes,a=this.uniforms;this!==Ni.LAST_USED_CONTROLLER&&(i.useProgram(this.program),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.texture),i.bindBuffer(i.ARRAY_BUFFER,this.essenceBuffer),i.enableVertexAttribArray(o.aPosition),i.vertexAttribPointer(o.aPosition,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(o.aTexCoord),i.vertexAttribPointer(o.aTexCoord,2,i.FLOAT,!1,0,48),i.uniform1i(a.uImage,0),Ni.LAST_USED_CONTROLLER=this),i.uniform4fv(a.uTint,r),i.uniformMatrix3fv(a.uProjection,!1,t),i.uniformMatrix3fv(a.uTranslation,!1,e),i.uniformMatrix3fv(a.uTransformation,!1,n),i.drawArrays(i.TRIANGLE_STRIP,0,6)}}])&&go(n.prototype,r),i&&go(n,i),e}();function To(t){return(To="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Eo(t,e){return!e||"object"!==To(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Po(t){return(Po=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _o(t,e){return(_o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Oo=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),.5*t.getParameter(t.MAX_VERTEX_ATTRIBS)<n&&console.error(.5*t.getParameter(t.MAX_VERTEX_ATTRIBS),"MAX"),(r=Eo(this,Po(e).call(this,t,vi(n)))).units=n,r.originalTextures=[],r.textures=[],r.essenceBuffers=[],r.lastUsedUnit=0,r.Initialise(),r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_o(t,e)}(e,Ni),n=e,(r=[{key:"Initialise",value:function(){for(var t=0;t<this.units;++t)this.AssignAttribute("aPosition"+t),this.AssignAttribute("aTexCoord"+t);this.AssignUniform("uImage"),this.AssignUniform("uUnitId"),this.AssignUniform("uProjection"),this.AssignUniform("uTranslation"),this.AssignUniform("uTransformation"),this.AssignUniform("uTint")}},{key:"BindBasicTexture",value:function(t,e,n){var r=this.gl,i=Object(B.TriRectArray)(0,0,t.w,t.h);null==e&&(e=0),n=null!=n?n:r.LINEAR,t.uniformId=e,this.originalTextures[e]=t,this.textures[e]=r.createTexture(),this.essenceBuffers[e]=r.createBuffer(),i.push.apply(i,Object(B.TriRectArray)(0,0,1,1)),r.bindTexture(r.TEXTURE_2D,this.textures[e]),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t.image),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n),r.bindBuffer(r.ARRAY_BUFFER,this.essenceBuffers[e]),r.bufferData(r.ARRAY_BUFFER,new Float32Array(i),r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,null),r.bindTexture(r.TEXTURE_2D,null)}},{key:"BindUnit",value:function(t,e,n,r){null!=this.textures[r]&&(t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,this.textures[r]),t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffers[r]),t.enableVertexAttribArray(n["aPosition"+r]),t.vertexAttribPointer(n["aPosition"+r],2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(n["aTexCoord"+r]),t.vertexAttribPointer(n["aTexCoord"+r],2,t.FLOAT,!1,0,48))}},{key:"Execute",value:function(t,e,n,r,i){var o=this.gl,a=this.attributes,s=this.uniforms;if(this!==Ni.LAST_USED_CONTROLLER){o.useProgram(this.program);for(var u=0;u<this.units;++u)this.BindUnit(o,s,a,u);o.uniform1i(s.uUnitId,i),o.uniform1i(s.uImage,i),Ni.LAST_USED_CONTROLLER=this,this.lastUsedUnit=i}else i!==this.lastUsedUnit&&(o.uniform1i(s.uUnitId,i),o.uniform1i(s.uImage,i),this.lastUsedUnit=i);o.uniform4fv(s.uTint,r),o.uniformMatrix3fv(s.uProjection,!1,t),o.uniformMatrix3fv(s.uTranslation,!1,e),o.uniformMatrix3fv(s.uTransformation,!1,n),o.drawArrays(o.TRIANGLE_STRIP,0,6)}}])&&xo(n.prototype,r),i&&xo(n,i),e}();function Ro(t){return(Ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Do(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ko(t,e){return!e||"object"!==Ro(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Io(t){return(Io=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Lo(t,e){return(Lo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jo=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=ko(this,Io(e).call(this,t,n))).essenceBuffer=null,r.vertices=null,r.Initialise(),r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lo(t,e)}(e,Ni),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array(Object(B.TriRectArray)(0,0,1,1)),t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("a_v2Position"),this.AssignUniform("u_m3Projection"),this.AssignUniform("u_fTime"),this.AssignUniform("u_v2Resolution")}},{key:"Execute",value:function(t,e,n,r,i,o){var a=this.gl,s=this.attributes,u=this.uniforms,l=this.vertices;Object(B.TriRectArray)(e,n,r,i,l),this!==Ni.LAST_USED_CONTROLLER&&(a.useProgram(this.program),Ni.LAST_USED_CONTROLLER=this),a.bindBuffer(a.ARRAY_BUFFER,this.essenceBuffer),a.bufferSubData(a.ARRAY_BUFFER,0,l),a.enableVertexAttribArray(s.a_v2Position),a.vertexAttribPointer(s.a_v2Position,2,a.FLOAT,!1,0,0),a.uniformMatrix3fv(u.u_m3Projection,!1,t),a.uniform2f(u.u_v2Resolution,r,i),a.uniform1f(u.u_fTime,o),a.drawArrays(a.TRIANGLE_STRIP,0,6)}}])&&Do(n.prototype,r),i&&Do(n,i),e}();function Bo(t){return(Bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Go(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Vo(t,e){return!e||"object"!==Bo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function No(t){return(No=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fo(t,e){return(Fo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Uo=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Vo(this,No(e).call(this,t,n))).essenceBuffer=null,r.frameBuffer=null,r.renderBuffer=null,r.texture=null,r.w=0,r.h=0,r.Initialise(),r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fo(t,e)}(e,Ni),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.frameBuffer=t.createFramebuffer(),this.renderBuffer=t.createRenderbuffer(),this.texture=t.createTexture(),this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignUniform("uImage")}},{key:"Config",value:function(t,e,n){this.w=t,this.h=e;var r=this.gl,i=Object(B.TriRectArray)(-1,-1,2,2);n=null!=n?n:r.LINEAR,i.push.apply(i,Object(B.TriRectArray)(0,0,1,1)),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.w,this.h,0,r.RGBA,r.UNSIGNED_BYTE,null),r.bindRenderbuffer(r.RENDERBUFFER,this.renderBuffer),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,this.w,this.h),r.bindFramebuffer(r.FRAMEBUFFER,this.frameBuffer),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,this.texture,0),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,this.renderBuffer),r.bindBuffer(r.ARRAY_BUFFER,this.essenceBuffer),r.bufferData(r.ARRAY_BUFFER,new Float32Array(i),r.STATIC_DRAW),r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindRenderbuffer(r.RENDERBUFFER,null)}},{key:"Execute",value:function(){var t=this.gl,e=this.attributes;this!==Ni.LAST_USED_CONTROLLER&&(t.useProgram(this.program),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.texture),t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.enableVertexAttribArray(e.aPosition),t.vertexAttribPointer(e.aPosition,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(e.aTexCoord),t.vertexAttribPointer(e.aTexCoord,2,t.FLOAT,!1,0,48),t.uniform1i(this.uniforms.uImage,0),Ni.LAST_USED_CONTROLLER=this),t.drawArrays(t.TRIANGLE_STRIP,0,6)}}])&&Go(n.prototype,r),i&&Go(n,i),e}();function Mo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Xo=function(){function t(e,n,r,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.split(" "),this.handle=n,this.info=r,this.priority=i,this.breakIfExecuted=!!o,this.data={},this.command=null}var e,n,r;return e=t,(n=[{key:"Execute",value:function(t,e,n){return this.handle(t,e,n),this.breakIfExecuted}}])&&Mo(e.prototype,n),r&&Mo(e,r),t}();function Ho(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Yo=function(){function t(e,n,r,i,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.split(" "),this.handle=n,this.info=r,this.data={},this.options=null,this.registry=null,this.optionPrefix=null==a?Wo:a,this.dataSeparator="=",this.allOptionIds=null,this.fullInfo=null,this.continueToPrime=!!i,this.filterNull=!!o,this.jsonPrefix="(JSON)"}var e,n,r;return e=t,r=[{key:"OPTION_PREFIX",get:function(){return Wo},set:function(t){Wo=t}}],(n=[{key:"Execute",value:function(t,e,n){this.HandleData(t,e),!0===this.filterNull&&(t=t.filter(zo)),!0===this.HandleOptions(t,e,n)&&this.handle(t,e,n)}},{key:"AddOption",value:function(t,e,n,r,i,o){null!=(o=null==o?this.optionPrefix:o)&&(t=t.replace(/\S+/g,o+"$&")),null==this.options&&(this.options=[]),r=null==r?0:r;var a=this.options,s=a[0],u=new Xo(t,e,n,r,i);u.command=this;for(var l=0;l<a.length;s=a[++l])if(s.priority<=r)return a.splice(l,0,u),this.allOptionIds=this.GetAllOptionIds(),this;return this.options.push(u),this.allOptionIds=this.GetAllOptionIds(),this}},{key:"HandleData",value:function(t,e){var n,r=this.dataSeparator,i=qo,o=this.jsonPrefix,a=o.length;i.push.apply(i,t);for(var s=i[0],u=0;u<i.length;s=i[++u])2===(n=s.split(r)).length&&(t[u]=null,n[0].substring(0,a)===o?e[n[0].substring(a)]=JSON.parse(n[1]):e[n[0]]=n[1]);i.length=0}},{key:"HandleOptions",value:function(t,e,n){if(0===t.length)return this.continueToPrime;var r=this.GetAndRemoveMatchingOptionIds(t);if(null==r)return this.continueToPrime;for(var i=0;i<r.length;++i)if(!0===this.GetOptionById(r[i]).Execute(t,e,n))return!1;return this.continueToPrime}},{key:"GetOptionById",value:function(t){for(var e=this.options,n=e[0],r=0;r<e.length;n=e[++r])if(-1!==n.id.indexOf(t))return n;return null}},{key:"GetAllOptionIds",value:function(){for(var t=this.options,e=[],n=0;n<t.length;++n)e.push.apply(e,t[n].id);return e}},{key:"GetAndRemoveMatchingOptionIds",value:function(t){var e,n=this.allOptionIds;if(null==n)return null;for(var r=[],i=0;i<n.length;++i)-1!==(e=t.indexOf(n[i]))&&r.push(t.fickleSplice(e));return r}},{key:"GenerateInfoString",value:function(){for(var t="COMMAND: "+this.id.join(", ")+" -> "+this.info+"\n",e=this.options,n=e[0],r=0;r<e.length;n=e[++r])t+="OPTION: "+n.id.join(", ")+" -> "+n.info+"\n";return t}}])&&Ho(e.prototype,n),r&&Ho(e,r),t}(),Wo="",qo=[],zo=function(t){return null!=t};function Ko(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Jo=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.commands=[],this.splitter=" "}var e,n,r;return e=t,(n=[{key:"AddCommand",value:function(t){if(null==t.registry)return this.commands.push(t),t.registry=this,t}},{key:"RemoveCommand",value:function(t){var e=this.commands,n=e.indexOf(t);if(-1!==n)return t.registry=null,e.fickleSplice(n)}},{key:"GetCommandById",value:function(t){for(var e=this.commands,n=e[0],r=0;r<e.length;n=e[++r])if(n)for(var i=0;i<n.id.length;++i)if(n.id[i]===t)return n;return null}},{key:"Parse",value:function(t,e){var n=String(t).split(this.splitter),r=n.shift(),i=this.GetCommandById(r);return i?(i.Execute(n,{},e),null):r}}])&&Ko(e.prototype,n),r&&Ko(e,r),t}();function Qo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $o=function(){function t(e,n,r,i,a,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.target=n,this.propertyString=r,this.value=i,this.duration=a,this.easing=o[null==s?Zo:s],this.time=0,this.startValue=0,this.change=0,this.property=null,this.properyObject=null,this.running=!1,this.onStart=new Tr,this.onEnd=new Tr,this.onStop=new Tr,this.onReconfigure=new Tr,this.onReset=new Tr}var e,n,r;return e=t,(n=[{key:"Start",value:function(){var t=this.propertyString.split(".");this.property=t[t.length-1],this.propertyObject=Object(j.Nested)(this.target,this.propertyString,!0),this.startValue=this.propertyObject[this.property],this.change=this.value-this.startValue,this.time=0,this.running=!0,this.onStart.Dispatch(this,null)}},{key:"Stop",value:function(){this.property=null,this.propertyObject=null,this.startValue=0,this.change=0,this.time=0,this.running=!1,this.onStop.Dispatch(this,null)}},{key:"Process",value:function(){!0===this.running&&(this.propertyObject[this.property]=this.easing(this.time,this.startValue,this.change,this.duration),++this.time>=this.duration&&(this.running=!1,this.propertyObject[this.property]=this.value,this.onEnd.Dispatch(this,null)))}},{key:"Reconfigure",value:function(t,e,n,r){null!=t&&(this.propertyString=t),this.value=e,this.duration=n,this.easing=o[null==r?Zo:r],this.onReconfigure.Dispatch(this,null)}},{key:"NewValue",value:function(t){this.value=t,this.Start()}},{key:"Reset",value:function(){if(null==this.propertyObject||null==this.property)return!1;this.propertyObject[this.property]=this.startValue,this.property=null,this.propertyObject=null,this.startValue=0,this.change=0,this.time=0,this.running=!1,this.onReset.Dispatch(this,null)}}])&&Qo(e.prototype,n),r&&Qo(e,r),t}(),Zo="Linear";function ta(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ea=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.motions=[],this.target=e}var e,n,r;return e=t,(n=[{key:"Create",value:function(t,e,n,r,i){if(null==this.GetMotionById(t)){var o=new $o(t,this.target,e,n,r,i);return this.motions.push(o),o}return null}},{key:"Add",value:function(t){null==this.GetMotionById(t.id)&&this.motions.push(t)}},{key:"Start",value:function(t){var e=this.GetMotionById(t);return null!==e&&e.Start(),e}},{key:"StartMultiple",value:function(t){t=t.split(" ");for(var e=0;e<t.length;++e)this.Start(t[e])}},{key:"Stop",value:function(t){var e=this.GetMotionById(t);return null!==e&&e.Stop(),e}},{key:"StopMultiple",value:function(t){t=t.split(" ");for(var e=0;e<t.length;++e)this.Stop(t[e])}},{key:"Reset",value:function(t){var e=this.GetMotionByid(t);return null!==e&&e.Reset(),e}},{key:"ResetMultiple",value:function(t){t=t.split(" ");for(var e=0;e<t.length;++e)this.Reset(t[e])}},{key:"Process",value:function(){for(var t=this.motions,e=0;e<t.length;++e)t[e].Process()}},{key:"GetMotionById",value:function(t){for(var e=this.motions,n=0;n<e.length;++n)if(e[n].id===t)return e[n];return null}}])&&ta(e.prototype,n),r&&ta(e,r),t}(),na=n(6);function ra(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ia(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oa(t,e,n){return e&&ia(t.prototype,e),n&&ia(t,n),t}var aa=function(){function t(e,n,r){ra(this,t),this.Set(e,n,r)}return oa(t,[{key:"Set",value:function(t,e,n){this.from=t,this.to=e,this.amplitude=n,this.active=!0}},{key:"Inactivate",value:function(){this.active=!1}}]),t}(),sa=function(){function t(){ra(this,t),this.velocityX=null,this.velocityY=null,this.torque=null,this.accelerationX=null,this.accelerationY=null,this.spin=null,this.growthX=null,this.growthY=null,this.gravityX=null,this.gravityY=null,this.active=!0}return oa(t,[{key:"CreateOscillatingObject",value:function(t,e,n,r){if(null!==this[t])throw new Error("Invalid key");this[t]=new aa(e,n,r)}},{key:"SetOscillatingObject",value:function(t,e,n,r){var i=this[t];if(null==i)return this.CreateOscillatingObject(t,e,n,r);i.Set(e,n,r)}},{key:"Nullify",value:function(t){null!=this[t]&&this[t].Inactivate()}}]),t}();function ua(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var la=Math.cos,ca=Math.sin,ha=Math.atan2,fa=Math.sqrt,da=Math.abs,pa=Math.PI,ya=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.array=new Float32Array(9),this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}var e,n,r;return e=t,(n=[{key:"Identity",value:function(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}},{key:"Copy",value:function(){var e=new t;return e.Set(this.a,this.b,this.c,this.d,this.e,this.f),e}},{key:"Set",value:function(t,e,n,r,i,o){return this.a=t,this.b=e,this.c=n,this.d=r,this.e=i,this.f=o,this}},{key:"SetTransform",value:function(t,e,n,r,i,o,a,s,u){t=null==t?0:t,e=null==e?0:e,n=null==n?1:n,r=null==r?1:r,o=null==o?0:o,a=null==a?0:a,s=null==s?0:s,u=null==u?0:u;var l=ca(i=null==i?0:i),c=la(i),h=-ca(o),f=la(o),d=ca(a),p=la(a),y=c*n,v=l*n,m=-l*r,b=c*r;return this.a=p*y+d*m,this.b=p*v+d*b,this.c=h*y+f*m,this.d=h*v+f*b,this.e=t+s*y+u*m,this.f=e+s*v+u*b,this}},{key:"Translate",value:function(t,e){this.e+=t,this.f+=e}},{key:"TranslateTo",value:function(t,e){this.e=t,this.f=e}},{key:"ApplyTranslation",value:function(t,e){this.e=t*this.a+e*this.c+this.e,this.f=t*this.b+e*this.d+this.f}},{key:"ApplyScale",value:function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e}},{key:"Scale",value:function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e}},{key:"Rotate",value:function(t){var e=Math.sin(t),n=Math.cos(t),r=this.a,i=this.c,o=this.e;this.a=r*n-this.b*e,this.b=r*e+this.b*n,this.c=i*n-this.d*e,this.d=i*e+this.d*n,this.e=o*n-this.f*e,this.f=o*e+this.f*n}},{key:"Decompose",value:function(t){var e=this.a,n=this.b,r=this.c,i=this.d,o=-ha(-r,i),a=ha(n,e);da(o+a)<va?(t.rotation=a,e<0&&i>=0&&(t.rotation+=pa),t.skew.SetSame(0)):t.skew.Set(o,a),t.scale.Set(fa(e*e+n*n),fa(r*r+i*i)),t.position.Set(this.e,this.f)}},{key:"ApplyToContext",value:function(t){t.setTransform(this.a,this.b,this.c,this.d,this.e,this.f)}},{key:"AsArray",value:function(t){var e=this.array;return!0===t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.e,e[7]=this.f,e[8]=1):(e[0]=this.a,e[1]=this.c,e[2]=this.e,e[3]=this.b,e[4]=this.d,e[5]=this.f,e[6]=0,e[7]=0,e[8]=1),e}}])&&ua(e.prototype,n),r&&ua(e,r),t}(),va=1e-5;function ma(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ba=Math.cos,ga=Math.sin,wa=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.position=new ut.a(e,n),this.scale=new ut.a(1,1),this.skew=new ut.a(0,0),this.pivot=new ut.a(0,0),this.localTransform=new ya,this.globalTransform=new ya,this.rotation=0,this.skewCX=1,this.skewSX=0,this.skewCY=0,this.skewSY=1}var e,n,r;return e=t,(n=[{key:"SetMatrix",value:function(t){t.Decompose(this),this.UpdateSkew()}},{key:"UpdateLocal",value:function(){var t=this.localTransform,e=this.position,n=this.scale,r=this.pivot;t.a=this.skewCX*n.x,t.b=this.skewSX*n.x,t.c=this.skewCY*n.y,t.d=this.skewSY*n.y,t.e=e.x-r.x*t.a+r.y*t.c,t.f=e.y-r.y*t.b+r.y*t.d}},{key:"UpdateGlobal",value:function(t){var e=this.localTransform,n=this.globalTransform,r=this.position,i=this.scale,o=this.pivot;e.a=this.skewCX*i.x,e.b=this.skewSX*i.x,e.c=this.skewCY*i.y,e.d=this.skewSY*i.y,e.e=r.x-o.x*e.a+o.y*e.c,e.f=r.y-o.y*e.b+o.y*e.d,n.a=e.a*t.a+e.b*t.c,n.b=e.a*t.b+e.b*t.d,n.c=e.c*t.a+e.d*t.c,n.d=e.c*t.b+e.d*t.d,n.e=e.e*t.a+e.f*t.c+t.e,n.f=e.e*t.b+e.f*t.d+t.f}},{key:"UpdateSkew",value:function(){var t=this.skew,e=this.rotation;this.skewCX=ba(e+t.y),this.skewSX=ga(e+t.y),this.skewCY=-ga(e-t.x),this.skewSY=ba(e-t.x)}},{key:"ApplyGlobal",value:function(t){this.globalTransform.ApplyToContext(t)}}])&&ma(e.prototype,n),r&&ma(e,r),t}();function Aa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Sa=Math.abs,Ca=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.local=null,this.localDirty=!0,this.global=null,this.globalDirty=!0}var e,n,r;return e=t,(n=[{key:"ComputeLocal",value:function(t,e,n,r,i,o){return null!=i&&(t-=n*i.x,e-=r*i.y),null===this.local?(this.local=new pe(t,e,t+n,e+r),this.local.belongsTo=o):this.local.Set(t,e,t+n,e+r),this.localDirty=!1,this.local}},{key:"ComputeGlobal",value:function(t,e,n,r,i,o,a){return null!=a&&(t-=a.e,e-=a.f,t/=a.a,e/=a.d,n=Sa(n/a.a),r=Sa(r/a.d)),null!=i&&(t-=n*i.x,e-=r*i.y),null===this.global?(this.global=new pe(t,e,t+n,e+r),this.global.belongsTo=o):this.global.Set(t,e,t+n,e+r),this.globalDirty=!1,this.global}}])&&Aa(e.prototype,n),r&&Aa(e,r),t}();function Ta(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xa=Math.abs,Ea=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.transform=new wa(e,n),this.data={},this.w=0,this.h=0,this.bounds=new Ca,this.globalPosition=null,this.transformShouldUpdate=!0,this.transformAutomaticUpdate=!0,this.render=!0,this.motionManager=null,this.__inside__=null}var e,n,r;return e=t,(n=[{key:"UpdateTransform",value:function(t){null!=t?this.transform.UpdateGlobal(t.transform.globalTransform):this.transform.UpdateGlobal(Pa.globalTransform)}},{key:"ProcessTransform",value:function(t){!0===this.transformShouldUpdate&&(this.UpdateTransform(t),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1))}},{key:"RequestTransformUpdate",value:function(){this.transformShouldUpdate=!0}},{key:"GetGlobalPosition",value:function(){var t=this.transform.globalTransform;return null===this.globalPosition?this.globalPosition=new ut.a(t.e,t.f):this.globalPosition.Set(t.e,t.f),this.globalPosition}},{key:"ComputeLocalBounds",value:function(t){return this.bounds.ComputeLocal(this.x,this.y,this.width,this.height,t,this)}},{key:"ComputeGlobalBounds",value:function(t,e){var n=this.transform.globalTransform;return this.bounds.ComputeGlobal(n.e,n.f,xa(this.w*n.a),xa(this.h*n.d),t,this,e)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t,this.transform.UpdateSkew()}},{key:"scale",get:function(){return this.transform.scale}},{key:"position",get:function(){return this.transform.position}},{key:"pivot",get:function(){return this.transform.pivot}},{key:"x",get:function(){return this.transform.position.x},set:function(t){this.transform.position.x=t}},{key:"y",get:function(){return this.transform.position.y},set:function(t){this.transform.position.y=t}},{key:"width",get:function(){return this.w*this.scale.x},set:function(t){this.scale.x=t/this.w}},{key:"height",get:function(){return this.h*this.scale.y},set:function(t){this.scale.y=t/this.h}}])&&Ta(e.prototype,n),r&&Ta(e,r),t}(),Pa=new wa;function _a(t){return(_a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ra(t,e){return!e||"object"!==_a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Da(t){return(Da=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ka(t,e){return(ka=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ia=Math.abs,La=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Ra(this,Da(e).call(this,t,n))).parent=null,r.children=[],r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ka(t,e)}(e,Ea),n=e,(r=[{key:"Render",value:function(){!0===this.render&&(this.ProcessTransform(this.parent),this.children.length>0&&this.RenderChildren())}},{key:"RenderChildren",value:function(){for(var t=this.children,e=0;e<t.length;++e)t[e].Render()}},{key:"AddChild",value:function(t){var e=t.parent;return null!=e&&e.RemoveChild(t),this.children.push(t),t.parent=this,t}},{key:"AddChildren",value:function(){var t=arguments;Object(j.IsArray)(t[0])&&(t=t[0]);for(var e=0;e<t.length;++e)this.AddChild(t[e])}},{key:"AddSibling",value:function(t){var e=this.parent;return null!=e&&e.AddChild(t),t}},{key:"RemoveChild",value:function(t){var e=this.children,n=e.indexOf(t);if(-1!==n)return t.parent=null,e.fickleSplice(n)}},{key:"RemoveChildren",value:function(){var t,e,n=arguments;Object(j.IsArray)(r[0])&&(function(t){throw new Error('"'+t+'" is read-only')}("children"),r=r[0]);for(var r=this.children,i=[],o=0;o<n.length;++o)t=n[o],-1!==(e=r.indexOf(t))&&(i.push(r.fickleSplice(e)),t.parent=null);return i}},{key:"Swap",value:function(t){if(null!=this.parent){var e=this.parent.children,n=e.indexOf(this);if(-1!==n){-1===t&&(t=e.length-1);var r=e[t];e[t]=this,e[n]=r}}}},{key:"SendToFront",value:function(){this.Swap(-1)}},{key:"SendToBack",value:function(){this.Swap(0)}},{key:"Dump",value:function(){for(var t=this.children,e=0;e<t.length;++e)t[e].parent=null;t.length=0}},{key:"Destroy",value:function(){this.Dump(),null!=this.parent&&this.parent.RemoveChild(this)}},{key:"AttachTo",value:function(t){t.AddChild(this)}},{key:"Detach",value:function(){return null!=this.parent?this.parent.RemoveChild(this):null}},{key:"GetChildClosestTo",value:function(t,e){var n,r,i,o=1/0,a=this.children;if(0!==a.length){for(var s=0;s<a.length;++s)n=a[s],void 0!==e&&!1===e(n)||(r=Ia(n.position.GetDistanceSquared(t.x,t.y)))<o&&(o=r,i=n);return i}return null}},{key:"GetChildFurthestFrom",value:function(t,e){var n,r,i,o=0,a=this.children;if(0!==a.length){for(var s=0;s<a.length;++s)n=a[s],void 0!==e&&!1===e(n)||(r=Ia(n.position.GetDistanceSquared(t.x,t.y)))>o&&(o=r,i=n);return i}return null}}])&&Oa(n.prototype,r),i&&Oa(n,i),e}();function ja(t){return(ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ba(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ga(t,e){return!e||"object"!==ja(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Va(t){return(Va=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Na(t,e){return(Na=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}La.prototype.Mount=La.prototype.AddChildren;var Fa=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Ga(this,Va(e).call(this,t,n))).interactive=!0,r.display=!0,r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Na(t,e)}(e,La),n=e,(r=[{key:"PreRender",value:function(){}},{key:"GLPreRender",value:function(){}},{key:"PostRender",value:function(){}},{key:"GLPostRender",value:function(){}},{key:"Render",value:function(t){this.PreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),this.children.length>0&&!0===this.display&&this.RenderChildren(t)),this.PostRender(t)}},{key:"GLRender",value:function(t){this.GLPreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),this.children.length>0&&!0===this.display&&this.GLRenderChildren(t)),this.GLPostRender(t)}},{key:"RenderChildren",value:function(t){for(var e=this.children,n=0;n<e.length;++n)e[n].Render(t)}},{key:"GLRenderChildren",value:function(t){for(var e=this.children,n=0;n<e.length;++n)e[n].GLRender(t)}}])&&Ba(n.prototype,r),i&&Ba(n,i),e}();function Ua(t){return(Ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ma(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xa(t,e){return!e||"object"!==Ua(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ha(t){return(Ha=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ya(t,e){return(Ya=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}La.prototype.Mount=La.prototype.AddChildren;var Wa=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Xa(this,Ha(e).call(this,t,n))).isBatchParent=!1,r.childDataBuffer=null,r.bufferData=null,r.programController=null,r.bufferStartIndex=0,r.bufferEndIndex=0,r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ya(t,e)}(e,Fa),n=e,(r=[{key:"Render",value:function(t){this.PreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),this.children.length>0&&!0===this.display&&this.RenderChildren(t)),this.PostRender(t)}},{key:"GLRender",value:function(t){this.GLPreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchRenderChildren():this.GLRenderChildren(t))),this.GLPostRender(t)}},{key:"GLBatchRenderChildren",value:function(){null!=this.childDataBuffer&&null!=this.programController&&this.programController.Execute(this.childDataBuffer,this.children.length)}},{key:"ComputeBatchBuffer",value:function(t){for(var e,n,r=this.children,i=[],o=0;o<r.length;++o)e=r[o],n=null!=t?t(e):e.GetBufferData(),e.bufferStartIndex=i.length,e.bufferEndIndex=i.length+n.length,i.push.apply(i,n);this.childDataBuffer=new Float32Array(i)}},{key:"UpdateInBuffer",value:function(){throw new Error(qa)}},{key:"GetBufferData",value:function(){throw new Error(qa)}},{key:"UseAsBatchParent",value:function(t){this.isBatchParent=!0,this.programController=t}}])&&Ma(n.prototype,r),i&&Ma(n,i),e}(),qa="Cannot access buffer data directly on Container2D!";function za(t){return(za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ka(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ja(t,e){return!e||"object"!==za(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qa(t){return(Qa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $a(t,e){return($a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Za=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Ja(this,Qa(e).call(this,t,n))).anchor=new ut.a(0,0),o.shape=new pe(0,0,0,0),o.clip=new pe(0,0,0,0),o.textureTransformation=new ya,o.textureTranslation=new ya,o.originalShape=new pe(0,0,0,0),o.tint=new hr(1,1,1,1),o.texture=null,o.gco=ke,o.programController=null,r instanceof Co?(o.programController=r,o.SetTexture(r.originalTexture)):r instanceof Oo?(o.programController=r,null!=i?o.SetTexture(r.originalTextures[i]):o.SetTexture(r.originalTextures[0])):null!=r&&o.SetTexture(r),o}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$a(t,e)}(e,Wa),n=e,(r=[{key:"Render",value:function(t){if(this.PreRender(t),!0===this.render){if(this.ProcessTransform(this.parent),!0===this.display){var e=this.clip,n=e.tl,r=e.br,i=this.textureTranslation;this.transform.ApplyGlobal(t),t.globalAlpha=this.tint.channel[3],t.globalCompositeOperation=this.gco,t.drawImage(this.texture.image,n.x,n.y,r.x,r.y,i.e,i.f,this.w,this.h)}this.children.length>0&&this.RenderChildren(t)}this.PostRender(t)}},{key:"GLRender",value:function(t){this.GLPreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),!0===this.display&&(null!==this.programController&&this.programController.Execute(this.transform.globalTransform.AsArray(!0),this.textureTranslation.AsArray(!0),this.textureTransformation.AsArray(!0),this.tint.channel,this.texture.uniformId),this.children.length>0&&(!0===this.isBatchParent?this.GLBatchRenderChildren(t):this.GLRenderChildren(t)))),this.GLPostRender(t)}},{key:"UpdateTextureTransform",value:function(){this.textureTranslation.TranslateTo(-this.w*this.anchor.x,-this.h*this.anchor.y),this.textureTransformation.TranslateTo(this.w/this.texture.fw*this.clip.tl.x/this.w,this.h/this.texture.fh*this.clip.tl.y/this.h)}},{key:"UpdateShape",value:function(t){null!=t&&(this.originalShape=t),this.shape.SetC(this.originalShape),this.shape.Scale(this.scale.x,this.scale.y)}},{key:"ClipReconfigure",value:function(t,e,n,r){var i=n/this.texture.fw,o=r/this.texture.fh,a=this.width,s=this.height;this.clip.Set(t,e,n,r),this.w=n,this.h=r,0!==a&&0!==s&&(this.width=a,this.height=s),this.textureTranslation.SetTransform(-n*this.anchor.x,-r*this.anchor.y,i,o),this.textureTransformation.SetTransform(i*this.clip.tl.x/n,o*this.clip.tl.y/r,i,o)}},{key:"SetTexture",value:function(t){this.texture=t,this.ClipReconfigure(0,0,t.w,t.h),this.shape.SetC(this.clip),this.originalShape.SetC(this.shape)}},{key:"alpha",get:function(){return this.tint.channel[3]},set:function(t){this.tint.channel[3]=t}}])&&Ka(n.prototype,r),i&&Ka(n,i),e}();function ts(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var es=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.frames=[],this.controller=e,this.sprite=e.sprite,this.id=n,this.onEnd=new Tr,this.onStop=new Tr,this.onStart=new Tr,this.currentFrame=0,this.currentFrameIndex=0,this.playing=!1,this.rate=60,this.timer=0,this.reverse=!1,this.overrideFrameRate=!1,this.loop=!1,this.autoFrame=!0,null!=r&&(this.rate=r)}var e,n,r;return e=t,(n=[{key:"CreateFrame",value:function(t,e,n,r,i){i=null==i?this.rate:i,this.frames.push(new _i(t,e,n,r,i))}},{key:"AddFrame",value:function(t){(null==t.rate||t.rate<=0)&&(t.rate=this.rate),this.frames.push(t)}},{key:"GenerateFrames",value:function(t,e,n,r,i,o){var a,s=n/r;o=null==o?{}:o;for(var u=0;u<i;++u)a=o[u],this.CreateFrame(u%s*t,(u/s|0)*e,t,e,a)}},{key:"SetFrame",value:function(t){t=null==t?0:t;var e=this.frames[t];void 0!==e&&(this.currentFrame=e,this.currentFrameIndex=t,this.currentFrame.Apply(this.sprite))}},{key:"GetFrameById",value:function(t,e){for(var n=this.frames,r=0;r<n.length;++r)if(n[r].id===t)return!0===e?r:n[r]}},{key:"SetFrameById",value:function(t){var e=this.GetFrameById(t,!0);this.SetFrame(e)}},{key:"Start",value:function(t){null==t&&this.autoFrame&&(t=this.reverse?this.frames.length-1:0),this.SetFrame(t),this.ResetAllFrames(),this.timer=this.rate,this.playing=!0,this.onStart.Dispatch()}},{key:"Stop",value:function(){this.playing=!1,this.onStop.Dispatch()}},{key:"Process",value:function(){!0===this.playing&&(!0===this.overrideFrameRate?--this.timer<=0&&(this.timer=this.rate,this.NextFrame()):!0===this.currentFrame.Process()&&this.NextFrame())}},{key:"NextFrame",value:function(){var t=!1,e=this.frames,n=e.length;!1===this.reverse?++this.currentFrameIndex:--this.currentFrameIndex,this.currentFrameIndex>=n?(!0===this.loop?this.currentFrameIndex=0:this.currentFrameIndex=n-1,t=!0):this.currentFrameIndex<0&&(!0===this.loop?this.currentFrameIndex=n-1:this.currentFrameIndex=0,t=!0),this.currentFrame=e[this.currentFrameIndex],this.currentFrame.Apply(this.sprite),!0===t&&(this.onEnd.Dispatch(),!1===this.loop&&this.Stop())}},{key:"Clear",value:function(){this.frames=[],this.currentFrame=null,this.playing=!1,this.currentFrameIndex=0,this.timer=this.rate}},{key:"Reset",value:function(){this.SetFrame(0),this.ResetAllFrames(),this.timer=this.rate,this.playing=!1}},{key:"ResetAllFrames",value:function(){for(var t=this.frames,e=0;e<t.length;++e)t[e].Reset()}}])&&ts(e.prototype,n),r&&ts(e,r),t}();function ns(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var rs=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.animations=[],this.sprite=null,this.currentAnimation=null,null!=e&&(this.sprite=e)}var e,n,r;return e=t,(n=[{key:"CreateAnimation",value:function(t,e){var n=new es(this,t,e);return this.animations.push(n),n}},{key:"AddAnimation",value:function(t){t.controller=this,this.animations.push(t)}},{key:"GetAnimationById",value:function(t){for(var e=this.animations,n=e[0],r=0;r<e.length;n=e[++r])if(n&&n.id===t)return n;return null}},{key:"PlayAnimation",value:function(t,e){var n=this.GetAnimationById(t);null!==n&&(this.currentAnimation=n,n.Start(e))}},{key:"StopCurrentAnimation",value:function(){null!==this.currentAnimation&&this.currentAnimation.Stop()}},{key:"Process",value:function(){null!==this.currentAnimation&&this.currentAnimation.Process()}}])&&ns(e.prototype,n),r&&ns(e,r),t}();function is(t){return(is="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function os(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function as(t,e){return!e||"object"!==is(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ss(t){return(ss=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function us(t,e){return(us=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ls=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=as(this,ss(e).call(this,t,n))).anchor=new ut.a(0,0),i.SetPath(r),i.alpha=1,i}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&us(t,e)}(e,Wa),n=e,(r=[{key:"Render",value:function(t){if(this.PreRender(t),!0===this.render){this.ProcessTransform(this.parent),this.transform.ApplyGlobal(t);var e=this.path;e&&e.Render&&!0===this.display&&(t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,e.Render(t)),this.children.length>0&&this.RenderChildren(t)}this.PostRender(t)}},{key:"GLRender",value:function(t){if(this.GLPreRender(t),!0===this.render){this.ProcessTransform(this.parent);var e=this.path;e&&e.GLRender&&!0===this.display&&e.GLRender(t,this.transform),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchRenderChildren(t):this.GLRenderChildren(t))}this.GLPostRender(t)}},{key:"GetBufferData",value:function(){this.UpdateTransform(this.parent);var t=this.transform.globalTransform.AsArray(!0);null==this.bufferData&&(this.bufferData=[]);var e=this.bufferData;return e.length=0,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this.path&&this.path.GetBufferData&&e.push.apply(e,this.path.GetBufferData()),e}},{key:"UpdateInBuffer",value:function(){this.UpdateTransform(this.parent);var t=this.transform.globalTransform.AsArray(!0),e=this.parent.childDataBuffer,n=this.bufferStartIndex;e[n]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=t[3],e[n+4]=t[4],e[n+5]=t[5],e[n+6]=t[6],e[n+7]=t[7],e[n+8]=t[8],this.path&&this.path.UpdateInBuffer&&this.path.UpdateInBuffer(e,n+9)}},{key:"IntersectsPoint2D",value:function(t){return!1!==this.interactive&&(cs.SetV(t),cs.SubtractV(this.position),this.path.IntersectsPoint2D(cs))}},{key:"SetPath",value:function(t){void 0!==t&&(void 0!==t.w&&void 0!==t.h?(this.w=t.w,this.h=t.h):void 0!==t.GetLength?this.w=this.h=t.GetLength():void 0!==t.diameter?this.w=this.h=t.diameter:void 0!==t.aabb&&(this.w=t.aabb.w,this.h=t.aabb.h),this.path=t)}}])&&os(n.prototype,r),i&&os(n,i),e}(),cs=new ut.a(0,0);function hs(t){return(hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ds(t,e){return!e||"object"!==hs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ps(t){return(ps=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ys(t,e){return(ys=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vs=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=ds(this,ps(e).call(this,t,n,r,i))).animationController=null,null==r&&o.SetTexture(bs),o}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ys(t,e)}(e,Za),n=e,i=[{key:"BUILD_DEFAULT_TEXTURE",value:function(t){if(!0===gs)throw new Error("Function can only be called once!");bs=new Si(H(X(function(){var t=new ar([0,0,64,0,64,64,0,64,0,0,32,32,64,0,32,32,64,64,32,32,0,64]);return t.ComputeBounds(),t.style.stroke.lineWidth=3,new ls(0,0,t)}),64,64,t),"__DEFAULT_SPRITE_TEXTURE__",64,64,64,64),gs=!0}},{key:"DEFAULT_TEXTURE",get:function(){return bs}}],(r=[{key:"GetBufferData",value:function(){this.UpdateTransform(this.parent),this.UpdateTextureTransform();var t=this.transform.globalTransform.AsArray(!0),e=this.textureTranslation.AsArray(!0),n=this.textureTransformation.AsArray(!0);null==this.bufferData&&(this.bufferData=[]);var r=this.bufferData;return r.length=0,r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=e[0],r[10]=e[1],r[11]=e[2],r[12]=e[3],r[13]=e[4],r[14]=e[5],r[15]=e[6],r[16]=e[7],r[17]=e[8],r[18]=n[0],r[19]=n[1],r[20]=n[2],r[21]=n[3],r[22]=n[4],r[23]=n[5],r[24]=n[6],r[25]=n[7],r[26]=n[8],r}},{key:"UpdateInBuffer",value:function(){this.UpdateTransform(this.parent),this.UpdateTextureTransform();var t=this.transform.globalTransform.AsArray(!0),e=this.textureTranslation.AsArray(!0),n=this.textureTransformation.AsArray(!0),r=this.parent.childDataBuffer,i=this.bufferStartIndex;r[i]=t[0],r[i+1]=t[1],r[i+2]=t[2],r[i+3]=t[3],r[i+4]=t[4],r[i+5]=t[5],r[i+6]=t[6],r[i+7]=t[7],r[i+8]=t[8],r[i+9]=e[0],r[i+10]=e[1],r[i+11]=e[2],r[i+12]=e[3],r[i+13]=e[4],r[i+14]=e[5],r[i+15]=e[6],r[i+16]=e[7],r[i+17]=e[8],r[i+18]=n[0],r[i+19]=n[1],r[i+20]=n[2],r[i+21]=n[3],r[i+22]=n[4],r[i+23]=n[5],r[i+24]=n[6],r[i+25]=n[7],r[i+26]=n[8]}},{key:"CreateAnimation",value:function(t){var e;null===this.animationController&&(this.animationController=new rs(this));var n=this.animationController.CreateAnimation(t.id,t.rate);if(null!=t.spritesheet)for(e=0;e<t.frames.length;++e)n.AddFrame(t.spritesheet.GetFrameById(t.frames[e]));else{var r=t.frames[0];for(e=0;e<t.frames.length;r=t.frames[++e])n.CreateFrame(r.x,r.y,r.w,r.h,r.rate)}return n.loop=!!t.loop,n.overrideFrameRate=!!t.overrideFrameRate,n.reverse=!!t.reverse,n}},{key:"PlayAnimation",value:function(t,e){this.animationController.PlayAnimation(t,e)}},{key:"StopCurrentAnimation",value:function(){this.animationController.StopCurrentAnimation()}},{key:"IntersectsPoint2D",value:function(t){return!1!==this.interactive&&(ms.SetV(t),ms.SubtractV(this.position),ms.Add(this.width*this.anchor.x,this.height*this.anchor.y),this.shape.IntersectsPoint2D(ms))}}])&&fs(n.prototype,r),i&&fs(n,i),e}(),ms=new ut.a(0,0),bs=null,gs=!1;function ws(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var As=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.velocity=new ut.a(0,0),this.torque=0,this.spin=0,this.growth=new ut.a(1,1),this.acceleration=new ut.a(1,1),this.initialScale=new ut.a(1,1),this.fade=!1,this.deflate=!1,this.gravity=new ut.a(0,0),this.lifespan=0,this.lifespanTotal=0,this.dead=!1,this.entity=null,this.system=null,this.oscillation=null,this.oscillationOffset=0,this.Renew(e,n)}var e,n,r;return e=t,r=[{key:"USE_POOL",get:function(){return Cs},set:function(t){Cs=!!t}},{key:"Pool",get:function(){return Ss}}],(n=[{key:"Process",value:function(){if(!0!==this.dead)if(this.lifespan++<this.lifespanTotal){var t=this.entity,e=this.velocity,n=1-this.lifespan/this.lifespanTotal,r=this.oscillation;if(e.AddV(this.gravity).MultiplyV(this.acceleration),0!==this.torque&&e.Rotate(this.torque),t.position.AddV(e),!0===this.fade&&(t.alpha=n),!0===this.deflate?t.scale.Set(n*this.initialScale.x,n*this.initialScale.y):t.scale.MultiplyV(this.growth),t.rotation+=this.spin,null!==r&&!0===r.active){var i=this.lifespan+this.oscillationOffset;null!=r.torque&&!0===r.torque.active&&(this.torque=Object(B.Oscillate)(i,r.torque.from,r.torque.to,r.torque.amplitude)),null!=r.spin&&!0===r.spin.active&&(this.spin=Object(B.Oscillate)(i,r.spin.from,r.spin.to,r.spin.amplitude)),null!=r.velocityX&&!0===r.velocityX.active&&(this.velocity.x=Object(B.Oscillate)(i,r.velocityX.from,r.velocityX.to,r.velocityX.amplitude)),null!=r.velocityY&&!0===r.velocityY.active&&(this.velocity.y=Object(B.Oscillate)(i,r.velocityY.from,r.velocityY.to,r.velocityY.amplitude)),null!=r.gravityX&&!0===r.gravityX.active&&(this.gravity.x=Object(B.Oscillate)(i,r.gravityX.from,r.gravityX.to,r.gravityX.amplitude)),null!=r.gravityY&&!0===r.gravityY.active&&(this.gravity.y=Object(B.Oscillate)(i,r.gravityY.from,r.gravityY.to,r.gravityY.amplitude)),null!=r.accelerationX&&!0===r.accelerationX.active&&(this.acceleration.x=Object(B.Oscillate)(i,r.accelerationX.from,r.accelerationX.to,r.accelerationX.amplitude)),null!=r.accelerationY&&!0===r.accelerationY.active&&(this.acceleration.y=Object(B.Oscillate)(i,r.accelerationY.from,r.accelerationY.to,r.accelerationY.amplitude)),null!=r.growthX&&!0===r.growthX.active&&(this.growth.x=Object(B.Oscillate)(i,r.growthX.from,r.growthX.to,r.growthX.amplitude)),null!=r.growthY&&!0===r.growthY.active&&(this.growth.y=Object(B.Oscillate)(i,r.growthY.from,r.growthY.to,r.growthY.amplitude))}}else this.dead=!0,this.entity.display=!1}},{key:"Renew",value:function(t,e){if(null!=t){this.dead=!1;var n=this.entity;if(null==t.texture)throw new Error("No texture or controller provided!");if(null===n?(n=this.entity=new vs(0,0,t.texture,t.unitId),null!=t.anchor&&(n.anchor.SetV(t.anchor),n.UpdateTextureTransform())):this.ResetEntity(t.unitId),null!=t.frames&&(t.frames[Object(j.RandomInteger)(0,t.frames.length-1)].Apply(n),n.scale.SetSame(1),n.UpdateTextureTransform()),this.RenewVector(t.position,n.position,e,0,0),this.RenewVector(t.velocity,this.velocity,e,0,0),this.RenewVector(t.gravity,this.gravity,e,0,0),this.RenewVector(t.acceleration,this.acceleration,e,1,1),this.RenewVector(t.growth,this.growth,e,1,1),this.RenewVector(t.scale,n.scale,e,1,1),this.RenewVector(t.scale,this.initialScale,e,1,1),null!=t.rotation?n.rotation=Object(j.MinMaxOrValue)(t.rotation):n.rotation=0,null!=t.lifespan?this.SetLifespan(t.lifespan):this.SetLifespan(0),null!=t.torque?this.torque=Object(j.MinMaxOrValue)(t.torque):this.torque=0,null!=t.spin?this.spin=Object(j.MinMaxOrValue)(t.spin):this.spin=0,null!=t.fade?this.fade=t.fade:this.fade=!1,null!=t.deflate?this.deflate=t.deflate:this.deflate=!1,null!=t.oscillation){var r=t.oscillation,i=this.oscillation;null===i&&(i=this.oscillation=new sa),i.active=!0,null!=r.offset?this.oscillationOffset=Object(j.MinMaxOrValue)(r.offset):this.oscillationOffset=0,null!=r.torque?i.SetOscillatingObject("torque",r.torque.from,r.torque.to,r.torque.amplitude):i.Nullify("torque"),null!=r.spin?i.SetOscillatingObject("spin",r.spin.from,r.spin.to,r.spin.amplitude):i.Nullify("spin"),null!=r.velocity&&(null!=r.velocity.x?i.SetOscillatingObject("velocityX",r.velocity.x.from,r.velocity.x.to,r.velocity.x.amplitude):i.Nullify("velocityX"),null!=r.velocity.y?i.SetOscillatingObject("velocityY",r.velocity.y.from,r.velocity.y.to,r.velocity.y.amplitude):i.Nullify("velocityY")),null!=r.gravity&&(null!=r.gravity.x?i.SetOscillatingObject("gravityX",r.gravity.x.from,r.gravity.x.to,r.gravity.x.amplitude):i.Nullify("gravityX"),null!=r.gravity.y?i.SetOscillatingObject("gravityY",r.gravity.y.from,r.gravity.y.to,r.gravity.y.amplitude):i.Nullify("gravityY")),null!=r.acceleration&&(null!=r.acceleration.x?i.SetOscillatingObject("accelerationX",r.acceleration.x.from,r.acceleration.x.to,r.acceleration.x.amplitude):i.Nullify("accelerationX"),null!=r.acceleration.y?i.SetOscillatingObject("accelerationY",r.acceleration.y.from,r.acceleration.y.to,r.acceleration.y.amplitude):i.Nullify("accelerationY")),null!=r.growth&&(null!=r.growth.x?i.SetOscillatingObject("growthX",r.growth.x.from,r.growth.x.to,r.growth.x.amplitude):i.Nullify("growthX"),null!=r.growth.y?i.SetOscillatingObject("growthY",r.growth.y.from,r.growth.y.to,r.growth.y.amplitude):i.Nullify("growthY"))}else null!==this.oscillation&&(this.oscillation.active=!1)}}},{key:"RenewVector",value:function(t,e,n,r,i){null!=t?null!=t.points?null!=t.moduloWrapper?(null!=t.indexGap&&(n+=t.indexGap),e.SetV(t.points[n%t.moduloWrapper])):e.SetV(Object(j.RandomInArray)(t.points)):null!=t.xy?e.SetSame(Object(j.MinMaxOrValue)(t.xy)):(null!=t.x?e.x=Object(j.MinMaxOrValue)(t.x):e.x=r,null!=t.y?e.y=Object(j.MinMaxOrValue)(t.y):e.y=i):e.Set(r,i)}},{key:"SetLifespan",value:function(t){this.lifespan=0,this.lifespanTotal=Object(j.MinMaxOrValue)(t)}},{key:"ResetEntity",value:function(t){var e=this.entity;null!=t&&e.SetTexture(e.programController["originalTexture"+t]),e.scale.SetSame(1),e.alpha=1,e.display=!0,e.rotation=0}},{key:"Destroy",value:function(t){return(!0!==t||!1!==this.dead)&&(null!==this.system&&this.system.RemoveParticle(this),Cs&&Ss.Store(this),!0)}}])&&ws(e.prototype,n),r&&ws(e,r),t}(),Ss=new na.a,Cs=!0;function Ts(t){return(Ts="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Es(t){return(Es=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ps(t,e){return(Ps=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}Ss.Retrieve=function(t,e){this.PreRetrieve();var n=this.objects.pop();return n.Renew(t,e),n},Ss.Flood(function(){return new As},1e3);var Os=function(t){function e(t,n){var r,i,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i=this,(r=!(o=Es(e).call(this,t,n))||"object"!==Ts(o)&&"function"!=typeof o?_s(i):o).particles=[],r.deletionTimer=new Pr(60),r.deletionTimer.onFinish.Add(r.HandleParticleDeletion,_s(_s(r))),r.deletionTimer.Start(),r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ps(t,e)}(e,Fa),n=e,(r=[{key:"Process",value:function(){this.HandleParticles(),this.deletionTimer.Process()}},{key:"HandleParticles",value:function(){for(var t=this.particles,e=0;e<t.length;++e)t[e].Process()}},{key:"HandleParticleDeletion",value:function(){for(var t=this.particles,e=t[0],n=0;n<t.length;e=t[++n])e&&e.Destroy(!0)&&n--;this.deletionTimer.Start()}},{key:"AddParticle",value:function(t){return t.system=this,this.AddChild(t.entity),this.particles.push(t),t}},{key:"RemoveParticle",value:function(t){var e=this.particles,n=e.indexOf(t);if(-1!==n)return t.system=null,this.RemoveChild(t.entity),e.fickleSplice(n)}},{key:"Emit",value:function(t){for(var e=0;e<t.amount;++e)!0===As.USE_POOL?this.AddParticle(As.Pool.Retrieve(t,e)):this.AddParticle(new As(t,e))}}])&&xs(n.prototype,r),i&&xs(n,i),e}(),Rs=function(t,e,n){t.setTransform(1,0,0,1,0,0),t.globalAlpha=.25,t.strokeStyle="rgba(255, 0, 255, 1)",t.fillStyle="rgba(0, 255, 0, 1)",null!=n&&(null!=n.alpha&&(t.globalAlpha=n.alpha),null!=n.strokeStyle&&(t.strokeStyle=n.strokeStyle),null!=n.fillStyle&&(t.fillStyle=n.fillStyle)),t.lineWidth=2,t.beginPath(),t.moveTo(e.tl.x,e.tl.y),t.lineTo(e.br.x,e.tl.y),t.lineTo(e.br.x,e.br.y),t.lineTo(e.tl.x,e.br.y),t.closePath(),null!=n?(null==n.noStroke&&t.stroke(),null==n.noFill&&t.fill()):(t.stroke(),t.fill())};function Ds(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ks=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.root=null,this.propW="width",this.propH="height",this.w=e,this.h=n,this.__dynamic=!e,this.padding=new ut.a(0,0)}var e,n,r;return e=t,(n=[{key:"Pack",value:function(t,e){var n=t.length,r=this.propW,i=this.propH,o=this.padding.x,a=this.padding.y,s=t[0],u=s[r]+o,l=s[i]+a,c=null,h=[];this.root=new pe(0,0,0,0).SetXYWH(0,0,this.w,this.h);for(var f=0;f<n;s=t[++f])if(u=s[r]+o,l=s[i]+a,f===n-1&&(u-=o,l-=a),(c=this.Find(this.root,u,l))&&(h[f]=this.Partition(c,u,l)),null==h[f]&&!0!==e)throw new Error(Is);return h}},{key:"PackDynamic",value:function(t,e){var n=t.length,r=this.propW,i=this.propH,o=this.padding.x,a=this.padding.y,s=t[0],u=s[r]+o,l=s[i]+a,c=null,h=[];this.root=new pe(0,0,0,0).SetXYWH(0,0,u,l);for(var f=0;f<n;s=t[++f])if(u=s[r]+o,l=s[i]+a,f===n-1&&(u-=o,l-=a),c=this.Find(this.root,u,l),h[f]=c?this.Partition(c,u,l):this.Extend(u,l),null==h[f]&&!0!==e)throw new Error(Is);return h}},{key:"Find",value:function(t,e,n){return t.vertical&&t.horizontal?this.Find(t.horizontal,e,n)||this.Find(t.vertical,e,n):e<=t.w&&n<=t.h?t:null}},{key:"Partition",value:function(t,e,n){return t.vertical=new pe(0,0,0,0).SetXYWH(t.tl.x,t.tl.y+n,t.w,t.h-n),t.horizontal=new pe(0,0,0,0).SetXYWH(t.tl.x+e,t.tl.y,t.w-e,n),t}},{key:"Extend",value:function(t,e){var n=t<=this.root.w,r=e<=this.root.h,i=n&&this.root.w>=this.root.h+e;return r&&this.root.h>=this.root.w+t?this.ExtendAxis(t,e):i?this.ExtendAxis(t,e,!0):r?this.ExtendAxis(t,e):n?this.ExtendAxis(t,e,!0):null}},{key:"ExtendAxis",value:function(t,e,n){var r=null;n?((r=new pe(0,0,0,0).SetXYWH(0,0,this.root.w,this.root.h+e)).horizontal=this.root,r.vertical=new pe(0,0,0,0).SetXYWH(0,this.root.h,this.root.w,e)):((r=new pe(0,0,0,0).SetXYWH(0,0,this.root.w+t,this.root.h)).vertical=this.root,r.horizontal=new pe(0,0,0,0).SetXYWH(this.root.w,0,t,this.root.h)),this.root=r;var i=this.Find(this.root,t,e);return i?this.Partition(i,t,e):null}},{key:"UseProp",value:function(t,e){return this.propW=t,this.propH=e,this}},{key:"SetSize",value:function(t,e){return this.w=t,this.h=e,this.dynamic=!0,this}},{key:"SetPadding",value:function(t,e){return this.padding.Set(t,e),this}}])&&Ds(e.prototype,n),r&&Ds(e,r),t}(),Is="Size error!";function Ls(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var js=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.element.setAttribute&&this.element.setAttribute("tabindex","1"),this.element.focus&&this.element.focus(),this.___bound___OnKeyDown=this.OnKeyDown.bind(this),this.___bound___OnKeyUp=this.OnKeyUp.bind(this),this.element.addEventListener("keydown",this.___bound___OnKeyDown),this.element.addEventListener("keyup",this.___bound___OnKeyUp),this.onDown=new Tr,this.onUp=new Tr}var e,n,r;return e=t,(n=[{key:"OnKeyDown",value:function(t){t.stopPropagation(),this.onDown.Dispatch(this.element,t)}},{key:"OnKeyUp",value:function(t){t.stopPropagation(),this.onUp.Dispatch(this.element,t)}},{key:"Destroy",value:function(){this.element.removeEventListener("keydown",this.___bound___OnKeyDown),this.element.removeEventListener("keyup",this.___bound___OnKeyUp)}}])&&Ls(e.prototype,n),r&&Ls(e,r),t}();function Bs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Gs=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.position=new ut.a,this.scale=new ut.a(1,1),this.offset=new ut.a(n,r),this.eventData={position:this.position,native:null},this.offsets=[],this.___bound___OnMove=this.OnMove.bind(this),this.___bound___OnDown=this.OnDown.bind(this),this.___bound___OnUp=this.OnUp.bind(this),this.___bound___OnLeave=this.OnLeave.bind(this),this.___bound___OnWheel=this.OnWheel.bind(this),this.element.addEventListener("mousemove",this.___bound___OnMove),this.element.addEventListener("mousedown",this.___bound___OnDown),this.element.addEventListener("mouseup",this.___bound___OnUp),this.element.addEventListener("mouseleave",this.___bound___OnLeave),this.element.addEventListener("wheel",this.___bound___OnWheel,{passive:!0}),this.onMove=new Tr,this.onDown=new Tr,this.onUp=new Tr,this.onLeave=new Tr,this.onWheel=new Tr}var e,n,r;return e=t,(n=[{key:"OnMove",value:function(t){return this.CalculatePosition(t.clientX,t.clientY),this.eventData.native=t,this.onMove.Dispatch(this.element,this.eventData),!1}},{key:"OnDown",value:function(t){t.stopPropagation(),this.CalculatePosition(t.clientX,t.clientY),this.eventData.native=t,this.onDown.Dispatch(this.element,this.eventData)}},{key:"OnUp",value:function(t){t.stopPropagation(),this.CalculatePosition(t.clientX,t.clientY),this.eventData.native=t,this.onUp.Dispatch(this.element,this.eventData)}},{key:"OnLeave",value:function(t){t.stopPropagation(),this.CalculatePosition(t.clientX,t.clientY),this.eventData.native=t,this.onLeave.Dispatch(this.element,this.eventData)}},{key:"OnWheel",value:function(t){t.stopPropagation(),this.CalculatePosition(t.clientX,t.clientY),this.eventData.native=t,this.onWheel.Dispatch(this.element,this.eventData)}},{key:"CalculatePosition",value:function(t,e){var n=this.offsets,r=this.position,i=this.element.getBoundingClientRect();r.Set(t,e).Subtract(i.left,i.top).SubtractV(this.offset).DivideV(this.scale);for(var o=0;o<n.length;++o)r.SubtractV(n[o])}},{key:"AddOffset",value:function(t){return this.offsets.push(t),this}},{key:"Destroy",value:function(){this.element.removeEventListener("mousemove",this.___bound___OnMove),this.element.removeEventListener("mousedown",this.___bound___OnDown),this.element.removeEventListener("mouseup",this.___bound___OnUp),this.element.removeEventListener("mouseleave",this.___bound___OnLeave),this.element.removeEventListener("wheel",this.___bound___OnWheel)}},{key:"x",get:function(){return this.position.x}},{key:"y",get:function(){return this.position.y}}])&&Bs(e.prototype,n),r&&Bs(e,r),t}();function Vs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ns=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.position=new ut.a,this.scale=new ut.a(1,1),this.offset=new ut.a(n,r),this.eventData={position:this.position,native:null},this.offsets=[],this.___bound___OnMove=this.OnMove.bind(this),this.___bound___OnStart=this.OnStart.bind(this),this.___bound___OnEnd=this.OnEnd.bind(this),this.___bound___OnCancel=this.OnCancel.bind(this),this.element.addEventListener("touchmove",this.___bound___OnMove),this.element.addEventListener("touchstart",this.___bound___OnStart),this.element.addEventListener("touchend",this.___bound___OnEnd),this.element.addEventListener("touchcancel",this.___bound___OnCancel),this.onMove=new Tr,this.onStart=new Tr,this.onEnd=new Tr,this.onCancel=new Tr}var e,n,r;return e=t,(n=[{key:"OnMove",value:function(t){return t.stopPropagation(),this.CalculatePosition(t.touches.item(0).clientX,t.touches.item(0).clientY),this.eventData.native=t,this.onMove.Dispatch(this.element,this.eventData),!1}},{key:"OnStart",value:function(t){t.stopPropagation(),this.CalculatePosition(t.touches.item(0).clientX,t.touches.item(0).clientY),this.eventData.native=t,this.onStart.Dispatch(this.element,this.eventData)}},{key:"OnEnd",value:function(t){t.stopPropagation(),this.eventData.native=t,this.onEnd.Dispatch(this.element,this.eventData)}},{key:"OnCancel",value:function(t){t.stopPropagation(),this.eventData.native=t,this.onCancel.Dispatch(this.element,this.eventData)}},{key:"CalculatePosition",value:function(t,e){var n=this.offsets,r=this.position,i=this.element.getBoundingClientRect();r.Set(t,e).Subtract(i.left,i.top).SubtractV(this.offset).DivideV(this.scale);for(var o=0;o<n.length;++o)r.SubtractV(n[o])}},{key:"AddOffset",value:function(t){return this.offsets.push(t),this}},{key:"Destroy",value:function(){this.element.removeEventListener("touchmove",this.___bound___OnMove),this.element.removeEventListener("touchstart",this.___bound___OnStart),this.element.removeEventListener("touchend",this.___bound___OnEnd),this.element.removeEventListener("touchcancel",this.___bound___OnCancel)}},{key:"x",get:function(){return this.position.x}},{key:"y",get:function(){return this.position.y}}])&&Vs(e.prototype,n),r&&Vs(e,r),t}();function Fs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Us=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=0}var e,n,r;return e=t,(n=[{key:"Add",value:function(t){this.value|=t}},{key:"Remove",value:function(t){this.value=this.value&~t}},{key:"Compare",value:function(t){return 0!=(this.value&t)}},{key:"Holds",value:function(t){return(this.value&t)===t}},{key:"Toggle",value:function(t){this.value^=t}}])&&Fs(e.prototype,n),r&&Fs(e,r),t}();function Ms(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Xs=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.NONE=0,this.next=1}var e,n,r;return e=t,(n=[{key:"Add",value:function(t){void 0===this[t=t.toUpperCase()]&&(this[t]=this.next,this.next=this.next<<1)}}])&&Ms(e.prototype,n),r&&Ms(e,r),t}(),Hs=n(10);function Ys(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ws=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.orders=[],this.classUsed=null,this.amount=1,this.locked=!1}var e,n,r;return e=t,(n=[{key:"Many",value:function(t){return this.amount=t,this}},{key:"Bind",value:function(t,e){return e&&(this.orders.length=0),this.orders.push(t),this}},{key:"Make",value:function(t){var e=this.amount,n=Object(j.CreateIteratorArgs)(arguments,"@","i");if(!0===this.locked)throw new Error('"Make" called twice before end!');this.locked=!0,this.orders.length=0,this.classUsed=t;for(var r=0;r<e;++r)qs(arguments,n,r),this.orders.push(new(Function.prototype.bind.apply(t,arguments)));return this}},{key:"Call",value:function(t,e,n){var r,i,o,a=this.orders,s=Object(j.IsArray)(e),u="string"==typeof t,l=a[0];!0===s&&(o=Object(j.CreateIteratorArgs)(e,"@","i"));for(var c=0;c<a.length;l=a[++c])!0===s&&(i=e.slice(),Object(j.ReplaceArgumentWithObjectValue)(l,i,"$"),qs(i,o,c)),!1===u&&null!=n?("$"===n[0]&&(n=n.slice(1),console.warn("No need for '$' on property arguments")),Object(j.Nested)(l,n,!1,!0,t.apply(null,i))):!1===u?t.apply(null,i):(r=Object(j.Nested)(l,t,!0),Object(j.Nested)(l,t).apply(r,i));return this}},{key:"Cast",value:function(t,e){for(var n=this.orders,r="string"==typeof e,i=0;i<n.length;++i)!0===r&&"$"===e[0]&&(e=Object(j.Nested)(n[i],e)),Object(j.Nested)(n[i],t,!1,!0,e);return this}},{key:"Done",value:function(){return this.amount=1,this.locked=!1,this.orders[0]}},{key:"Mass",value:function(){return this.amount=1,this.locked=!1,this.orders}},{key:"Ship",value:function(t){this.amount=1,this.locked=!1;var e=!0===t?this.orders.slice():this.orders[0];return this.orders.length=0,e}}])&&Ys(e.prototype,n),r&&Ys(e,r),t}(),qs=function(t,e,n){if(null!=e)for(var r=0,i=e[r];r<e.length;i=e[++r])if(-1!==i.iteratorIndex)if(i.mod&&i.val)switch(i.mod){case"+":t[i.iteratorIndex]=n+parseInt(i.val);break;case"*":t[i.iteratorIndex]=n*parseInt(i.val);break;case"-":t[i.iteratorIndex]=n-parseInt(i.val);break;case"/":t[i.iteratorIndex]=n/parseInt(i.val);break;case"%":t[i.iteratorIndex]=n%parseInt(i.val);break;default:throw new Error("Bad mod!")}else t[i.iteratorIndex]=n},zs=n(8);function Ks(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Js=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=e,this.w=n,this.h=r,this.aspectRatio=Object(B.SimplifyAspectRatio)(n,r),this.onChange=new Tr,this.mode=i,this.stage=null,this.culler=null,this.cullerAabbOrig=null,this.rootContainer=null,this.currentWidth=0,this.currentHeight=0,e.setAttribute("width",n),e.setAttribute("height",r),this.___bound___OnWindowRsize=this.OnWindowResize.bind(this),window.addEventListener("resize",this.___bound___OnWindowRsize)}var e,n,r;return e=t,r=[{key:"FILL_SCREEN",get:function(){return Qs}},{key:"KEEP_ASPECT_RATIO",get:function(){return $s}},{key:"KEEP_ASPECT_RATIO_MIN",get:function(){return Zs}},{key:"KEEP_ASPECT_RATIO_MAX",get:function(){return tu}},{key:"KEEP_ASPECT_RATIO_FIT",get:function(){return eu}}],(n=[{key:"OnWindowResize",value:function(){this[this.mode]()}},{key:"Trigger",value:function(){return this.OnWindowResize(),this}},{key:"Reconfigure",value:function(t,e,n){return this.w=t,this.h=e,this.mode=n,this}},{key:"BindStage",value:function(t){return this.stage=t,this}},{key:"BindRootContainer",value:function(t){return this.rootContainer=t,this}},{key:"BindCuller",value:function(t){return this.culler=t,this.cullerAabbOrig=new pe(0,0,0,0),this.cullerAabbOrig.SetC(t.bounds),this}},{key:"SetCurrent",value:function(t,e){t|=0,e|=0,this.canvas.setAttribute("width",t),this.canvas.setAttribute("height",e),this.currentWidth=t,this.currentHeight=e;var n=t/this.w,r=e/this.h;null!==this.stage&&(this.stage.w=t,this.stage.h=e,this.stage.mouse&&this.stage.mouse.scale.Set(n,r),this.stage.touch&&this.stage.touch.scale.Set(n,r),!0===this.stage.usingWebGL&&this.stage.GLConfig()),null!==this.rootContainer&&this.rootContainer.scale.Set(n,r),null!==this.culler&&(this.culler.bounds.SetC(this.cullerAabbOrig),this.culler.bounds.Scale(n,r))}},{key:"FillScreen",value:function(){this.SetCurrent(window.innerWidth,window.innerHeight)}},{key:"KeepAspectRatio",value:function(){var t=window.innerWidth,e=t/this.aspectRatio[0]*this.aspectRatio[1];this.SetCurrent(t,e)}},{key:"KeepAspectRatioMIN",value:function(){var t,e=window.innerWidth;e<=this.w&&(e=this.w),t=e/this.aspectRatio[0]*this.aspectRatio[1],this.SetCurrent(e,t)}},{key:"KeepAspectRatioMAX",value:function(){var t,e=window.innerWidth;e>=this.w&&(e=this.w),t=e/this.aspectRatio[0]*this.aspectRatio[1],this.SetCurrent(e,t)}},{key:"KeepAspectRatioFIT",value:function(){var t=window.innerWidth,e=t/this.aspectRatio[0]*this.aspectRatio[1];e>=window.innerHeight&&(t=(e=window.innerHeight)/this.aspectRatio[1]*this.aspectRatio[0]),this.SetCurrent(t,e)}},{key:"Destroy",value:function(){window.removeEventListener("resize",this.___bound___OnWindowRsize)}}])&&Ks(e.prototype,n),r&&Ks(e,r),t}(),Qs="FillScreen",$s="KeepAspectRatio",Zs="KeepAspectRatioMIN",tu="KeepAspectRatioMAX",eu="KeepAspectRatioFIT";function nu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ru=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nodes={},this.objects=[],this.convergence=[],this.objectCap=0,this.levelCap=0,this.level=0,this.aabb=null,this.hasSplit=!1,this.Set(e,n,r,i)}var e,n,r;return e=t,r=[{key:"pool",get:function(){return uu}},{key:"USE_POOL",get:function(){return lu},set:function(t){lu=!!t}}],(n=[{key:"Set",value:function(t,e,n,r){return this.aabb=t,this.level=e,this.objectCap=n,this.levelCap=r,this}},{key:"FromPool",value:function(e,n,r,i){return!0===lu?uu.Retrieve(e,n,r,i):new t(e,n,r,i)}},{key:"Store",value:function(){uu.Store(this)}},{key:"Add",value:function(t){var e=0,n="",r=this.objects,i=this.nodes;if(!0!==this.hasSplit||null===(n=this.Marking(t))){if(r.push(t),this.level<this.levelCap&&r.length>this.objectCap)for(!1===this.hasSplit&&this.Split();e<r.length;)null!==(n=this.Marking(r[e]))?i[n].Add(r.fickleSplice(e)):++e}else i[n].Add(t)}},{key:"Converge",value:function(t){var e="",n=this.nodes,r=this.convergence;return r.length=0,r.push.apply(r,this.objects),!0===this.hasSplit&&(null!==(e=this.Marking(t))?r.push.apply(r,n[e].Converge(t)):(r.push.apply(r,n[iu].Converge(t)),r.push.apply(r,n[ou].Converge(t)),r.push.apply(r,n[au].Converge(t)),r.push.apply(r,n[su].Converge(t)))),r}},{key:"Split",value:function(){var t=this.level+1,e=this.objectCap,n=this.levelCap,r=this.nodes,i=this.aabb;r[iu]=this.FromPool(i.GetQuadrant(iu),t,e,n),r[ou]=this.FromPool(i.GetQuadrant(ou),t,e,n),r[au]=this.FromPool(i.GetQuadrant(au),t,e,n),r[su]=this.FromPool(i.GetQuadrant(su),t,e,n),this.hasSplit=!0}},{key:"Dump",value:function(){var t=this.nodes;this.objects.length=0,!0===this.hasSplit&&(t[iu].Dump(),t[ou].Dump(),t[au].Dump(),t[su].Dump(),!0===lu&&(t[iu].Store(),t[ou].Store(),t[au].Store(),t[su].Store())),this.nodes={},this.hasSplit=!1}},{key:"Marking",value:function(t){var e=this.nodes;return!0===e[iu].aabb.ContainsAABB2D(t)?iu:!0===e[ou].aabb.ContainsAABB2D(t)?ou:!0===e[au].aabb.ContainsAABB2D(t)?au:!0===e[su].aabb.ContainsAABB2D(t)?su:null}},{key:"ConcatNodes",value:function(t){var e=this.nodes;return void 0===t&&(t=[]),t.push(this),!1===this.hasSplit?t:(e[iu].ConcatNodes(t),e[ou].ConcatNodes(t),e[au].ConcatNodes(t),e[su].ConcatNodes(t),t)}}])&&nu(e.prototype,n),r&&nu(e,r),t}(),iu="TL",ou="TR",au="BL",su="BR",uu=new na.a,lu=!0;function cu(t){return(cu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fu(t){return(fu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function du(t,e){return(du=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function pu(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}uu.Retrieve=function(t,e,n,r){return this.PreRetrieve(),this.objects.pop().Set(t,e,n,r)},uu.Flood(function(){return new ru(null,0,0,0)},500);var yu=function(t){function e(t){var n,r,i;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,n=!(i=fu(e).call(this,0,0))||"object"!==cu(i)&&"function"!=typeof i?pu(r):i,"string"==typeof t.canvas&&(t.canvas=document.getElementById(t.canvas)),n.canvas=t.canvas,n.w=t.canvas.width,n.h=t.canvas.height,n.id=null,n.backgroundColor="rgba(10,20,30,1)",n.clear=!0,n.fill=!0,n.usingWebGL=!1,n.canvasManager=null,n.mouse=null,n.touch=null,n.ticker=null,null==t.mode||"webgl2"!==t.mode.toLowerCase()&&"webgl"!==t.mode.toLowerCase())n.rc=t.canvas.getContext("2d"),console.log("%cCanvas 2D!","color:#f0f7da;background-color:#234d20;font-family:Arial;font-size:18px;font-weight:900;padding:5px;"),!0!==t.noTicker&&(n.ticker=new Or(n.Process.bind(pu(pu(n))),60,t.halt));else{if(n.gl=t.canvas.getContext(t.mode.toLowerCase(),{antialias:t.antialias,powerPreference:t.powerPreference,preserveDrawingBuffer:!0}),null!=n.gl?console.log("%cWebGL!","color:#f0f7da;background-color:#234d20;font-family:Arial;font-size:18px;font-weight:900;padding:5px;"):(n.gl=t.canvas.getContext("experimental-webgl"),null!=n.gl&&console.warn("Experimental WebGL!")),null==n.gl)throw new Error("WebGL is not supported!");n.gl.clearColor(.0392156862745098,.0784313725490196,.11764705882352941,1),n.usingWebGL=!0,!0!==t.noTicker&&(n.ticker=new Or(n.GLProcess.bind(pu(pu(n))),60,t.halt)),n.GLConfig(n.gl)}return null!=t.backgroundColor&&(n.backgroundColor=t.backgroundColor),!1===t.clear&&(n.clear=!1),!1===t.fill&&(n.fill=!1),null!=t.id&&(n.id=t.id),n.onProcess=new Tr,!0!==t.noMouse&&(n.mouse=new Gs(t.canvas,0,0)),!0!==t.noKeyboard&&(n.keyboard=new js(t.canvas)),!0!==t.noTouch&&(n.touch=new Ns(t.canvas,0,0)),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&du(t,e)}(e,Fa),n=e,(r=[{key:"PreRender",value:function(t){t.setTransform(1,0,0,1,0,0),t.globalAlpha=1,t.globalCompositeOperation=ke,!0===this.fill?(t.fillStyle=this.backgroundColor,t.fillRect(0,0,this.w,this.h)):!0===this.clear&&t.clearRect(0,0,this.w,this.h)}},{key:"GLConfig",value:function(t){null==t&&(t=this.gl),this.position.Set(-1,1),this.scale.Set(2/this.w,-2/this.h),this.UpdateTransform(),t.viewport(0,0,this.w,this.h),t.enable(t.BLEND),t.disable(t.DEPTH_TEST),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)}},{key:"GLPreRender",value:function(t){!0===this.clear&&t.clear(t.COLOR_BUFFER_BIT)}},{key:"GLPostRender",value:function(t){t.flush()}},{key:"Process",value:function(t){this.Render(this.rc),this.onProcess.Dispatch(this,t)}},{key:"GLProcess",value:function(t){this.GLRender(this.gl),this.onProcess.Dispatch(this,t)}},{key:"MixedProcess",value:function(t){!0===this.usingWebGL?this.GLRender(this.gl):this.Render(this.rc),this.onProcess.Dispatch(this,t)}},{key:"SetFramebuffer",value:function(t,e){null==t&&(t=this.gl),null==e?(t.viewport(0,0,this.w,this.h),t.bindFramebuffer(t.FRAMEBUFFER,null)):(t.viewport(0,0,e.w,e.h),t.bindFramebuffer(t.FRAMEBUFFER,e.frameBuffer),t.clear(t.COLOR_BUFFER_BIT))}},{key:"Destroy",value:function(){this.Dump(),null!==this.keyboard&&this.keyboard.Destroy(),null!==this.mouse&&this.mouse.Destroy(),null!==this.touch&&this.touch.Destroy(),null!==this.ticker&&this.ticker.Stop()}}])&&hu(n.prototype,r),i&&hu(n,i),e}();function vu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var mu=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.stages=[],this.currentStage=null,this.onlyCurrent=!1,this.options=null,this.ticker=new Or(this.Process.bind(this),60,e.halt),this.SetOptions(e)}var e,n,r;return e=t,(n=[{key:"SetOptions",value:function(t){null!=t&&(this.options=t)}},{key:"CreateStage2D",value:function(t){var e,n=document.createElement("canvas");"string"==typeof t&&(e=t,t=null),null==t&&(t=this.options),null==t&&(t={}),null!==e&&(t.id=e),null!=t.width&&(n.width=t.width),null!=t.height&&(n.height=t.height),null!=t.className&&(n.className=t.className),null==t.rootNode&&(t.rootNode=document.body),t.rootNode.appendChild(n),t.canvas=n,t.noTicker=!0,t.halt=!0;var r=new yu(t);return t.id=null,t.canvas=null,this.stages.push(r),r}},{key:"GetStages",value:function(){for(var t=this.stages,e=[],n=0;n<t.length;++n)for(var r=0;r<arguments.length;++r)t[n].id===arguments[r]&&e.push(t[n]);return e}},{key:"Process",value:function(t){for(var e=this.stages,n=0;n<e.length;++n)e[n].MixedProcess(t)}},{key:"Destroy",value:function(){for(var t=this.stages,e=0;e<t.length;++e)t[e].Destroy();this.ticker.Stop()}}])&&vu(e.prototype,n),r&&vu(e,r),t}();function bu(t){return(bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wu(t,e){return!e||"object"!==bu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Au(t){return(Au=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Su(t,e){return(Su=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Cu=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=wu(this,Au(e).call(this,t,n,null==r?Tu:r,i))).pattern=null,o.patternOffset=new ut.a(0,0),o}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Su(t,e)}(e,Za),n=e,i=[{key:"BUILD_DEFAULT_TEXTURE",value:function(t){if(!0===xu)throw new Error("Function can only be called once!");Tu=new Si(H(X(function(){var t=new ar([0,0,64,0,64,64,0,64,0,0,32,32,64,0,32,32,64,64,32,32,0,64]);return t.ComputeBounds(),t.style.stroke.lineWidth=3,new ls(0,0,t)}),64,64,t),"__DEFAULT_TILESPRITE_TEXTURE__",64,64,64,64),xu=!0}},{key:"DEFAULT_TEXTURE",get:function(){return Tu}}],(r=[{key:"Render",value:function(t){this.PreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),!0===this.display&&null!==this.pattern&&(this.transform.ApplyGlobal(t),t.globalAlpha=this.tint.channel[3],t.globalCompositeOperation=this.gco,t.fillStyle=this.pattern,t.beginPath(),t.rect(0,0,this.w,this.h),t.closePath(),t.translate(this.patternOffset.x,this.patternOffset.y),t.fill()),this.children.length>0&&this.RenderChildren(t)),this.PostRender(t)}},{key:"GeneratePattern",value:function(t,e,n){null==this.programController?(this.pattern=t.createPattern(this.texture.image,null),this.w=e,this.h=n,this.scale.SetSame(1)):(this.width=e,this.height=n,this.textureTransformation.SetTransform(0,0,this.scale.x,this.scale.y))}},{key:"OffsetPattern",value:function(t,e){this.patternOffset.Add(t,e),this.textureTransformation.Translate(-t/this.w,-e/this.h)}},{key:"SetPatternOffset",value:function(t,e){this.patternOffset.Set(t,e),this.textureTransformation.TranslateTo(-t/this.w,-e/this.h)}},{key:"GetPatternOffset",value:function(){return this.patternOffset}}])&&gu(n.prototype,r),i&&gu(n,i),e}(),Tu=null,xu=!1;function Eu(t){return(Eu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pu(t,e){return!e||"object"!==Eu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _u(t){return(_u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ou(t,e){return(Ou=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ru=function(t){function e(t,n,r,i,o,a,s,u,l,c,h,f){var d;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(d=Pu(this,_u(e).call(this,n,r))).index=t,d.clipX=i,d.clipY=o,d.w=l,d.h=c,d.textureTranslation=new ya,d.textureTransformation=new ya,d.textureTransformation.SetTransform(h*i/l,f*o/c,h,f),a&&s&&u?(d.textureTranslation.SetTransform(-l,-c,h,f),d.rotation=90*-B.RADIAN,d.scale.y=-1):a&&s?(d.textureTranslation.SetTransform(-l,-c,h,f),d.scale.Set(-1,-1)):a&&u?(d.textureTranslation.SetTransform(0,-c,h,f),d.rotation=90*B.RADIAN):s&&u?(d.textureTranslation.SetTransform(-l,0,h,f),d.rotation=90*-B.RADIAN):a?(d.textureTranslation.SetTransform(-l,0,h,f),d.scale.x=-1):s?(d.textureTranslation.SetTransform(0,-c,h,f),d.scale.y=-1):u?(d.textureTranslation.SetTransform(0,0,h,f),d.rotation=90*B.RADIAN,d.scale.y=-1):d.textureTranslation.SetTransform(0,0,h,f),d}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ou(t,e)}(e,Ea),e}();function Du(t){return(Du="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ku(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Iu(t,e){return!e||"object"!==Du(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lu(t){return(Lu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ju(t,e){return(ju=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bu=function(t){function e(t,n,r,i,o,a){var s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(s=Iu(this,Lu(e).call(this,t,n,r,a))).w=0,s.h=0,s.tileW=0,s.tileH=0,s.columns=0,s.cull=!1,s.tiles=[],s.mapData=i,s.Config(i),s.SetMapLayer(i.layers[o]),s}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ju(t,e)}(e,Za),n=e,(r=[{key:"Config",value:function(t){this.tileW=t.tilewidth,this.tileH=t.tileheight,this.w=this.tileW*t.width,this.h=this.tileH*t.height,this.columns=this.w/this.tileW|0}},{key:"SetMapLayer",value:function(t){var e=t.data;if(t.width*t.height!==e.length)throw new Error(Gu);this.tiles.length=0,this.alpha=t.opacity,this.mapData.orientation===Vu&&this.SetOrthogonal(e)}},{key:"Cull",value:function(t){this.culler=t,this.cull=!0}},{key:"SetOrthogonal",value:function(t){for(var e=t.length,n=this.tileW,r=this.tileH,i=this.texture.fw/n|0,o=this.w/n|0,a=n/this.texture.fw,s=r/this.texture.fh,u=0,l=0,c=0,h=0,f=0,d=0,p=0;p<e;++p)0!==(l=t[p])&&(c=p%o*n,h=(p/o|0)*r,f=(u=Object(j.ClearBit)(31,Object(j.ClearBit)(30,Object(j.ClearBit)(29,l)))-1)%i*n,d=(u/i|0)*r,this.tiles.push(new Ru(u,c,h,f,d,Object(j.IsBitSet)(31,l),Object(j.IsBitSet)(30,l),Object(j.IsBitSet)(29,l),n,r,a,s)))}},{key:"Render",value:function(t){this.PreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),!0===this.display&&(!0===this.cull?this.CullRender(t):this.NoCullRender(t),this.children.length>0&&this.RenderChildren(t))),this.PostRender(t)}},{key:"GLRender",value:function(t){this.GLPreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),!0===this.display&&(!0===this.cull?this.GLCullRender(t):this.GLNoCullRender(t),this.children.length>0&&this.GLRenderChildren(t))),this.GLPostRender(t)}},{key:"CullRender",value:function(t){for(var e=this.texture.image,n=this.tiles,r=this.tileW,i=this.tileH,o=this.culler,a=o.bounds.tl,s=o.bounds.br,u=o.rootMatrix.e,l=o.rootMatrix.f,c=o.rootMatrix.a,h=o.rootMatrix.d,f=n[0],d=null,p=0;p<n.length;f=n[++p])f.ProcessTransform(this),(d=f.GetGlobalPosition()).Subtract(u,l),d.Divide(c,h),d.x>s.x||d.y>s.y||d.x<a.x||d.y<a.y||(f.transform.ApplyGlobal(t),t.drawImage(e,f.clipX,f.clipY,r,i,f.textureTranslation.e,f.textureTranslation.f,r,i))}},{key:"NoCullRender",value:function(t){for(var e=this.texture.image,n=this.tiles,r=this.tileW,i=this.tileH,o=n[0],a=0;a<n.length;o=n[++a])o.ProcessTransform(this),o.transform.ApplyGlobal(t),t.drawImage(e,o.clipX,o.clipY,r,i,o.textureTranslation.e,o.textureTranslation.f,r,i)}},{key:"GLCullRender",value:function(){for(var t=this.programController,e=this.texture.uniformId,n=this.tint.channel,r=this.tiles,i=this.culler,o=i.bounds.tl,a=i.bounds.br,s=i.rootMatrix.e,u=i.rootMatrix.f,l=i.rootMatrix.a,c=i.rootMatrix.d,h=r[0],f=null,d=0;d<r.length;h=r[++d])h.ProcessTransform(this),(f=h.GetGlobalPosition()).Subtract(s,u),f.Divide(l,c),f.x>a.x||f.y>a.y||f.x<o.x||f.y<o.y||t.Execute(h.transform.globalTransform.AsArray(!0),h.textureTranslation.AsArray(!0),h.textureTransformation.AsArray(!0),n,e)}},{key:"GLNoCullRender",value:function(){for(var t=this.programController,e=this.texture.uniformId,n=this.tint.channel,r=this.tiles,i=r[0],o=0;o<r.length;i=r[++o])i.ProcessTransform(this),t.Execute(i.transform.globalTransform.AsArray(!0),i.textureTranslation.AsArray(!0),i.textureTransformation.AsArray(!0),n,e)}}])&&ku(n.prototype,r),i&&ku(n,i),e}(),Gu="Size error!",Vu="orthogonal";function Nu(t){return(Nu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Uu(t,e){return!e||"object"!==Nu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mu(t){return(Mu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xu(t,e){return(Xu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hu=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Uu(this,Mu(e).call(this,t,n))).id=parseInt(r.id),i.cx=parseInt(r.x),i.cy=parseInt(r.y),i.w=parseInt(r.width),i.h=parseInt(r.height),i.xoffset=parseInt(r.xoffset),i.yoffset=parseInt(r.yoffset),i.xadvance=parseInt(r.xadvance),i.yadvance=0,i.kernings=[],i.translation=new ya,i.transformation=new ya,i}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xu(t,e)}(e,Ea),n=e,(r=[{key:"Render",value:function(t,e){t.drawImage(e,this.cx,this.cy,this.width,this.height,this.position.x,this.position.y,this.width,this.height)}},{key:"GLRenderAuto",value:function(t,e,n){this.UpdateMatrices(),t.Execute(this.transform.globalTransform.AsArray(!0),this.translation.AsArray(!0),this.transformation.AsArray(!0),e,n)}},{key:"GLRender",value:function(t,e,n){t.Execute(this.transform.globalTransform.AsArray(!0),this.translation.AsArray(!0),this.transformation.AsArray(!0),e,n)}},{key:"ApplyKernings",value:function(t){for(var e,n=0;n<t.length;++n)e=t[n].attributes,parseInt(e.first)===this.id&&this.kernings.push(parseInt(e.first),parseInt(e.second),parseInt(e.amount))}},{key:"Crunch",value:function(t){if(this.position.SetSame(0),null!=t&&(this.x=t.x+t.xadvance,this.y=this.yadvance=t.yadvance,t.kernings&&t.kernings.length>0&&this.kernings.length>0))for(var e=this.kernings,n=0;n<e.length;n+=3)if(e[n+1]===t.id){this.x+=e[n+2];break}this.position.Add(this.xoffset,this.yoffset)}},{key:"UpdateMatrices",value:function(){if(null!=this.parent){var t=this.parent.texture,e=this.width/t.fw,n=this.height/t.fh;this.UpdateTransform(this.parent),this.translation.SetTransform(0,0,e,n),this.transformation.SetTransform(e*this.cx/this.width,n*this.cy/this.height,e,n)}}}])&&Fu(n.prototype,r),i&&Fu(n,i),e}();function Yu(t){return(Yu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qu(t,e){return!e||"object"!==Yu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zu(t){return(zu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ku(t,e){return(Ku=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ju=function(t){function e(t,n,r,i,o,a){var s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(s=qu(this,zu(e).call(this,t,n,r,a))).fontData=i,s.lineHeight=i.font.common.attributes.lineHeight,s.chars=[],s.maxWidth=1024,s.text="",s.autoUpdateChars=!0,null!=o&&(s.text=o),s.ComputeText(),s}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ku(t,e)}(e,Za),n=e,(r=[{key:"Render",value:function(t){this.PreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),this.transform.ApplyGlobal(t),!0===this.display&&(t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,this.RenderText(t)),this.children.length>0&&this.RenderChildren(t)),this.PostRender(t)}},{key:"GLRender",value:function(t){this.GLPreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),!0===this.display&&null!==this.programController&&this.GLRenderText(t),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchRenderChildren(t):this.GLRenderChildren(t))),this.GLPostRender(t)}},{key:"RenderText",value:function(t){for(var e=this.chars,n=this.texture.image,r=0;r<e.length;++r)e[r].Render(t,n)}},{key:"GLRenderText",value:function(){var t=this.chars;if(!0===this.autoUpdateChars)for(var e=0;e<t.length;++e)t[e].GLRenderAuto(this.programController,this.tint.channel,this.texture.uniformId);else for(e=0;e<t.length;++e)t[e].GLRender(this.programController,this.tint.channel,this.texture.uniformId)}},{key:"ComputeText",value:function(){var t,e,n,r=0,i=0,o=!1,a=0,s=0,u=0,l=0,c=this.chars,h=this.text;this.UpdateTransform(this.parent),c.length=0,this.fontData.font.kernings&&(t=this.fontData.font.kernings.kerning);for(var f=0;f<h.length;++f){var d=h.charCodeAt(f);n=c[f-1-i],10!==d?(e=new Hu(0,0,this.GetCharDataById(d)),null!=t&&e.ApplyKernings(t),e.Crunch(n),u=e.position.x+e.width,l=e.position.y+e.height,(u>this.maxWidth||!0===o)&&(e.position.SetSame(0),e.yadvance=this.lineHeight*++r,e.position.Add(e.xoffset,e.yoffset+e.yadvance),o=!1),u>a&&(a=u),l>s&&(s=l),e.parent=this,e.UpdateMatrices(),c.push(e)):(i++,o=!0)}this.w=a,this.h=s}},{key:"UpdateChars",value:function(){for(var t=this.chars,e=0;e<t.length;++e)t[e].UpdateMatrices()}},{key:"GetCharDataById",value:function(t){for(var e=this.fontData.font.chars.char,n=0;n<e.length;++n)if(parseInt(e[n].attributes.id)===t)return e[n].attributes}},{key:"UpdateInBuffer",value:function(){throw new Error(Qu)}},{key:"GetBufferData",value:function(){throw new Error(Qu)}}])&&Wu(n.prototype,r),i&&Wu(n,i),e}(),Qu="Cannot access buffer data directly on BitmapText!";function $u(t){return($u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tl(t,e){return!e||"object"!==$u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function el(t){return(el=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nl(t,e){return(nl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rl=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=tl(this,el(e).call(this,t,n))).text=r,o.style=jn(i),o.maxWidth=void 0,o.alpha=1,o.gco=ke,o}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nl(t,e)}(e,Fa),n=e,(r=[{key:"Render",value:function(t){if(this.PreRender(t),!0===this.render){if(this.ProcessTransform(this.parent),this.transform.ApplyGlobal(t),!0===this.display){var e=this.style;!0===e.shadow.applied&&e.shadow.Apply(t),!0===e.text.applied&&(e.text.Apply(t),t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,t.fillText(this.text,0,0,this.maxWidth),t.strokeText(this.text,0,0,this.maxWidth))}this.children.length>0&&this.RenderChildren(t)}}},{key:"IntersectsPoint2D",value:function(){return!1}}])&&Zu(n.prototype,r),i&&Zu(n,i),e}();function il(t){return(il="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ol(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function al(t,e){return!e||"object"!==il(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function sl(t){return(sl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ul(t,e){return(ul=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ll=Math.cos,cl=Math.sin,hl=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=al(this,sl(e).call(this,0,0))).focus=t,r.target=n,r.velocity=new ut.a(0,0),r.force=new ut.a(1,1),r.stopRadiusSq=1e3,r.EPSILON=2e-4,r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ul(t,e)}(e,Fa),n=e,(r=[{key:"Process",value:function(){var t=this.target;if(null!=t){dl.SetV(t.position),dl.Invert(),dl.AddV(this.focus),fl.SetV(this.position).SubtractV(dl);var e=fl.GetMagnitudeSquared();if(e<this.stopRadiusSq)return;e*=this.EPSILON;var n=fl.GetAngle();this.velocity.Set(e*ll(n),e*cl(n)).MultiplyV(this.force),this.position.SubtractV(this.velocity)}}},{key:"SetTarget",value:function(t){return this.target=t,this}}])&&ol(n.prototype,r),i&&ol(n,i),e}(),fl=new ut.a(0,0),dl=new ut.a(0,0);function pl(t){return(pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vl(t,e){return!e||"object"!==pl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ml(t){return(ml=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bl(t,e){return(bl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gl=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=vl(this,ml(e).call(this,t,n))).programController=r,i.w=128,i.h=128,i.time=0,i.timeInc=.1,i.transformShouldUpdate=!1,i.transformAutomaticUpdate=!1,i}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bl(t,e)}(e,Ea),n=e,(r=[{key:"GLPreRender",value:function(){}},{key:"GLPostRender",value:function(){}},{key:"GLRender",value:function(t){this.GLPreRender(t),this.ProcessTransform(this.parent);var e=this.bounds.local;this.programController.Execute(this.transform.globalTransform.AsArray(!0),e.tl.x,e.tl.y,e.w,e.h,this.time),this.time+=this.timeInc,this.GLPostRender(t)}}])&&yl(n.prototype,r),i&&yl(n,i),e}();function wl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Al=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.bounds=new pe(e,n,r,i),this.container=null,this.entities=null,this.rootMatrix=null,this.onOut=new Tr,this.onIn=new Tr}var e,n,r;return e=t,(n=[{key:"BindContainer",value:function(t){return this.container=t,this.entities=t.children,this}},{key:"SetRootMatrix",value:function(t){return this.rootMatrix=t,this}},{key:"Process",value:function(){for(var t=this.entities,e=t[0],n=this.bounds,r=this.rootMatrix,i=0;i<t.length;e=t[++i])e.ComputeGlobalBounds(e.anchor,r),!1===n.IntersectsAABB2D(e.bounds.global)?!1!==e.__inside__&&(e.__inside__=!1,this.onOut.Dispatch(e)):!0!==e.__inside__&&(e.__inside__=!0,this.onIn.Dispatch(e))}}])&&wl(e.prototype,n),r&&wl(e,r),t}();n.d(e,"Math",function(){return B}),n.d(e,"Assert",function(){return mi.a}),n.d(e,"Pool",function(){return na.a}),n.d(e,"FlagList",function(){return Us}),n.d(e,"FlagEnum",function(){return Xs}),n.d(e,"Cache",function(){return gi}),n.d(e,"Glob",function(){return Hs.a}),n.d(e,"Maker",function(){return Ws}),n.d(e,"Color",function(){return hr}),n.d(e,"Utility",function(){return j}),n.d(e,"Cipher",function(){return r}),n.d(e,"BrowserUtility",function(){return i}),n.d(e,"Style",function(){return b}),n.d(e,"Time",function(){return w}),n.d(e,"CharacterSets",function(){return zs.a}),n.d(e,"CanvasManager",function(){return Js}),n.d(e,"Vector2D",function(){return ut.a}),n.d(e,"Matrix2D",function(){return ya}),n.d(e,"Transform2D",function(){return wa}),n.d(e,"Bounds2D",function(){return Ca}),n.d(e,"QuadtreeNode",function(){return ru}),n.d(e,"Ease",function(){return o}),n.d(e,"Collision",function(){return f}),n.d(e,"Geom",function(){return p}),n.d(e,"Packing",function(){return I}),n.d(e,"Path",function(){return g}),n.d(e,"CoreEntity2D",function(){return Ea}),n.d(e,"Container2D",function(){return La}),n.d(e,"VisualContainer2D",function(){return Fa}),n.d(e,"BatchableContainer2D",function(){return Wa}),n.d(e,"TextureEntity2D",function(){return Za}),n.d(e,"Stage2D",function(){return yu}),n.d(e,"Stadium",function(){return mu}),n.d(e,"Graphic2D",function(){return ls}),n.d(e,"Sprite",function(){return vs}),n.d(e,"Tilesprite",function(){return Cu}),n.d(e,"Tile",function(){return Ru}),n.d(e,"Tilemap",function(){return Bu}),n.d(e,"Char",function(){return Hu}),n.d(e,"BitmapText",function(){return Ju}),n.d(e,"Text",function(){return rl}),n.d(e,"Camera2D",function(){return hl}),n.d(e,"GLEntity2D",function(){return gl}),n.d(e,"Culler2D",function(){return Al}),n.d(e,"Shader",function(){return A}),n.d(e,"Load",function(){return S}),n.d(e,"Controller",function(){return T}),n.d(e,"CP",function(){return x}),n.d(e,"Motion",function(){return E}),n.d(e,"Particle",function(){return _}),n.d(e,"Texture",function(){return O}),n.d(e,"Animator",function(){return R}),n.d(e,"Debug",function(){return k}),n.d(e,"Input",function(){return L}),n(25)},function(t,e,n){"use strict";n.d(e,"a",function(){return f});var r=n(6);function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=Math.ceil,a=Math.round,s=Math.abs,u=Math.sqrt,l=Math.atan2,c=Math.cos,h=Math.sin,f=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=n}var e,n,r;return e=t,r=[{key:"SortMinMag",value:function(t,e){return t.GetMagnitudeSquared()-e.GetMagnitudeSquared()}},{key:"pool",get:function(){return d}},{key:"USE_POOL",get:function(){return p},set:function(t){p=!!t}}],(n=[{key:"Copy",value:function(){return!0===p?d.Retrieve(this.x,this.y):new t(this.x,this.y)}},{key:"FromPool",value:function(e,n){return!0===p?d.Retrieve(e,n):new t(e,n)}},{key:"AbsoluteCopy",value:function(){var t=this.Copy();return t.Positive(),t}},{key:"SetV",value:function(t){return this.x=t.x,this.y=t.y,this}},{key:"Set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"SetSame",value:function(t){return this.x=t,this.y=t,this}},{key:"Is0",value:function(){return 0===this.x&&0===this.y}},{key:"AddVC",value:function(t){return this.Copy().AddV(t)}},{key:"AddV",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"Add",value:function(t,e){return this.x+=t,this.y+=e,this}},{key:"SubtractVC",value:function(t){return this.Copy().SubtractV(t)}},{key:"SubtractV",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"Subtract",value:function(t,e){return this.x-=t,this.y-=e,this}},{key:"MultiplyVC",value:function(t){return this.Copy().MultiplyV(t)}},{key:"MultiplyV",value:function(t){return this.x*=t.x,this.y*=t.y,this}},{key:"Multiply",value:function(t,e){return this.x*=t,this.y*=e,this}},{key:"DivideVC",value:function(t){return this.Copy().DivideV(t)}},{key:"DivideV",value:function(t){return this.x/=t.x,this.y/=t.y,this}},{key:"Divide",value:function(t,e){return this.x/=t,this.y/=e,this}},{key:"Normalize",value:function(){var t=this.GetMagnitude();return this.Divide(t,t)}},{key:"Positive",value:function(){return this.x=s(this.x),this.y=s(this.y),this}},{key:"Negative",value:function(){return this.x=-s(this.x),this.y=-s(this.y),this}},{key:"Invert",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"Rotate",value:function(t){var e=h(t),n=c(t),r=this.x,i=this.y;return this.x=r*n-i*e,this.y=r*e+i*n,this}},{key:"RotateAroundV",value:function(t,e){return this.SubtractV(t).Rotate(e).AddV(t)}},{key:"RotateAround",value:function(t,e,n){return this.SubtractV(t,e).Rotate(n).AddV(t,e)}},{key:"RotateAbsolute",value:function(t){return this.Rotate(t-this.GetAngle())}},{key:"RotateAbsoluteAroundV",value:function(t,e){return this.SubtractV(t).RotateAbsolute(e).AddV(t)}},{key:"RotateAbsoluteAround",value:function(t,e,n){return this.SubtractV(t,e).RotateAbsolute(n).AddV(t,e)}},{key:"PushFromV",value:function(t,e){var n=this.Copy();return n.SubtractV(t).Normalize().Multiply(e,e),this.AddV(n)}},{key:"PushFrom",value:function(t,e,n){var r=this.Copy();return r.SubtractV(t,e).Normalize().Multiply(n,n),this.AddV(r)}},{key:"GetWeightedAverageV",value:function(t,e){return this.FromPool(this.x*(1-e)+t.x*e,this.y*(1-e)+t.y*e)}},{key:"GetWeightedAverage",value:function(t,e,n){return this.FromPool(this.x*(1-n)+t*n,this.y*(1-n)+e*n)}},{key:"GetAngle",value:function(){return l(this.y,this.x)}},{key:"GetAngleBetweenV",value:function(t){return l(this.y-t.y,this.x-t.x)}},{key:"GetAngleBetween",value:function(t,e){return l(this.y-e,this.x-t)}},{key:"GetDotV",value:function(t){return this.x*t.x+this.y*t.y}},{key:"GetDot",value:function(t,e){return this.x*t+this.y*e}},{key:"GetCrossV",value:function(t){return this.x*t.y+this.y*t.x}},{key:"GetCross",value:function(t,e){return this.x*e+this.y*t}},{key:"GetMagnitudeSquared",value:function(){return this.x*this.x+this.y*this.y}},{key:"GetMagnitude",value:function(){return u(this.x*this.x+this.y*this.y)}},{key:"GetDistanceSquaredV",value:function(t){return this.Copy().SubtractV(t).GetMagnitudeSquared()}},{key:"GetDistanceSquared",value:function(t,e){return this.Copy().Subtract(t,e).GetMagnitudeSquared()}},{key:"GetDistanceV",value:function(t){return this.Copy().SubtractV(t).GetMagnitude()}},{key:"GetDistance",value:function(t,e){return this.Copy().Subtract(t,e).GetMagnitude()}},{key:"GetPerpendicularCCWV",value:function(t){return this.FromPool(-(t.y-this.y),t.x-this.x)}},{key:"GetPerpendicularCCW",value:function(t,e){return this.FromPool(-(e-this.y),t-this.x)}},{key:"GetPerpendicularCWV",value:function(t){return this.FromPool(t.y-this.y,-(t.x-this.x))}},{key:"GetPerpendicularCW",value:function(t,e){return this.FromPool(e-this.y,-(t-this.x))}},{key:"GetNormalAV",value:function(t){return this.GetPerpendicularCCWV(t).Normalize()}},{key:"GetNormalA",value:function(t,e){return this.GetPerpendicularCCW(t,e).Normalize()}},{key:"GetNormalBV",value:function(t){return this.GetPerpendicularCWV(t).Normalize()}},{key:"GetNormalB",value:function(t,e){return this.GetPerpendicularCW(t,e).Normalize()}},{key:"GetMidpointV",value:function(t){return this.Copy().AddV(t).Divide(2,2)}},{key:"GetMidpoint",value:function(t,e){return this.Copy().Add(t,e).Multiply(.5,.5)}},{key:"IsEqualToV",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"IsEqualTo",value:function(t,e){return this.x===t&&this.y===e}},{key:"GetProjectionOntoV",value:function(t){var e=this.GetDotV(t);if(0===e)return this.FromPool(0,0);var n=t.GetMagnitude(),r=e/(n*n);return t.Copy().Multiply(r,r)}},{key:"GetProjectionOnto",value:function(t,e){var n=this.Copy();n.Set(t,e);var r=this.GetDotV(n);if(0===r)return this.FromPool(0,0);var i=n.GetMagnitude(),o=r/(i*i);return n.Multiply(o,o),n}},{key:"GetReflectionV",value:function(t){var e=t.Copy(),n=this.GetDotV(e);return e.Multiply(2,2).Multiply(n,n),this.SubtractVC(e)}},{key:"GetReflection",value:function(t,e){var n=this.Copy();n.Set(t,e);var r=this.GetDotV(n);return n.Multiply(2,2).Multiply(r,r),this.SubtractVC(n)}},{key:"Store",value:function(){return d.Store(this),this}},{key:"AddTo",value:function(t){for(var e=0;e<t.length;++e)t[e].AddV(this);return this}},{key:"Floor",value:function(){return this.x=0|this.x,this.y=0|this.y,this}},{key:"Ceil",value:function(){return this.x=o(this.x),this.y=o(this.y),this}},{key:"Round",value:function(){return this.x=a(this.x),this.y=a(this.y),this}},{key:"GetMinMaxDot",value:function(t){for(var e=1/0,n=-e,r=0,i=this.Copy(),o=0;o<t.length;++o)(r=t[o].GetDotV(this))>n&&(n=r),r<e&&(e=r);return i.Set(e,n),i}}])&&i(e.prototype,n),r&&i(e,r),t}(),d=new r.a,p=!0;d.Retrieve=function(t,e){return this.PreRetrieve(),this.objects.pop().Set(t,e)},d.Flood(function(){return new f(0,0)},1e3)},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(t,e){var n=document.getElementById("buttons"),r=document.createElement("input"),i=document.getElementById("back-button");r.setAttribute("value",t),r.setAttribute("type","button"),r.addEventListener("click",function(){n.style.display="none",i.onclick=a,e(o)}),n.appendChild(r);var o={canvas:null,stage:null,stadium:null,ticker:null};function a(){o.canvas&&o.canvas.parentNode.removeChild(o.canvas),o.stage&&o.stage.Destroy(),o.stadium&&(o.stadium.stages.forEach(function(t){t.canvas.parentNode.removeChild(t.canvas)}),o.stadium.Destroy()),o.canvasManager&&o.canvasManager.Destroy(),o.ticker&&o.ticker.Stop(),i.onclick=null,n.style.display=null}}},function(t,e,n){"use strict";n.r(e),n.d(e,"RandomInteger",function(){return l}),n.d(e,"RandomFloat",function(){return c}),n.d(e,"IsInteger",function(){return h}),n.d(e,"IsFloat",function(){return f}),n.d(e,"IsArray",function(){return d}),n.d(e,"Sign",function(){return p}),n.d(e,"IsBitSet",function(){return y}),n.d(e,"SetBit",function(){return v}),n.d(e,"ClearBit",function(){return m}),n.d(e,"ToggleBit",function(){return b}),n.d(e,"Clamp",function(){return g}),n.d(e,"InverseClamp",function(){return w}),n.d(e,"FlipACoin",function(){return A}),n.d(e,"NearestPow2Floor",function(){return S}),n.d(e,"NearestPow2Ceil",function(){return C}),n.d(e,"NearestPow2Round",function(){return T}),n.d(e,"GenerateSequence",function(){return x}),n.d(e,"RandomInArray",function(){return E}),n.d(e,"MinMaxOrValue",function(){return P}),n.d(e,"UUID",function(){return _}),n.d(e,"ApplyProperties",function(){return O}),n.d(e,"Nested",function(){return R}),n.d(e,"ArrayGetRandom",function(){return D}),n.d(e,"ArrayShuffle",function(){return k}),n.d(e,"Base16ToBase10",function(){return I}),n.d(e,"Base2ToBase10",function(){return L}),n.d(e,"IsObjectEmpty",function(){return j}),n.d(e,"DeepClone",function(){return B}),n.d(e,"CreateIteratorArgs",function(){return G}),n.d(e,"ReplaceArgumentWithObjectValue",function(){return V}),n.d(e,"PRINT_VERSION",function(){return N});var r=n(4),i=n(8);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a=n(26).version,s=Math.random,u=Math.clz32;function l(t,e){return s()*(e-t+1)+t|0}function c(t,e){return s()*(e-t)+t}function h(t){return Number(t)===t&&t%1==0}function f(t){return Number(t)===t&&t%1!=0}function d(t){return"[object Array]"===Object.prototype.toString.call(t)}function p(t,e){return 0===t?!0===e?1:0:t>0?1:-1}function y(t,e){return 0!=(e&1<<t)}function v(t,e){return e|1<<t}function m(t,e){return e&~(1<<t)}function b(t,e){return e^1<<t}function g(t,e,n){return t<e?e:t>n?n:t}function w(t,e,n){return t<e?n:t>n?e:t}function A(t,e){return 1===l(1,2)?t:e}function S(t){return 1<<31-u(t)}function C(t){return 1<<31-u(2*t)}function T(t){return 1<<31-u(1.5*t)}function x(t,e,n,i){for(var o=[],a=0;a<e;a+=n)o.push(Object(r.PrecisionRound)(a,i));return o}function E(t){return t[l(0,t.length-1)]}function P(t,e){return null!=t.min&&null!=t.max?c(t.min,t.max):null!=t.values&&t.values.length>0?E(t.values):null!=e&&t[e].length>0?E(t[e]):t}function _(t,e,n,r){var o,a,s="",u=t/e,c=i.a[n];t=null==t?32:t,e=null==e?4:e,n=null==n?0:n,r=null==r?"-":r;for(var f=0;f<t;++f)0!==(a=f/u)&&h(a)?s+=r:(o=l(1,c.length-1),s+=c.charAt(o));return s}function O(t,e){var n;if(void 0!==e)for(n in e)void 0!==t[n]&&(t[n]=e[n])}function R(t,e,n,r,i,o){var a;if("string"==typeof e&&(o=null==o?".":o,e=e.split(o)),e.length>1){if(void 0!==t[a=e.shift()])return R(t[a],e,n,r,i,o)}else{if(void 0!==t[a=e.shift()])return!0===r?void(t[a]=i):!0===n?t:t[a];if(!0===r)return void(t[a]=i)}}function D(t,e){for(var n=[],r={},i=t.length,o=0;o<e;++o){var a=s()*i|0;void 0===r[a]?(r[a]=null,n.push(t[a])):o--}return n}function k(t){for(var e,n,r=t.length-1;r-- >=0;)n=s()*r|0,e=t[r],t[r]=t[n],t[n]=e}function I(t){return parseInt(t,16)}function L(t){return parseInt(t,2)}function j(t){var e;for(e in t)if(t.hasOwnProperty(e))return!1;return JSON.stringify(t)===JSON.stringify({})}function B(t){var e,n=null,r=!1;if("function"==typeof t)throw new TypeError("Object was of type: function. Not acceptable.");if(d(t))n=[],r=!0;else{if("object"!==o(t))return t;n={}}if(r)for(var i=0;i<t.length;++i)n[i]=B(t[i]);else for(e in t)t.hasOwnProperty(e)&&(n[e]=B(t[e]));return n}function G(t,e,n){for(var r,i,o,a,s=[],u=0;u<t.length;++u)"string"==typeof(r=t[u])&&0===r.indexOf(e)&&r.indexOf(n)===e.length&&(-1!==(a=r.indexOf("|"))?(i=r.slice(r.indexOf("(")+1,a),o=r.slice(a+1,r.indexOf(")")),s.push({mod:i,val:o,iteratorIndex:u})):s.push({iteratorIndex:u}));return s}function V(t,e,n){for(var r,i=0;i<e.length;++i)"string"==typeof(r=e[i])&&0===r.indexOf(n)&&(e[i]=R(t,r.slice(n.length)))}function N(t){t?console.log("nenkraft2 server version "+a):console.log("%cnenkraft2 %cversion %c"+a,"color:#f0f7da;background-color:#234d20;font-family:Arial;font-size:18px;font-weight:900;padding:5px;","color:#f0f7da;background-color:#36802d;font-family:Arial;font-size:18px;font-weight:900;padding:5px;","color:#f0f7da;background-color:#77ab59;font-family:Arial;font-size:18px;font-weight:900;padding:5px;")}},function(t,e,n){"use strict";n.r(e),n.d(e,"PII",function(){return c}),n.d(e,"PI5",function(){return h}),n.d(e,"DEGREES_TO_RADIANS",function(){return f}),n.d(e,"RADIANS_TO_DEGRESS",function(){return d}),n.d(e,"RADIAN",function(){return p}),n.d(e,"DegreesToRadians",function(){return y}),n.d(e,"RadiansToDegress",function(){return v}),n.d(e,"PrecisionRound",function(){return m}),n.d(e,"Spread",function(){return b}),n.d(e,"AttractRepel",function(){return g}),n.d(e,"Oscillate",function(){return w}),n.d(e,"LikeASquareGrid",function(){return A}),n.d(e,"TriRectArray",function(){return S}),n.d(e,"GreatestCommonDivisor",function(){return C}),n.d(e,"SimplifyAspectRatio",function(){return T}),n.d(e,"IntegerNotation",function(){return x});var r=n(7);n.d(e,"Misc",function(){return r});var i=Math.PI,o=Math.sin,a=Math.cos,s=Math.pow,u=Math.round,l=Math.ceil,c=2*i,h=.5*i,f=i/180,d=180/i,p=f;function y(t){return t*f}function v(t){return t*d}function m(t,e){if(null==e)return t;var n=s(10,e);return u(n*t)/n}function b(t,e,n,r){return t-n*(e-1)*.5+r*n}function g(t,e,n,r,i){var s=e.SubtractVC(t);if(s.GetMagnitudeSquared()<r*r){var u=s.GetAngle();n.Add(a(u)*i,o(u)*i)}}function w(t,e,n,r){var i=.5*(n-e);return e+i+o(y(t*r))*i}function A(t,e,n,r){for(var i=e/n|0,o=0;o<t.length;++o)t[o].Set(o%i*n,(o/i|0)*r)}function S(t,e,n,r,i){return null!=i?(i[0]=t,i[1]=e,i[2]=t+n,i[3]=e,i[4]=t,i[5]=e+r,i[6]=t,i[7]=e+r,i[8]=t+n,i[9]=e,i[10]=t+n,i[11]=e+r,i):[t,e,t+n,e,t,e+r,t,e+r,t+n,e,t+n,e+r]}function C(t,e){return 0===e?t:C(e,t%e)}function T(t,e,n){var r=C(t,e),i=null==n?[]:n;return i[0]=t/r,i[1]=e/r,i}function x(t,e,n){var r=t%e,i=t/e;return l(0===r?i+1:i)+n+(1+r)}},function(t,e,n){"use strict";(function(t){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e,n,a){if(null==a||"function"!=typeof t.Assert)switch(e){case i.IS:return void function(t,e,n){var r=!1;t!==e&&(r=!0);o(r,t,e,n)}(t,n,e);case i.IS_NOT:return void function(t,e,n){var r=!1;t===e&&(r=!0);o(r,t,e,n)}(t,n,e);case i.IS_SAME_TYPE:return void function(t,e,n){var i=!1;Array.isArray(t)||Array.isArray(e)?!Array.isArray(t)!=!Array.isArray(e)&&(i=!0):null===t||null===e?t!==e&&(i=!0):r(t)!==r(e)?i=!0:"number"!=typeof t&&"number"!=typeof e||(isNaN(t)||isNaN(e))&&t!==e&&(i=!0);o(i,t,e,n)}(t,n,e);case i.IS_NOT_SAME_TYPE:return void function(t,e,n){var i=!1;Array.isArray(t)||Array.isArray(e)?Array.isArray(t)&&Array.isArray(e)&&(i=!0):null===t||null===e?e===t&&(i=!0):r(t)===r(e)?i=!0:"number"!=typeof t&&"number"!=typeof e||(isNaN(t)||isNaN(e))&&isNaN(t)&&isNaN(e)&&(i=!0);o(i,t,e,n)}(t,n,e);case i.IS_INSTANCE_OF:return void function(t,e,n){var r=!1;t instanceof e||(r=!0);o(r,t,e.name,n)}(t,n,e);case i.IS_NOT_INSTANCE_OF:return void function(t,e,n){var r=!1;t instanceof e&&(r=!0);o(r,t,e.name,n)}(t,n,e);case i.IS_LESS_THAN:return void function(t,e,n){var r=!1;t>=e&&(r=!0);o(r,t,e,n)}(t,n,e);case i.IS_GREATER_THAN:return void function(t,e,n){var r=!1;t<=e&&(r=!0);o(r,t,e,n)}(t,n,e);case i.IS_LESS_THAN_OR_EQUAL:return void function(t,e,n){var r=!1;t>e&&(r=!0);o(r,t,e,n)}(t,n,e);case i.IS_GREATER_THAN_OR_EQUAL:return void function(t,e,n){var r=!1;t<e&&(r=!0);o(r,t,e,n)}(t,n,e);default:throw new Error("No comparison: "+e)}else t.Assert(e,n)}function o(t,e,n,r){if(t)throw function(t,e,n){switch(n){case i.IS:n=i.IS_NOT;break;case i.IS_NOT:n=i.IS;break;case i.IS_SAME_TYPE:n=i.IS_NOT_SAME_TYPE;break;case i.IS_NOT_SAME_TYPE:n=i.IS_SAME_TYPE;break;case i.IS_INSTANCE_OF:n=i.IS_NOT_INSTANCE_OF;break;case i.IS_NOT_INSTANCE_OF:n=i.IS_INSTANCE_OF;break;case i.IS_LESS_THAN:n=i.IS_GREATER_THAN_OR_EQUAL;break;case i.IS_GREATER_THAN:n=i.IS_LESS_THAN_OR_EQUAL;break;case i.IS_LESS_THAN_OR_EQUAL:n=i.IS_GREATER_THAN;break;case i.IS_GREATER_THAN_OR_EQUAL:n=i.IS_LESS_THAN;break;default:throw new Error("Unexpected error")}console.error(t,n,e)}(e,n,r),new Error("Assertion failed: "+r);i.LOG&&window&&function(t,e,n){console.log("%c<<||-?START?-||>>","background-color: black; color: #0FF; padding: 0px 25px;"),console.log("%cAssertion success: ","background-color: #333; color: #0F0; padding: 0px 25px;"),console.log(t),console.log(n),console.log(e),console.log("%c>>||-?END?-||<<","background-color: black; color: #FF0; padding: 0px 25px;")}(e,n,r)}n.d(e,"a",function(){return i}),i.IS="I",i.IS_NOT="IN",i.IS_SAME_TYPE="IST",i.IS_NOT_SAME_TYPE="INST",i.IS_INSTANCE_OF="IIO",i.IS_NOT_INSTANCE_OF="INIO",i.IS_LESS_THAN="ILT",i.IS_GREATER_THAN="IGT",i.IS_LESS_THAN_OR_EQUAL="ILTOE",i.IS_GREATER_THAN_OR_EQUAL="IGTOE",i.Assign=function(e){if(window&&!e?e=window:t&&!e&&(e=t),!e)throw new Error("No global namespace");e.IS=i.IS,e.IS_NOT=i.IS_NOT,e.IS_SAME_TYPE=i.IS_SAME_TYPE,e.IS_NOT_SAME_TYPE=i.IS_NOT_SAME_TYPE,e.IS_INSTANCE_OF=i.IS_INSTANCE_OF,e.IS_NOT_INSTANCE_OF=i.IS_NOT_INSTANCE_OF,e.IS_LESS_THAN=i.IS_LESS_THAN,e.IS_GREATER_THAN=i.IS_GREATER_THAN,e.IS_LESS_THAN_OR_EQUAL=i.IS_LESS_THAN_OR_EQUAL,e.IS_GREATER_THAN_OR_EQUAL=i.IS_GREATER_THAN_OR_EQUAL},i.LOG=!1}).call(this,n(9))},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,"a",function(){return i});var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.objects=[],this.floodFunction=null,this.floodAmount=null,this.context=null,this.arguments=null}var e,n,i;return e=t,(n=[{key:"Store",value:function(t){this.objects.push(t)}},{key:"PreRetrieve",value:function(){0===this.objects.length&&this.Flood()}},{key:"Retrieve",value:function(){return this.PreRetrieve(),this.objects.pop()}},{key:"Flood",value:function(t,e,n){t&&(this.floodFunction=t),e&&(this.floodAmount=e),n&&(this.context=n);for(var r=0;r<this.floodAmount;++r)this.Store(this.floodFunction.call(this.context))}},{key:"Flush",value:function(){this.objects.length=0}},{key:"Clean",value:function(){var t=this.objects.length;this.Flush(),this.Flood(void 0,t)}}])&&r(e.prototype,n),i&&r(e,i),t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"Line2DLine2DIntersection",function(){return i}),n.d(e,"ClosestPoint2DOnLine2D",function(){return o});var r=n(1);function i(t,e,n,r){a.SetV(e).SubtractV(t),s.SetV(r).SubtractV(n);var i=-s.x*a.y+a.x*s.y,o=t.x-n.x,u=t.y-n.y,l=(-a.y*o+a.x*u)/i,c=(s.x*u-s.y*o)/i;return l>=0&&l<=1&&c>=0&&c<=1}function o(t,e,n){var r=e.SubtractVC(t),i=((n.x-t.x)*r.x+(n.y-t.y)*r.y)/r.GetMagnitudeSquared();return i<0?t:i>1?e:(r.Set(t.x+i*r.x,t.y+i*r.y),r)}var a=new r.a(0,0),s=new r.a(0,0)},function(t,e,n){"use strict";e.a=["0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz!?#$%@&","0123456789","ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","ABCDEFGHJIKLMNOPQRSTUWVXYZ","abcdefghijklmnopqrstuwvxyz","0123456789abcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZ"]},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return a});var r=n(3);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.functions={},this.values={},this.constants={},this.components={},this.objects={},this.lists={}}var n,a,p;return n=e,p=[{key:"Assign",value:function(e){if(window&&!e?e=window:t&&!e&&(e=t),!e)throw new Error("No global namespace");e.FUNC=s,e.VAL=u,e.CONST=l,e.COMP=c,e.OBJ=h,e.LIST=f}},{key:"Create",value:function(n){var r=r||null;if(null==r){if(null==t)throw new Error("Neither window nor global exists!");if(void 0!==t[n])throw new Error("global."+n+" already exists!");t[n]=new e}else{if(void 0!==r[n])throw new Error("window."+n+" already exists!");r[n]=new e}}},{key:"FUNCTION",get:function(){return s}},{key:"VALUE",get:function(){return u}},{key:"CONSTANT",get:function(){return l}},{key:"COMPONENT",get:function(){return c}},{key:"OBJECT",get:function(){return h}},{key:"LIST",get:function(){return f}},{key:"AllowGetNullUndefined",get:function(){return d},set:function(t){(function(t){throw new Error('"'+t+'" is read-only')})("PS_AllowGetNullUndefined"),d=!!t}}],(a=[{key:"Define",value:function(t,e,n){this.Mark(t,e),this.Set(t,e,n)}},{key:"Mark",value:function(t,e){if("string"!=typeof t)throw new Error("Type needs to be a string!");if("string"!=typeof e)throw new Error("Id needs to be a string!");if(null==this[t])throw new Error("Type does not exist");if((t===l||t===c)&&void 0!==this[t][e])throw new Error("Constants cannot be reassigned!");this[t][e]=null}},{key:"Get",value:function(t,n){if("string"!=typeof t)throw new Error("Type needs to be a string!");if("string"!=typeof n)throw new Error("Id needs to be a string!");if(null==this[t])throw new Error("Type does not exist");if(!1===e.AllowGetNullUndefined&&null==this[t][n])throw new Error("Null or undefined!");return this[t][n]}},{key:"Set",value:function(t,e,n){if("string"!=typeof t)throw new Error("Type needs to be a string!");if("string"!=typeof e)throw new Error("Id needs to be a string!");switch(t){case s:if("function"!=typeof n)throw new Error("Needs to be a function!");if(null!==this.functions[e])throw new Error("No mark!");this.functions[e]=n;break;case u:if(n instanceof Object)throw new Error("Objects are not allowed!");if(null!==this.values[e])throw new Error("No mark!");this.values[e]=n;break;case l:if(n instanceof Object)throw new Error("Objects are not allowed!");if(null!==this.constants[e])throw new Error("No mark!");Object.defineProperty(this.constants,e,{writable:!1,configurable:!1,value:n});break;case c:if("function"!=typeof n)throw new Error("Needs to be a function!");if(null!==this.components[e])throw new Error("No mark!");Object.defineProperty(this.components,e,{writable:!1,configurable:!1,value:n});break;case h:if("object"!==i(n))throw new Error("Needs to be an object");if(!0===Object(r.IsArray)(n))throw new Error("Arrays are not allowed!");if(null!==this.objects[e])throw new Error("No mark!");this.objects[e]=n;break;case f:if(!1===Object(r.IsArray)(n))throw new Error("Needs to be an array!");if(null!==this.lists[e])throw new Error("No mark!");this.lists[e]=n;break;default:throw new Error("Unrecognized type!")}}}])&&o(n.prototype,a),p&&o(n,p),e}(),s="functions",u="values",l="constants",c="components",h="objects",f="lists",d=!1}).call(this,n(9))},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nuniform mat3 uProjection;\r\nuniform mat3 uTranslation;\r\nuniform mat3 uTransformation;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vTexCoord = ( uTransformation * vec3( aTexCoord, 1.0 ) ).xy;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\nuniform vec4 uTint;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  gl_FragColor = TEX( uImage, vTexCoord ) * uTint;\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nattribute vec3 aProjection1;\r\nattribute vec3 aProjection2;\r\nattribute vec3 aProjection3;\r\n\r\nattribute vec3 aTranslation1;\r\nattribute vec3 aTranslation2;\r\nattribute vec3 aTranslation3;\r\n\r\nattribute vec3 aTransformation1;\r\nattribute vec3 aTransformation2;\r\nattribute vec3 aTransformation3;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  mat3 projection = mat3( aProjection1, aProjection2, aProjection3 );\r\n  mat3 translation = mat3( aTranslation1, aTranslation2, aTranslation3 );\r\n  mat3 transformation = mat3( aTransformation1, aTransformation2, aTransformation3 );\r\n  gl_Position = vec4( ( projection * translation * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vTexCoord = ( transformation * vec3( aTexCoord, 1.0 ) ).xy;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  gl_FragColor = TEX( uImage, vTexCoord );\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec3 aProjection1;\r\nattribute vec3 aProjection2;\r\nattribute vec3 aProjection3;\r\nattribute vec2 aPosition;\r\nattribute vec4 aColor;\r\nattribute float aPointSize;\r\n\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  mat3 projection = mat3( aProjection1, aProjection2, aProjection3 );\r\n  gl_Position = vec4( ( projection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  gl_PointSize = aPointSize;\r\n  vColor = aColor;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  gl_FragColor = vColor;\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform vec2 uSize;\r\nuniform float uOutline;\r\n\r\nvarying vec2 vPosition;\r\nvarying float vBorderX;\r\nvarying float vNegBorderX;\r\nvarying float vBorderY;\r\nvarying float vNegBorderY;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vPosition = aPosition;\r\n  vBorderX = -uSize.x * 0.5 + uOutline;\r\n  vNegBorderX = uSize.x * 0.5 - uOutline;\r\n  vBorderY = -uSize.y * 0.5 + uOutline;\r\n  vNegBorderY = uSize.y * 0.5 - uOutline;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform lowp vec4 uFillColor;\r\nuniform lowp vec4 uOutlineColor;\r\n\r\nvarying vec2 vPosition;\r\nvarying float vBorderX;\r\nvarying float vNegBorderX;\r\nvarying float vBorderY;\r\nvarying float vNegBorderY;\r\n\r\nvoid main() {\r\n  if (\r\n    vPosition.x > vBorderX &&\r\n    vPosition.x < vNegBorderX && \r\n    vPosition.y > vBorderY && \r\n    vPosition.y < vNegBorderY\r\n  ) {\r\n    gl_FragColor = uFillColor;\r\n  } else {\r\n    gl_FragColor = uOutlineColor;\r\n  }\r\n  \r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\n\r\nvarying vec2 vPosition;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vPosition = aPosition;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform lowp vec4 uFillColor;\r\nuniform lowp vec4 uOutlineColor;\r\nuniform float uRadius;\r\nuniform float uOutline;\r\n\r\nvarying vec2 vPosition;\r\n\r\nvoid main() {\r\n  float d = dot( vPosition, vPosition );\r\n  float rs = uRadius * uRadius;\r\n  float ors = uRadius - uOutline;\r\n  ors = ors * ors;\r\n  if ( d < rs && d > ors ) {\r\n    gl_FragColor = uOutlineColor;\r\n  } else if ( d < rs ) {\r\n    gl_FragColor = uFillColor;\r\n  }\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform lowp vec4 uColor;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform lowp vec4 uColor;\r\n\r\nvoid main() {\r\n  gl_FragColor = uColor;\r\n}\r\n@fragment-end@"},function(t,e){t.exports='/**\r\n* @author Gustav \'Nuuf\' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision highp float;\r\n\r\nattribute vec2 a_v2Position;\r\n\r\nuniform mat3 u_m3Projection;\r\n\r\nvarying vec2 v_v2Position;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( u_m3Projection * vec3( a_v2Position, 1.0 ) ).xy, 0.0, 1.0 );\r\n  v_v2Position = a_v2Position;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n\r\n(import \'RADIAN\' /)\r\n\r\nprecision highp float;\r\n\r\nuniform float u_fTime;\r\nuniform vec2 u_v2Resolution;\r\n\r\nvarying vec2 v_v2Position;\r\n\r\n(import \'rotate2d\' /)\r\n(import \'mod289\' /)\r\n(import \'permute\' /)\r\n(import \'snoise\' /)\r\n(import \'ridge\' /)\r\n(import \'pixelate\' /)\r\n(import \'rmf\' [\r\n  {\r\n    "set": {\r\n      "OFFSET": "1.0 + 0.1 * abs( sin( u_fTime ) )",\r\n      "OCTAVES": "19"\r\n    }\r\n  }\r\n] /)\r\n(import \'rmf\' [\r\n  {\r\n    "replace": {\r\n      "rmf": "rmf2"\r\n    },\r\n    "set": {\r\n      "OFFSET": "0.5 + 0.1 * abs( sin( u_fTime ) )",\r\n      "OCTAVES": "3"\r\n    }\r\n  }\r\n] /)\r\n\r\nvoid main() {\r\n\r\n  vec2 pos = v_v2Position / u_v2Resolution;\r\n\r\n  float sp = 4.0 * u_fTime;\r\n\r\n  pos *= -1.0; \r\n\r\n  pos = pixelate( pos, 1028 );\r\n\r\n  // pos *= rotate2d( RADIAN * sp );\r\n  \r\n  pos += sp / 100.0;\r\n\r\n  vec3 color = vec3( 0.0, rmf2( pos * 10.0 ) * rmf( pos * 0.4 ), 0.0 );\r\n\r\n  color = mix( color * rmf( pos ), vec3( 0.9, 0.0, 0.9 ), 0.2 );\r\n\r\n  gl_FragColor = vec4( color, 1.0 );\r\n  \r\n}\r\n\r\n@fragment-end@'},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( aPosition, 1.0, 1.0 );\r\n    vTexCoord = aTexCoord;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  vec4 color = TEX( uImage, vTexCoord );\r\n  gl_FragColor = vec4( vec3( step( 1.0, color.r + color.g + color.b / 3.0 ) ), color.a );\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( aPosition, 1.0, 1.0 );\r\n    vTexCoord = aTexCoord;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  vec4 color = TEX( uImage, vTexCoord );\r\n  gl_FragColor = vec4( vec3( color.r + color.g + color.b / 3.0 ), color.a );\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( aPosition, 1.0, 1.0 );\r\n    vTexCoord = aTexCoord;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  vec4 color = TEX( uImage, vTexCoord );\r\n  gl_FragColor = vec4( vec3(\r\n    ( color.r * 0.393 ) + ( color.g * 0.769 ) + ( color.b * 0.189 ),\r\n    ( color.r * 0.349 ) + ( color.g * 0.686 ) + ( color.b * 0.168 ),\r\n    ( color.r * 0.272 ) + ( color.g * 0.534 ) + ( color.b * 0.131 )\r\n  ), color.a );\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( aPosition, 1.0, 1.0 );\r\n    vTexCoord = aTexCoord;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  vec4 color = TEX( uImage, vTexCoord );\r\n  gl_FragColor = vec4( vec3(\r\n    1.0 - color.r,\r\n    1.0 - color.g,\r\n    1.0 - color.b\r\n  ), color.a );\r\n}\r\n@fragment-end@"},function(t,e,n){t.exports=n(23)},function(t,e,n){n(24);var r=n(0);console.log(r,r.Shader.UN),r.Utility.PRINT_VERSION(),r.Sprite.BUILD_DEFAULT_TEXTURE(function(){r.Tilesprite.BUILD_DEFAULT_TEXTURE(function(){var t=new r.Load.LoaderCombiner([{loader:new r.Load.ImageLoader,args:[[{id:"fontimg",src:"./assets/images/font.png"},{id:"fontNoK",src:"./assets/images/fontNoK.png"},{id:"1to8",src:"./assets/images/1to8.png"},{id:"4dots",src:"./assets/images/4dots.png"},{id:"colors",src:"./assets/images/colors.png"},{id:"glass-of-blueberryjuice",src:"./assets/images/glass-of-blueberryjuice.png"},{id:"raindrop",src:"./assets/images/raindrop.png"},{id:"smudge",src:"./assets/images/smudge.png"}],!0]},{loader:new r.Load.XHRLoader,args:[[{id:"fontdataxml",src:"./assets/xhr/font.fnt",type:"xml"},{id:"fontdatajson",src:"./assets/xhr/font.json",type:"json"},{id:"fontNoK",src:"./assets/xhr/fontNoK.xml",type:"xml"},{id:"particleExplosion",src:"./assets/xhr/particle-explosion.json",type:"json"}]]},{loader:new r.Load.SpritesheetLoader,args:[[{id:"sheet-default",image:{src:"./../assets/images/invaders/invaders-sheet.png"},data:{src:"./../assets/xhr/invaders.json",type:"json"}}]]},{loader:new r.Load.TilesetLoader,args:[[{id:"tileset",image:{src:"./../assets/images/spritesheet-tiles.png"},data:{src:"./../assets/xhr/spritesheet-tiles.json",type:"json"}}]]}]);t.onComplete.Add(function(){console.log(t),function(){var e=[];window.testData={xhrloader:t.loaders[1],imgloader:t.loaders[0],ssloader:t.loaders[2],tsloader:t.loaders[3],invadersSpritesheet:t.loaders[2].GetSpritesheetById("sheet-default"),tileset:t.loaders[3].GetTilesetById("tileset")},window.testData.invadersSpritesheet.GenerateFrames();var r=n(50);r.keys().forEach(function(t){e.push(r(t))});for(var i=0,o=e.length;i<o;++i)e[i].default()}()},null,!0),t.Load()})})},function(t,e,n){},function(t,e){Array.prototype.indexPop=function(t){var e=this.length-1;if(e>1&&t<=e&&t>=0){var n=this[e];return this[e]=this[t],this[t]=n,this.pop()}return this.pop()},Array.prototype.indexShift=function(t){if(this.length>1&&t<=this.length-1&&t>=0){var e=this[0];return this[0]=this[t],this[t]=e,this.shift()}return this.shift()},Array.prototype.popSplice=function(t){var e=this.length-1;if(!(e<1)){for(var n=this[t];t<e;)this[t]=this[t+1],t++;return this.pop(),n}},Array.prototype.shiftSplice=function(t){if(!(this.length<1)){for(var e=this[t];t>0;)this[t]=this[t-1],t--;return this.shift(),e}},Array.prototype.fickleSplice=function(t){return t>.5*this.length|0?this.popSplice(t):this.shiftSplice(t)}},function(t){t.exports={name:"nenkraft2",version:"1.3.8",description:"A small rendering tool",main:"./bundle-fe/nk2.js",devDependencies:{"@babel/core":"^7.0.0","@babel/preset-env":"^7.0.0","babel-loader":"^8.0.2","copy-webpack-plugin":"^4.5.2","css-loader":"^1.0.0",eslint:"^5.5.0","file-loader":"^2.0.0","html-loader":"^0.5.5","html-webpack-plugin":"^3.2.0","mini-css-extract-plugin":"^0.4.2","raw-loader":"^0.5.1",rimraf:"^2.6.2",webpack:"^4.17.2","webpack-cli":"^3.1.0","webpack-dev-server":"^3.1.8"},dependencies:{},scripts:{"build-prod":"webpack --env production --mode production","build-bundle-fe":"webpack --env bundle-fe --mode production","build-bundle-be":"webpack --env bundle-be --mode production",start:"webpack-dev-server --env development --mode development","clear-bundle-fe":"rimraf bundle-fe/dist","clear-bundle-be":"rimraf bundle-be/dist","clear-dist":"rimraf dist",ce:"rimraf dist bundle-fe/dist bundle-be/dist",be:"yarn run ce && yarn run build-prod && yarn run build-bundle-be && yarn run build-bundle-fe","lint-f":"eslint src demos --fix",lint:"eslint src demos"},keywords:["2d","rendering","command","vector","game","graphic","tween","animation","collision","canvas","web","webgl","utilities"],author:"nuuf",license:"MIT"}},function(t,e){t.exports="#define PI 3.141592653589793\r\n"},function(t,e){t.exports="#define RADIAN 0.017453292519943295"},function(t,e){t.exports="#define RSEED1 46.1964987\r\n#define RSEED2 71.7294374\r\n#define RSEED3 94638.4836"},function(t,e){t.exports="#define VRSEED1 127.1\r\n#define VRSEED2 311.7\r\n#define VRSEED3 269.5\r\n#define VRSEED4 183.3\r\n#define VRSEED5 43758.5453123"},function(t,e){t.exports="float mod289( float n ) {\r\n     return ( n - floor( n * ( 1.0 / 289.0 ) ) * 289.0 );\r\n}\r\nvec2 mod289( vec2 p ) {\r\n     return ( p - floor( p * ( 1.0 / 289.0 ) ) * 289.0 );\r\n}\r\nvec3 mod289( vec3 p ) {\r\n     return ( p - floor( p * ( 1.0 / 289.0 ) ) * 289.0 );\r\n}"},function(t,e){t.exports="float permute( float n ) { \r\n    return ( mod289( ( ( n * 34.0 ) +1.0 ) * n ) );\r\n}\r\nvec2 permute( vec2 p ) { \r\n    return ( mod289( ( ( p * 34.0 ) +1.0 ) * p ) );\r\n}\r\nvec3 permute( vec3 p ) { \r\n    return ( mod289( ( ( p * 34.0 ) +1.0 ) * p ) );\r\n}"},function(t,e){t.exports="mat2 rotate2d ( float a ) {\r\n    float ca = cos( a );\r\n    float sa = sin( a );\r\n    return mat2( ca, sa, -sa, ca );\r\n}"},function(t,e){t.exports="mat2 scale2d ( vec2 scl ) {\r\n    return mat2( scl.x, 0.0, 0.0, scl.y );\r\n}"},function(t,e){t.exports="float plot ( float n, float pct, float prec ) {\r\n    return (\r\n        smoothstep( pct - prec, pct, n ) -\r\n        smoothstep( pct, pct + prec, n )\r\n    );\r\n}"},function(t,e){t.exports="float ridge( float h, float offset ) {\r\n    h = abs( h );\r\n    h = offset - h;\r\n    h *= h;\r\n    return h;\r\n}"},function(t,e){t.exports="vec2 pixelate( vec2 p, int pixels ) {\r\n    return floor( p * float( pixels ) );\r\n}"},function(t,e){t.exports="float random( float n ) {\r\n    return ( fract( sin( n ) * RSEED3 ) );\r\n}\r\nfloat random( vec2 p ) {\r\n    return ( fract( sin( dot( p, vec2( RSEED1, RSEED2 ) ) ) * RSEED3 ) );\r\n}\r\n"},function(t,e){t.exports="vec2 vrandom( vec2 p ) {\r\n    p = vec2( \r\n        dot( p, vec2( VRSEED1, VRSEED2 ) ),\r\n        dot( p, vec2( VRSEED3, VRSEED4 ) )\r\n    );\r\n    return ( -1.0 + 2.0 * fract( sin ( p ) * VRSEED5 ) );\r\n}"},function(t,e){t.exports="float noise( float n ) {\r\n    float fl = floor( n );\r\n    return( mix( random( fl ), random( fl + 1.0 ), fract( n ) ) );\r\n}\r\nfloat noise ( vec2 p ) {\r\n    vec2 fl = floor( p );\r\n    vec2 fr = fract( p );\r\n    float a = random( fl );\r\n    float b = random( fl + vec2( 1.0, 0.0 ) );\r\n    float c = random( fl + vec2( 0.0, 1.0 ) );\r\n    float d = random( fl + vec2( 1.0, 1.0 ) );\r\n    vec2 sm = fr * fr * ( 3.0 - 2.0 * fr );\r\n    return ( \r\n        mix( a, b, sm.x ) + \r\n        ( c -a ) * sm.y * \r\n        ( 1.0 - sm.x ) + \r\n        ( d - b ) * sm.x * sm.y\r\n    );\r\n}"},function(t,e){t.exports="float gnoise( vec2 p ) {\r\n    vec2 fl = floor( p );\r\n    vec2 fr = fract( p );\r\n    vec2 sm = fr * fr * ( 3.0 - 2.0 * fr );\r\n    return ( mix( \r\n            mix( \r\n                dot( vrandom( fl ), fr ), \r\n                dot( vrandom( fl + vec2( 1.0, 0.0 ) ), fr - vec2( 1.0, 0.0 ) ), sm.x\r\n            ),\r\n            mix( \r\n                dot( vrandom( fl + vec2( 0.0, 1.0 ) ), fr - vec2( 0.0, 1.0 ) ), \r\n                dot( vrandom( fl + vec2( 1.0, 1.0 ) ), fr - vec2( 1.0, 1.0 ) ), sm.x\r\n            ),\r\n            sm.y\r\n        )\r\n    );\r\n}"},function(t,e){t.exports="float snoise( vec2 v ) {\r\n    vec4 C = vec4(\r\n        0.211324865405187,\r\n        0.366025403784439,\r\n        -0.577350269189626,\r\n        0.024390243902439\r\n    );\r\n    vec2 i  = floor( v + dot( v, C.yy ) );\r\n    vec2 x0 = v - i + dot( i, C.xx );\r\n    vec2 i1 = vec2( 0.0 );\r\n    i1 = ( x0.x > x0.y ) ? vec2( 1.0, 0.0 ) : vec2( 0.0, 1.0 );\r\n    vec2 x1 = x0.xy + C.xx - i1;\r\n    vec2 x2 = x0.xy + C.zz;\r\n    i = mod289( i );\r\n    vec3 p = permute(\r\n        permute( i.y + vec3( 0.0, i1.y, 1.0 ) ) + i.x + vec3( 0.0, i1.x, 1.0 )\r\n    );\r\n    vec3 m = max( \r\n        0.5 - vec3(\r\n            dot( x0, x0 ),\r\n            dot( x1, x1 ),\r\n            dot( x2, x2 )\r\n        ),\r\n    0.0);\r\n    m = m * m ;\r\n    m = m * m ;\r\n    vec3 x = 2.0 * fract( p * C.www ) - 1.0;\r\n    vec3 h = abs( x ) - 0.5;\r\n    vec3 ox = floor( x + 0.5 );\r\n    vec3 a0 = x - ox;\r\n    m *= 1.79284291400159 - 0.85373472095314 * ( a0 * a0 + h * h );\r\n    vec3 g = vec3( 0.0 );\r\n    g.x  = a0.x  * x0.x  + h.x  * x0.y;\r\n    g.yz = a0.yz * vec2( x1.x, x2.x ) + h.yz * vec2( x1.y, x2.y );\r\n    return ( 130.0 * dot( m, g ) );\r\n}"},function(t,e){t.exports="float fbm ( vec2 p ) {\r\n    float v = 0.0;\r\n    float AMP = 0.5;\r\n    float MULT = 2.0;\r\n    float AMP_MULT = 0.5;\r\n    const int OCTAVES = 3;\r\n    for ( int i = 0; i < OCTAVES; ++i ) {\r\n        v += AMP * NOISE( p );\r\n        AMP *= AMP_MULT;\r\n        p *= MULT;\r\n    }\r\n    return v;\r\n}"},function(t,e){t.exports="float abs_fbm ( vec2 p ) {\r\n    float v = 0.0;\r\n    float AMP = 0.5;\r\n    float LACUNARITY = 2.0;\r\n    float GAIN = 0.5;\r\n    const int OCTAVES = 3;\r\n    for ( int i = 0; i < OCTAVES; ++i ) {\r\n        v += AMP * abs( NOISE( p ) );\r\n        AMP *= GAIN;\r\n        p *= LACUNARITY;\r\n    }\r\n    return v;\r\n}"},function(t,e){t.exports="float rot_fbm_3 ( vec2 p, float a ) {\r\n    float v = 0.0;\r\n    vec2 s = vec2( 100.0 );\r\n    mat2 r = rotate2d( a );\r\n    v += 0.500000 * NOISE( p ); p = p * r * 2.0043 + s;\r\n    v += 0.250000 * NOISE( p ); p = p * r * 2.0310 + s;\r\n    v += 0.125000 * NOISE( p );\r\n    return v;\r\n}"},function(t,e){t.exports="float rmf ( vec2 p ) {\r\n    float LACUNARITY = 2.0;\r\n    float GAIN = 0.5;\r\n    float OFFSET = 0.9;\r\n    float v = 0.0;\r\n    float f = 1.0;\r\n    float AMP = 0.5;\r\n    float prev = 1.0;\r\n    const int OCTAVES = 3;\r\n    for ( int i = 0; i < OCTAVES; ++i ) {\r\n        float n = ridge( snoise( p * f ), OFFSET );\r\n        v += ( n * AMP ) + ( n * AMP * prev );\r\n        prev = n;\r\n        f *= LACUNARITY;\r\n        AMP *= GAIN;\r\n    }\r\n    return v;\r\n}"},function(t,e){t.exports="float aabb( vec2 pos, vec2 size, float blur ){\r\n    size = 0.5 - size * 0.5;\r\n    vec2 dim = smoothstep( size, size + blur, pos ) *\r\n               smoothstep( size - blur, size, 1.0 - pos - blur );\r\n    return dim.x * dim.y;\r\n}"},function(t,e){t.exports="float cruciform( vec2 pos, float size, float armSize, float blur ) {\r\n  return aabb( pos, vec2( size, armSize ), blur ) +\r\n         aabb( pos, vec2( armSize, size ), blur );\r\n}"},function(t,e){t.exports="float circle( vec2 pos, float r, float blur ) {\r\n  return ( 1.0 - smoothstep( r - blur, r, dot( pos , pos ) * 4.0 ) );\r\n}"},function(t,e,n){var r={"./playground/pg.bla.demo":51,"./playground/pg.cameradrag.demo":52,"./playground/pg.packing.demo":53,"./playground/pg.un.demo":54,"./solid/01.sprite.demo":55,"./solid/02.graphic2d.demo":56,"./solid/03.container2d.demo":57,"./solid/04.bitmap-text.demo":58,"./solid/05.stage2d.demo":59,"./solid/06.stadium.demo":60,"./solid/07.canvas-manager.demo":61,"./solid/08.camera2d.demo":62,"./solid/09.basic-setup.demo":63,"./solid/10.tilesprite.demo":64,"./solid/11.text.demo":65,"./solid/12.geom.demo":66,"./solid/13.collision-aabb2d.demo":67,"./solid/14.collision-circle.demo":68,"./solid/15.collision-polygon2d.demo":69,"./solid/16.collision-line2d-circle.demo":70,"./solid/17.create-texture.demo":71,"./solid/18.animation.demo":72,"./solid/19.quadtree.demo":73,"./solid/20.ray-casting.demo":74,"./solid/21.particle-system.demo":75,"./solid/22.webgl-animation.demo":76,"./solid/23.webgl-circle.demo":77,"./solid/24.webgl-rectangle.demo":78,"./solid/25.webgl-line2d.demo":79,"./solid/26.webgl-pixelbatch.demo":80,"./solid/27.webgl-texture2dbatch.demo":81,"./solid/28.webgl-bitmap-text.demo":82,"./solid/29.webgl-tilesprite.demo":83,"./solid/30.stresstest.demo":84,"./solid/31.webgl-stresstest.demo":85,"./solid/32.utilities.demo":86,"./solid/33.motion.demo":87,"./solid/34.interaction.demo":88,"./solid/35.webgl-rendertexture.demo":89,"./solid/36.spritesheet.demo":90,"./solid/37.culler.demo":91,"./solid/38.tilemap.demo":92};function i(t){var e=o(t);return n(e)}function o(t){var e=r[t];if(!(e+1)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return e}i.keys=function(){return Object.keys(r)},i.resolve=o,t.exports=i,i.id=50},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("PGBLA",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200),u=new i.Vector2D(0,0),l=new i.Vector2D(0,0),c=null,h=new i.Graphic2D(0,0,new i.Path.AABB2D(-50,-50,50,50)),f=new i.Graphic2D(0,0,new i.Path.Line2D(-50,-50,50,50)),d=new i.Graphic2D(0,0,new i.Path.Circle(0,0,25)),p=new i.Graphic2D(0,0,new i.Path.Circle(0,0,25)),y=new i.Graphic2D(0,0,new i.Path.Circle(0,0,25)),v=new i.Graphic2D(0,0,new i.Path.Circle(0,0,25)),m={shape:h.path,relative:h.position},b={shape:f.path,relative:f.position},g=new i.Collision.AABB2DvsLine2D.Result,w=i.Collision.AABB2DvsLine2D.CollideRel;d.interactive=p.interactive=y.interactive=v.interactive=!1,a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s).AddChildren(h,f,d,p,y,v),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger(),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process(),f.path.Rotate(10*i.Math.RADIAN),g.Reset(),w(m,b,g),g.top&&d.position.SetV(g.poc.a),g.right&&p.position.SetV(g.poc.b),g.bottom&&y.position.SetV(g.poc.c),g.left&&v.position.SetV(g.poc.d)}),r.mouse.onDown.Add(function(t){if(0===t.data.native.button){for(var e=s.children.length,n=t.data.position;e--;)if(s.children[e].IntersectsPoint2D(n)){u.SetV(n),c=s.children[e],l.SetV(c.position),t.stopPropagation=!0,c.SendToFront();break}c||a.target.position.SetV(n)}}),r.mouse.onMove.Add(function(t){if(c){var e=t.data.position;c.position.SetV(e).AddV(l).SubtractV(u)}},r),r.mouse.onUp.Add(function(){c&&(c=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("PGCAMERADRAG",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s={canvas:a,halt:!0},u=t.stage=new i.Stage2D(s),l=new i.Camera2D(new i.Vector2D(r,o),{position:new i.Vector2D(0,0)}),c=new i.VisualContainer2D(0,0),h=new i.Sprite(0,0),f=new i.Vector2D(0,0),d=new i.Vector2D(0,0),p=!1;u.AddChild(l).AddChild(c).AddChild(h),u.ticker.StartAF(),u.mouse.onDown.Add(function(t){p=!0,f.SetV(t.data.position),d.SetV(l.position)}),u.mouse.onUp.Add(function(){p=!1}),u.mouse.onMove.Add(function(t){p&&l.position.SetV(t.data.position).AddV(d).SubtractV(f)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("PGPACKING",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";for(var s={canvas:a,halt:!0},u=t.stage=new i.Stage2D(s),l=new i.Camera2D(new i.Vector2D(r,o),{position:new i.Vector2D(0,0)}),c=new i.VisualContainer2D(0,0),h=new i.Vector2D(0,0),f=new i.Vector2D(0,0),d=!1,p=15,y=[];p--;){var v=new i.Sprite(0,0);v.w=100+100*Math.random()|0,v.h=100+10*Math.random()|0,y.push(v)}y.sort(function(t,e){return e.w-t.w}),(new i.Packing.RectanglePacker).SetPadding(10,10).PackDynamic(y).forEach(function(t,e){t&&y[e].position.SetV(t.tl)}),u.AddChild(l).AddChild(c).AddChildren(y),u.ticker.StartAF(),u.mouse.onDown.Add(function(t){d=!0,h.SetV(t.data.position),f.SetV(l.position)}),u.mouse.onUp.Add(function(){d=!1}),u.mouse.onMove.Add(function(t){d&&l.position.SetV(t.data.position).AddV(f).SubtractV(h)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("PGUNDEMO",function(t){var e=600,n=400,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"WebGL"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(300,200);a.gl.clearColor(.9,.9,.9,1),u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();for(var c=new i.Controller.ProgramController.GLUnProgramController(a.gl,i.Shader.UN),h=1;h--;){var f=new i.GLEntity2D(0,0,c);f.transformAutomaticUpdate=!0,f.transformShouldUpdate=!0;f.w=f.h=384,f.w=e,f.h=n,f.timeInc=.05/12,f.ComputeLocalBounds({x:.5,y:.5}),f.position.Set(i.Utility.RandomInteger(-300,300),i.Utility.RandomInteger(-200,200)),f.position.Set(300,200),s.AddChild(f)}a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Sprite",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new i.Sprite(r,o),u=new i.Graphic2D(r,o,new i.Path.Line2D(-r,0,r,0)),l=new i.Graphic2D(r,o,new i.Path.Line2D(0,-o,0,o));s.anchor.SetSame(.5),s.UpdateTextureTransform();var c=a.getContext("2d");s.Render(c),u.Render(c),l.Render(c)})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Graphic2D",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new i.Path.Circle(0,0,50);new i.Graphic2D(r,o,s).Render(a.getContext("2d"))})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("VisualContainer2D",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new i.Sprite(r,o);s.anchor.SetSame(.5),s.UpdateTextureTransform();var u=new i.VisualContainer2D(0,0);u.AddChild(s),u.Render(a.getContext("2d"))})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("BitmapText",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute",a.style.backgroundColor="white";var s=a.getContext("2d"),u=new i.BitmapText(0,0,window.testData.imgloader.GetBasicTextureById("fontNoK"),window.testData.xhrloader.GetDataById("fontNoK"),"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.");u.scale.SetSame(.6),u.x=r-.5*u.width,u.y=o-.5*u.height,u.Render(s)})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Stage2D",function(t){var e=window.innerWidth,n=window.innerHeight,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!0},a=t.stage=new i.Stage2D(o);a.ticker.StartAF(),a.onProcess.Add(function(){console.log("tick"),a.onProcess.Dump()})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Stadium",function(t){var e={className:"mcnvs",width:600,height:400,mode:"2d",fill:!1},n=t.stadium=new i.Stadium(e);function r(){this.children.forEach(o)}function o(t){t.position.AddV(t.data.velocity),t.data.velocity.Rotate(t.data.torque)}n.CreateStage2D("stage1"),n.CreateStage2D("stage2"),n.CreateStage2D("stage3"),n.CreateStage2D("stage4"),n.GetStages("stage1","stage2","stage3").forEach(function(t){for(var e=10;e--;){var n=t.AddChild(new i.Graphic2D(i.Utility.RandomFloat(100,500),i.Utility.RandomFloat(50,350),new i.Path.Circle(0,0,i.Utility.RandomInteger(10,50))));n.data.velocity=new i.Vector2D(i.Utility.RandomFloat(-1,1),i.Utility.RandomFloat(-1,1)),n.data.torque=i.Utility.RandomFloat(-i.Math.RADIAN,i.Math.RADIAN)}t.onProcess.Add(r,t)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("CanvasManager",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",1920),e.setAttribute("height",1080),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0);(t.canvasManager=new i.CanvasManager(e,1920,1080,i.CanvasManager.KEEP_ASPECT_RATIO_FIT)).BindStage(r).BindRootContainer(o).Trigger()})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Camera2D",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s={canvas:a,halt:!0},u=t.stage=new i.Stage2D(s),l=new i.Camera2D(new i.Vector2D(r,o),{position:new i.Vector2D(0,0)}),c=new i.VisualContainer2D(0,0),h=new i.Sprite(0,0);u.AddChild(l).AddChild(c).AddChild(h),u.mouse.AddOffset(l),u.ticker.StartAF(),u.onProcess.Add(function(){l.Process()}),u.mouse.onDown.Add(function(t){l.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("BasicSetup",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200),u=new i.Sprite(0,0);a.force.SetSame(5),u.anchor.SetSame(.5),u.UpdateTextureTransform(),r.AddChild(o).AddChild(a).AddChild(s).AddChild(u),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger(),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Tilesprite",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=a.getContext("2d"),u=new i.Tilesprite(r,o,i.Tilesprite.DEFAULT_TEXTURE);u.GeneratePattern(s,640,640),u.x=r-.5*u.width,u.y=o-.5*u.height,u.Render(s)})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Text",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute",a.style.backgroundColor="white";var s=a.getContext("2d"),u=new i.Text(r,o,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.");u.style.text.align=i.Style.TextConf.ALIGN_CENTER,u.style.text.baseline=i.Style.TextConf.BASELINE_MIDDLE,u.style.text.lineWidth=.3,u.style.text.font="40px Arial",u.Render(s)})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Geom",function(t){var e=window.innerWidth,n=window.innerHeight,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o=r.getContext("2d"),a=new i.Path.Circle(0,0,50),s=new i.Path.AABB2D(0,0,100,100),u=new i.Path.Polygon2D,l=new i.Path.Line2D(0,0,100,100),c=new i.Path.Polygon2D,h=new i.Path.Polygon2D;i.Geom.PolygonConstruction.Butterfly(u,0,0,1e3,50),i.Geom.PolygonConstruction.Star(c,0,0,100,50,5),i.Geom.PolygonConstruction.Rose(h,0,0,100,7/9,1e3,9);var f=new i.Graphic2D(100,100,a),d=new i.Graphic2D(200,100,s),p=new i.Graphic2D(350,100,l),y=new i.Graphic2D(600,200,u),v=new i.Graphic2D(100,300,c),m=new i.Graphic2D(400,400,h);f.Render(o),d.Render(o),p.Render(o),y.Render(o),v.Render(o),m.Render(o)})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("CollisionAABB2D",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u);var c=i.Collision.AABB2DvsAABB2D.CollideRel,h=new i.Collision.AABB2DvsAABB2D.Result,f=l.AddChild(new i.Graphic2D(0,100,new i.Path.AABB2D(0,0,50,50))),d=l.AddChild(new i.Graphic2D(0,0,new i.Path.AABB2D(0,0,400,100))),p={shape:f.path,relative:f.position},y={shape:d.path,relative:d.position},v=new i.Vector2D(0,0),m=new i.Vector2D(0,0),b=null;a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){for(var e=l.children.length,n=t.data.position;e--;)if(l.children[e].IntersectsPoint2D(n)){v.SetV(n),b=l.children[e],m.SetV(b.position),t.stopPropagation=!0,b.SendToFront();break}b||u.target.position.SetV(n)}),a.mouse.onMove.Add(function(t){if(b){var e=t.data.position;b.position.SetV(e).AddV(m).SubtractV(v),h.Reset(),c(p,y,h),h.occured&&p.relative.AddV(h.mtv)}},a),a.mouse.onUp.Add(function(){b&&(b=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("CollisionCircle",function(t){var e=5760,n=3240,r=2880,o=1620,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s={canvas:a,halt:!1},u=t.stage=new i.Stage2D(s),l=new i.VisualContainer2D(0,0),c=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),h=new i.VisualContainer2D(r,o);c.force.SetSame(5),u.AddChild(l).AddChild(c).AddChild(h);for(var f=new i.CanvasManager(a,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT),d=[],p=i.Collision.CirclevsCircle.CollideRel,y=i.Collision.CirclevsCircle.ElasticResponse,v=new i.Collision.CirclevsCircle.Result,m=50;m--;){var b=i.Utility.RandomInteger(50,125),g=new i.Path.Circle(0,0,b),w=new i.Graphic2D(i.Utility.RandomFloat(-r,r),i.Utility.RandomFloat(-o,o),g);w.data.body={shape:g,relative:w.position,mass:b,velocity:new i.Vector2D(i.Utility.RandomInteger(-30,30),i.Utility.RandomInteger(-30,30))},d.push(w.data.body),h.AddChild(w)}f.BindStage(u).BindRootContainer(l).Trigger(),u.mouse.AddOffset(h).AddOffset(c),u.onProcess.Add(function(){c.Process();for(var t,e,n=0,i=0,a=d.length;n<a;++n)for((t=d[n]).relative.AddV(t.velocity),t.relative.x>r?(t.relative.x=r,t.velocity.x=-t.velocity.x):t.relative.x<-r&&(t.relative.x=-r,t.velocity.x=-t.velocity.x),t.relative.y>o?(t.relative.y=o,t.velocity.y=-t.velocity.y):t.relative.y<-o&&(t.relative.y=-o,t.velocity.y=-t.velocity.y),i=0;i<a;++i)t!==(e=d[i])&&(v.Reset(),p(t,e,v),v.occured&&y(t,e,v))}),u.mouse.onDown.Add(function(t){c.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("CollisionPolygon2D",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l);for(var c=new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT),h=[],f=i.Collision.Polygon2DvsPolygon2D.CollideRel,d=new i.Collision.Polygon2DvsPolygon2D.Result,p=new i.Vector2D(0,0),y=new i.Vector2D(0,0),v=null,m=100;m--;){var b=new i.Path.Polygon2D;i.Geom.PolygonConstruction.Cyclic(b,0,0,i.Utility.RandomInteger(30,60),i.Utility.RandomInteger(3,6));var g=new i.Graphic2D(0,0,b);g.data.body={shape:b,relative:g.position},h.push(g.data.body),l.AddChild(g)}c.BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process();for(var t,e,n=0,r=0,i=h.length;n<i;++n)for(t=h[n],r=0;r<i;++r)t!==(e=h[r])&&(d.Reset(),f(t,e,d),d.occured&&(v?(t.relative!==v.position&&t.relative.SubtractV(d.mtv),e.relative!==v.position&&e.relative.AddV(d.mtv)):(d.mtv.Multiply(.5,.5),t.relative.SubtractV(d.mtv),e.relative.AddV(d.mtv))))}),a.mouse.onDown.Add(function(t){for(var e=l.children.length,n=t.data.position;e--;)if(l.children[e].IntersectsPoint2D(n)){p.SetV(n),v=l.children[e],y.SetV(v.position),t.stopPropagation=!0,v.SendToFront();break}v||u.target.position.SetV(n)}),a.mouse.onMove.Add(function(t){if(v){var e=t.data.position;v.position.SetV(e).AddV(y).SubtractV(p)}},a),a.mouse.onUp.Add(function(){v&&(v=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("CollisionLine2DCircle",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();for(var u=[],l=[],c=50;c--;){var h=new i.Path.Circle(0,0,i.Utility.RandomInteger(5,8)),f=new i.Graphic2D(0,0,h);f.data.body={shape:h,relative:f.position,velocity:new i.Vector2D(i.Utility.RandomFloat(-4,4),i.Utility.RandomFloat(-4,4))},s.AddChild(f),u.push(f.data.body)}for(var d=50;d--;){var p=new i.Path.Line2D(0,0,i.Utility.RandomInteger(10,25),i.Utility.RandomInteger(10,25)),y=new i.Graphic2D(i.Utility.RandomInteger(-300,300),i.Utility.RandomInteger(-200,200),p);p.Rotate(i.Math.RADIAN*i.Utility.RandomInteger(0,360)),y.data.body={shape:p,relative:y.position},s.AddChild(y),l.push(y.data.body)}var v=i.Collision.CirclevsLine2D.CollideRel,m=i.Collision.CirclevsLine2D.ReflectingResponse,b=new i.Collision.CirclevsLine2D.Result;r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){var t,e;a.Process();for(var n=0;n<u.length;++n){(t=u[n]).relative.AddV(t.velocity),t.relative.y<-200&&(t.relative.y=-200,t.velocity.y*=-1),t.relative.y>200&&(t.relative.y=200,t.velocity.y*=-1),t.relative.x<-300&&(t.relative.x=-300,t.velocity.x*=-1),t.relative.x>300&&(t.relative.x=300,t.velocity.x*=-1);for(var r=0;r<l.length;++r)e=l[r],b.Reset(),v(t,e,b),b.occured&&m(t,e,b)}}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("CreateTexture",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new Image;s.onload=function(){var t=new i.Sprite(r,o,new i.Texture.BasicTexture2D(s));t.anchor.Set(.5,.5),t.Render(a.getContext("2d"))},s.src=i.BrowserUtility.GenerateSimpleBase64PNG(function(){var t=new i.Path.Polygon2D;return i.Geom.PolygonConstruction.Supershape(t,0,0,100,100,6,.3,.3,.3),new i.Graphic2D(Math.abs(t.aabb.tl.x),Math.abs(t.aabb.tl.y),t)},null,null,"white")})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Animation",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.Sprite(0,0,window.testData.imgloader.GetBasicTextureById("1to8"));u.anchor.SetSame(.5),u.UpdateTextureTransform(),s.AddChild(u);var l=(u.animationController=new i.Animator.Controller(u)).CreateAnimation("play",25);u.width=64,u.height=64,l.GenerateFrames(64,64,512,64,8,{5:10,3:8,1:6}),l.reverse=!0,l.loop=!0,l.Start(),l.onEnd.Add(function(){console.log("end")}),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process(),l.Process()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Quadtree",function(t){var e=window.innerWidth,n=window.innerHeight,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.Geom.AABB2D(0,0,e,n),u=new i.QuadtreeNode(s,0,4,5),l=[],c=[];a.onProcess.Add(function(){l.forEach(function(t){i.Debug.Draw.AABB2D(a.rc,t.aabb)})}),a.mouse.onDown.Add(function(t){var e=new i.Graphic2D(t.data.position.x,t.data.position.y,new i.Path.AABB2D(0,0,10,10));e.ComputeLocalBounds(e.anchor),a.AddChild(e),c.push(e),u.Dump(),c.forEach(function(t){u.Add(t.bounds.local)}),l.length=0,u.ConcatNodes(l)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("RayCasting",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();for(var c=[],h=[],f=100;f--;){var d=new i.Path.Polygon2D;i.Geom.PolygonConstruction.Cyclic(d,i.Utility.RandomInteger(-e,e),i.Utility.RandomInteger(-n,n),i.Utility.RandomInteger(30,60),i.Utility.RandomInteger(3,8)),d.Rotate(i.Utility.RandomFloat(0,i.Math.PII));var p=new i.Graphic2D(0,0,d);c.push(p)}for(var y=180,v=2*Math.PI/y;y--;){var m=v*y,b=new i.Path.Ray2D(0,0,0,0);b.style.stroke.lineWidth=1;var g=new i.Graphic2D(0,0,b);g.interactive=!1,g.data.angle=m,g.data.r=360,h.push(g)}l.Mount(c.concat(h)),a.mouse.AddOffset(l).AddOffset(u);var w=new i.Vector2D(0,0);a.onProcess.Add(function(){u.Process(),h.forEach(function(t){t.path.s.SetV(a.mouse.position),t.path.e.SetV(t.path.s),t.path.e.Add(t.data.r,t.data.r),t.path.e.RotateAroundV(t.path.s,t.data.angle)});for(var t,e,n,r=0,o=0,s=0,l=0,f=h[r],d=h.length,p=c.length,y=0;r<d;f=h[++r])for(t=c[o=0];o<p;t=c[++o])for(s=0,l=(y=t.path.vertices.length)-1;s<y;l=s++)e=t.path.vertices[s],n=t.path.vertices[l],i.Collision.Line2DvsLine2D.Line2DLine2DCollision(f.path.s,f.path.e,e,n,w)&&h[r].path.e.SetV(w)}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("ParticleSystem",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540),c=new i.Particle.Particle2D.System(0,0),h=window.testData.xhrloader.GetClonedDataById("particleExplosion"),f=new i.Time.Timer(10),d=new i.Geom.Polygon2D;i.Geom.PolygonConstruction.Cyclic(d,0,0,400,72);var p=d.Copy();p.vertices.forEach(function(t){t.Invert(),t.Multiply(.1,.1)}),f.onFinish.Add(function(){c.Emit(h),f.Start()}),f.Start(),h.texture=i.Sprite.DEFAULT_TEXTURE,h.position={points:d.vertices,moduloWrapper:d.vertices.length},h.velocity={points:p.vertices,moduloWrapper:p.vertices.length},u.force.SetSame(.1),a.AddChild(s).AddChild(u).AddChild(l).AddChild(c),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process(),c.Process(),f.Process()}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("WebGLAnimation",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,mode:"WebGL2",antialias:!0},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger(),r.mouse.AddOffset(s).AddOffset(a);var u=new i.Controller.ProgramController.GLDynamicTexture2DProgramController(r.gl,2);u.BindBasicTexture(i.Sprite.DEFAULT_TEXTURE,0),u.BindBasicTexture(window.testData.imgloader.GetBasicTextureById("1to8"),1);var l=new i.Sprite(0,0,u,1),c=new i.Sprite(0,0,u,0);l.anchor.SetSame(.5),c.anchor.SetSame(.5),c.UpdateTextureTransform(),c.alpha=.5,s.AddChildren(l,c);var h=(l.animationController=new i.Animator.Controller(l)).CreateAnimation("play",25);l.width=64,l.height=64,h.GenerateFrames(64,64,512,64,8,{5:10,3:8,1:6}),h.loop=!0,h.Start(),r.onProcess.Add(function(){a.Process(),h.Process()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("WebGLCircle",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"WebGL"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();for(var c=new i.Controller.ProgramController.GLCircleProgramController(a.gl),h=1e3;h--;){var f=new i.Path.Circle(0,0,50);f.style.stroke.lineWidth=1,f.LinkProgramController(c);var d=new i.Graphic2D(i.Utility.RandomInteger(-960,960),i.Utility.RandomInteger(-540,540),f);l.Mount(d)}a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("WebGLRectangle",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.Controller.ProgramController.GLRectangleProgramController(r.gl),l=new i.Path.AABB2D(-100,-100,100,100);l.style.stroke.lineWidth=1,l.LinkProgramController(u);var c=new i.Graphic2D(0,0,l);s.Mount(c),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process(),c.rotation+=i.Math.RADIAN}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("WebGLLine2D",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.Controller.ProgramController.GLLine2DProgramController(r.gl),l=new i.Path.Line2D(-100,-100,100,100);l.style.stroke.lineWidth=1,l.LinkProgramController(u);var c=new i.Graphic2D(0,0,l);s.Mount(c),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process(),c.rotation+=i.Math.RADIAN}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("WebGLPixelBatch",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.BatchableContainer2D(0,0),l=new i.Controller.ProgramController.GLPixelBatchProgramController(r.gl);s.AddChild(u),u.UseAsBatchParent(l);for(var c=1e4;c--;){var h=new i.Path.Pixel(0,0);h.color.r=.2,h.color.g=Math.random(),h.color.b=.8,h.color.a=i.Utility.RandomFloat(.1,.6),h.style.pixel.size=i.Utility.RandomFloat(1,5);var f=new i.Graphic2D(0,0,h);f.data.velocity=new i.Vector2D(i.Utility.RandomFloat(-2,2),i.Utility.RandomFloat(-2,2)),f.data.torque=i.Utility.RandomFloat(20*-i.Math.RADIAN,20*i.Math.RADIAN),u.Mount(f),f.UpdateTransform(f.parent)}u.ComputeBatchBuffer(),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){var t;a.Process();for(var e=0;e<u.children.length;++e)(t=u.children[e]).data.velocity.Rotate(t.data.torque),t.position.AddV(t.data.velocity),t.UpdateInBuffer()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("WebGLTexture2DBatch",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200),u=new i.Sprite(0,0);a.force.SetSame(5),u.anchor.SetSame(.5),u.UpdateTextureTransform(),r.AddChild(o).AddChild(a).AddChild(s).AddChild(u),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var l=new i.BatchableContainer2D(0,0),c=new i.Controller.ProgramController.GLTexture2DBatchProgramController(r.gl);c.BindBasicTexture(window.testData.imgloader.GetBasicTextureById("colors")),s.AddChild(l),l.UseAsBatchParent(c);for(var h=1e4;h--;){var f=new i.Sprite(0,0,c.originalTexture);f.w=64,f.h=64,f.scale.SetSame(.05),f.anchor.SetSame(.5),f.animationController=new i.Animator.Controller(f);var d=f.animationController.CreateAnimation("animation",60);d.GenerateFrames(64,64,1024,64,16),d.SetFrame(i.Utility.RandomInteger(0,15)),f.data.velocity=new i.Vector2D(i.Utility.RandomFloat(-2,2),i.Utility.RandomFloat(-2,2)),f.data.torque=i.Utility.RandomFloat(20*-i.Math.RADIAN,20*i.Math.RADIAN),l.Mount(f),f.UpdateTransform(f.parent)}l.ComputeBatchBuffer(),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){var t;a.Process();for(var e=0;e<l.children.length;++e)(t=l.children[e]).data.velocity.Rotate(t.data.torque),t.position.AddV(t.data.velocity),t.UpdateInBuffer()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("WebGLBitmapText",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);r.gl.clearColor(1,1,1,1),a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.Controller.ProgramController.GLTexture2DProgramController(r.gl);u.BindBasicTexture(window.testData.imgloader.GetBasicTextureById("fontimg"));var l=new i.BitmapText(0,0,u,window.testData.xhrloader.GetDataById("fontdataxml"),"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.");l.scale.SetSame(.3),l.x=.5*-l.width,l.y=.5*-l.height,s.AddChild(l),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("WebGLTilesprite",function(t){var e=960,n=540,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"WebGL"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(480,270);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();var c=new i.Controller.ProgramController.GLTexture2DProgramController(a.gl);c.BindBasicTexture(i.Tilesprite.DEFAULT_TEXTURE);var h=new i.Tilesprite(-240,-135,c);h.GeneratePattern(null,480,270),l.AddChild(h),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process(),h.OffsetPattern(1,1)}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Stresstest",function(t){var e=window.innerWidth,n=window.innerHeight,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o=r.getContext("2d"),a=new i.VisualContainer2D(0,0),s=t.ticker=new i.Time.Ticker(function(){o.setTransform(1,0,0,1,0,0),o.fillStyle="rgba(0,0,0,1)",o.fillRect(0,0,e,n),a.Render(o),d.Process()},1e3,!0),u=20,l=0,c=35,h=[],f=new i.Pool,d=new i.Time.Timer;f.Flood(function(){var t=new i.Sprite(Math.random()*e,Math.random()*n);return t.transformAutomaticUpdate=!1,t},2e4),d.onFinish.Add(function(){var t=c;for(c=c<3?3:c--;t--;)a.AddChild(f.Retrieve());if(s.GetTPS()>40||l++<20)this.Start(1);else{var e=a.children.length;console.log(e,s.GetTPS()),a.children.forEach(function(t){f.Store(t)}),a.Dump(),l=0,h.push(e),--u>0?this.Start(120):(h.sort(function(t,e){return t-e}),console.log(h,"\nMIN: "+h[0],"MED: "+h[Math.round(h.length/2)],"MAX: "+h[h.length-1]))}},d),s.Start(),d.Start(120)})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("WebGLStresstest",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=a.getContext("webgl2"),u=new i.VisualContainer2D(0,0),l=t.ticker=new i.Time.Ticker(function(){s.viewport(0,0,e,n),s.clear(s.COLOR_BUFFER_BIT),s.enable(s.BLEND),s.disable(s.DEPTH_TEST),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),u.GLRender(s),y.Process(),s.flush()},1e3,!0),c=20,h=0,f=35,d=[],p=new i.Pool(i.Sprite),y=new i.Time.Timer,v=new i.Controller.ProgramController.GLTexture2DProgramController(s);v.BindBasicTexture(i.Sprite.DEFAULT_TEXTURE,s.NEAREST),u.scale.Set(2/e,-2/n),u.position.Add(0,0),u.UpdateTransform(u.parent),p.Flood(function(){var t=new i.Sprite(Math.random()*e-r,Math.random()*n-o,v);return t.transformAutomaticUpdate=!1,t},4e4),y.onFinish.Add(function(){var t=f;for(f=f<3?3:f--;t--;)u.AddChild(p.Retrieve());if(l.GetTPS()>40||h++<20)this.Start(1);else{var e=u.children.length;console.log(e,l.GetTPS()),u.children.forEach(function(t){p.Store(t)}),u.Dump(),h=0,d.push(e),--c>0?this.Start(120):(d.sort(function(t,e){return t-e}),console.log(d,"\nMIN: "+d[0],"MED: "+d[Math.round(d.length/2)],"MAX: "+d[d.length-1]))}},y),l.Start(),y.Start(120)})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.default=function(){Object(r.a)("Utilities",function(t){var e=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mem1=e,this.mem2=n,this.mem3=null,this.mem4=null,this.deep={deeper:{deepest:0}}}var e,n,r;return e=t,(n=[{key:"Some",value:function(t){this.mem3=t,this.mem4=this.mem1+this.mem2}}])&&o(e.prototype,n),r&&o(e,r),t}(),n=new i.Maker;console.log(n.Many(15).Make(e,"@i(*|2)","@i(%|3)").Call(Math.random,null,"deep.deeper.deepest").Call("Some",["@i"]).Call(console.log,["$deep.deeper.deepest"]).Ship(!0)),console.log(n),i.Glob.Create("myGlob");var r=window.myGlob;r.Define(i.Glob.CONSTANT,"myConstant","someValue"),r.Define(i.Glob.FUNCTION,"myFunction",function(){}),r.Define(i.Glob.VALUE,"myValue","someValue");try{r.Mark(i.Glob.CONSTANT,"myConstant")}catch(t){console.error(t)}r.Mark(i.Glob.OBJECT,"myObject");try{r.Set(i.Glob.OBJECT,"myObject",0)}catch(t){console.error(t)}r.Set(i.Glob.OBJECT,"myObject",{}),console.log(r),window.myGlob=void 0,i.Assert.LOG=!0,i.Assert(0,i.Assert.IS_SAME_TYPE,1),i.Assert("myString",i.Assert.IS,"myString"),i.Assert(10,i.Assert.IS_GREATER_THAN,9);try{i.Assert(10,i.Assert.IS_LESS_THAN,9)}catch(t){console.error(t)}try{i.Assert([],i.Assert.IS_SAME_TYPE,Object)}catch(t){console.error(t)}i.Assert([],i.Assert.IS_INSTANCE_OF,Object);var a=new i.CP.Registry;i.CP.Command.OPTION_PREFIX="--",a.AddCommand(new i.CP.Command("myCommand mycmd",function(t,e,n){console.log(t,e,n,"prime")},"some info about this command",!0,!0).AddOption("anOption anopt",function(t,e,n){console.log(t,e,n,"priorty 0")},"some info about this option",0,!1).AddOption("op2",function(){console.log("op2 called.","priorty 99")},"brrrr",99,!1)),console.log(a),a.Parse('myCommand --anopt someData=myData someString --op2 (JSON)myJsonData={"someJsonData":"value"}',{someStatic:"data"}),null!=a.Parse("what?")&&console.error("Unknown command");var s=a.Parse("hmmm...");s&&console.error(s,"- is not a recognized command")})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}e.default=function(){Object(r.a)("Motion",function(t){var e=function(t){function e(t,n,a){var u,h,f;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),h=this,(u=!(f=s(e).call(this,0,0,new i.Path.Line2D(t.x,t.y,n.x,n.y)))||"object"!==o(f)&&"function"!=typeof f?l(h):f).path.style.stroke.color=new i.Color(i.Utility.RandomInteger(u.w,200),i.Utility.RandomInteger(u.w,150),i.Utility.RandomInteger(0,20),1).value,u.path.style.stroke.lineWidth=u.w/12,a.AddChild(l(l(u))),u.x=i.Utility.RandomFloat(-c,c),u.y=i.Utility.RandomFloat(0,r),u.rotation=i.Utility.RandomInteger(0,i.Math.PII),u.rotation=i.Utility.FlipACoin(u.rotation,-u.rotation);var d=u.motionManager=new i.Motion.Manager(l(l(u))),p=d.Create("moveX","x",0,120,"SineInOut"),y=d.Create("moveY","y",0,120,"SineInOut"),v=d.Create("rotate","rotation",0,120,"SineInOut");return d.Start("moveX"),p.onEnd.Add(function(){v.Start()}),v.onEnd.Add(function(){y.Start()}),u.w>12&&u.Grow(),u}var n,h,f;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(e,i["Graphic2D"]),n=e,(h=[{key:"Grow",value:function(){var t=this.path.e.SubtractVC(this.path.s),n=t.Copy();t.Rotate(50*i.Math.RADIAN+i.Utility.RandomFloat(20*-i.Math.RADIAN,20*i.Math.RADIAN)),n.Rotate(50*-i.Math.RADIAN+i.Utility.RandomFloat(20*-i.Math.RADIAN,20*i.Math.RADIAN)),t.Multiply(.67,.67),n.Multiply(.67,.67),t.AddV(this.path.e),n.AddV(this.path.e),new e(this.path.e,t,this.parent),new e(this.path.e,n,this.parent)}}])&&a(n.prototype,h),f&&a(n,f),e}(),n=1920,r=1080,c=960,h=t.canvas=document.createElement("canvas");document.body.appendChild(h),h.setAttribute("width",n),h.setAttribute("height",r),h.style.display="initial",h.style.position="absolute";var f={canvas:h,halt:!1},d=t.stage=new i.Stage2D(f),p=new i.VisualContainer2D(0,0),y=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),v=new i.VisualContainer2D(c,r);v.scale.Set(1,-1),y.force.SetSame(5),d.AddChild(p).AddChild(y).AddChild(v),new i.CanvasManager(h,n,r,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(d).BindRootContainer(p).Trigger(),d.mouse.AddOffset(v).AddOffset(y),new e(new i.Vector2D(0,0),new i.Vector2D(0,300),v);var m=new i.Time.Timer(500);m.onFinish.Add(function(){d.ticker.Stop()}),m.Start(),d.onProcess.Add(function(){y.Process(),v.children.forEach(function(t){t.motionManager.Process()}),m.Process()}),d.mouse.onDown.Add(function(t){y.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Interaction",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute",e.style.top="50%",e.style.transform="translateY(-50%)";var n={canvas:e,halt:!1,mode:"webgl2"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200),u=new i.Controller.ProgramController.GLTexture2DProgramController(r.gl),l=new i.Controller.ProgramController.GLCircleProgramController(r.gl),c=new i.Controller.ProgramController.GLLine2DProgramController(r.gl);u.BindBasicTexture(i.Sprite.DEFAULT_TEXTURE);var h=new i.Sprite(0,0,u),f=new i.Graphic2D(-100,-100,new i.Path.Circle(0,0,50)),d=new i.Graphic2D(100,100,new i.Path.Line2D(-100,0,100,0));f.path.LinkProgramController(l),d.path.LinkProgramController(c);var p=new i.Vector2D(0,0),y=new i.Vector2D(0,0),v=null;d.path.Rotate(23/180*Math.PI),a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s).AddChildren(h,f,d),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger(),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process()}),r.mouse.onDown.Add(function(t){for(var e=s.children.length,n=t.data.position;e--;)if(s.children[e].IntersectsPoint2D(n)){p.SetV(n),v=s.children[e],y.SetV(v.position),t.stopPropagation=!0,v.SendToFront();break}v||a.target.position.SetV(n)}),r.mouse.onMove.Add(function(t){if(v){var e=t.data.position;v.position.SetV(e).AddV(y).SubtractV(p)}},r),r.mouse.onUp.Add(function(){v&&(v=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Rendertexture",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"WebGL2"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540),c=new i.VisualContainer2D(960,540),h=new i.Controller.ProgramController.GLTexture2DProgramController(a.gl);h.BindBasicTexture(i.Sprite.DEFAULT_TEXTURE);var f=new i.Controller.ProgramController.GLRendertextureProgramController(a.gl,i.Shader.RENDERTEXTURE_INVERT);f.Config(e,n,a.gl.LINEAR);var d=new i.Sprite(0,0,h),p=new i.Sprite(0,0,h);d.anchor.SetSame(.5),p.anchor.SetSame(.5),d.alpha=.5,d.UpdateTextureTransform(),p.UpdateTextureTransform(),a.gl.clearColor(.3,.3,.3,1),s.GLPreRender=function(t){a.SetFramebuffer(t,f)},s.GLPostRender=function(){a.SetFramebuffer(),f.Execute()},u.force.SetSame(5),a.AddChild(s).AddChild(u).Mount(l,c),l.Mount(d),c.Mount(p),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u);var y=0;a.onProcess.Add(function(){u.Process(),d.x=128*Math.cos(y),d.y=128*Math.sin(y),y+=i.Math.RADIAN}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Spritesheet",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,backgroundColor:"white"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200),u=new i.Sprite(0,0,window.testData.invadersSpritesheet.basicTexture),l=new i.Sprite(0,50,window.testData.invadersSpritesheet.basicTexture);window.testData.invadersSpritesheet.GetFrameById("Ship").FullApply(u),window.testData.invadersSpritesheet.GetFrameById("Explo-f1").FullApply(l),l.CreateAnimation({spritesheet:window.testData.invadersSpritesheet,id:"explode",frames:["Explo-f1","Explo-f2","Explo-f3","Explo-f4"],rate:15,loop:!0,reverse:!1,overrideFrameRate:!0}),l.PlayAnimation("explode"),l.anchor.SetSame(.5),l.UpdateTextureTransform(),l.scale.SetSame(5),a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s).AddChildren(u,l),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger(),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process(),l.animationController.Process()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Culler",function(t){var e=600,n=400,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"webgl2"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(300,200),c=new i.Culler2D(0,0,e,n),h=new i.Controller.ProgramController.GLTexture2DProgramController(a.gl);h.BindBasicTexture(i.Sprite.DEFAULT_TEXTURE);var f=new i.Sprite(0,0,h);f.anchor.SetSame(.5),f.UpdateTextureTransform(),c.BindContainer(l),c.SetRootMatrix(a.transform.globalTransform),c.onIn.Add(function(t){t.target.display=!0,console.log("in")}),c.onOut.Add(function(t){t.target.display=!1,console.log("out")}),u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l).AddChildren(f),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).BindCuller(c).Trigger(),console.log(c),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process(),c.Process()}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Tilemap",function(t){var e=600,n=400,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"webgl2"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(300,200),c=new i.Controller.ProgramController.GLTexture2DProgramController(a.gl);c.BindBasicTexture(window.testData.tileset.basicTexture);var h=new i.Culler2D(0,0,568,368);h.SetRootMatrix(a.transform.globalTransform),u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).BindCuller(h).Trigger();var f=new i.Tilemap(-300,-200,c,window.testData.tileset.data,0);f.Cull(h),f.scale.SetSame(1),l.AddChild(f),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}}]);