/**
* @package     Nenkraft2
* @author      Gustav 'Nuuf' Åberg <gustavrein@gmail.com>
* @version     0.2.0
* @copyright   (C) 2018 Gustav 'Nuuf' Åberg
* @license     {@link https://github.com/Nuuf/nenkraft2/blob/master/LICENSE}
*/!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=14)}([function(t,e,n){"use strict";n.r(e);var i={};n.r(i),n.d(i,"CCH1",function(){return I}),n.d(i,"CCH1Decipher",function(){return j});var r={};n.r(r),n.d(r,"GenerateSimpleBase64PNG",function(){return U}),n.d(r,"ImageFromDataURL",function(){return F}),n.d(r,"ParsedXMLToJSON",function(){return V}),n.d(r,"XMLToJSON",function(){return M}),n.d(r,"DownloadAsJSON",function(){return X});var o={};n.r(o),n.d(o,"Linear",function(){return z}),n.d(o,"QuadIn",function(){return K}),n.d(o,"QuadOut",function(){return Q}),n.d(o,"QuadInOut",function(){return J}),n.d(o,"SineIn",function(){return Z}),n.d(o,"SineOut",function(){return $}),n.d(o,"SineInOut",function(){return tt}),n.d(o,"CircIn",function(){return et}),n.d(o,"CircOut",function(){return nt}),n.d(o,"CircInOut",function(){return it});var a={};n.r(a),n.d(a,"Result",function(){return mt}),n.d(a,"CollideRel",function(){return gt});var s={};n.r(s),n.d(s,"Result",function(){return xt}),n.d(s,"CollideRel",function(){return Tt}),n.d(s,"ElasticResponse",function(){return _t});var u={};n.r(u),n.d(u,"Result",function(){return Bt}),n.d(u,"CollideRel",function(){return Ut}),n.d(u,"ReflectingResponse",function(){return Ft});var l={};n.r(l),n.d(l,"Result",function(){return Wt}),n.d(l,"CollideRel",function(){return qt}),n.d(l,"AxisSeparates",function(){return zt});var c={};n.r(c),n.d(c,"AABB2DvsAABB2D",function(){return a}),n.d(c,"CirclevsCircle",function(){return s}),n.d(c,"CirclevsLine",function(){return u}),n.d(c,"PolygonvsPolygon",function(){return l});var h={};n.r(h),n.d(h,"Rectangular",function(){return ee}),n.d(h,"Isosceles",function(){return ne}),n.d(h,"Cyclic",function(){return ie}),n.d(h,"Equilateral",function(){return re}),n.d(h,"Star",function(){return oe}),n.d(h,"Butterfly",function(){return ae}),n.d(h,"Supershape",function(){return se});var f={};n.r(f),n.d(f,"AABB2D",function(){return le}),n.d(f,"Circle",function(){return ge}),n.d(f,"Line2D",function(){return Se}),n.d(f,"Ray2D",function(){return Se}),n.d(f,"Polygon2D",function(){return xe}),n.d(f,"PolygonConstruction",function(){return h});var d={};n.r(d),n.d(d,"DEFAULT",function(){return _e}),n.d(d,"SOURCE_OVER",function(){return Pe}),n.d(d,"SOURCE_IN",function(){return ke}),n.d(d,"SOURCE_OUT",function(){return Ee}),n.d(d,"SOURCE_ATOP",function(){return Re}),n.d(d,"DESTINATION_OVER",function(){return De}),n.d(d,"DESTINATION_IN",function(){return Ie}),n.d(d,"DESTINATION_OUT",function(){return je}),n.d(d,"DESTINATION_ATOP",function(){return Le}),n.d(d,"LIGHTER",function(){return Ne}),n.d(d,"COPY",function(){return Ge}),n.d(d,"XOR",function(){return Be}),n.d(d,"MULTIPLY",function(){return Ue}),n.d(d,"OVERLAY",function(){return Fe}),n.d(d,"DARKEN",function(){return Ve}),n.d(d,"LIGHTEN",function(){return Me}),n.d(d,"COLOR_DODGE",function(){return Xe}),n.d(d,"COLOR_BURN",function(){return Ye}),n.d(d,"HARD_LIGHT",function(){return He}),n.d(d,"SOFT_LIGHT",function(){return We}),n.d(d,"DIFFERENCE",function(){return qe}),n.d(d,"EXCLUSION",function(){return ze}),n.d(d,"HUE",function(){return Ke}),n.d(d,"SATURATION",function(){return Qe}),n.d(d,"COLOR",function(){return Je}),n.d(d,"LUMINOSITY",function(){return Ze});var p={};n.r(p),n.d(p,"CAP_ROUND",function(){return $e}),n.d(p,"CAP_BUTT",function(){return tn}),n.d(p,"CAP_SQUARE",function(){return en}),n.d(p,"JOIN_BEVEL",function(){return nn}),n.d(p,"JOIN_ROUND",function(){return rn}),n.d(p,"JOIN_MITER",function(){return on});var y={};n.r(y),n.d(y,"ALIGN_START",function(){return an}),n.d(y,"ALIGN_END",function(){return sn}),n.d(y,"ALIGN_CENTER",function(){return un}),n.d(y,"ALIGN_LEFT",function(){return ln}),n.d(y,"ALIGN_RIGHT",function(){return cn}),n.d(y,"BASELINE_ALPHABETIC",function(){return hn}),n.d(y,"BASELINE_TOP",function(){return fn}),n.d(y,"BASELINE_HANGING",function(){return dn}),n.d(y,"BASELINE_MIDDLE",function(){return pn}),n.d(y,"BASELINE_IDEOGRAPHIC",function(){return yn}),n.d(y,"BASELINE_BOTTOM",function(){return vn});var v={};n.r(v),n.d(v,"Fill",function(){return mn}),n.d(v,"Stroke",function(){return wn}),n.d(v,"Shadow",function(){return Sn}),n.d(v,"Text",function(){return On}),n.d(v,"Pixel",function(){return xn}),n.d(v,"GCO",function(){return d}),n.d(v,"LineConf",function(){return p}),n.d(v,"TextConf",function(){return y}),n.d(v,"All",function(){return Tn}),n.d(v,"FFSa",function(){return _n}),n.d(v,"SSa",function(){return Pn}),n.d(v,"FSa",function(){return kn}),n.d(v,"SaT",function(){return En}),n.d(v,"P",function(){return Rn});var b={};n.r(b),n.d(b,"AABB2D",function(){return Gn}),n.d(b,"Circle",function(){return Xn}),n.d(b,"Line2D",function(){return Kn}),n.d(b,"Ray2D",function(){return Kn}),n.d(b,"Polygon2D",function(){return ei});var m={};n.r(m),n.d(m,"Timer",function(){return ui}),n.d(m,"Ticker",function(){return ci});var g={};n.r(g),n.d(g,"TEXTURE_2D",function(){return _i}),n.d(g,"TEXTURE_2D_BATCH",function(){return Pi}),n.d(g,"PIXEL_BATCH",function(){return ki}),n.d(g,"RECTANGLE",function(){return Ei}),n.d(g,"CIRCLE",function(){return Ri}),n.d(g,"LINE2D",function(){return Di});var w={};n.r(w),n.d(w,"ImageLoader",function(){return Fi}),n.d(w,"SpritesheetLoader",function(){return zi}),n.d(w,"XHRLoader",function(){return Mi});var A={};n.r(A),n.d(A,"GLProgramController",function(){return Qi}),n.d(A,"GLCircleProgramController",function(){return pr}),n.d(A,"GLLine2DProgramController",function(){return Cr}),n.d(A,"GLPixelBatchProgramController",function(){return Dr}),n.d(A,"GLRectangleProgramController",function(){return Vr}),n.d(A,"GLTexture2DBatchProgramController",function(){return Qr}),n.d(A,"GLTexture2DProgramController",function(){return oo});var S={};n.r(S),n.d(S,"ProgramController",function(){return A});var C={};n.r(C),n.d(C,"Option",function(){return so}),n.d(C,"Command",function(){return lo}),n.d(C,"Registry",function(){return po});var O={};n.r(O),n.d(O,"Motion",function(){return vo}),n.d(O,"Manager",function(){return go});var x={};n.r(x),n.d(x,"Particle2D",function(){return fa}),n.d(x,"Oscillation",function(){return Ao}),n.d(x,"System",function(){return wa});var T={};n.r(T),n.d(T,"Particle2D",function(){return x});var _={};n.r(_),n.d(_,"BasicTexture2D",function(){return Bi}),n.d(_,"Spritesheet",function(){return Wi});var P={};n.r(P),n.d(P,"Animation",function(){return qo}),n.d(P,"Controller",function(){return Ko}),n.d(P,"Frame",function(){return Yi});var k={};n.r(k),n.d(k,"AABB2D",function(){return Aa});var E={};n.r(E),n.d(E,"Draw",function(){return k});var R=n(1),D=n(3);function I(t,e){var n,i,r=t.split(""),o=[];e=void 0===e?1:e;for(var a=0;a<r.length;++a)n=((n=r[a]).charCodeAt(0)+e).toString(2),i=Object(R.RandomInteger)(1,9),o.push(i+"x"+n.replace(/1/g,i));return o.join(" ")}function j(t,e){var n,i=t.split(" "),r=[];e=void 0===e?1:e;for(var o=0;o<i.length;++o)n=(n=i[o]).slice(2-n.length),r.push(String.fromCharCode(parseInt(n.replace(/[2-9]/g,"1"),2)-e));return r.join("")}var L,N,G,B=Math.ceil;function U(t,e,n,i){var r=t();return null==L&&(L=document.createElement("canvas"),N=L.getContext("2d")),L.width=B(r.w),L.height=B(r.h),null!=e&&(L.width=e),null!=n&&(L.height=n),null!=i?(N.fillStyle=i,N.fillRect(0,0,L.width,L.height)):N.clearRect(0,0,L.width,L.height),N.setTransform(1,0,0,1,0,0),r.Draw(N),L.toDataURL("image/png")}function F(t,e,n,i){var r=new Image;return r.width=e,r.height=n,r.onload=i,r.src=t,r}function V(t,e){var n,i,r,o,a,s,u={},l=t.childNodes,c=l.length;if(1===t.nodeType){if((c=(i=t.attributes).length)>0)for(u.attributes={},n=0,r=i.item(n);n<c;r=i.item(++n))u.attributes[r.nodeName]=r.nodeValue}else 3===t.nodeType&&(/^\s*$/g.exec(t.nodeValue)||(u=t.nodeValue,!0===e&&(u=u.replace(/^\s+|\s+&|\n/gim,""))));if(null!=l)for(c=l.length,n=0,o=l.item(n);n<c;o=l.item(++n))void 0===u[o.nodeName]?u[o.nodeName]=V(o,e):(void 0===u[o.nodeName].push&&(s=u[o.nodeName],u[o.nodeName]=[],Object(R.IsObjectEmpty)(s)||u[o.nodeName].push(s)),a=V(o,e),Object(R.IsObjectEmpty)(a)||u[o.nodeName].push(a));return u["#text"]&&0===u["#text"].length&&delete u["#text"],u}function M(t,e){return null==G&&(G=new DOMParser),V(G.parseFromString(t,"text/xml"),e)}function X(t,e){var n="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t)),i=document.createElement("a");i.setAttribute("href",n),i.setAttribute("download",e+".json"),i.click()}var Y=Math.sin,H=Math.cos,W=Math.sqrt,q=Math.PI,z=function(t,e,n,i){return n*t/i+e},K=function(t,e,n,i){return n*(t/=i)*t+e},Q=function(t,e,n,i){return-n*(t/=i)*(t-2)+e},J=function(t,e,n,i){return(t/=.5*i)<1?.5*n*t*t+e:.5*-n*(--t*(t-2)-1)+e},Z=function(t,e,n,i){return-n*H(t/i*(.5*q))+n+e},$=function(t,e,n,i){return n*Y(t/i*(.5*q))+e},tt=function(t,e,n,i){return.5*-n*(H(q*t/i)-1)+e},et=function(t,e,n,i){return-n*(W(1-(t/=i)*t)-1)+e},nt=function(t,e,n,i){return t/=i,n*W(1- --t*t)+e},it=function(t,e,n,i){return(t/=.5*i)<1?.5*-n*(W(1-t*t)-1)+e:.5*n*(W(1-(t-=2)*t)+1)+e};function rt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ot=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.class=e,this.objects=[],this.floodFunction=null,this.floodAmount=null,this.context=null}return function(t,e,n){e&&rt(t.prototype,e),n&&rt(t,n)}(t,[{key:"Store",value:function(t){this.objects.push(t)}},{key:"PreRetrieve",value:function(){0===this.objects.length&&this.Flood()}},{key:"Retrieve",value:function(){return this.PreRetrieve(),this.objects.pop()}},{key:"Flood",value:function(t,e,n){t&&(this.floodFunction=t),e&&(this.floodAmount=e),n&&(this.context=n);for(var i=0;i<this.floodAmount;++i)if(null!=this.class){var r=new this.class;this.Store(r),this.floodFunction.call(this.context,r)}else this.Store(this.floodFunction.call(this.context))}},{key:"Flush",value:function(){this.objects.length=0}},{key:"Clean",value:function(){var t=this.objects.length;this.Flush(),this.Flood(void 0,t)}}]),t}();function at(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var st=Math.ceil,ut=Math.round,lt=Math.abs,ct=Math.sqrt,ht=Math.atan2,ft=Math.cos,dt=Math.sin,pt=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=n}return function(t,e,n){e&&at(t.prototype,e),n&&at(t,n)}(t,[{key:"Copy",value:function(){return!0===vt?yt.Retrieve(this.x,this.y):new t(this.x,this.y)}},{key:"FromPool",value:function(e,n){return!0===vt?yt.Retrieve(e,n):new t(e,n)}},{key:"AbsoluteCopy",value:function(){var t=this.Copy();return t.Positive(),t}},{key:"SetV",value:function(t){return this.x=t.x,this.y=t.y,this}},{key:"Set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"SetSame",value:function(t){return this.x=t,this.y=t,this}},{key:"Is0",value:function(){return 0===this.x&&0===this.y}},{key:"AddVC",value:function(t){return this.Copy().AddV(t)}},{key:"AddV",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"Add",value:function(t,e){return this.x+=t,this.y+=e,this}},{key:"SubtractVC",value:function(t){return this.Copy().SubtractV(t)}},{key:"SubtractV",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"Subtract",value:function(t,e){return this.x-=t,this.y-=e,this}},{key:"MultiplyVC",value:function(t){return this.Copy().MultiplyV(t)}},{key:"MultiplyV",value:function(t){return this.x*=t.x,this.y*=t.y,this}},{key:"Multiply",value:function(t,e){return this.x*=t,this.y*=e,this}},{key:"DivideVC",value:function(t){return this.Copy().DivideV(t)}},{key:"DivideV",value:function(t){return this.x/=t.x,this.y/=t.y,this}},{key:"Divide",value:function(t,e){return this.x/=t,this.y/=e,this}},{key:"Normalize",value:function(){var t=this.GetMagnitude();return this.Divide(t,t)}},{key:"Positive",value:function(){return this.x=lt(this.x),this.y=lt(this.y),this}},{key:"Negative",value:function(){return this.x=-lt(this.x),this.y=-lt(this.y),this}},{key:"Invert",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"Rotate",value:function(t){var e=dt(t),n=ft(t),i=this.x,r=this.y;return this.x=i*n-r*e,this.y=i*e+r*n,this}},{key:"RotateAroundV",value:function(t,e){return this.SubtractV(t).Rotate(e).AddV(t)}},{key:"RotateAround",value:function(t,e,n){return this.SubtractV(t,e).Rotate(n).AddV(t,e)}},{key:"RotateAbsolute",value:function(t){return this.Rotate(t-this.GetAngle())}},{key:"RotateAbsoluteAroundV",value:function(t,e){return this.SubtractV(t).RotateAbsolute(e).AddV(t)}},{key:"RotateAbsoluteAround",value:function(t,e,n){return this.SubtractV(t,e).RotateAbsolute(n).AddV(t,e)}},{key:"PushFromV",value:function(t,e){var n=this.Copy();return n.SubtractV(t).Normalize().Multiply(e,e),this.AddV(n)}},{key:"PushFrom",value:function(t,e,n){var i=this.Copy();return i.SubtractV(t,e).Normalize().Multiply(n,n),this.AddV(i)}},{key:"GetWeightedAverageV",value:function(t,e){return this.FromPool(this.x*(1-e)+t.x*e,this.y*(1-e)+t.y*e)}},{key:"GetWeightedAverage",value:function(t,e,n){return this.FromPool(this.x*(1-n)+t*n,this.y*(1-n)+e*n)}},{key:"GetAngle",value:function(){return ht(this.y,this.x)}},{key:"GetAngleBetweenV",value:function(t){return ht(this.y-t.y,this.x-t.x)}},{key:"GetAngleBetween",value:function(t,e){return ht(this.y-e,this.x-t)}},{key:"GetDotV",value:function(t){return this.x*t.x+this.y*t.y}},{key:"GetDot",value:function(t,e){return this.x*t+this.y*e}},{key:"GetCrossV",value:function(t){return this.x*t.y+this.y*t.x}},{key:"GetCross",value:function(t,e){return this.x*e+this.y*t}},{key:"GetMagnitudeSquared",value:function(){return this.x*this.x+this.y*this.y}},{key:"GetMagnitude",value:function(){return ct(this.x*this.x+this.y*this.y)}},{key:"GetDistanceSquaredV",value:function(t){return this.Copy().SubtractV(t).GetMagnitudeSquared()}},{key:"GetDistanceSquared",value:function(t,e){return this.Copy().Subtract(t,e).GetMagnitudeSquared()}},{key:"GetDistanceV",value:function(t){return this.Copy().SubtractV(t).GetMagnitude()}},{key:"GetDistance",value:function(t,e){return this.Copy().Subtract(t,e).GetMagnitude()}},{key:"GetPerpendicularCCWV",value:function(t){return this.FromPool(-(t.y-this.y),t.x-this.x)}},{key:"GetPerpendicularCCW",value:function(t,e){return this.FromPool(-(e-this.y),t-this.x)}},{key:"GetPerpendicularCWV",value:function(t){return this.FromPool(t.y-this.y,-(t.x-this.x))}},{key:"GetPerpendicularCW",value:function(t,e){return this.FromPool(e-this.y,-(t-this.x))}},{key:"GetNormalAV",value:function(t){return this.GetPerpendicularCCWV(t).Normalize()}},{key:"GetNormalA",value:function(t,e){return this.GetPerpendicularCCW(t,e).Normalize()}},{key:"GetNormalBV",value:function(t){return this.GetPerpendicularCWV(t).Normalize()}},{key:"GetNormalB",value:function(t,e){return this.GetPerpendicularCW(t,e).Normalize()}},{key:"GetMidpointV",value:function(t){return this.Copy().AddV(t).Divide(2,2)}},{key:"GetMidpoint",value:function(t,e){return this.Copy().Add(t,e).Multiply(.5,.5)}},{key:"IsEqualToV",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"IsEqualTo",value:function(t,e){return this.x===t&&this.y===e}},{key:"GetProjectionOntoV",value:function(t){var e=this.GetDotV(t);if(0===e)return this.FromPool(0,0);var n=t.GetMagnitude(),i=e/(n*n),r=t.Copy();return r.Multiply(i,i),r}},{key:"GetProjectionOnto",value:function(t,e){var n=this.Copy();n.Set(t,e);var i=this.GetDotV(n);if(0===i)return this.FromPool(0,0);var r=n.GetMagnitude(),o=i/(r*r);return n.Multiply(o,o),n}},{key:"GetReflectionV",value:function(t){var e=t.Copy(),n=this.GetDotV(e);return e.Multiply(2,2).Multiply(n,n),this.SubtractVC(e)}},{key:"GetReflection",value:function(t,e){var n=this.Copy();n.Set(t,e);var i=this.GetDotV(n);return n.Multiply(2,2).Multiply(i,i),this.SubtractVC(n)}},{key:"Store",value:function(){return yt.Store(this),this}},{key:"AddTo",value:function(t){for(var e=0;e<t.length;++e)t[e].AddV(this);return this}},{key:"Floor",value:function(){return this.x=0|this.x,this.y=0|this.y,this}},{key:"Ceil",value:function(){return this.x=st(this.x),this.y=st(this.y),this}},{key:"Round",value:function(){return this.x=ut(this.x),this.y=ut(this.y),this}},{key:"GetMinMaxDot",value:function(t){for(var e=1/0,n=-e,i=0,r=this.Copy(),o=0;o<t.length;++o)(i=t[o].GetDotV(this))>n&&(n=i),i<e&&(e=i);return r.Set(e,n),r}}],[{key:"SortMinMag",value:function(t,e){return t.GetMagnitudeSquared()-e.GetMagnitudeSquared()}},{key:"pool",get:function(){return yt}},{key:"USE_POOL",get:function(){return vt},set:function(t){vt=t}}]),t}(),yt=new ot(pt),vt=!0;function bt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}yt.Retrieve=function(t,e){this.PreRetrieve();var n=this.objects.pop();return n.Set(t,e),n},yt.Flood(function(t){t.Set(0,0)},1e3);var mt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new pt(0,0),this.occured=!1}return function(t,e,n){e&&bt(t.prototype,e),n&&bt(t,n)}(t,[{key:"Reset",value:function(){this.mtv.SetSame(0),this.occured=!1}}]),t}(),gt=function(t,e,n){var i=t.shape,r=i.w,o=i.h,a=t.anchor,s=e.shape,u=s.w,l=s.h,c=e.anchor;wt.SetV(i.tl).SubtractV(t.relative),At.SetV(s.tl).SubtractV(e.relative);var h=At.x+r,f=wt.x+u,d=At.y+o,p=wt.y+l;return void 0!=a&&(wt.x+=a.x*r,wt.y+=a.y*o),void 0!=c&&(At.x+=c.x*u,At.y+=c.y*l),wt.x<h&&At.x<f&&wt.y<d&&At.y<p&&(void 0!=n&&(St[0].Set(wt.x-h,0),St[1].Set(f-At.x,0),St[2].Set(0,wt.y-d),St[3].Set(0,p-At.y),St.sort(pt.SortMinMag),n.mtv.SetV(St[0]),n.occured=!0),!0)},wt=new pt(0,0),At=new pt(0,0),St=[new pt(0,0),new pt(0,0),new pt(0,0),new pt(0,0)];function Ct(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ot=Math.sqrt,xt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new pt(0,0),this.poc={a:new pt(0,0),b:new pt(0,0),c:new pt(0,0)},this.mtd=0,this.delta=new pt(0,0),this.occured=!1}return function(t,e,n){e&&Ct(t.prototype,e),n&&Ct(t,n)}(t,[{key:"Reset",value:function(){this.poc.a.SetSame(0),this.poc.b.SetSame(0),this.poc.c.SetSame(0),this.mtv.SetSame(0),this.mtd=0,this.delta.SetSame(0),this.occured=!1}}]),t}(),Tt=function(t,e,n){var i=t.shape,r=e.shape,o=i.radius,a=r.radius,s=o+a,u=t.anchor,l=e.anchor;Et.SetV(t.relative),Rt.SetV(e.relative),Lt.SetV(Rt).SubtractV(Et);var c=Lt.GetMagnitudeSquared();if(void 0!=u&&(Et.x+=u.x*i.diameter,Et.y+=u.y*i.diameter),void 0!=l&&(Rt.x+=l.x*r.diameter,Rt.y+=l.y*r.diameter),s*s>c){if(void 0!=n){var h=Ot(c),f=(i.radiusSquared-r.radiusSquared+c)/(h+h),d=Ot(i.radiusSquared-f*f)/h,p=-Lt.y*d,y=Lt.x*d;Dt.Set(Et.x+Lt.x*f/h,Et.y+Lt.y*f/h),It.Set(Dt.x+p,Dt.y+y),jt.Set(Dt.x-p,Dt.y-y),Et.SubtractV(Rt).Divide(s,s);var v=h-o-a;n.poc.a.SetV(Dt),n.poc.b.SetV(It),n.poc.c.SetV(jt),n.mtv.SetV(Et),n.mtd=v,n.delta.SetV(Lt),n.occured=!0}return!0}return!1},_t=function(t,e,n){Pt.SetV(n.delta).Normalize(),kt.SetV(n.mtv);var i=t.mass,r=e.mass,o=t.velocity,a=e.velocity,s=2*(o.GetDotV(Pt)-a.GetDotV(Pt))/(i+r);o.Set(o.x-s*r*Pt.x,o.y-s*r*Pt.y),a.Set(a.x+s*i*Pt.x,a.y+s*i*Pt.y),kt.Multiply(n.mtd,n.mtd).Divide(2,2),t.relative.SubtractV(kt),e.relative.AddV(kt)},Pt=new pt(0,0),kt=new pt(0,0),Et=new pt(0,0),Rt=new pt(0,0),Dt=new pt(0,0),It=new pt(0,0),jt=new pt(0,0),Lt=new pt(0,0);function Nt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Gt=Math.sqrt,Bt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new pt(0,0),this.cp=new pt(0,0),this.sOrE=0,this.occured=!1}return function(t,e,n){e&&Nt(t.prototype,e),n&&Nt(t,n)}(t,[{key:"Reset",value:function(){this.mtv.SetSame(0),this.cp.SetSame(0),this.sOrE=0,this.occured=!1}}]),t}(),Ut=function(t,e,n){var i=e.shape,r=t.shape,o=e.relative,a=t.relative;Vt.Set(i.s.x+o.x,i.s.y+o.y),Mt.Set(i.e.x+o.x,i.e.y+o.y);var s=Object(D.ClosestPointOnLine)(Vt,Mt,a);Xt.Set(a.x-s.x,a.y-s.y);var u=Xt.GetMagnitudeSquared();if(u<r.radiusSquared){if(n){var l=r.radius-Gt(u);Xt.Normalize().Multiply(l,l),n.mtv.SetV(Xt),n.cp.SetV(s),n.occured=!0,s===Vt?n.sOrE=1:s===Mt&&(n.sOrE=-1)}return!0}return!1},Ft=function(t,e,n){var i,r,o=e.shape,a=t.velocity,s=t.relative,u=n.cp;0!==n.sOrE?(i=u.SubtractVC(s)).Normalize():i=o.GetNormalA(),r=a.GetReflectionV(i),a.SetV(r),s.AddV(n.mtv)},Vt=new pt(0,0),Mt=new pt(0,0),Xt=new pt(0,0);function Yt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ht=Math.abs,Wt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new pt(0,0),this.olAxis=new pt(0,0),this.mtd=1/0,this.occured=!1}return function(t,e,n){e&&Yt(t.prototype,e),n&&Yt(t,n)}(t,[{key:"Reset",value:function(){this.occured=!1,this.mtv.Set(0,0),this.mtd=1/0,this.olAxis.Set(0,0)}}]),t}(),qt=function(t,e,n){for(var i=0,r=t.shape,o=e.shape,a=r.normals,s=o.normals,u=a.length,l=s.length;i<u;++i)if(!0===zt(t,e,a[i],n))return!1;for(i=0;i<l;++i)if(!0===zt(t,e,s[i],n))return!1;return void 0!=n&&(n.mtv.SetV(n.olAxis),n.mtv.Multiply(n.mtd,n.mtd),n.occured=!0),!0},zt=function(t,e,n,i){var r=n.GetMinMaxDot(t.shape.vertices),o=n.GetMinMaxDot(e.shape.vertices),a=e.relative.SubtractVC(t.relative).GetDotV(n);if(o.Add(a,a),r.x>o.y||o.x>r.y)return!0;if(void 0!=i){var s=0,u=0,l=0,c=r.x,h=r.y,f=o.x,d=o.y;s=c<f?h<d?h-f:(u=h-f)<(l=d-c)?u:-l:h>d?c-d:(u=h-f)<(l=d-c)?u:-l;var p=Ht(s);p<i.mtd&&(i.mtd=p,i.olAxis.SetV(n),s<0&&i.olAxis.Invert())}return!1},Kt=Math.PI,Qt=Math.cos,Jt=Math.sin,Zt=Math.abs,$t=Math.pow,te=Math.exp,ee=function(t,e,n,i,r){var o=new pt(e,n),a=new pt(e+i,n),s=new pt(e+i,n+r),u=new pt(e,n+r);return t.Recreate([o,a,s,u]),t.ComputeBounds(),t.GetNormalsA(),t},ne=function(t,e,n,i,r){var o=new pt(e,n),a=new pt(e+.5*i,n+r),s=new pt(e-.5*i,n+r);return t.Recreate([o,a,s]),t.ComputeBounds(),t.GetNormalsA(),t},ie=function(t,e,n,i,r){var o,a,s,u=0,l=r,c=2*Kt/l;for(t.Recreate([]);u<l;++u)o=Qt(s=c*u)*i,a=Jt(s)*i,t.AddVertex(new pt(e+o,n+a));return t.ComputeBounds(),t.GetNormalsA(),t},re=function(t,e,n,i){var r,o,a=2.0943951023931953;return t.Recreate([]),r=Qt(0)*i,o=Jt(0)*i,t.AddVertex(new pt(e+r,n+o)),r=Qt(a)*i,o=Jt(a)*i,t.AddVertex(new pt(e+r,n+o)),r=Qt(2*a)*i,o=Jt(2*a)*i,t.AddVertex(new pt(e+r,n+o)),t.Rotate(-90*new Math.RADIAN),t.ComputeBounds(),t.GetNormalsA(),t},oe=function(t,e,n,i,r,o){var a,s,u,l,c=0,h=2*o,f=2*Math.PI/h;for(t.Recreate([]);c<h;++c)l=0==(1&c)?i:r,u=f*c,a=Math.cos(u)*l,s=Math.sin(u)*l,t.AddVertex(new pt(e+a,n+s));return t.ComputeBounds(),t.GetNormalsA(),t},ae=function t(e,n,i,r,o){var a,s,u,l=0,c=t.C;for(e.Recreate([]);l<r;++l)u=l*c._1*Kt/r,a=Qt(u)*(te(Qt(u))-c._2*Qt(c._3*u)-$t(Jt(u/c._4),c._5))*o,s=Jt(u)*(te(Qt(u))-c._2*Qt(c._3*u)-$t(Jt(u/c._4),c._5))*o,e.AddVertex(new pt(n+a,i+s));return e.ComputeBounds(),e.GetNormalsA(),e};ae.C={_1:24,_2:2,_3:4,_4:12,_5:5};var se=function t(e,n,i,r,o,a,s,u,l){var c,h,f,d,p,y,v=0,b=o,m=t.C;for(s=void 0===s?1:s,u=void 0===u?1:u,l=void 0===l?1:l,e.Recreate([]);v<b;++v)p=Qt(a*(f=v*Kt*2/o)/4)/m._A,p=Zt(p),p=$t(p,u),y=Jt(a*f/4)/m._B,y=Zt(y),y=$t(y,l),d=$t(p+y,1/s),0===Zt(d)?(c=0,h=0):(d=1/d,c=Qt(f)*d*r,h=Jt(f)*d*r),e.AddVertex(new pt(n+c,i+h));return e.ComputeBounds(),e.GetNormalsA(),e};function ue(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}se.C={_A:1,_B:1};var le=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tl=new pt(e,n),this.br=new pt(i,r),this.w=0,this.h=0,this.hw=0,this.hh=0,this.area=0,this.belongsTo=null,this.TYPE=pe,this.ComputeWH()}return function(t,e,n){e&&ue(t.prototype,e),n&&ue(t,n)}(t,[{key:"Set",value:function(t,e,n,i){this.tl.Set(t,e),this.br.Set(n,i),this.ComputeWH()}},{key:"SetC",value:function(t){this.Set(t.tl.x,t.tl.y,t.br.x,t.br.y)}},{key:"Scale",value:function(t,e){this.tl.Multiply(t,e),this.br.Multiply(t,e),this.ComputeWH()}},{key:"ScaleV",value:function(t){this.tl.MultiplyV(t),this.br.MultiplyV(t),this.ComputeWH()}},{key:"ComputeWH",value:function(){this.w=this.br.x-this.tl.x,this.h=this.br.y-this.tl.y,this.hw=.5*this.w,this.hh=.5*this.h,this.area=this.w*this.h}},{key:"IntersectsPoint",value:function(t){return!(t.x<this.tl.x||t.x>this.br.x||t.y<this.tl.y||t.y>this.br.y)}},{key:"ContainsPoint",value:function(t){return t.x>this.tl.x&&t.x<this.br.x&&t.y>this.tl.y&&t.y<this.br.y}},{key:"IntersectsAABB2D",value:function(t){var e=this.tl,n=this.br,i=t.tl,r=t.br;return!(i.x>=n.x||i.y>=n.y||r.x<=e.x||r.y<=e.y)}},{key:"ContainsAABB2D",value:function(t){if(t.area>this.area)return!1;var e=this.tl,n=this.br,i=t.tl,r=t.br;return i.x>=e.x&&i.y>=e.y&&r.x<=n.x&&r.y<=n.y}},{key:"GetQuadrant",value:function(e){var n=this.tl,i=this.br;switch(e){case ce:return new t(n.x,n.y,n.x+this.hw,n.y+this.hh);case he:return new t(n.x+this.hw,n.y,i.x,n.y+this.hh);case fe:return new t(n.x,n.y+this.hh,n.x+this.hw,i.y);case de:return new t(n.x+this.hw,n.y+this.hh,i.x,i.y);default:return null}}}],[{key:"TYPE",get:function(){return pe}}]),t}(),ce="TL",he="TR",fe="BL",de="BR",pe=1;function ye(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ve=Math.PI,be=Math.sin,me=Math.cos,ge=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.center=new pt(e,n),this.diameter=0,this.w=0,this.h=0,this.radiusSquared=0,this.radiusUnsquared=0,this.area=0,this.radius=i,this.belongsTo=null,this.TYPE=we}return function(t,e,n){e&&ye(t.prototype,e),n&&ye(t,n)}(t,[{key:"Set",value:function(t,e,n){this.center.Set(t,e),this.radius=n}},{key:"SetC",value:function(t){this.center.SetV(t),this.radius=t.radius}},{key:"Scale",value:function(t){this.radius*=t}},{key:"IntersectsCircle",value:function(t){var e=this.radius+t.radius;return e*e>=this.center.GetDistanceSquaredV(t.center)}},{key:"IntersectsPoint",value:function(t){return this.radiusSquared>=this.center.GetDistanceSquaredV(t)}},{key:"GenerateRandomPoints",value:function(t,e,n){var i=R.RandomFloat,r=new pt(this.x-this.radius,this.y-this.radius),o=new pt(this.x+this.radius,this.y+this.radius),a=[];n=!!n,!0===e&&(i=R.RandomInteger);for(var s=0;s<t;++s){for(var u=Nenkraft.Vector2D(i(r.x,o.x),i(r.y,o.y));this.IntersectsPoint(u)===n;)u.Set(i(r.x,o.x),i(r.y,o.y));a.push(u)}return a}},{key:"GeneratePerimeterPoints",value:function(t,e){var n=[];t*=e;for(var i=0;i<t;i+=e)n.push(Nenkraft.Vector2D(this.x+me(Object(D.DegreesToRadians)(i))*this.radius,this.y+be(Object(D.DegreesToRadians)(i))*this.radius));return n}},{key:"x",get:function(){return this.center.x},set:function(t){this.center.x=t}},{key:"y",get:function(){return this.center.y},set:function(t){this.center.y=t}},{key:"radius",get:function(){return this.radiusUnsquared},set:function(t){this.radiusUnsquared=t,this.radiusSquared=t*t,this.diameter=this.w=this.h=2*t,this.area=ve*t*t}}],[{key:"TYPE",get:function(){return we}}]),t}(),we=2;function Ae(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Se=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.s=new pt(e,n),this.e=new pt(i,r),this.epsilon=1e3,this.belongsTo=null,this.TYPE=Ce}return function(t,e,n){e&&Ae(t.prototype,e),n&&Ae(t,n)}(t,[{key:"Set",value:function(t,e,n,i){this.s.Set(t,e),this.e.Set(n,i)}},{key:"SetC",value:function(t){this.s.SetV(t.s),this.e.SetV(t.e)}},{key:"Stretch",value:function(t){var e=.5*t;this.s.PushFromV(this.e,e),this.e.PushFromV(this.s,e)}},{key:"Rotate",value:function(t,e,n){e=void 0==e?.5:e;var i=this.s.Copy();i.AddV(this.e),i.Multiply(e,void 0==n?e:n),this.s.RotateAroundV(i,t),this.e.RotateAroundV(i,t)}},{key:"Cut",value:function(t,e){null==e&&(e=[]);for(var n=0;n<t.length;++n)e.push(this.s.GetWeightedAverageV(this.e,t[n]));return e}},{key:"GetLength",value:function(){return this.s.GetDistanceV(this.e)}},{key:"GetLengthSquared",value:function(){return this.s.GetDistanceSquaredV(this.e)}},{key:"IntersectsPoint",value:function(t){var e=this.s,n=this.e,i=(t.y-e.y)*(n.x-e.x)-(t.x-e.x)*(n.y-e.y);if(Math.abs(i)>this.epsilon)return!1;var r=(t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y);return!(r<0)&&!(r>this.GetLengthSquared())}},{key:"IntersectsLine",value:function(t){return Object(D.LineLineIntersection)(this.s,this.e,t.s,t.e)}},{key:"GetClosestPointTo",value:function(t){return Object(D.ClosestPointOnLine)(this.s,this.e,t)}},{key:"GetNormalA",value:function(){return this.s.GetNormalAV(this.e)}},{key:"GetNormalB",value:function(){return this.s.GetNormalBV(this.e)}}]),t}(),Ce=0;function Oe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var xe=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertices=[],this.normals=[],this.perimeterMidPoints=[],this.centroid=new pt(0,0),this.aabb=null,this.dirtyBounds=!0,this.belongsTo=null,this.TYPE=Te,null!=e&&this.AddVertices(e)}return function(t,e,n){e&&Oe(t.prototype,e),n&&Oe(t,n)}(t,[{key:"Copy",value:function(){for(var e=new t,n=this.vertices,i=0;i<n.length;++i)e.AddVertex(n[i].Copy());return e}},{key:"ExtractSegments",value:function(t){var e=this.vertices,n=e.length-1;null==t&&(t=[]);for(var i=0;i<n;++i)t.push(new Se(e[i],e[i+1]));return t.push(new Se(e[n],e[0])),t}},{key:"GenerateRandomPoints",value:function(t,e,n){this.ComputeBounds(),n=!!n;var i=R.RandomFloat,r=this.aabb.tl,o=this.aabb.br,a=[];!0===e&&(i=R.RandomInteger);for(var s=0;s<t;++s){for(var u=new pt(i(r.x,o.x),i(r.y,o.y));this.IntersectsPoint(u)===n;)u.Set(i(r.x,o.x),i(r.y,o.y));a.push(u)}return a}},{key:"AddVertex",value:function(t){this.vertices.push(t)}},{key:"AddVertices",value:function(t){if(t[0]instanceof pt)this.vertices.push.apply(this.vertices,t);else if("number"==typeof t[0])for(var e=0;e<t.length;e+=2)this.AddVertex(new pt(t[e],t[e+1]));else if(null!=t[0].x)for(e=0;e<t.length;++e)this.AddVertex(new pt(t[e].x,t[e].y))}},{key:"Recreate",value:function(t){this.vertices.length=0,void 0!=t&&this.vertices.push.apply(this.vertices,t)}},{key:"ComputeBounds",value:function(){var t,e=1/0,n=-e,i=e,r=-e,o=this.vertices;null===this.aabb&&(this.aabb=new le(0,0,0,0));for(var a=0;a<o.length;++a)(t=o[a]).x<e&&(e=t.x),t.x>n&&(n=t.x),t.y<i&&(i=t.y),t.y>r&&(r=t.y);this.aabb.Set(e,i,n,r),this.dirtyBounds=!1}},{key:"Rotate",value:function(t,e,n,i){var r=0,o=this.aabb,a=o.tl.Copy(),s=this.vertices,u=s.length;for(!0===this.dirtyBounds&&!0===i?this.ComputeBounds():null===this.aabb&&this.ComputeBounds(),e=void 0===e?.5:e,a.AddV(o.br),a.Multiply(e,void 0===n?e:n);r<u;++r)s[r].RotateAroundV(a,t);this.dirtyBounds=!0}},{key:"GetControid",value:function(){var t=this.vertices,e=this.centroid;e.Set(0,0);for(var n=0;n<t.length;++n)e.AddV(t[n]);return e.Divide(t.length,t.length),e}},{key:"GetNormalsA",value:function(){var t=this.vertices,e=t.length-1,n=this.normals;n.length=0;for(var i=0;i<e;++i)n.push(t[i].GetNormalAV(t[i+1]));return n.push(t[e].GetNormalAV(t[0])),n}},{key:"GetNormalsA",value:function(){var t=this.vertices,e=t.length-1,n=this.normals;n.length=0;for(var i=0;i<e;++i)n.push(t[i].GetNormalBV(t[i+1]));return n.push(t[e].GetNormalBV(t[0])),n}},{key:"GetPerimeterMidPoints",value:function(){var t=this.vertices,e=t.length-1,n=this.perimeterMidPoints;n.length=0;for(var i=0;i<e;++i)n.push(t[i].GetMidPointV(t[i+1]));return n.push(t[e].GetMidPointV(t[0])),n}},{key:"IntersectsPoint",value:function(t){if(!0===this.dirtyBounds&&this.ComputeBounds(),!1===this.aabb.IntersectsPoint(t))return!1;for(var e,n,i=!1,r=this.vertices,o=t.x,a=t.y,s=0,u=r.length-1;s<r.length;u=s++)e=r[s],n=r[u],e.y>a!=n.y>a&&o<(n.x-e.x)*(a-e.y)/(n.y-e.y)+e.x&&(i=!i);return i}}]),t}(),Te=3,_e="source-over",Pe="source-over",ke="source-in",Ee="source-out",Re="source-atop",De="destination-over",Ie="destination-in",je="destination-out",Le="destination-atop",Ne="lighter",Ge="copy",Be="xor",Ue="multiply",Fe="overlay",Ve="darken",Me="lighten",Xe="color-dodge",Ye="color-burn",He="hard-light",We="soft-light",qe="difference",ze="exclusion",Ke="hue",Qe="saturation",Je="color",Ze="luminosity",$e="round",tn="butt",en="square",nn="bevel",rn="round",on="miter",an="start",sn="end",un="center",ln="left",cn="right",hn="alphabetic",fn="top",dn="hanging",pn="middle",yn="ideographic",vn="bottom";function bn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var mn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#36802d",this.applied=!0,Object(R.ApplyProperties)(this,e)}return function(t,e,n){e&&bn(t.prototype,e),n&&bn(t,n)}(t,[{key:"Apply",value:function(t){t.fillStyle=this.color}}]),t}();function gn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var wn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#c9df8a",this.lineCap=$e,this.lineJoin=rn,this.lineWidth=2,this.miterLimit=10,this.applied=!0,Object(R.ApplyProperties)(this,e)}return function(t,e,n){e&&gn(t.prototype,e),n&&gn(t,n)}(t,[{key:"Apply",value:function(t){t.strokeStyle=this.color,t.lineCap=this.lineCap,t.lineJoin=this.lineJoin,t.lineWidth=this.lineWidth,t.miterLimit=this.miterLimit}}]),t}();function An(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Sn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#234d20",this.blur=5,this.offsetX=0,this.offsetY=0,this.applied=!1,Object(R.ApplyProperties)(this,e)}return function(t,e,n){e&&An(t.prototype,e),n&&An(t,n)}(t,[{key:"Apply",value:function(t){t.shadowColor=this.color,t.shadowBlur=this.blur,t.shadowOffsetX=this.offsetX,t.shadowOffsetY=this.offsetY}}]),t}();function Cn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var On=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fillColor="#36802d",this.strokeColor="#36802d",this.fontSize=45,this.font=null,this.fontFamily="Arial",this.align=ln,this.baseline=fn,this.lineWidth=.5,this.applied=!0,Object(R.ApplyProperties)(this,e),this.ConcatFont()}return function(t,e,n){e&&Cn(t.prototype,e),n&&Cn(t,n)}(t,[{key:"Apply",value:function(t){t.fillStyle=this.fillColor,t.strokeStyle=this.strokeColor,t.font=this.font,t.textAlign=this.align,t.textBaseline=this.baseline,t.lineWidth=this.lineWidth}},{key:"ConcatFont",value:function(){this.font=this.fontSize+"px "+this.fontFamily}}]),t}();var xn=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#c9df8a",this.size=1,Object(R.ApplyProperties)(this,e)},Tn=function(t){return{fill:new mn(t?t.fill:null),stroke:new wn(t?t.stroke:null),shadow:new Sn(t?t.shadow:null),text:new On(t?t.text:null),pixel:new xn(t?t.pixel:null)}},_n=function(t){return{fill:new mn(t?t.fill:null),stroke:new wn(t?t.stroke:null),shadow:new Sn(t?t.shadow:null)}},Pn=function(t){return{stroke:new wn(t?t.stroke:null),shadow:new Sn(t?t.shadow:null)}},kn=function(t){return{fill:new mn(t?t.fill:null),shadow:new Sn(t?t.shadow:null)}},En=function(t){return{shadow:new Sn(t?t.shadow:null),text:new On(t?t.text:null)}},Rn=function(t){return{pixel:new xn(t?t.pixel:null)}};function Dn(t){return(Dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function In(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function jn(t,e){return!e||"object"!==Dn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ln(t){return(Ln=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nn(t,e){return(Nn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gn=function(t){function e(t,n,i,r,o){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=jn(this,Ln(e).call(this,t,n,i,r))).programController=null,a.style=_n(o),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nn(t,e)}(e,le),function(t,e,n){e&&In(t.prototype,e),n&&In(t,n)}(e,[{key:"Draw",value:function(t){var e=this.tl,n=this.br,i=this.style;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(n.x,e.y),t.lineTo(n.x,n.y),t.lineTo(e.x,n.y),t.closePath(),!0===i.shadow.applied&&i.shadow.Apply(t),!0===i.fill.applied&&(i.fill.Apply(t),t.fill()),!0===i.stroke.applied&&(i.stroke.Apply(t),t.stroke())}},{key:"GLDraw",value:function(t,e){null!==this.programController&&this.programController.Execute(e.globalTransform.AsArray(!0),this.tl.x,this.tl.y,this.w,this.h)}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.fillColor&&null!==t.outlineColor&&null!==t.outline&&(t.fillColor.SetHex(this.style.fill.color),t.fillColor.Normalize(),t.outlineColor.SetHex(this.style.stroke.color),t.outlineColor.Normalize(),t.outline=this.style.stroke.lineWidth+.2),this}}]),e}();function Bn(t){return(Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Un(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Fn(t,e){return!e||"object"!==Bn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vn(t){return(Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mn(t,e){return(Mn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xn=function(t){function e(t,n,i,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Fn(this,Vn(e).call(this,t,n,i))).programController=null,o.style=_n(r),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mn(t,e)}(e,ge),function(t,e,n){e&&Un(t.prototype,e),n&&Un(t,n)}(e,[{key:"Draw",value:function(t){var e=this.center,n=this.style;t.beginPath(),t.arc(e.x,e.y,this.radius,0,D.PII,!1),t.closePath(),!0===n.shadow.applied&&n.shadow.Apply(t),!0===n.fill.applied&&(n.fill.Apply(t),t.fill()),!0===n.stroke.applied&&(n.stroke.Apply(t),t.stroke())}},{key:"GLDraw",value:function(t,e){null!==this.programController&&this.programController.Execute(e.globalTransform.AsArray(!0),this.center.x,this.center.y,this.radius)}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.fillColor&&null!==t.outlineColor&&null!==t.outline&&(t.fillColor.SetHex(this.style.fill.color),t.fillColor.Normalize(),t.outlineColor.SetHex(this.style.stroke.color),t.outlineColor.Normalize(),t.outline=this.style.stroke.lineWidth+.2),this}}]),e}();function Yn(t){return(Yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Wn(t,e){return!e||"object"!==Yn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qn(t){return(qn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zn(t,e){return(zn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Kn=function(t){function e(t,n,i,r,o){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=Wn(this,qn(e).call(this,t,n,i,r))).programController=null,a.style=Pn(o),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zn(t,e)}(e,Se),function(t,e,n){e&&Hn(t.prototype,e),n&&Hn(t,n)}(e,[{key:"Draw",value:function(t){var e=this.s,n=this.e,i=this.style;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(n.x,n.y),t.closePath(),!0===i.shadow.applied&&i.shadow.Apply(t),!0===i.stroke.applied&&(i.stroke.Apply(t),t.stroke())}},{key:"GLDraw",value:function(t,e){null!==this.programController&&this.programController.Execute(e.globalTransform.AsArray(!0),this.s,this.e)}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.color&&(t.color.SetHex(this.style.stroke.color),t.color.Normalize()),this}}]),e}();function Qn(t){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Zn(t,e){return!e||"object"!==Qn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $n(t){return($n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ti(t,e){return(ti=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ei=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Zn(this,$n(e).call(this,t))).programController=null,i.style=_n(n),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ti(t,e)}(e,xe),function(t,e,n){e&&Jn(t.prototype,e),n&&Jn(t,n)}(e,[{key:"Draw",value:function(t){var e=this.vertices,n=this.style;t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var i=1;i<e.length;++i)t.lineTo(e[i].x,e[i].y);t.closePath(),!0===n.shadow.applied&&n.shadow.Apply(t),!0===n.fill.applied&&(n.fill.Apply(t),t.fill()),!0===n.stroke.applied&&(n.stroke.Apply(t),t.stroke())}}]),e}();function ni(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ii=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=n,this.holderContext=e,this.handle=i,this.removeOnNextCall=r}return function(t,e,n){e&&ni(t.prototype,e),n&&ni(t,n)}(t,[{key:"Execute",value:function(){this.handle.apply(this.context,arguments),!0===this.removeOnNextCall&&this.Remove()}},{key:"Remove",value:function(){this.holderContext.Remove(this.handle,this.context)}}]),t}();function ri(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var oi=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.listeners=[],this.stopPropagation=!1,this.target=null,this.data=null}return function(t,e,n){e&&ri(t.prototype,e),n&&ri(t,n)}(t,[{key:"GetListenerIndex",value:function(t,e){var n,i=this.listeners;if(0===i.length)return-1;for(var r=0;r<i.length;++r)if((n=i[r]).context===e&&n.handle===t)return r;return-1}},{key:"Add",value:function(t,e,n){var i=new ii(this,e,t,n);this.listeners.push(i)}},{key:"Remove",value:function(t,e){var n=this.GetListenerIndex(t,e);-1!==n&&this.listeners.fickleSplice(n)}},{key:"Dump",value:function(t){var e=this.listeners;if(0!==e.length)if(void 0!==t)for(var n=0;n<e.length;++n)e[n].context===t&&this.listeners.fickleSplice(n);else this.listeners.length=0}},{key:"Dispatch",value:function(t,e){var n=this.listeners.slice();if(0!==n.length){this.stopPropagation=!1,this.target=t,this.data=e;for(var i=0;i<n.length&&(n[i].Execute(this),!0!==this.stopPropagation);++i);this.target=null,this.data=null}}}]),t}();function ai(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var si=Math.round,ui=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.stopTime=si(null==e?0:e),this.time=0,this.isRunning=!1,this.canResume=!1,this.count=0,this.onStop=new oi,this.onFinish=new oi,this.onStart=new oi,this.onReset=new oi,this.onPause=new oi,this.onResume=new oi}return function(t,e,n){e&&ai(t.prototype,e),n&&ai(t,n)}(t,[{key:"Reset",value:function(){this.onReset.Dispatch(this,null),this.count=0,this.time=0,this.isRunning=!1,this.canResume=!1}},{key:"Start",value:function(t){this.stopTime=si(null==t?this.stopTime:t),this.stopTime>0&&(this.time=0,this.isRunning=!0,this.canResume=!1,this.onStart.Dispatch(this,{stopTime:this.stopTime}))}},{key:"Stop",value:function(){!0===this.isRunning&&(this.isRunning=!1,this.onStop.Dispatch(this,null))}},{key:"Pause",value:function(){!0===this.isRunning&&!1===this.canResume&&(this.isRunning=!1,this.canResume=!0,this.onPause.Dispatch(this,null))}},{key:"Resume",value:function(){!0===this.canResume&&(this.isRunning=!0,this.canResume=!1,this.onResume.Dispatch(this,null))}},{key:"Process",value:function(){this.time<this.stopTime&&!0===this.isRunning&&++this.time>=this.stopTime&&(this.isRunning=!1,this.count++,this.onFinish.Dispatch(this,null))}}]),t}();function li(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ci=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.SetDesiredRate(n),this.onProcess=e,this.intervalId=null,this.afId=null,this.delta=0,this.then=0,this.now=0,this.desiredRate=0,this.supplyDelta=!0,i||this.StartAF()}return function(t,e,n){e&&li(t.prototype,e),n&&li(t,n)}(t,[{key:"Process",value:function(){this.onProcess(this.ComputeDelta())}},{key:"ProcessAF",value:function(){this.onProcess(this.ComputeDelta()),null!==this.afId&&(this.afId=requestAnimationFrame(this.ProcessAF))}},{key:"ComputeDelta",value:function(){return this.now=Date.now(),this.delta=this.now-this.then,this.then=this.now,this.delta}},{key:"GetTPS",value:function(){return Object(D.PrecisionRound)(1/this.delta*1e3,2)}},{key:"SetDesiredRate",value:function(t){this.desiredRate=void 0===t?16.66:1e3/t}},{key:"Start",value:function(t){if(null!==this.afId)return di("%cTicker: RAF is running!","color:red;".concat(fi)),null;null!==this.intervalId?!0===t?(this.Stop(),this.intervalId=setInterval(this.Process.bind(this),this.desiredRate),di("%cTicker: Starting interval!","color:#0F0;".concat(fi))):di("%cTicker: Interval already running!","color:#F00;".concat(fi)):(this.intervalId=setInterval(this.Process.bind(this),this.desiredRate),di("%cTicker: Starting interval!","color:#0F0;".concat(fi)))}},{key:"StartAF",value:function(t){if(null!==this.intervalId)return di("%cTicker: Interval is running!","color:#F00;".concat(fi)),null;null!==this.afId?!0===t?(this.Stop(),this.ProcessAF=this.ProcessAF.bind(this),this.afId=requestAnimationFrame(this.ProcessAF),di("%cTicker: Starting RAF!","color:#0F0;".concat(fi))):di("%cTicker: RAF already running!","color:#F00;".concat(fi)):(this.ProcessAF=this.ProcessAF.bind(this),this.afId=requestAnimationFrame(this.ProcessAF),di("%cTicker: Starting RAF!","color:#0F0;".concat(fi)))}},{key:"Stop",value:function(){null!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null,di("%cTicker: Stopping interval!","color:cyan;".concat(fi))),null!==this.afId&&(cancelAnimationFrame(this.afId),this.afId=null,di("%cTicker: Stopping RAF!","color:cyan;".concat(fi)))}}],[{key:"LOG",get:function(){return hi},set:function(t){(function(t){throw new Error('"'+t+'" is read-only')})("PS_LOG"),hi=!!t}}]),t}(),hi=!0,fi="background-color:black;font-family:Arial;font-size:16px;padding:5px;",di=function(){!1!==hi&&console.log.apply(null,arguments)},pi=n(8),yi=n.n(pi),vi=n(9),bi=n.n(vi),mi=n(10),gi=n.n(mi),wi=n(11),Ai=n.n(wi),Si=n(12),Ci=n.n(Si),Oi=n(13),xi=n.n(Oi),Ti=function(t){var e,n,i="@vertex@",r="@fragment@";e=t.indexOf(i)+i.length,n=t.indexOf("@vertex-end@");var o=t.substring(e,n);return e=t.indexOf(r)+r.length,n=t.indexOf("@fragment-end@"),{vertex:o,fragment:t.substring(e,n)}},_i=Ti(yi.a),Pi=Ti(bi.a),ki=Ti(gi.a),Ei=Ti(Ai.a),Ri=Ti(Ci.a),Di=Ti(xi.a),Ii=n(4);function ji(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Li=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,this.items=[]}return function(t,e,n){e&&ji(t.prototype,e),n&&ji(t,n)}(t,[{key:"Store",value:function(t){var e=!1;return null==t?(console.warn("Item is null."),null):(null!=t.id&&""!==t.id?e=!this.Contains(t,t.id):t.data&&null!=t.data.id&&""!==t.data.id&&(e=!this.Contains(t,t.data.id)),!1===e?(console.warn("Invalid item. Check the item id. The item has not been stored"),!1):(this.items.push(t),!0))}},{key:"StoreSafe",value:function(t){return null!=this.type&&Object(Ii.a)(t,Ii.a.IS_INSTANCE_OF,this.type),Object(Ii.a)(t,Ii.a.IS_SAME_TYPE,Ni),t.id?(Object(Ii.a)(t.id,Ii.a.IS_SAME_TYPE,Gi),Object(Ii.a)(t.id,Ii.a.IS_NOT,"")):(Object(Ii.a)(t.data,Ii.a.IS_SAME_TYPE,Ni),Object(Ii.a)(t.data.id,Ii.a.IS_SAME_TYPE,Gi),Object(Ii.a)(t.data.id,Ii.a.IS_NOT,"")),this.Store(t)}},{key:"GetById",value:function(t){for(var e=this.items,n=e[0],i=0;i<e.length;n=e[++i])if(null!=n&&(n.id===t||null!=n.data&&n.data.id===t))return n;return null}},{key:"Contains",value:function(t,e){for(var n=this.items,i=n[r],r=0;r<n.length;i=n[++r])if(null!=i){if(i===t)return!0;if(i.id===e)return!0;if(null!=i.data&&i.data.id===e)return!0}return!1}}]),t}(),Ni=Object.create(null),Gi="string";var Bi=function t(e,n,i,r,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.image=e,this.id=null,this.w=0,this.h=0,this.fw=0,this.fh=0,this.uniformId=0,this.id=null!=n?n:e.id,this.w=null!=i?i:e.naturalWidth,this.h=null!=r?r:e.naturalHeight,this.fw=null!=o?o:e.naturalWidth,this.fh=null!=a?a:e.naturalHeight};function Ui(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Fi=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.imageCache=new Li(Image),this.basicTextureCache=new Li(Bi),this.onImageLoaded=new oi,this.onComplete=new oi,this.count=0,this.loading=!1,this.toLoad=null,this.createTexture=!1,null!=i&&this.onComplete.Add(i,this),null!=e&&this.Load(e,n)}return function(t,e,n){e&&Ui(t.prototype,e),n&&Ui(t,n)}(t,[{key:"Load",value:function(t,e){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),null!=e&&(this.createTextures=e),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))}},{key:"Haul",value:function(t){var e=this.toLoad[t];if(null!=e){var n=new Image;n.onload=this.OnLoad.bind(this),n.onerror=this.OnError.bind(this),n.src=e.src,n.id=e.id,n.data=Object.create(null),n.data.w=e.w,n.data.h=e.h,n.data.fw=e.fw,n.data.fh=e.fh}else this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{imageCache:this.imageCache,basicTextureCache:this.basicTextureCache})}},{key:"OnLoad",value:function(t){var e=t.currentTarget;e.onload=null,e.onerror=null,this.imageCache.StoreSafe(e),!0===this.createTextures&&this.basicTextureCache.StoreSafe(new Bi(e,null,e.data.w,e.data.h,e.data.fw,e.data.fh)),this.onImageLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count)}},{key:"OnError",value:function(){throw new Error("Request failed")}},{key:"GetImageById",value:function(t){return this.imageCache.GetById(t)}},{key:"GetBasicTextureById",value:function(t){return this.basicTextureCache.GetById(t)}}]),t}();function Vi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Mi=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.XHRcache=new Li(XMLHttpRequest),this.dataCache=new Li,this.onXHRLoaded=new oi,this.onComplete=new oi,this.count=0,this.loading=!1,this.toLoad=null,null!=n&&this.onComplete.Add(n,this),null!=e&&this.Load(e)}return function(t,e,n){e&&Vi(t.prototype,e),n&&Vi(t,n)}(t,[{key:"Load",value:function(t){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))}},{key:"Haul",value:function(t){var e=this.toLoad[t];if(null!=e){var n=new XMLHttpRequest;switch(n.open("GET",e.src),e.type){case"json":n.onreadystatechange=this.OnLoadJSON.bind(this);break;default:n.onreadystatechange=this.OnLoadXML.bind(this)}n.onerror=this.OnError.bind(this),null!=n.data?n.data.id=e.id:n.data={id:e.id},n.send()}else this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{XHRcache:this.XHRcache,dataCache:this.dataCache})}},{key:"OnLoadXML",value:function(t){var e=t.currentTarget;200!==e.status&&null==e.responseText||4!==e.readyState||(e.onload=null,e.onerror=null,this.XHRcache.StoreSafe(e),this.dataCache.Store({id:e.data.id,data:M(e.responseText,!0)}),this.onXHRLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count),e.abort())}},{key:"OnLoadJSON",value:function(t){var e=t.currentTarget;200!==e.status&&null==e.responseText||4!==e.readyState||(e.onload=null,e.onerror=null,this.XHRcache.StoreSafe(e),this.dataCache.Store({id:e.data.id,data:JSON.parse(e.responseText)}),this.onXHRLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count),e.abort())}},{key:"OnError",value:function(t){throw console.error(t),new Error("Request failed")}},{key:"GetXHRById",value:function(t){return this.XHRcache.GetById(t)}},{key:"GetDataById",value:function(t){return this.dataCache.GetById(t).data}},{key:"GetClonedDataById",value:function(t){return Object(R.DeepClone)(this.GetDataById(t))}}]),t}();function Xi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Yi=function(){function t(e,n,i,r,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rate=o,this.timer=o,this.x=e,this.y=n,this.w=i,this.h=r,this.nextFrameIndex=null,this.id=null,null!=a&&(this.id=a)}return function(t,e,n){e&&Xi(t.prototype,e),n&&Xi(t,n)}(t,[{key:"Process",value:function(){return this.timer--<=0&&(this.Reset(),!0)}},{key:"Apply",value:function(t){t.ClipReconfigure(this.x,this.y,this.w,this.h)}},{key:"Reset",value:function(){this.timer=this.rate}}]),t}();function Hi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Wi=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.id,this.basicTexture=e,this.data=n,this.frameCache=new Li(Yi)}return function(t,e,n){e&&Hi(t.prototype,e),n&&Hi(t,n)}(t,[{key:"GenerateFrames",value:function(){for(var t,e,n,i=this.data,r=i.frames,o=i.meta.frameTags,a=0;a<r.length;++a)e=(t=r[a]).frame,n=o[a],this.frameCache.Store(new Yi(e.x,e.y,e.w,e.h,t.duration,n?n.name:null))}},{key:"GetFrameById",value:function(t){return this.frameCache.GetById(t)}}]),t}();function qi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var zi=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.spritesheetCache=new Li(Wi),this.xhrLoader=new Mi,this.imageLoader=new Fi,this.onComplete=new oi,this.onSpritesheetLoaded=new oi,this.count=0,this.loading=!1,this.toLoad=null,this.pairCount=0,this.tempBasicTexture=null,this.tempData=null,this.xhrLoader.onXHRLoaded.Add(this.OnPartXHRLoaded,this),this.imageLoader.onImageLoaded.Add(this.OnPartImageLoaded,this),null!=n&&this.onComplete.Add(n,this),null!=e&&this.Load(e)}return function(t,e,n){e&&qi(t.prototype,e),n&&qi(t,n)}(t,[{key:"Load",value:function(t){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))}},{key:"Haul",value:function(t){var e=this.toLoad[t];null!=e?(e.data.id=e.image.id=e.id,this.xhrLoader.Load([e.data]),this.imageLoader.Load([e.image],!0)):(this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{spritesheetCache:this.spritesheetCache}))}},{key:"OnPartLoaded",value:function(){if(2==++this.pairCount){var t=this.tempData.meta.size;this.tempBasicTexture.fw=t.w,this.tempBasicTexture.fh=t.h;var e=new Wi(this.tempBasicTexture,this.tempData);this.spritesheetCache.StoreSafe(e),this.pairCount=0,this.onSpritesheetLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count)}}},{key:"OnPartXHRLoaded",value:function(t){this.tempData=this.xhrLoader.GetDataById(t.target.data.id),this.OnPartLoaded()}},{key:"OnPartImageLoaded",value:function(t){this.tempBasicTexture=this.imageLoader.GetBasicTextureById(t.target.id),this.OnPartLoaded()}},{key:"GetSpritesheetById",value:function(t){return this.spritesheetCache.GetById(t)}}]),t}();function Ki(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Qi=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.data={},this.program=null,this.attributes=null,this.uniforms=null,null!=e&&null!=n&&this.Init(n.v,n.f)}return function(t,e,n){e&&Ki(t.prototype,e),n&&Ki(t,n)}(t,[{key:"Init",value:function(t,e){var n=this.gl,i=this.CreateShader(t,n.VERTEX_SHADER),r=this.CreateShader(e,n.FRAGMENT_SHADER),o=this.program=n.createProgram();if(n.attachShader(o,i),n.attachShader(o,r),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS)){var a=n.getProgramInfoLog(o);throw new Error("Program link failed:"+a)}n.detachShader(o,i),n.detachShader(o,r),n.deleteShader(i),n.deleteShader(r),this.attributes={},this.uniforms={}}},{key:"CreateShader",value:function(t,e){var n=this.gl,i=n.createShader(e);if(n.shaderSource(i,t),n.compileShader(i),!n.getShaderParameter(i,n.COMPILE_STATUS)){var r=n.getShaderInfoLog(i);throw new Error("Shader compilation failed:"+r)}return i}},{key:"AssignAttribute",value:function(t){this.attributes[t]=this.gl.getAttribLocation(this.program,t)}},{key:"AssignUniform",value:function(t){this.uniforms[t]=this.gl.getUniformLocation(this.program,t)}},{key:"Execute",value:function(){}}],[{key:"LAST_USED_CONTROLLER",get:function(){return Ji},set:function(t){Ji=t}}]),t}(),Ji=null;function Zi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var $i=Math.max,tr=Math.min,er=Math.round,nr=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.channel=new Float32Array([null==e?0:e,null==n?0:n,null==i?0:i,null==r?1:r]),this.value="",this.currentConversion="",this.ComputeValueRGBA()}return function(t,e,n){e&&Zi(t.prototype,e),n&&Zi(t,n)}(t,[{key:"Copy",value:function(){var e=new t(this.channel[0],this.channel[1],this.channel[2],this.channel[3]);return e.value=this.value,e.currentConversion=this.currentConversion,e}},{key:"ComputeValueRGBA",value:function(){return this.value="rgba(".concat(this.channel.join(",").concat(")")),this.value}},{key:"ComputeValueHSLA",value:function(){return this.value="hsla("+this.channel[0]+","+this.channel[1]+"%,"+this.channel[2]+"%,"+this.channel[3]+")",this.value}},{key:"ComputeValueHex",value:function(){return this.value="#"+this.channel[0].toString(16)+this.channel[1].toString(16)+this.channel[2].toString(16),this.value}},{key:"ConvertToHSLA",value:function(t){var e=0,n=0,i=this.channel[0]/ir,r=this.channel[1]/ir,o=this.channel[2]/ir,a=$i(i,r,o),s=tr(i,r,o),u=a-s,l=.5*(a+s);a!==s&&(n=l>.5?u/(2-a-s):u/(a+s),e=a===i?(r-o)/u+(r<o?6:0):a===r?(o-i)/u+2:(i-r)/u+4,e/=6),this.channel[0]=360*e,this.channel[1]=100*n,this.channel[2]=100*l,!0===t&&(this.channel[0]=er(this.channel[0]),this.channel[1]=er(this.channel[1]),this.channel[2]=er(this.channel[2])),this.currentConversion="hsl",this.ComputeValueHSLA()}},{key:"SetRGB",value:function(t,e,n,i){this.channel[0]=Object(R.Clamp)(t,rr,ir),this.channel[1]=Object(R.Clamp)(e,rr,ir),this.channel[2]=Object(R.Clamp)(n,rr,ir),this.currentConversion="rgb",i||this.ComputeValueRGBA()}},{key:"SetRGBA",value:function(t,e,n,i){this.SetRGB(t,e,n,!0),this.channel[3]=Object(R.Clamp)(i,0,1),this.ComputeValueRGBA()}},{key:"SetHex",value:function(t){var e=(t=t.replace(/#/g,"")).match(/.{2}/g);null==(e=e.map(R.Base16ToBase10))[3]&&(e[3]=1),this.SetRGBA(e[0],e[1],e[2],e[3])}},{key:"IncreaseChannel",value:function(t,e){this.channel[t]+=e,"rgb"===this.currentConversion?this.ComputeValueRGBA():"hsl"===this.currentConversion&&this.ComputeValueHSLA()}},{key:"SetChannel",value:function(t,e){this.channel[t]=e,"rgb"===this.currentConversion?this.ComputeValueRGBA():"hsl"===this.currentConversion&&this.ComputeValueHSLA()}},{key:"Normalize",value:function(){this.channel[0]=or*this.channel[0],this.channel[1]=or*this.channel[1],this.channel[2]=or*this.channel[2]}},{key:"r",get:function(){return this.channel[0]},set:function(t){this.channel[0]=t}},{key:"g",get:function(){return this.channel[1]},set:function(t){this.channel[1]=t}},{key:"b",get:function(){return this.channel[2]},set:function(t){this.channel[2]=t}},{key:"a",get:function(){return this.channel[3]},set:function(t){this.channel[3]=t}}]),t}(),ir=255,rr=0,or=1/ir;function ar(t){return(ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ur(t,e){return!e||"object"!==ar(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function lr(t,e,n,i){return(lr="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,e,n,i){var r,o=hr(t,e);if(o){if((r=Object.getOwnPropertyDescriptor(o,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=Object.getOwnPropertyDescriptor(i,e)){if(!r.writable)return!1;r.value=n,Object.defineProperty(i,e,r)}else!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0})(t,e,n,i)}function cr(t,e,n){return(cr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=hr(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function hr(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=fr(t)););return t}function fr(t){return(fr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dr(t,e){return(dr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pr=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ur(this,fr(e).call(this,t,Ri))).essenceBuffer=null,n.vertices=null,n.fillColor=null,n.outlineColor=null,n.outline=5,n.Initialise(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dr(t,e)}(e,Qi),function(t,e,n){e&&sr(t.prototype,e),n&&sr(t,n)}(e,[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array(Object(D.TriRectArray)(0,0,1,1)),this.fillColor=new nr,this.outlineColor=new nr,t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uFillColor"),this.AssignUniform("uOutlineColor"),this.AssignUniform("uRadius"),this.AssignUniform("uOutline")}},{key:"Execute",value:function(t,n,i,r){var o=this.gl,a=this.attributes,s=this.uniforms,u=this.vertices,l=this.fillColor.channel,c=this.outlineColor.channel;Object(D.TriRectArray)(n-r,i-r,2*r,2*r,u),this!==cr(fr(e.prototype),"LAST_USED_CONTROLLER",this)&&(o.useProgram(this.program),function(t,e,n,i,r){if(!lr(t,e,n,i||t)&&r)throw new Error("failed to set property")}(fr(e.prototype),"LAST_USED_CONTROLLER",this,this,!0)),o.bindBuffer(o.ARRAY_BUFFER,this.essenceBuffer),o.bufferSubData(o.ARRAY_BUFFER,0,u),o.enableVertexAttribArray(a.aPosition),o.vertexAttribPointer(a.aPosition,2,o.FLOAT,!1,0,0),o.uniformMatrix3fv(s.uProjection,!1,t),o.uniform4f(s.uFillColor,l[0],l[1],l[2],l[3]),o.uniform4f(s.uOutlineColor,c[0],c[1],c[2],c[3]),o.uniform1f(s.uOutline,this.outline),o.uniform1f(s.uRadius,r),o.drawArrays(o.TRIANGLE_STRIP,0,6)}}]),e}();function yr(t){return(yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function br(t,e){return!e||"object"!==yr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mr(t,e,n,i){return(mr="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,e,n,i){var r,o=wr(t,e);if(o){if((r=Object.getOwnPropertyDescriptor(o,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=Object.getOwnPropertyDescriptor(i,e)){if(!r.writable)return!1;r.value=n,Object.defineProperty(i,e,r)}else!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0})(t,e,n,i)}function gr(t,e,n){return(gr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=wr(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function wr(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ar(t)););return t}function Ar(t){return(Ar=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sr(t,e){return(Sr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Cr=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=br(this,Ar(e).call(this,t,Di))).essenceBuffer=null,n.vertices=null,n.color=null,n.Initialise(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sr(t,e)}(e,Qi),function(t,e,n){e&&vr(t.prototype,e),n&&vr(t,n)}(e,[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array([-1,0,1,0]),this.color=new nr,t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uColor")}},{key:"Execute",value:function(t,n,i){var r=this.gl,o=this.attributes,a=this.uniforms,s=this.vertices,u=this.color.channel;s[0]=n.x,s[1]=n.y,s[2]=i.x,s[3]=i.y,this!==gr(Ar(e.prototype),"LAST_USED_CONTROLLER",this)&&(r.useProgram(this.program),function(t,e,n,i,r){if(!mr(t,e,n,i||t)&&r)throw new Error("failed to set property")}(Ar(e.prototype),"LAST_USED_CONTROLLER",this,this,!0)),r.bindBuffer(r.ARRAY_BUFFER,this.essenceBuffer),r.bufferSubData(r.ARRAY_BUFFER,0,s),r.enableVertexAttribArray(o.aPosition),r.vertexAttribPointer(o.aPosition,2,r.FLOAT,!1,0,0),r.uniformMatrix3fv(a.uProjection,!1,t),r.uniform4f(a.uColor,u[0],u[1],u[2],u[3]),r.drawArrays(r.LINES,0,2)}}]),e}();function Or(t){return(Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Tr(t,e){return!e||"object"!==Or(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _r(t,e,n,i){return(_r="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,e,n,i){var r,o=kr(t,e);if(o){if((r=Object.getOwnPropertyDescriptor(o,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=Object.getOwnPropertyDescriptor(i,e)){if(!r.writable)return!1;r.value=n,Object.defineProperty(i,e,r)}else!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0})(t,e,n,i)}function Pr(t,e,n){return(Pr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=kr(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function kr(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Er(t)););return t}function Er(t){return(Er=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rr(t,e){return(Rr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Dr=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Tr(this,Er(e).call(this,t,ki))).dataBuffer=null,n.previousNumberOfElements=0,n.Initialise(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rr(t,e)}(e,Qi),function(t,e,n){e&&xr(t.prototype,e),n&&xr(t,n)}(e,[{key:"Initialise",value:function(){var t=this.gl;this.dataBuffer=t.createBuffer(),this.AssignAttribute("aProjection1"),this.AssignAttribute("aProjection2"),this.AssignAttribute("aProjection3"),this.AssignAttribute("aPosition"),this.AssignAttribute("aColor"),this.AssignAttribute("aPointSize")}},{key:"Execute",value:function(t,n){var i=this.gl,r=this.attributes;Pr(Er(e.prototype),"LAST_USED_CONTROLLER",this)!==this&&i.useProgram(this.program),i.bindBuffer(i.ARRAY_BUFFER,this.dataBuffer),n!==this.previousNumberOfElements?i.bufferData(i.ARRAY_BUFFER,t,i.DYNAMIC_DRAW):i.bufferSubData(i.ARRAY_BUFFER,0,t),i.enableVertexAttribArray(r.aProjection1),i.vertexAttribPointer(r.aProjection1,3,i.FLOAT,!1,64,0),i.enableVertexAttribArray(r.aProjection2),i.vertexAttribPointer(r.aProjection2,3,i.FLOAT,!1,64,12),i.enableVertexAttribArray(r.aProjection3),i.vertexAttribPointer(r.aProjection3,3,i.FLOAT,!1,64,24),i.enableVertexAttribArray(r.aPosition),i.vertexAttribPointer(r.aPosition,2,i.FLOAT,!1,64,36),i.enableVertexAttribArray(r.aColor),i.vertexAttribPointer(r.aColor,4,i.FLOAT,!1,64,44),i.enableVertexAttribArray(r.aPointSize),i.vertexAttribPointer(r.aPointSize,1,i.FLOAT,!1,64,60),i.drawArrays(i.POINTS,0,n),this.previousNumberOfElements=n,function(t,e,n,i,r){if(!_r(t,e,n,i||t)&&r)throw new Error("failed to set property")}(Er(e.prototype),"LAST_USED_CONTROLLER",this,this,!0)}}]),e}();function Ir(t){return(Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Lr(t,e){return!e||"object"!==Ir(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Nr(t,e,n,i){return(Nr="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,e,n,i){var r,o=Br(t,e);if(o){if((r=Object.getOwnPropertyDescriptor(o,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=Object.getOwnPropertyDescriptor(i,e)){if(!r.writable)return!1;r.value=n,Object.defineProperty(i,e,r)}else!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0})(t,e,n,i)}function Gr(t,e,n){return(Gr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=Br(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Br(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ur(t)););return t}function Ur(t){return(Ur=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fr(t,e){return(Fr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vr=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Lr(this,Ur(e).call(this,t,Ei))).essenceBuffer=null,n.vertices=null,n.fillColor=null,n.outlineColor=null,n.outline=5,n.Initialise(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fr(t,e)}(e,Qi),function(t,e,n){e&&jr(t.prototype,e),n&&jr(t,n)}(e,[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array(Object(D.TriRectArray)(0,0,1,1)),this.fillColor=new nr,this.outlineColor=new nr,t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uFillColor"),this.AssignUniform("uOutlineColor"),this.AssignUniform("uSize"),this.AssignUniform("uOutline")}},{key:"Execute",value:function(t,n,i,r,o){var a=this.gl,s=this.attributes,u=this.uniforms,l=this.vertices,c=this.fillColor.channel,h=this.outlineColor.channel;Object(D.TriRectArray)(n,i,r,o,l),this!==Gr(Ur(e.prototype),"LAST_USED_CONTROLLER",this)&&(a.useProgram(this.program),function(t,e,n,i,r){if(!Nr(t,e,n,i||t)&&r)throw new Error("failed to set property")}(Ur(e.prototype),"LAST_USED_CONTROLLER",this,this,!0)),a.bindBuffer(a.ARRAY_BUFFER,this.essenceBuffer),a.bufferSubData(a.ARRAY_BUFFER,0,l),a.enableVertexAttribArray(s.aPosition),a.vertexAttribPointer(s.aPosition,2,a.FLOAT,!1,0,0),a.uniformMatrix3fv(u.uProjection,!1,t),a.uniform4f(u.uFillColor,c[0],c[1],c[2],c[3]),a.uniform4f(u.uOutlineColor,h[0],h[1],h[2],h[3]),a.uniform1f(u.uOutline,this.outline),a.uniform2f(u.uSize,r,o),a.drawArrays(a.TRIANGLE_STRIP,0,6)}}]),e}();function Mr(t){return(Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Yr(t,e){return!e||"object"!==Mr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hr(t,e,n,i){return(Hr="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,e,n,i){var r,o=qr(t,e);if(o){if((r=Object.getOwnPropertyDescriptor(o,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=Object.getOwnPropertyDescriptor(i,e)){if(!r.writable)return!1;r.value=n,Object.defineProperty(i,e,r)}else!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0})(t,e,n,i)}function Wr(t,e,n){return(Wr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=qr(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function qr(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=zr(t)););return t}function zr(t){return(zr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kr(t,e){return(Kr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qr=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Yr(this,zr(e).call(this,t,Pi))).originalTexture=null,n.boundTexture=null,n.essenceBuffer=null,n.dataBuffer=null,n.indexBuffer=null,n.previousNumberOfElements=0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kr(t,e)}(e,Qi),function(t,e,n){e&&Xr(t.prototype,e),n&&Xr(t,n)}(e,[{key:"BindBasicTexture",value:function(t){var e=this.gl,n=Object(D.TriRectArray)(0,0,t.w,t.h);this.aia=e.getExtension("ANGLE_instanced_arrays"),this.originalTexture=t,this.boundTexture=e.createTexture(),this.essenceBuffer=e.createBuffer(),this.dataBuffer=e.createBuffer(),n.push.apply(n,Object(D.TriRectArray)(0,0,1,1)),e.bindTexture(e.TEXTURE_2D,this.boundTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.MIRRORED_REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.MIRRORED_REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.image),e.bindBuffer(e.ARRAY_BUFFER,this.essenceBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindTexture(e.TEXTURE_2D,null),this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignAttribute("aProjection1"),this.AssignAttribute("aProjection2"),this.AssignAttribute("aProjection3"),this.AssignAttribute("aTranslation1"),this.AssignAttribute("aTranslation2"),this.AssignAttribute("aTranslation3"),this.AssignAttribute("aTransformation1"),this.AssignAttribute("aTransformation2"),this.AssignAttribute("aTransformation3"),this.AssignUniform("uImage")}},{key:"Execute",value:function(t,n){var i=this.gl,r=this.aia,o=this.attributes,a=this.uniforms;this!==Wr(zr(e.prototype),"LAST_USED_CONTROLLER",this)&&(i.useProgram(this.program),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.boundTexture),i.uniform1i(a.uImage,0),i.bindBuffer(i.ARRAY_BUFFER,this.essenceBuffer),i.enableVertexAttribArray(o.aPosition),i.vertexAttribPointer(o.aPosition,2,i.FLOAT,!1,0,0),r.vertexAttribDivisorANGLE(o.aPosition,0),i.enableVertexAttribArray(o.aTexCoord),i.vertexAttribPointer(o.aTexCoord,2,i.FLOAT,!1,0,48),r.vertexAttribDivisorANGLE(o.aTexCoord,0),function(t,e,n,i,r){if(!Hr(t,e,n,i||t)&&r)throw new Error("failed to set property")}(zr(e.prototype),"LAST_USED_CONTROLLER",this,this,!0)),i.bindBuffer(i.ARRAY_BUFFER,this.dataBuffer),n!==this.previousNumberOfElements?i.bufferData(i.ARRAY_BUFFER,t,i.DYNAMIC_DRAW):i.bufferSubData(i.ARRAY_BUFFER,0,t),i.enableVertexAttribArray(o.aProjection1),i.vertexAttribPointer(o.aProjection1,3,i.FLOAT,!1,108,0),r.vertexAttribDivisorANGLE(o.aProjection1,1),i.enableVertexAttribArray(o.aProjection2),i.vertexAttribPointer(o.aProjection2,3,i.FLOAT,!1,108,12),r.vertexAttribDivisorANGLE(o.aProjection2,1),i.enableVertexAttribArray(o.aProjection3),i.vertexAttribPointer(o.aProjection3,3,i.FLOAT,!1,108,24),r.vertexAttribDivisorANGLE(o.aProjection3,1),i.enableVertexAttribArray(o.aTranslation1),i.vertexAttribPointer(o.aTranslation1,3,i.FLOAT,!1,108,36),r.vertexAttribDivisorANGLE(o.aTranslation1,1),i.enableVertexAttribArray(o.aTranslation2),i.vertexAttribPointer(o.aTranslation2,3,i.FLOAT,!1,108,48),r.vertexAttribDivisorANGLE(o.aTranslation2,1),i.enableVertexAttribArray(o.aTranslation3),i.vertexAttribPointer(o.aTranslation3,3,i.FLOAT,!1,108,60),r.vertexAttribDivisorANGLE(o.aTranslation3,1),i.enableVertexAttribArray(o.aTransformation1),i.vertexAttribPointer(o.aTransformation1,3,i.FLOAT,!1,108,72),r.vertexAttribDivisorANGLE(o.aTransformation1,1),i.enableVertexAttribArray(o.aTransformation2),i.vertexAttribPointer(o.aTransformation2,3,i.FLOAT,!1,108,84),r.vertexAttribDivisorANGLE(o.aTransformation2,1),i.enableVertexAttribArray(o.aTransformation3),i.vertexAttribPointer(o.aTransformation3,3,i.FLOAT,!1,108,96),r.vertexAttribDivisorANGLE(o.aTransformation3,1),r.drawArraysInstancedANGLE(i.TRIANGLE_STRIP,0,6,n)}}]),e}();function Jr(t){return(Jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function $r(t,e){return!e||"object"!==Jr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function to(t,e,n,i){return(to="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,e,n,i){var r,o=no(t,e);if(o){if((r=Object.getOwnPropertyDescriptor(o,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=Object.getOwnPropertyDescriptor(i,e)){if(!r.writable)return!1;r.value=n,Object.defineProperty(i,e,r)}else!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(i,e,n);return!0})(t,e,n,i)}function eo(t,e,n){return(eo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=no(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function no(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=io(t)););return t}function io(t){return(io=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ro(t,e){return(ro=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var oo=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=$r(this,io(e).call(this,t,_i))).originalTexture0=null,n.boundTexture0=null,n.essenceBuffer0=null,n.originalTexture1=null,n.boundTexture1=null,n.essenceBuffer1=null,n.originalTexture2=null,n.boundTexture2=null,n.essenceBuffer2=null,n.originalTexture3=null,n.boundTexture3=null,n.essenceBuffer3=null,n.lastUsedUnit=0,n.Initialise(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ro(t,e)}(e,Qi),function(t,e,n){e&&Zr(t.prototype,e),n&&Zr(t,n)}(e,[{key:"Initialise",value:function(){this.AssignAttribute("aPosition0"),this.AssignAttribute("aTexCoord0"),this.AssignAttribute("aPosition1"),this.AssignAttribute("aTexCoord1"),this.AssignAttribute("aPosition2"),this.AssignAttribute("aTexCoord2"),this.AssignAttribute("aPosition3"),this.AssignAttribute("aTexCoord3"),this.AssignUniform("uImage"),this.AssignUniform("uUnitId"),this.AssignUniform("uProjection"),this.AssignUniform("uTranslation"),this.AssignUniform("uTransformation"),this.AssignUniform("uTint")}},{key:"BindBasicTexture",value:function(t,e){var n=this.gl,i=Object(D.TriRectArray)(0,0,t.w,t.h);(null==e||e<0||e>3)&&(e=0),t.uniformId=e,this["originalTexture"+e]=t,this["boundTexture"+e]=n.createTexture(),this["essenceBuffer"+e]=n.createBuffer(),i.push.apply(i,Object(D.TriRectArray)(0,0,1,1)),n.bindTexture(n.TEXTURE_2D,this["boundTexture"+e]),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t.image),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.bindBuffer(n.ARRAY_BUFFER,this["essenceBuffer"+e]),n.bufferData(n.ARRAY_BUFFER,new Float32Array(i),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindTexture(n.TEXTURE_2D,null)}},{key:"BindUnit",value:function(t,e,n,i){null!=this["boundTexture"+i]&&(t.activeTexture(t.TEXTURE0+i),t.bindTexture(t.TEXTURE_2D,this["boundTexture"+i]),t.bindBuffer(t.ARRAY_BUFFER,this["essenceBuffer"+i]),t.enableVertexAttribArray(n["aPosition"+i]),t.vertexAttribPointer(n["aPosition"+i],2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(n["aTexCoord"+i]),t.vertexAttribPointer(n["aTexCoord"+i],2,t.FLOAT,!1,0,48))}},{key:"Execute",value:function(t,n,i,r,o){var a=this.gl,s=this.attributes,u=this.uniforms;this!==eo(io(e.prototype),"LAST_USED_CONTROLLER",this)?(a.useProgram(this.program),this.BindUnit(a,u,s,0),this.BindUnit(a,u,s,1),this.BindUnit(a,u,s,2),this.BindUnit(a,u,s,3),a.uniform1f(u.uUnitId,o),a.uniform1i(u.uImage,o),function(t,e,n,i,r){if(!to(t,e,n,i||t)&&r)throw new Error("failed to set property")}(io(e.prototype),"LAST_USED_CONTROLLER",this,this,!0),this.lastUsedUnit=o):o!==this.lastUsedUnit&&(a.uniform1f(u.uUnitId,o),a.uniform1i(u.uImage,o),this.lastUsedUnit=o),a.uniform4fv(u.uTint,r),a.uniformMatrix3fv(u.uProjection,!1,t),a.uniformMatrix3fv(u.uTranslation,!1,n),a.uniformMatrix3fv(u.uTransformation,!1,i),a.drawArrays(a.TRIANGLE_STRIP,0,6)}}]),e}();function ao(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var so=function(){function t(e,n,i,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.split(" "),this.handle=n,this.info=i,this.priority=r,this.breakIfExecuted=!!o,this.data={},this.command=null}return function(t,e,n){e&&ao(t.prototype,e),n&&ao(t,n)}(t,[{key:"Execute",value:function(t,e,n){return this.handle(t,e,n),this.breakIfExecuted}}]),t}();function uo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var lo=function(){function t(e,n,i,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.split(" "),this.handle=n,this.info=i,this.data={},this.options=null,this.registry=null,this.optionPrefix=null==o?co:o,this.dsCopy=[],this.dataSeparator="=",this.allOptionIds=null,this.fullInfo=null,this.continueToPrime=!!r,this.filterNull=!1}return function(t,e,n){e&&uo(t.prototype,e),n&&uo(t,n)}(t,[{key:"Execute",value:function(t,e,n){this.HandleData(t,e),!0===this.filterNull&&(t=t.filter(ho)),!0===this.HandleOptions(t,e,n)&&this.handle(t,e,n)}},{key:"AddOption",value:function(t,e,n,i,r,o){null!=(o=null==o?this.optionPrefix:o)&&(t=t.replace(/\S+/g,o+"$&")),null==this.options&&(this.options=[]),i=null==i?0:i;var a=this.options,s=a[l],u=new so(t,e,n,i,r);u.command=this;for(var l=0;l<a.length;s=a[++l])if(s.priority<=i)return a.splice(l,0,u),this.allOptionIds=this.GetAllOptionIds(),this;return this.options.push(u),this.allOptionIds=this.GetAllOptionIds(),this}},{key:"HandleData",value:function(t,e){var n,i=this.dataSeparator,r=this.dsCopy;r.push.apply(r,t);for(var o=0;o<r.length;++o)2===(n=r[o].split(i)).length&&(t[o]=null,e[n[0]]=n[1]);r.length=0}},{key:"HandleOptions",value:function(t,e,n){if(0===t.length)return this.continueToPrime;var i=this.GetAndRemoveMatchingOptionIds(t);if(null==i)return this.continueToPrime;for(var r=0;r<i.length;++r)if(!0===this.GetOptionById(i[r]).Execute(t,e,n))return!1;return this.continueToPrime}},{key:"GetOptionById",value:function(t){for(var e=this.options,n=e[i],i=0;i<e.length;n=e[++i])if(-1!==(n=e[i]).id.indexOf(t))return n;return null}},{key:"GetAllOptionIds",value:function(){for(var t=this.options,e=[],n=0;n<t.length;++n)e.push.apply(e,t[n].id);return e}},{key:"GetAndRemoveMatchingOptionIds",value:function(t){var e,n=this.allOptionIds;if(null==n)return null;for(var i=[],r=0;r<n.length;++r)-1!==(e=t.indexOf(n[r]))&&i.push(t.fickleSplice(e));return i}},{key:"GenerateInfoString",value:function(){for(var t="COMMAND: "+this.id.join(", ")+" -> "+this.info+"\n",e=this.options,n=e[i],i=0;i<e.length;n=e[++i])t+="OPTION: "+(n=e[i]).id.join(", ")+" -> "+n.info+"\n";return t}},{key:"OPTION_PREFIX",get:function(){return co},set:function(t){(function(t){throw new Error('"'+t+'" is read-only')})("PS_OPTION_PREFIX"),co=t}}]),t}(),co="",ho=function(t){return null!=t};function fo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var po=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.commands=[],this.splitter=" "}return function(t,e,n){e&&fo(t.prototype,e),n&&fo(t,n)}(t,[{key:"AddCommand",value:function(t){if(null==t.registry)return this.commands.push(t),t.registry=this,t}},{key:"RemoveCommand",value:function(t){var e=this.commands,n=e.indexOf(t);if(-1!==n)return t.registry=null,e.fickleSplice(n)}},{key:"GetCommandById",value:function(t){for(var e=this.commands,n=e[i],i=0;i<e.length;n=e[++i])if(n)for(var r=0;r<n.id.length;++r)if(n.id[r]===t)return n;return null}},{key:"Parse",value:function(t,e){var n=String(t).split(this.splitter),i=n.shift(),r=this.GetCommandById(i);return r?(r.Execute(n,{},e),null):i}}]),t}();function yo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var vo=function(){function t(e,n,i,r,a,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.target=n,this.propertyString=i,this.value=r,this.duration=a,this.easing=o[null==s?bo:s],this.time=0,this.startValue=0,this.change=0,this.property=null,this.properyObject=null,this.running=!1,this.onStart=new oi,this.onEnd=new oi,this.onStop=new oi,this.onReconfigure=new oi,this.onReset=new oi}return function(t,e,n){e&&yo(t.prototype,e),n&&yo(t,n)}(t,[{key:"Start",value:function(){var t=this.propertyString.split(".");this.property=t[t.length-1],this.propertyObject=Object(R.Nested)(this.target,this.propertyString,!0),this.startValue=this.propertyObject[this.property],this.change=this.value-this.startValue,this.time=0,this.running=!0,this.onStart.Dispatch(this,null)}},{key:"Stop",value:function(){this.property=null,this.propertyObject=null,this.startValue=0,this.change=0,this.time=0,this.running=!1,this.onStop.Dispatch(this,null)}},{key:"Process",value:function(){!0===this.running&&(this.propertyObject[this.property]=this.easing(this.time,this.startValue,this.change,this.duration),++this.time>=this.duration&&(this.running=!1,this.propertyObject[this.property]=this.value,this.onEnd.Dispatch(this,null)))}},{key:"Reconfigure",value:function(t,e,n,i){null!=t&&(this.propertyString=t),this.value=e,this.duration=n,this.easing=o[null==i?bo:i],this.onReconfigure.Dispatch(this,null)}},{key:"NewValue",value:function(t){this.value=t,this.Start()}},{key:"Reset",value:function(){if(null==this.propertyObject||null==this.property)return!1;this.propertyObject[this.property]=this.startValue,this.property=null,this.propertyObject=null,this.startValue=0,this.change=0,this.time=0,this.running=!1,this.onReset.Dispatch(this,null)}}]),t}(),bo="Linear";function mo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var go=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.motions=[],this.target=e}return function(t,e,n){e&&mo(t.prototype,e),n&&mo(t,n)}(t,[{key:"Create",value:function(t,e,n,i,r){if(null==this.GetMotionById(t)){var o=new vo(t,this.target,e,n,i,r);return this.motions.push(o),o}return null}},{key:"Add",value:function(t){null==this.GetMotionById(t.id)&&this.motions.push(t)}},{key:"Start",value:function(t){var e=this.GetMotionById(t);return null!==e&&e.Start(),e}},{key:"StartMultiple",value:function(t){t=t.split(" ");for(var e=0;e<t.length;++e)this.Start(t[e])}},{key:"Stop",value:function(t){var e=this.GetMotionById(t);return null!==e&&e.Stop(),e}},{key:"StopMultiple",value:function(t){t=t.split(" ");for(var e=0;e<t.length;++e)this.Stop(t[e])}},{key:"Reset",value:function(t){var e=this.GetMotionByid(t);return null!==e&&e.Reset(),e}},{key:"ResetMultiple",value:function(t){t=t.split(" ");for(var e=0;e<t.length;++e)this.Reset(t[e])}},{key:"Process",value:function(){for(var t=this.motions,e=0;e<t.length;++e)t[e].Process()}},{key:"GetMotionById",value:function(t){for(var e=this.motions,n=0;n<e.length;++n)if(e[n].id===t)return e[n];return null}}]),t}();function wo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ao=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.velocityX=null,this.velocityY=null,this.torque=null,this.accelerationX=null,this.accelerationY=null,this.spin=null,this.growthX=null,this.growthY=null,this.gravityX=null,this.gravityY=null,this.active=!0}return function(t,e,n){e&&wo(t.prototype,e),n&&wo(t,n)}(t,[{key:"CreateOscillatingObject",value:function(t,e,n,i){if(null!==this[t])throw new Error("Invalid key");this[t]={from:e,to:n,amplitude:i,active:!0}}},{key:"SetOscillatingObject",value:function(t,e,n,i){var r=this[t];if(null==r)return this.CreateOscillatingObject(t,e,n,i);r.from=e,r.to=n,r.amplitude=i,r.active=!0}},{key:"Nullify",value:function(t){null!=this[t]&&(this[t].active=!1)}}]),t}();function So(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Co=Math.cos,Oo=Math.sin,xo=Math.atan2,To=Math.sqrt,_o=Math.abs,Po=Math.PI,ko=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.array=new Float32Array(9),this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}return function(t,e,n){e&&So(t.prototype,e),n&&So(t,n)}(t,[{key:"Identity",value:function(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}},{key:"Copy",value:function(){var e=new t;return e.Set(this.a,this.b,this.c,this.d,this.e,this.f),e}},{key:"Set",value:function(t,e,n,i,r,o){return this.a=t,this.b=e,this.c=n,this.d=i,this.e=r,this.f=o,this}},{key:"SetTransform",value:function(t,e,n,i,r,o,a,s,u){t=null==t?0:t,e=null==e?0:e,n=null==n?1:n,i=null==i?1:i,r=null==r?0:r,o=null==o?0:o,a=null==a?0:a,s=null==s?0:s,u=null==u?0:u;var l=Oo(r),c=Co(r),h=-Oo(o),f=Co(o),d=Oo(a),p=Co(a),y=c*n,v=l*n,b=-l*i,m=c*i;return this.a=p*y+d*b,this.b=p*v+d*m,this.c=h*y+f*b,this.d=h*v+f*m,this.e=t+s*y+u*b,this.f=e+s*v+u*m,this}},{key:"Translate",value:function(t,e){this.e+=t,this.f+=e}},{key:"TranslateTo",value:function(t,e){this.e=t,this.f=e}},{key:"ApplyTranslation",value:function(t,e){this.e=t*this.a+e*this.c+this.e,this.f=t*this.b+e*this.d+this.f}},{key:"ApplyScale",value:function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e}},{key:"Scale",value:function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e}},{key:"Rotate",value:function(t){var e=Math.sin(t),n=Math.cos(t),i=this.a,r=this.c,o=this.e;this.a=i*n-this.b*e,this.b=i*e+this.b*n,this.c=r*n-this.d*e,this.d=r*e+this.d*n,this.e=o*n-this.f*e,this.f=o*e+this.f*n}},{key:"Decompose",value:function(t){var e=this.a,n=this.b,i=this.c,r=this.d,o=-xo(-i,r),a=xo(n,e);_o(o+a)<Eo?(t.rotation=a,e<0&&r>=0&&(t.rotation+=Po),t.skew.SetSame(0)):t.skew.Set(o,a),t.scale.Set(To(e*e+n*n),To(i*i+r*r)),t.position.Set(this.e,this.f)}},{key:"ApplyToContext",value:function(t){t.setTransform(this.a,this.b,this.c,this.d,this.e,this.f)}},{key:"AsArray",value:function(t){var e=this.array;return!0===t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.e,e[7]=this.f,e[8]=1):(e[0]=this.a,e[1]=this.c,e[2]=this.e,e[3]=this.b,e[4]=this.d,e[5]=this.f,e[6]=0,e[7]=0,e[8]=1),e}}]),t}(),Eo=1e-5;function Ro(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Do=Math.cos,Io=Math.sin,jo=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.position=new pt(e,n),this.scale=new pt(1,1),this.skew=new pt(0,0),this.pivot=new pt(0,0),this.localTransform=new ko,this.globalTransform=new ko,this.rotation=0,this.skewCX=1,this.skewSX=0,this.skewCY=0,this.skewSY=1}return function(t,e,n){e&&Ro(t.prototype,e),n&&Ro(t,n)}(t,[{key:"Set",value:function(t){t.Decompose(this),this.UpdateSkew()}},{key:"UpdateLocal",value:function(){var t=this.localTransform,e=this.position,n=this.scale,i=this.pivot;t.a=this.skewCX*n.x,t.b=this.skewSX*n.x,t.c=this.skewCY*n.y,t.d=this.skewSY*n.y,t.e=e.x-i.x*t.a+i.y*t.c,t.f=e.y-i.y*t.b+i.y*t.d}},{key:"UpdateGlobal",value:function(t){var e=this.localTransform,n=this.globalTransform,i=this.position,r=this.scale,o=this.pivot;e.a=this.skewCX*r.x,e.b=this.skewSX*r.x,e.c=this.skewCY*r.y,e.d=this.skewSY*r.y,e.e=i.x-o.x*e.a+o.y*e.c,e.f=i.y-o.y*e.b+o.y*e.d,n.a=e.a*t.a+e.b*t.c,n.b=e.a*t.b+e.b*t.d,n.c=e.c*t.a+e.d*t.c,n.d=e.c*t.b+e.d*t.d,n.e=e.e*t.a+e.f*t.c+t.e,n.f=e.e*t.b+e.f*t.d+t.f}},{key:"UpdateSkew",value:function(){var t=this.skew,e=this.rotation;this.skewCX=Do(e+t.y),this.skewSX=Io(e+t.y),this.skewCY=-Io(e-t.x),this.skewSY=Do(e-t.x)}},{key:"ApplyGlobal",value:function(t){this.globalTransform.ApplyToContext(t)}}]),t}();function Lo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var No=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.transform=new jo(e,n),this.data={},this.parent=null,this.w=0,this.h=0,this.bounds=null,this.boundsDirty=!0,this.globalPosition=null}return function(t,e,n){e&&Lo(t.prototype,e),n&&Lo(t,n)}(t,[{key:"UpdateTransform",value:function(){null!=this.parent?this.transform.UpdateGlobal(this.parent.transform.globalTransform):this.transform.UpdateGlobal(Go.globalTransform)}},{key:"GetGlobalPosition",value:function(){var t=this.transform.globalTransform;return null===this.globalPosition?this.globalPosition=new pt(t.e,t.f):this.globalPosition.Set(t.e,t.f),this.globalPosition}},{key:"ComputeBounds",value:function(t){var e=0,n=0;return null!=t&&(e=this.width*t.x,n=this.height*t.y),null===this.bounds?(this.bounds=new le(this.x-e,this.y-n,this.x+this.width-e,this.y+this.height-n),this.bounds.belongsTo=this):this.bounds.Set(this.x-e,this.y-n,this.x+this.width-e,this.y+this.height-n),this.boundsDirty=!1,this.bounds}},{key:"rotation",get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t,this.transform.UpdateSkew()}},{key:"scale",get:function(){return this.transform.scale}},{key:"position",get:function(){return this.transform.position}},{key:"pivot",get:function(){return this.transform.pivot}},{key:"x",get:function(){return this.transform.position.x},set:function(t){this.transform.position.x=t}},{key:"y",get:function(){return this.transform.position.y},set:function(t){this.transform.position.y=t}},{key:"width",get:function(){return this.w*this.scale.x},set:function(t){this.w=t}},{key:"height",get:function(){return this.h*this.scale.y},set:function(t){this.h=t}}]),t}(),Go=new jo;function Bo(t){return(Bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Fo(t,e){return!e||"object"!==Bo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vo(t){return(Vo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mo(t,e){return(Mo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xo=Math.abs,Yo=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Fo(this,Vo(e).call(this,t,n))).children=[],i.render=!0,i.display=!0,i.transformShouldUpdate=!0,i.transformAutomaticUpdate=!0,i.motionManager=null,i.isBatchParent=!1,i.childDataBuffer=null,i.bufferData=null,i.programController=null,i.bufferStartIndex=0,i.bufferEndIndex=0,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mo(t,e)}(e,No),function(t,e,n){e&&Uo(t.prototype,e),n&&Uo(t,n)}(e,[{key:"PreDraw",value:function(){}},{key:"GLPreDraw",value:function(){}},{key:"Draw",value:function(t){this.PreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.children.length>0&&!0===this.display&&this.DrawChildren(t))}},{key:"GLDraw",value:function(t){this.GLPreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren():this.GLDrawChildren(t)))}},{key:"RequestTransformUpdate",value:function(){this.transformShouldUpdate=!0}},{key:"DrawChildren",value:function(t){for(var e=this.children,n=0;n<e.length;++n)e[n].Draw(t)}},{key:"GLDrawChildren",value:function(t){for(var e=this.children,n=0;n<e.length;++n)e[n].GLDraw(t)}},{key:"GLBatchDrawChildren",value:function(){null!=this.childDataBuffer&&null!=this.programController&&this.programController.Execute(this.childDataBuffer,this.children.length)}},{key:"ComputeBatchBuffer",value:function(t){for(var e,n,i=this.children,r=[],o=0;o<i.length;++o)e=i[o],n=null!=t?t(e):e.GetBufferData(),e.bufferStartIndex=r.length,e.bufferEndIndex=r.length+n.length,r.push.apply(r,n);this.childDataBuffer=new Float32Array(r)}},{key:"UpdateInBuffer",value:function(){throw new Error(Ho)}},{key:"GetBufferData",value:function(){throw new Error(Ho)}},{key:"AddChild",value:function(t){var e=t.parent;return null!==e&&e.RemoveChild(t),this.children.push(t),t.parent=this,t}},{key:"AddChildren",value:function(){var t=arguments;Object(R.IsArray)(t[0])&&(t=t[0]);for(var e=0;e<t.length;++e)this.AddChild(t[e])}},{key:"AddSibling",value:function(t){var e=this.parent;return null!==e&&e.AddChild(t),t}},{key:"RemoveChild",value:function(t){var e=this.children,n=e.indexOf(t);if(-1!==n)return t.parent=null,e.fickleSplice(n)}},{key:"RemoveChildren",value:function(){var t,e,n=arguments;Object(R.IsArray)(i[0])&&(function(t){throw new Error('"'+t+'" is read-only')}("children"),i=i[0]);for(var i=this.children,r=[],o=0;o<n.length;++o)t=n[o],-1!==(e=i.indexOf(t))&&(r.push(i.fickleSplice(e)),t.parent=null);return r}},{key:"Swap",value:function(t){if(null!==this.parent){var e=this.parent.children,n=e.indexOf(this);if(-1!==n){-1===t&&(t=e.length-1);var i=e[t];e[t]=this,e[n]=i}}}},{key:"SendToFront",value:function(){this.Swap(-1)}},{key:"SendToBack",value:function(){this.Swap(0)}},{key:"Dump",value:function(){for(var t=this.children,e=0;e<t.length;++e)t[e].parent=null;t.length=0}},{key:"Destroy",value:function(){this.Dump(),null!==this.parent&&this.parent.RemoveChild(this)}},{key:"AttachTo",value:function(t){t.AddChild(this)}},{key:"Detach",value:function(){return null!==this.parent?this.parent.RemoveChild(this):null}},{key:"GetChildClosestTo",value:function(t,e){var n,i,r,o=1/0,a=this.children;if(0!==a.length){for(var s=0;s<a.length;++s)n=a[s],void 0!==e&&!1===e(n)||(i=Xo(n.position.GetDistanceSquared(t.x,t.y)))<o&&(o=i,r=n);return r}return null}},{key:"GetChildFurthestFrom",value:function(t,e){var n,i,r,o=0,a=this.children;if(0!==a.length){for(var s=0;s<a.length;++s)n=a[s],void 0!==e&&!1===e(n)||(i=Xo(n.position.GetDistanceSquared(t.x,t.y)))>o&&(o=i,r=n);return r}return null}},{key:"UseAsBatchParent",value:function(t){this.isBatchParent=!0,this.programController=t}}]),e}();Yo.prototype.Mount=Yo.prototype.AddChildren;var Ho="Cannot access buffer data directly on Container2D!";function Wo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var qo=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.frames=[],this.controller=e,this.sprite=e.sprite,this.id=n,this.onEnd=new oi,this.onStop=new oi,this.onStart=new oi,this.currentFrame=0,this.currentFrameIndex=0,this.playing=!1,this.rate=60,this.timer=0,this.reverse=!1,this.overrideFrameRate=!1,this.loop=!1,this.autoFrame=!0,null!=i&&(this.rate=i)}return function(t,e,n){e&&Wo(t.prototype,e),n&&Wo(t,n)}(t,[{key:"CreateFrame",value:function(t,e,n,i,r){r=null==r?this.rate:r,this.frames.push(new Yi(t,e,n,i,r))}},{key:"AddFrame",value:function(t){(null==t.rate||t.rate<=0)&&(t.rate=this.rate),this.frames.push(t)}},{key:"GenerateFrames",value:function(t,e,n,i,r,o){var a,s=n/i;o=null==o?{}:o;for(var u=0;u<r;++u)a=o[u],this.CreateFrame(u%s*t,(u/s|0)*e,t,e,a)}},{key:"SetFrame",value:function(t){t=null==t?0:t;var e=this.frames[t];void 0!==e&&(this.currentFrame=e,this.currentFrameIndex=t,this.currentFrame.Apply(this.sprite))}},{key:"GetFrameById",value:function(t,e){for(var n=this.frames,i=0;i<n.length;++i)if(n[i].id===t)return!0===e?i:n[i]}},{key:"SetFrameById",value:function(t){var e=this.GetFrameById(t,!0);this.SetFrame(e)}},{key:"Start",value:function(t){null==t&&this.autoFrame&&(t=this.reverse?this.frames.length-1:0),this.SetFrame(t),this.ResetAllFrames(),this.timer=this.rate,this.playing=!0,this.onStart.Dispatch()}},{key:"Stop",value:function(){this.playing=!1,this.onStop.Dispatch()}},{key:"Process",value:function(){!0===this.playing&&(!0===this.overrideFrameRate?--this.timer<=0&&(this.timer=this.rate,this.NextFrame()):!0===this.currentFrame.Process()&&this.NextFrame())}},{key:"NextFrame",value:function(){var t=!1,e=this.frames,n=e.length;!1===this.reverse?++this.currentFrameIndex:--this.currentFrameIndex,this.currentFrameIndex>=n?(!0===this.loop?this.currentFrameIndex=0:this.currentFrameIndex=n-1,t=!0):this.currentFrameIndex<0&&(!0===this.loop?this.currentFrameIndex=n-1:this.currentFrameIndex=0,t=!0),this.currentFrame=e[this.currentFrameIndex],this.currentFrame.Apply(this.sprite),!0===t&&(this.onEnd.Dispatch(),!1===this.loop&&this.Stop())}},{key:"Clear",value:function(){this.frames=[],this.currentFrame=null,this.playing=!1,this.currentFrameIndex=0,this.timer=this.rate}},{key:"Reset",value:function(){this.SetFrame(0),this.ResetAllFrames(),this.timer=this.rate,this.playing=!1}},{key:"ResetAllFrames",value:function(){for(var t=this.frames,e=0;e<t.length;++e)t[e].Reset()}}]),t}();function zo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ko=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.animations=[],this.sprite=null,this.currentAnimation=null,null!=e&&(this.sprite=e)}return function(t,e,n){e&&zo(t.prototype,e),n&&zo(t,n)}(t,[{key:"CreateAnimation",value:function(t,e){var n=new qo(this,t,e);return this.animations.push(n),n}},{key:"AddAnimation",value:function(t){t.controller=this,this.animations.push(t)}},{key:"GetAnimationById",value:function(t){for(var e=this.animations,n=e[i],i=0;i<e.length;n=e[++i])if(n&&n.id===t)return n;return null}},{key:"PlayAnimation",value:function(t,e){var n=this.GetAnimationById(t);null!==n&&(this.currentAnimation=n,n.Start(e))}},{key:"StopCurrentAnimation",value:function(){null!==this.currentAnimation&&this.currentAnimation.Stop()}},{key:"Process",value:function(){null!==this.currentAnimation&&this.currentAnimation.Process()}}]),t}();function Qo(t){return(Qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Zo(t,e){return!e||"object"!==Qo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $o(t){return($o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ta(t,e){return(ta=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ea=function(t){function e(t,n,i){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Zo(this,$o(e).call(this,t,n))).anchor=new pt(0,0),r.SetPath(i),r.alpha=1,r.gco=_e,r.interactive=!0,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ta(t,e)}(e,Yo),function(t,e,n){e&&Jo(t.prototype,e),n&&Jo(t,n)}(e,[{key:"Draw",value:function(t){if(this.PreDraw(t),!0===this.render){!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyGlobal(t);var e=this.path;e&&e.Draw&&!0===this.display&&(t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,e.Draw(t)),this.children.length>0&&this.DrawChildren(t)}}},{key:"GLDraw",value:function(t){if(this.GLPreDraw(t),!0===this.render){!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1));var e=this.path;e&&e.GLDraw&&!0===this.display&&e.GLDraw(t,this.transform),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren(t):this.GLDrawChildren(t))}}},{key:"GetBufferData",value:function(){this.UpdateTransform();var t=this.transform.globalTransform.AsArray(!0);null==this.bufferData&&(this.bufferData=[]);var e=this.bufferData;return e.length=0,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this.path&&this.path.GetBufferData&&e.push.apply(e,this.path.GetBufferData()),e}},{key:"UpdateInBuffer",value:function(){this.UpdateTransform();var t=this.transform.globalTransform.AsArray(!0),e=this.parent.childDataBuffer,n=this.bufferStartIndex;e[n]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=t[3],e[n+4]=t[4],e[n+5]=t[5],e[n+6]=t[6],e[n+7]=t[7],e[n+8]=t[8],this.path&&this.path.UpdateInBuffer&&this.path.UpdateInBuffer(e,n+9)}},{key:"IntersectsPoint",value:function(t){return!1!==this.interactive&&(na.SetV(t),na.SubtractV(this.position),this.path.IntersectsPoint(na))}},{key:"SetPath",value:function(t){void 0!==t&&(void 0!==t.w&&void 0!==t.h?(this.w=t.w,this.h=t.h):void 0!==t.GetLength?this.w=this.h=t.GetLength():void 0!==t.diameter?this.w=this.h=t.diameter:void 0!==t.aabb&&(this.w=t.aabb.w,this.h=t.aabb.h),this.path=t)}}]),e}(),na=new pt(0,0);function ia(t){return(ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ra(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function oa(t,e){return!e||"object"!==ia(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function aa(t){return(aa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sa(t,e){return(sa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ua=function(t){function e(t,n,i,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=oa(this,aa(e).call(this,t,n))).anchor=new pt(0,0),o.clip=new le(0,0,0,0),o.shape=new le(0,0,0,0),o.textureTransformation=new ko,o.textureTranslation=new ko,o.originalShape=new le(0,0,0,0),o.tint=new nr(1,1,1,1),o.texture=null,o.gco=_e,o.interactive=!0,o.programController=null,o.animationController=null,i instanceof oo?(o.programController=i,null!=r?o.SetTexture(i["originalTexture"+r]):o.SetTexture(i.originalTexture0)):null==i?o.SetTexture(la):o.SetTexture(i),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sa(t,e)}(e,Yo),function(t,e,n){e&&ra(t.prototype,e),n&&ra(t,n)}(e,[{key:"Draw",value:function(t){if(this.PreDraw(t),!0===this.render){if(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyGlobal(t),!0===this.display){var e=this.clip,n=e.tl,i=e.br,r=this.anchor;t.globalAlpha=this.tint.channel[3],t.globalCompositeOperation=this.gco,t.drawImage(this.texture.image,n.x,n.y,i.x,i.y,-this.w*r.x,-this.h*r.y,this.w,this.h)}this.children.length>0&&this.DrawChildren(t)}}},{key:"GLDraw",value:function(t){this.GLPreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),!0===this.display&&null!==this.programController&&this.programController.Execute(this.transform.globalTransform.AsArray(!0),this.textureTranslation.AsArray(!0),this.textureTransformation.AsArray(!0),this.tint.channel,this.texture.uniformId),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren(t):this.GLDrawChildren(t)))}},{key:"GetBufferData",value:function(){this.UpdateTransform(),this.UpdateTextureTransform();var t=this.transform.globalTransform.AsArray(!0),e=this.textureTranslation.AsArray(!0),n=this.textureTransformation.AsArray(!0);null==this.bufferData&&(this.bufferData=[]);var i=this.bufferData;return i.length=0,i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=e[0],i[10]=e[1],i[11]=e[2],i[12]=e[3],i[13]=e[4],i[14]=e[5],i[15]=e[6],i[16]=e[7],i[17]=e[8],i[18]=n[0],i[19]=n[1],i[20]=n[2],i[21]=n[3],i[22]=n[4],i[23]=n[5],i[24]=n[6],i[25]=n[7],i[26]=n[8],i}},{key:"UpdateInBuffer",value:function(){this.UpdateTransform(),this.UpdateTextureTransform();var t=this.transform.globalTransform.AsArray(!0),e=this.textureTranslation.AsArray(!0),n=this.textureTransformation.AsArray(!0),i=this.parent.childDataBuffer,r=this.bufferStartIndex;i[r]=t[0],i[r+1]=t[1],i[r+2]=t[2],i[r+3]=t[3],i[r+4]=t[4],i[r+5]=t[5],i[r+6]=t[6],i[r+7]=t[7],i[r+8]=t[8],i[r+9]=e[0],i[r+10]=e[1],i[r+11]=e[2],i[r+12]=e[3],i[r+13]=e[4],i[r+14]=e[5],i[r+15]=e[6],i[r+16]=e[7],i[r+17]=e[8],i[r+18]=n[0],i[r+19]=n[1],i[r+20]=n[2],i[r+21]=n[3],i[r+22]=n[4],i[r+23]=n[5],i[r+24]=n[6],i[r+25]=n[7],i[r+26]=n[8]}},{key:"UpdateTextureTransform",value:function(){var t=this.w/this.texture.fw,e=this.h/this.texture.fh;this.textureTranslation.TranslateTo(-this.w*this.anchor.x,-this.h*this.anchor.y),this.textureTransformation.TranslateTo(t*this.clip.tl.x/this.w,e*this.clip.tl.y/this.h)}},{key:"UpdateShape",value:function(t){null!=t&&(this.originalShape=t),this.shape.SetC(this.originalShape),this.shape.Scale(this.scale.x,this.scale.y)}},{key:"SetTexture",value:function(t){this.texture=t,this.ClipReconfigure(0,0,t.w,t.h),this.shape.SetC(this.clip),this.originalShape.SetC(this.shape)}},{key:"ClipReconfigure",value:function(t,e,n,i){var r=n/this.texture.fw,o=i/this.texture.fh,a=this.width,s=this.height;this.clip.Set(t,e,n,i),this.w=n,this.h=i,0!==a&&0!==s&&(this.width=a,this.height=s),this.textureTranslation.SetTransform(-n*this.anchor.x,-i*this.anchor.y,r,o),this.textureTransformation.SetTransform(r*this.clip.tl.x/n,o*this.clip.tl.y/i,r,o)}},{key:"CreateAnimation",value:function(t){null===this.animationController&&(this.animationController=new Ko(this));var e=this.animationController.CreateAnimation(t.id,t.rate);if(null!=t.spritesheet)for(var n=0;n<t.frames.length;++n)e.AddFrame(t.spritesheet.GetFrameById(t.frames[n]));return e}},{key:"IntersectsPoint",value:function(t){if(!1===this.interactive)return!1;var e=t.SubtractVC(this.position);return e.Add(this.width*this.anchor.x,this.height*this.anchor.y),this.shape.IntersectsPoint(e)}},{key:"width",get:function(){return this.w*this.scale.x},set:function(t){this.scale.x=t/this.w}},{key:"height",get:function(){return this.h*this.scale.y},set:function(t){this.scale.y=t/this.h}},{key:"alpha",get:function(){return this.tint.channel[3]},set:function(t){this.tint.channel[3]=t}}],[{key:"BUILD_DEFAULT_TEXTURE",value:function(t){if(!0===ca)throw new Error("Function can only be called once!");la=new Bi(F(U(function(){var t=new ei([0,0,64,0,64,64,0,64,0,0,32,32,64,0,32,32,64,64,32,32,0,64]);return t.ComputeBounds(),t.style.stroke.lineWidth=3,new ea(0,0,t)}),64,64,t),"__DEFAULT_SPRITE_TEXTURE__",64,64,64,64),ca=!0}},{key:"DEFAULT_TEXTURE",get:function(){return la}}]),e}(),la=null,ca=!1;function ha(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var fa=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.velocity=new pt(0,0),this.torque=0,this.spin=0,this.growth=new pt(1,1),this.acceleration=new pt(1,1),this.initialScale=new pt(1,1),this.fade=!1,this.deflate=!1,this.gravity=new pt,this.lifespan=0,this.lifespanTotal=0,this.dead=!1,this.entity=null,this.system=null,this.oscillation=null,this.oscillationOffset=0,this.Renew(e,n)}return function(t,e,n){e&&ha(t.prototype,e),n&&ha(t,n)}(t,[{key:"Process",value:function(){if(!0!==this.dead)if(this.lifespan++<this.lifespanTotal){var t=this.entity,e=this.velocity,n=1-this.lifespan/this.lifespanTotal,i=this.oscillation;if(e.AddV(this.gravity).MultiplyV(this.acceleration),0!==this.torque&&e.Rotate(this.torque),t.position.AddV(e),!0===this.fade&&(t.alpha=n),!0===this.deflate?t.scale.Set(n*this.initialScale.x,n*this.initialScale.y):t.scale.MultiplyV(this.growth),t.rotation+=this.spin,null!==i&&!0===i.active){var r=this.lifespan+this.oscillationOffset;null!=i.torque&&!0===i.torque.active&&(this.torque=Object(D.Oscillate)(r,i.torque.from,i.torque.to,i.torque.amplitude)),null!=i.spin&&!0===i.spin.active&&(this.spin=Object(D.Oscillate)(r,i.spin.from,i.spin.to,i.spin.amplitude)),null!=i.velocityX&&!0===i.velocityX.active&&(this.velocity.x=Object(D.Oscillate)(r,i.velocityX.from,i.velocityX.to,i.velocityX.amplitude)),null!=i.velocityY&&!0===i.velocityY.active&&(this.velocity.y=Object(D.Oscillate)(r,i.velocityY.from,i.velocityY.to,i.velocityY.amplitude)),null!=i.gravityX&&!0===i.gravityX.active&&(this.gravity.x=Object(D.Oscillate)(r,i.gravityX.from,i.gravityX.to,i.gravityX.amplitude)),null!=i.gravityY&&!0===i.gravityY.active&&(this.gravity.y=Object(D.Oscillate)(r,i.gravityY.from,i.gravityY.to,i.gravityY.amplitude)),null!=i.accelerationX&&!0===i.accelerationX.active&&(this.acceleration.x=Object(D.Oscillate)(r,i.accelerationX.from,i.accelerationX.to,i.accelerationX.amplitude)),null!=i.accelerationY&&!0===i.accelerationY.active&&(this.acceleration.y=Object(D.Oscillate)(r,i.accelerationY.from,i.accelerationY.to,i.accelerationY.amplitude)),null!=i.growthX&&!0===i.growthX.active&&(this.growth.x=Object(D.Oscillate)(r,i.growthX.from,i.growthX.to,i.growthX.amplitude)),null!=i.growthY&&!0===i.growthY.active&&(this.growth.y=Object(D.Oscillate)(r,i.growthY.from,i.growthY.to,i.growthY.amplitude))}}else this.dead=!0,this.entity.display=!1}},{key:"Renew",value:function(t,e){if(null!=t){this.dead=!1;var n=this.entity;if(null==t.texture)throw new Error("No texture or controller provided!");if(null===n?(n=this.entity=new ua(0,0,t.texture,t.unitId),null!=t.anchor&&(n.anchor.SetV(t.anchor),n.UpdateTextureTransform())):this.ResetEntity(t.unitId),null!=t.frames&&(t.frames[Object(R.RandomInteger)(0,t.frames.length-1)].Apply(n),n.scale.SetSame(1),n.UpdateTextureTransform()),this.RenewVector(t.position,n.position,e,0,0),this.RenewVector(t.velocity,this.velocity,e,0,0),this.RenewVector(t.gravity,this.gravity,e,0,0),this.RenewVector(t.acceleration,this.acceleration,e,1,1),this.RenewVector(t.growth,this.growth,e,1,1),this.RenewVector(t.scale,n.scale,e,1,1),this.RenewVector(t.scale,this.initialScale,e,1,1),null!=t.rotation?n.rotation=Object(R.MinMaxOrValue)(t.rotation):n.rotation=0,null!=t.lifespan?this.SetLifespan(t.lifespan):this.SetLifespan(0),null!=t.torque?this.torque=Object(R.MinMaxOrValue)(t.torque):this.torque=0,null!=t.spin?this.spin=Object(R.MinMaxOrValue)(t.spin):this.spin=0,null!=t.fade?this.fade=t.fade:this.fade=!1,null!=t.deflate?this.deflate=t.deflate:this.deflate=!1,null!=t.oscillation){var i=t.oscillation,r=this.oscillation;null===r&&(r=this.oscillation=new Ao),r.active=!0,null!=i.offset?this.oscillationOffset=Object(R.MinMaxOrValue)(i.offset):this.oscillationOffset=0,null!=i.torque?r.SetOscillatingObject("torque",i.torque.from,i.torque.to,i.torque.amplitude):r.Nullify("torque"),null!=i.spin?r.SetOscillatingObject("spin",i.spin.from,i.spin.to,i.spin.amplitude):r.Nullify("spin"),null!=i.velocity&&(null!=i.velocity.x?r.SetOscillatingObject("velocityX",i.velocity.x.from,i.velocity.x.to,i.velocity.x.amplitude):r.Nullify("velocityX"),null!=i.velocity.y?r.SetOscillatingObject("velocityY",i.velocity.y.from,i.velocity.y.to,i.velocity.y.amplitude):r.Nullify("velocityY")),null!=i.gravity&&(null!=i.gravity.x?r.SetOscillatingObject("gravityX",i.gravity.x.from,i.gravity.x.to,i.gravity.x.amplitude):r.Nullify("gravityX"),null!=i.gravity.y?r.SetOscillatingObject("gravityY",i.gravity.y.from,i.gravity.y.to,i.gravity.y.amplitude):r.Nullify("gravityY")),null!=i.acceleration&&(null!=i.acceleration.x?r.SetOscillatingObject("accelerationX",i.acceleration.x.from,i.acceleration.x.to,i.acceleration.x.amplitude):r.Nullify("accelerationX"),null!=i.acceleration.y?r.SetOscillatingObject("accelerationY",i.acceleration.y.from,i.acceleration.y.to,i.acceleration.y.amplitude):r.Nullify("accelerationY")),null!=i.growth&&(null!=i.growth.x?r.SetOscillatingObject("growthX",i.growth.x.from,i.growth.x.to,i.growth.x.amplitude):r.Nullify("growthX"),null!=i.growth.y?r.SetOscillatingObject("growthY",i.growth.y.from,i.growth.y.to,i.growth.y.amplitude):r.Nullify("growthY"))}else null!==this.oscillation&&(this.oscillation.active=!1)}}},{key:"RenewVector",value:function(t,e,n,i,r){null!=t?null!=t.points?null!=t.moduloWrapper?(null!=t.indexGap&&(n+=t.indexGap),e.SetV(t.points[n%t.moduloWrapper])):e.SetV(Object(R.RandomInArray)(t.points)):null!=t.xy?e.SetSame(Object(R.MinMaxOrValue)(t.xy)):(null!=t.x?e.x=Object(R.MinMaxOrValue)(t.x):e.x=i,null!=t.y?e.y=Object(R.MinMaxOrValue)(t.y):e.y=r):e.Set(i,r)}},{key:"SetLifespan",value:function(t){this.lifespan=0,this.lifespanTotal=Object(R.MinMaxOrValue)(t)}},{key:"ResetEntity",value:function(t){var e=this.entity;null!=t&&e.SetTexture(e.programController["originalTexture"+t]),e.scale.SetSame(1),e.alpha=1,e.display=!0,e.rotation=0}},{key:"Destroy",value:function(t){return(!0!==t||!1!==this.dead)&&(null!==this.system&&this.system.RemoveParticle(this),pa&&da.Store(this),!0)}}],[{key:"USE_POOl",get:function(){return pa},set:function(t){pa=!!t}},{key:"Pool",get:function(){return da}}]),t}(),da=new ot(pt),pa=!0;function ya(t){return(ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function va(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ba(t){return(ba=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ma(t,e){return(ma=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ga(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}da.Retrieve=function(t,e){this.PreRetrieve();var n=this.objects.pop();return n.Renew(t,e),n},da.Flood(function(){},1e3);var wa=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e){return!e||"object"!==ya(e)&&"function"!=typeof e?ga(t):e}(this,ba(e).call(this,t,n))).particles=[],i.deletionTimer=new ui(60),i.deletionTimer.onFinish.Add(i.HandleParticleDeletion,ga(ga(i))),i.deletionTimer.Start(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ma(t,e)}(e,Yo),function(t,e,n){e&&va(t.prototype,e),n&&va(t,n)}(e,[{key:"Process",value:function(){this.HandleParticles(),this.deletionTimer.Process()}},{key:"HandleParticles",value:function(){for(var t=this.particles,e=0;e<t.length;++e)t[e].Process()}},{key:"HandleParticleDeletion",value:function(){for(var t=this.particles,e=t[n],n=0;n<t.length;e=t[++n])e&&e.Destroy(!0)&&n--;this.deletionTimer.Start()}},{key:"AddParticle",value:function(t){return t.system=this,this.AddChild(t.entity),this.particles.push(t),t}},{key:"RemoveParticle",value:function(t){var e=this.particles,n=e.indexOf(t);if(-1!==n)return t.system=null,this.RemoveChild(t.entity),e.fickleSplice(n)}},{key:"Emit",value:function(t){for(var e=0;e<t.amount;++e)!0===fa.USE_POOL?this.AddParticle(fa.Pool.Retrieve(t,e)):this.AddParticle(new fa(t,e))}}]),e}(),Aa=function(t,e,n){t.setTransform(1,0,0,1,0,0),t.globalAlpha=.25,t.strokeStyle="rgba(255, 0, 255, 1)",t.fillStyle="rgba(0, 255, 0, 1)",null!=n&&(null!=n.alpha&&(t.globalAlpha=n.alpha),null!=n.strokeStyle&&(t.strokeStyle=n.strokeStyle),null!=n.fillStyle&&(t.fillStyle=n.fillStyle)),t.lineWidth=2,t.beginPath(),t.moveTo(e.tl.x,e.tl.y),t.lineTo(e.br.x,e.tl.y),t.lineTo(e.br.x,e.br.y),t.lineTo(e.tl.x,e.br.y),t.closePath(),null!=n?(null==n.noStroke&&t.stroke(),null==n.noFill&&t.fill()):(t.stroke(),t.fill())};function Sa(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ca=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=0}return function(t,e,n){e&&Sa(t.prototype,e),n&&Sa(t,n)}(t,[{key:"Add",value:function(t){this.value|=t}},{key:"Remove",value:function(t){this.value=this.value&~t}},{key:"Compare",value:function(t){return 0!=(this.value&t)}},{key:"Holds",value:function(t){return(this.value&t)===t}},{key:"Toggle",value:function(t){this.value^=t}}]),t}();function Oa(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var xa=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.NONE=0,this.next=1}return function(t,e,n){e&&Oa(t.prototype,e),n&&Oa(t,n)}(t,[{key:"Add",value:function(t){void 0===this[t=t.toUpperCase()]&&(this[t]=this.next,this.next=this.next<<1)}}]),t}(),Ta=n(7);function _a(t){throw new Error('"'+t+'" is read-only')}function Pa(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ka=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.orders=[],this.classUsed=null,this.amount=1,this.locked=!1}return function(t,e,n){e&&Pa(t.prototype,e),n&&Pa(t,n)}(t,[{key:"Many",value:function(t){return this.amount=t,this}},{key:"Bind",value:function(t,e){return e&&(this.orders.length=0),this.orders.push(t),this}},{key:"Make",value:function(t){var e=this.amount,n=Object(R.CreateIteratorArgs)(arguments,"@","i");if(!0===this.locked)throw new Error('"Make" called twice before end!');this.locked=!0,this.orders.length=0,this.classUsed=t;for(var i=0;i<e;++i)Ea(arguments,n,i),this.orders.push(new(Function.prototype.bind.apply(t,arguments)));return this}},{key:"Call",value:function(t,e,n){var i,r,o,a=this.orders,s=Object(R.IsArray)(e),u="string"==typeof t,l=a[c];_a("isArray"),s=Array.isArray(e),_a("isString"),u="string"==typeof t,!0===s&&(o=Object(R.CreateIteratorArgs)(e,"@","i"));for(var c=0;c<a.length;l=a[++c])!0===s&&(r=e.slice(),Object(R.ReplaceArgumentWithObjectValue)(l,r,"$"),Ea(r,o,c)),!1===u?Object(R.Nested)(l,n,!1,!0,t.apply(null,r)):(i=Object(R.Nested)(l,t,!0),Object(R.Nested)(l,t).apply(i,r));return this}},{key:"Cast",value:function(t,e){for(var n=this.orders,i="string"==typeof e,r=0;r<n.length;++r)!0===i&&"$"===e[0]&&(e=Object(R.Nested)(n[r],e)),Object(R.Nested)(n[r],t,!1,!0,e);return this}},{key:"Done",value:function(){return this.amount=1,this.locked=!1,this.orders[0]}},{key:"Mass",value:function(){return this.amount=1,this.locked=!1,this.orders}}]),t}(),Ea=function(t,e,n){var i=e[r];if(null!=e)for(var r=0;r<e.length;i=e[++r])if(-1!==i.iteratorIndex)if(i.mod&&i.val)switch(i.mod){case"+":t[i.iteratorIndex]=n+parseInt(i.val);break;case"*":t[i.iteratorIndex]=n*parseInt(i.val);break;case"-":t[i.iteratorIndex]=n-parseInt(i.val);break;case"/":t[i.iteratorIndex]=n/parseInt(i.val);break;default:throw new Error("Bad mod!")}else t[i.iteratorIndex]=n},Ra=n(5);function Da(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ia=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=e,this.w=n,this.h=i,this.aspectRatio=Object(D.SimplifyAspectRatio)(n,i),this.onChange=new oi,this.mode=r,this.stage=null,this.rootContainer=null,this.currentWidth=0,this.currentHeight=0,e.setAttribute("width",n),e.setAttribute("height",i),this.___bound___OnWindowRsize=this.OnWindowResize.bind(this),window.addEventListener("resize",this.___bound___OnWindowRsize)}return function(t,e,n){e&&Da(t.prototype,e),n&&Da(t,n)}(t,[{key:"OnWindowResize",value:function(){this[this.mode]()}},{key:"Trigger",value:function(){return this.OnWindowResize(),this}},{key:"Reconfigure",value:function(t,e,n){return this.w=t,this.h=e,this.mode=n,this}},{key:"BindStage",value:function(t){return this.stage=t,this}},{key:"BindRootContainer",value:function(t){return this.rootContainer=t,this}},{key:"SetCurrent",value:function(t,e){this.canvas.setAttribute("width",t),this.canvas.setAttribute("height",e),this.currentWidth=t,this.currentHeight=e,null!==this.stage&&(this.stage.w=t,this.stage.h=e,this.stage.mouse&&this.stage.mouse.scale.Set(t/this.w,e/this.h),this.stage.touch&&this.stage.touch.scale.Set(t/this.w,e/this.h),!0===this.stage.usingWebGL&&this.stage.GLConfig()),null!==this.rootContainer&&this.rootContainer.scale.Set(t/this.w,e/this.h)}},{key:"FillScreen",value:function(){this.SetCurrent(window.innerWidth,window.innerHeight)}},{key:"KeepAspectRatio",value:function(){var t=window.innerWidth,e=t/this.aspectRatio[0]*this.aspectRatio[1];this.SetCurrent(t,e)}},{key:"KeepAspectRatioMIN",value:function(){var t,e=window.innerWidth;e<=this.w&&(e=this.w),t=e/this.aspectRatio[0]*this.aspectRatio[1],this.SetCurrent(e,t)}},{key:"KeepAspectRatioMAX",value:function(){var t,e=window.innerWidth;e>=this.w&&(e=this.w),t=e/this.aspectRatio[0]*this.aspectRatio[1],this.SetCurrent(e,t)}},{key:"KeepAspectRatioFIT",value:function(){var t=window.innerWidth,e=t/this.aspectRatio[0]*this.aspectRatio[1];e>=window.innerHeight&&(t=(e=window.innerHeight)/this.aspectRatio[1]*this.aspectRatio[0]),this.SetCurrent(t,e)}},{key:"Destroy",value:function(){window.removeEventListener("resize",this.___bound___OnWindowRsize)}}],[{key:"FILL_SCREEN",get:function(){return ja}},{key:"KEEP_ASPECT_RATIO",get:function(){return La}},{key:"KEEP_ASPECT_RATIO_MIN",get:function(){return Na}},{key:"KEEP_ASPECT_RATIO_MAX",get:function(){return Ga}},{key:"KEEP_ASPECT_RATIO_FIT",get:function(){return Ba}}]),t}(),ja="FillScreen",La="KeepAspectRatio",Na="KeepAspectRatioMIN",Ga="KeepAspectRatioMAX",Ba="KeepAspectRatioFIT";function Ua(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Fa=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nodes={},this.objects=[],this.convergence=[],this.objectCap=0,this.levelCap=0,this.level=0,this.aabb=null,this.hasSplit=!1,this.Set(e,n,i,r)}return function(t,e,n){e&&Ua(t.prototype,e),n&&Ua(t,n)}(t,[{key:"Set",value:function(t,e,n,i){this.aabb=t,this.level=e,this.objectCap=n,this.levelCap=i}},{key:"FromPool",value:function(e,n,i,r){return!0===Wa?Ha.Retrieve(e,n,i,r):new t(e,n,i,r)}},{key:"Store",value:function(){Ha.Store(this)}},{key:"Add",value:function(t){var e=0,n="",i=this.objects,r=this.nodes;if(!0!==this.hasSplit||null===(n=this.Marking(t))){if(i.push(t),this.level<this.levelCap&&i.length>this.objectCap)for(!1===this.hasSplit&&this.Split();e<i.length;)null!==(n=this.Marking(i[e]))?r[n].Add(i.fickleSplice(e)):++e}else r[n].Add(t)}},{key:"Converge",value:function(t){var e="",n=this.nodes,i=this.convergence;return i.length=0,i.push.apply(i,this.objects),!0===this.hasSplit&&(null!==(e=this.Marking(t))?i.push.apply(i,n[e].Converge(t)):(i.push.apply(i,n[Va].Converge(t)),i.push.apply(i,n[Ma].Converge(t)),i.push.apply(i,n[Xa].Converge(t)),i.push.apply(i,n[Ya].Converge(t)))),i}},{key:"Split",value:function(){var t=this.level+1,e=this.objectCap,n=this.levelCap,i=this.nodes,r=this.aabb;i[Va]=this.FromPool(r.GetQuadrant(Va),t,e,n),i[Ma]=this.FromPool(r.GetQuadrant(Ma),t,e,n),i[Xa]=this.FromPool(r.GetQuadrant(Xa),t,e,n),i[Ya]=this.FromPool(r.GetQuadrant(Ya),t,e,n),this.hasSplit=!0}},{key:"Dump",value:function(){var t=this.nodes;this.objects.length=0,!0===this.hasSplit&&(t[Va].Dump(),t[Ma].Dump(),t[Xa].Dump(),t[Ya].Dump(),!0===Wa&&(t[Va].Store(),t[Ma].Store(),t[Xa].Store(),t[Ya].Store())),this.nodes={},this.hasSplit=!1}},{key:"Marking",value:function(t){var e=this.nodes;return!0===e[Va].aabb.ContainsAABB2D(t)?Va:!0===e[Ma].aabb.ContainsAABB2D(t)?Ma:!0===e[Xa].aabb.ContainsAABB2D(t)?Xa:!0===e[Ya].aabb.ContainsAABB2D(t)?Ya:null}},{key:"ConcatNodes",value:function(t){var e=this.nodes;return void 0===t&&(t=[]),t.push(this),!1===this.hasSplit?t:(e[Va].ConcatNodes(t),e[Ma].ConcatNodes(t),e[Xa].ConcatNodes(t),e[Ya].ConcatNodes(t),t)}}],[{key:"pool",get:function(){return Ha}},{key:"USE_POOL",get:function(){return Wa},set:function(t){Wa=t}}]),t}(),Va="TL",Ma="TR",Xa="BL",Ya="BR",Ha=new ot(Fa),Wa=!0;function qa(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Ha.Retrieve=function(t,e,n,i){this.PreRetrieve();var r=this.objects.pop();return r.Set(t,e,n,i),r},Ha.Flood(function(t){t.Set(null,0,0,0)},500);var za=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.element.setAttribute("tabindex","1"),this.element.focus(),this.___bound___OnKeyDown=this.OnKeyDown.bind(this),this.___bound___OnKeyUp=this.OnKeyUp.bind(this),this.element.addEventListener("keydown",this.___bound___OnKeyDown),this.element.addEventListener("keyup",this.___bound___OnKeyUp),this.onDown=new oi,this.onUp=new oi}return function(t,e,n){e&&qa(t.prototype,e),n&&qa(t,n)}(t,[{key:"OnKeyDown",value:function(t){t.preventDefault(),t.stopPropagation(),this.onDown.Dispatch(this.element,t)}},{key:"OnKeyUp",value:function(t){t.preventDefault(),t.stopPropagation(),this.onUp.Dispatch(this.element,t)}},{key:"Destroy",value:function(){this.element.removeEventListener("keydown",this.___bound___OnKeyDown),this.element.removeEventListener("keyup",this.___bound___OnKeyUp)}}]),t}();function Ka(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Qa=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.position=new pt,this.scale=new pt(1,1),this.offset=new pt(n,i),this.eventData={position:this.position,native:null},this.offsets=[],this.___bound___OnMove=this.OnMove.bind(this),this.___bound___OnDown=this.OnDown.bind(this),this.___bound___OnUp=this.OnUp.bind(this),this.___bound___OnLeave=this.OnLeave.bind(this),this.___bound___OnWheel=this.OnWheel.bind(this),this.element.addEventListener("mousemove",this.___bound___OnMove),this.element.addEventListener("mousedown",this.___bound___OnDown),this.element.addEventListener("mouseup",this.___bound___OnUp),this.element.addEventListener("mouseleave",this.___bound___OnLeave),this.element.addEventListener("wheel",this.___bound___OnWheel,{passive:!0}),this.onMove=new oi,this.onDown=new oi,this.onUp=new oi,this.onLeave=new oi,this.onWheel=new oi}return function(t,e,n){e&&Ka(t.prototype,e),n&&Ka(t,n)}(t,[{key:"OnMove",value:function(t){return this.CalculatePosition(t.pageX,t.pageY),this.eventData.native=t,this.onMove.Dispatch(this.element,this.eventData),!1}},{key:"OnDown",value:function(t){t.stopPropagation(),t.preventDefault(),this.CalculatePosition(t.pageX,t.pageY),this.eventData.native=t,this.onDown.Dispatch(this.element,this.eventData)}},{key:"OnUp",value:function(t){t.stopPropagation(),t.preventDefault(),this.CalculatePosition(t.pageX,t.pageY),this.eventData.native=t,this.onUp.Dispatch(this.element,this.eventData)}},{key:"OnLeave",value:function(t){t.stopPropagation(),this.CalculatePosition(t.pageX,t.pageY),this.eventData.native=t,this.onLeave.Dispatch(this.element,this.eventData)}},{key:"OnWheel",value:function(t){t.stopPropagation(),this.CalculatePosition(t.pageX,t.pageY),this.eventData.native=t,this.onWheel.Dispatch(this.element,this.eventData)}},{key:"CalculatePosition",value:function(t,e){var n=this.offsets,i=this.position;i.Set(t,e).Subtract(this.element.offsetLeft,this.element.offsetTop).SubtractV(this.offset).DivideV(this.scale);for(var r=0;r<n.length;++r)i.SubtractV(n[r])}},{key:"AddOffset",value:function(t){return this.offsets.push(t),this}},{key:"Destroy",value:function(){this.element.removeEventListener("mousemove",this.___bound___OnMove),this.element.removeEventListener("mousedown",this.___bound___OnDown),this.element.removeEventListener("mouseup",this.___bound___OnUp),this.element.removeEventListener("mouseleave",this.___bound___OnLeave),this.element.removeEventListener("wheel",this.___bound___OnWheel)}}],[{key:"x",get:function(){return this.position.x}},{key:"y",get:function(){return this.position.y}}]),t}();function Ja(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Za=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.position=new pt,this.scale=new pt(1,1),this.offset=new pt(n,i),this.eventData={position:this.position,native:null},this.___bound___OnMove=this.OnMove.bind(this),this.___bound___OnStart=this.OnStart.bind(this),this.___bound___OnEnd=this.OnEnd.bind(this),this.___bound___OnCancel=this.OnCancel.bind(this),this.element.addEventListener("touchmove",this.___bound___OnMove),this.element.addEventListener("touchstart",this.___bound___OnStart,{passive:!0}),this.element.addEventListener("touchend",this.___bound___OnEnd),this.element.addEventListener("touchcancel",this.___bound___OnCancel),this.onMove=new oi,this.onStart=new oi,this.onEnd=new oi,this.onCancel=new oi}return function(t,e,n){e&&Ja(t.prototype,e),n&&Ja(t,n)}(t,[{key:"OnMove",value:function(t){return t.preventDefault(),t.stopPropagation(),this.CalculatePosition(t.touches.item(0).pageX,t.touches.item(0).pageY),this.eventData.native=t,this.onMove.Dispatch(this.element,this.eventData),!1}},{key:"OnStart",value:function(t){t.stopPropagation(),this.CalculatePosition(t.touches.item(0).pageX,t.touches.item(0).pageY),this.eventData.native=t,this.onStart.Dispatch(this.element,this.eventData)}},{key:"OnEnd",value:function(t){t.stopPropagation(),this.eventData.native=t,this.onEnd.Dispatch(this.element,this.eventData)}},{key:"OnCancel",value:function(t){t.stopPropagation(),this.eventData.native=t,this.onCancel.Dispatch(this.element,this.eventData)}},{key:"CalculatePosition",value:function(t,e){var n=this.position;n.Set(t,e),n.Subtract(this.element.offsetLeft,this.element.offsetTop),n.SubtractV(this.offset),n.DivideV(this.scale)}},{key:"Destroy",value:function(){this.element.removeEventListener("touchmove",this.___bound___OnMove),this.element.removeEventListener("touchstart",this.___bound___OnStart),this.element.removeEventListener("touchend",this.___bound___OnEnd),this.element.removeEventListener("touchcancel",this.___bound___OnCancel)}}],[{key:"x",get:function(){return this.position.x}},{key:"y",get:function(){return this.position.y}}]),t}();function $a(t){return($a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ts(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function es(t){return(es=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ns(t,e){return(ns=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function is(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var rs=function(t){function e(t){var n;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=function(t,e){return!e||"object"!==$a(e)&&"function"!=typeof e?is(t):e}(this,es(e).call(this,t.x,t.y)),"string"==typeof t.canvas&&(t.canvas=document.getElementById(t.canvas)),n.canvas=t.canvas,n.w=t.canvas.width,n.h=t.canvas.height,n.id=null,n.backgroundColor="rgba(10,20,30,1)",n.clear=!0,n.fill=!0,n.usingWebGL=!1,n.positionReconfiguration=new pt(t.x,t.y),n.canvasManager=null,n.mouse=null,n.touch=null,n.ticker=null,"WebGL"===t.mode){if(n.gl=t.canvas.getContext("webgl",{antialias:t.antialias,preserveDrawingBuffer:!0}),null==n.gl&&(n.gl=t.canvas.getContext("experimental-webgl")),null==n.gl)throw new Error("WebGL is not supported!");n.gl.clearColor(.0392156862745098,.0784313725490196,.11764705882352941,1),n.usingWebGL=!0,!0!==t.noTicker&&(n.ticker=new ci(n.GLProcess.bind(is(is(n))),60,t.halt)),n.GLConfig(n.gl)}else n.rc=t.canvas.getContext("2d"),!0!==t.noTicker&&(n.ticker=new ci(n.Process.bind(is(is(n))),60,t.halt));return null!=t.backgroundColor&&(n.backgroundColor=t.backgroundColor),!1===t.clear&&(n.clear=!1),!1===t.fill&&(n.fill=!1),null!=t.id&&(n.id=t.id),n.onProcess=new oi,!0!==t.noMouse&&(n.mouse=new Qa(t.canvas,t.x,t.y)),!0!==t.noKeyboard&&(n.keyboard=new za(t.canvas)),!0!==t.noTouch&&(n.touch=new Za(t.canvas,t.x,t.y)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ns(t,e)}(e,Yo),function(t,e,n){e&&ts(t.prototype,e),n&&ts(t,n)}(e,[{key:"PreDraw",value:function(t){t.setTransform(1,0,0,1,0,0),t.globalAlpha=1,t.globalCompositeOperation=_e,!0===this.fill?(t.fillStyle=this.backgroundColor,t.fillRect(0,0,this.w,this.h)):!0===this.clear&&t.clearRect(0,0,this.w,this.h)}},{key:"GLConfig",value:function(t){null==t&&(t=this.gl),this.position.SetSame(0),this.scale.Set(2/this.w,-2/this.h),this.position.Add(-1,1),this.position.Add(this.positionReconfiguration.x*this.scale.x,this.positionReconfiguration.y*this.scale.y),this.UpdateTransform(),t.viewport(0,0,this.w,this.h),t.enable(t.BLEND),t.disable(t.DEPTH_TEST),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)}},{key:"GLPreDraw",value:function(t){!0===this.clear&&t.clear(t.COLOR_BUFFER_BIT)}},{key:"GLPostDraw",value:function(t){t.flush()}},{key:"Process",value:function(t){this.Draw(this.rc),this.onProcess.Dispatch(this,t)}},{key:"GLProcess",value:function(t){this.GLDraw(this.gl),this.GLPostDraw(this.gl),this.onProcess.Dispatch(this,t)}},{key:"MixedProcess",value:function(t){!0===this.usingWebGL?(this.GLDraw(this.gl),this.GLPostDraw(this.gl)):this.Draw(this.rc),this.onProcess.Dispatch(this,t)}},{key:"Destroy",value:function(){this.Dump(),this.keyboard.Destroy(),this.mouse.Destroy(),this.touch.Destroy(),null!=this.ticker&&this.ticker.Stop()}}]),e}();function os(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var as=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.stages=[],this.currentStage=null,this.onlyCurrent=!1,this.options=null,this.ticker=new ci(this.Process.bind(this),60,e.halt),this.SetOptions(e)}return function(t,e,n){e&&os(t.prototype,e),n&&os(t,n)}(t,[{key:"SetOptions",value:function(t){null!=t&&(this.options=t)}},{key:"CreateStage2D",value:function(t){var e,n=document.createElement("canvas");"string"==typeof t&&(e=t,t=null),null==t&&(t=this.options),null==t&&(t={}),null!==e&&(t.id=e),null!=t.width&&(n.width=t.width),null!=t.height&&(n.height=t.height),null!=t.className&&(n.className=t.className),null==t.rootNode&&(t.rootNode=document.body),t.rootNode.appendChild(n),t.canvas=n,t.noTicker=!0,t.halt=!0;var i=new rs(t);return t.id=null,t.canvas=null,this.stages.push(i),i}},{key:"GetStages",value:function(){for(var t=this.stages,e=[],n=0;n<t.length;++n)for(var i=0;i<arguments.length;++i)t[n].id===arguments[i]&&e.push(t[n]);return e}},{key:"Process",value:function(t){for(var e=this.stages,n=0;n<e.length;++n)e[n].MixedProcess(t)}},{key:"Destroy",value:function(){for(var t=this.stages,e=0;e<t.length;++e)t[e].Destroy();this.ticker.Stop()}}]),t}();function ss(t){return(ss="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function us(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ls(t,e){return!e||"object"!==ss(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cs(t){return(cs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hs(t,e){return(hs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fs=function(t){function e(t,n,i,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=ls(this,cs(e).call(this,t,n,null==i?ds:i,r))).pattern=null,o.patternOffset=new pt(0,0),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hs(t,e)}(e,ua),function(t,e,n){e&&us(t.prototype,e),n&&us(t,n)}(e,[{key:"Draw",value:function(t){this.PreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyGlobal(t),!0===this.display&&null!==this.pattern&&(t.globalAlpha=this.tint.channel[3],t.globalCompositeOperation=this.gco,t.fillStyle=this.pattern,t.beginPath(),t.rect(0,0,this.w,this.h),t.closePath(),t.translate(this.patternOffset.x,this.patternOffset.y),t.fill()),this.children.length>0&&this.DrawChildren(t))}},{key:"GeneratePattern",value:function(t,e,n){null==this.programController?(this.pattern=t.createPattern(this.texture.image,null),this.w=e,this.h=n,this.scale.SetSame(1)):(this.width=e,this.height=n,this.textureTransformation.SetTransform(0,0,this.scale.x,this.scale.y))}},{key:"OffsetPattern",value:function(t,e){this.patternOffset.Add(t,e),this.textureTransformation.Translate(-t/this.w,-e/this.h)}},{key:"SetPatternOffset",value:function(t,e){this.patternOffset.Set(t,e),this.textureTransformation.TranslateTo(-t/this.w,-e/this.h)}},{key:"GetPatternOffset",value:function(){return this.patternOffset}}],[{key:"BUILD_DEFAULT_TEXTURE",value:function(t){if(!0===ps)throw new Error("Function can only be called once!");ds=new Bi(F(U(function(){var t=new ei([0,0,64,0,64,64,0,64,0,0,32,32,64,0,32,32,64,64,32,32,0,64]);return t.ComputeBounds(),t.style.fill.color="#234d20",t.style.stroke.lineWidth=3,new ea(0,0,t)}),64,64,t),"__DEFAULT_TILESPRITE_TEXTURE__",64,64,64,64),ps=!0}},{key:"DEFAULT_TEXTURE",get:function(){return ds}}]),e}(),ds=null,ps=!1;function ys(t){return(ys="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vs(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function bs(t,e){return!e||"object"!==ys(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ms(t){return(ms=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gs(t,e){return(gs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ws=function(t){function e(t,n,i){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=bs(this,ms(e).call(this,t,n))).id=parseInt(i.id),r.cx=parseInt(i.x),r.cy=parseInt(i.y),r.w=parseInt(i.width),r.h=parseInt(i.height),r.xoffset=parseInt(i.xoffset),r.yoffset=parseInt(i.yoffset),r.xadvance=parseInt(i.xadvance),r.yadvance=0,r.kernings=[],r.translation=new ko,r.transformation=new ko,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gs(t,e)}(e,No),function(t,e,n){e&&vs(t.prototype,e),n&&vs(t,n)}(e,[{key:"Draw",value:function(t,e){t.drawImage(e,this.cx,this.cy,this.width,this.height,this.position.x,this.position.y,this.width,this.height)}},{key:"GLDrawAuto",value:function(t,e,n){this.UpdateMatrices(),t.Execute(this.transform.globalTransform.AsArray(!0),this.translation.AsArray(!0),this.transformation.AsArray(!0),e,n)}},{key:"GLDraw",value:function(t,e,n){t.Execute(this.transform.globalTransform.AsArray(!0),this.translation.AsArray(!0),this.transformation.AsArray(!0),e,n)}},{key:"ApplyKernings",value:function(t){for(var e,n=0;n<t.length;++n)e=t[n].attributes,parseInt(e.first)===this.id&&this.kernings.push(parseInt(e.first),parseInt(e.second),parseInt(e.amount))}},{key:"Crunch",value:function(t){if(this.position.SetSame(0),null!=t&&(this.x=t.x+t.xadvance,this.y=this.yadvance=t.yadvance,t.kernings&&t.kernings.length>0&&this.kernings.length>0))for(var e=this.kernings,n=0;n<e.length;n+=3)if(e[n+1]===t.id){this.x+=e[n+2];break}this.position.Add(this.xoffset,this.yoffset)}},{key:"UpdateMatrices",value:function(){if(null!=this.parent){var t=this.parent.texture,e=this.width/t.fw,n=this.height/t.fh;this.UpdateTransform(),this.translation.SetTransform(0,0,e,n),this.transformation.SetTransform(e*this.cx/this.width,n*this.cy/this.height,e,n)}}}]),e}();function As(t){return(As="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ss(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Cs(t,e){return!e||"object"!==As(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Os(t){return(Os=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xs(t,e){return(xs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ts=function(t){function e(t,n,i,r,o,a){var s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(s=Cs(this,Os(e).call(this,t,n,i,a))).fontData=r,s.lineHeight=r.font.common.attributes.lineHeight,s.chars=[],s.maxWidth=1024,s.text="",s.autoUpdateChars=!0,null!=o&&(s.text=o),s.ComputeText(),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xs(t,e)}(e,ua),function(t,e,n){e&&Ss(t.prototype,e),n&&Ss(t,n)}(e,[{key:"Draw",value:function(t){this.PreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyGlobal(t),!0===this.display&&(t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,this.DrawText(t)),this.children.length>0&&this.DrawChildren(t))}},{key:"GLDraw",value:function(t){this.GLPreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),!0===this.display&&null!==this.programController&&this.GLDrawText(t),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren(t):this.GLDrawChildren(t)))}},{key:"DrawText",value:function(t){for(var e=this.chars,n=this.texture.image,i=0;i<e.length;++i)e[i].Draw(t,n)}},{key:"GLDrawText",value:function(){var t=this.chars;if(!0===this.autoUpdateChars)for(var e=0;e<t.length;++e)t[e].GLDrawAuto(this.programController,this.tint.channel,this.texture.uniformId);else for(e=0;e<t.length;++e)t[e].GLDraw(this.programController,this.tint.channel,this.texture.uniformId)}},{key:"ComputeText",value:function(){var t,e,n,i=0,r=0,o=!1,a=0,s=0,u=0,l=0,c=this.chars,h=this.text;this.UpdateTransform(),c.length=0,this.fontData.font.kernings&&(t=this.fontData.font.kernings.kerning);for(var f=0;f<h.length;++f){var d=h.charCodeAt(f);n=c[f-1-r],10!==d?(e=new ws(0,0,this.GetCharDataById(d)),null!=t&&e.ApplyKernings(t),e.Crunch(n),u=e.position.x+e.width,l=e.position.y+e.height,(u>this.maxWidth||!0===o)&&(e.position.SetSame(0),e.yadvance=this.lineHeight*++i,e.position.Add(e.xoffset,e.yoffset+e.yadvance),o=!1),u>a&&(a=u),l>s&&(s=l),e.parent=this,e.UpdateMatrices(),c.push(e)):(r++,o=!0)}this.w=a,this.h=s}},{key:"UpdateChars",value:function(){for(var t=this.chars,e=0;e<t.length;++e)t[e].UpdateMatrices()}},{key:"GetCharDataById",value:function(t){for(var e=this.fontData.font.chars.char,n=0;n<e.length;++n)if(parseInt(e[n].attributes.id)===t)return e[n].attributes}},{key:"UpdateInBuffer",value:function(){throw new Error(_s)}},{key:"GetBufferData",value:function(){throw new Error(_s)}}]),e}(),_s="Cannot access buffer data directly on BitmapText!";function Ps(t){return(Ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ks(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Es(t,e){return!e||"object"!==Ps(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rs(t){return(Rs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ds(t,e){return(Ds=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Is=function(t){function e(t,n,i,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Es(this,Rs(e).call(this,t,n))).text=i,o.style=En(r),o.maxWidth=void 0,o.alpha=1,o.gco=_e,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ds(t,e)}(e,Yo),function(t,e,n){e&&ks(t.prototype,e),n&&ks(t,n)}(e,[{key:"Draw",value:function(t){if(this.PreDraw(t),!0===this.render){if(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyGlobal(t),!0===this.display){var e=this.style;!0===e.shadow.applied&&e.shadow.Apply(t),!0===e.text.applied&&(e.text.Apply(t),t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,t.fillText(this.text,0,0,this.maxWidth),t.strokeText(this.text,0,0,this.maxWidth))}this.children.length>0&&this.DrawChildren(t)}}},{key:"IntersectsPoint",value:function(){return!1}}]),e}();function js(t){return(js="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ls(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ns(t,e){return!e||"object"!==js(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gs(t){return(Gs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bs(t,e){return(Bs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Us=Math.cos,Fs=Math.sin,Vs=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Ns(this,Gs(e).call(this,0,0))).focus=t,i.target=n,i.velocity=new pt(0,0),i.force=new pt(1,1),i.stopRadiusSq=1e3,i.EPSILON=2e-4,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bs(t,e)}(e,Yo),function(t,e,n){e&&Ls(t.prototype,e),n&&Ls(t,n)}(e,[{key:"Process",value:function(){var t=this.target;if(null!=t){Xs.SetV(t.position),Xs.Invert(),Xs.AddV(this.focus),Ms.SetV(this.position).SubtractV(Xs);var e=Ms.GetMagnitudeSquared();if(e<this.stopRadiusSq)return;e*=this.EPSILON;var n=Ms.GetAngle();this.velocity.Set(e*Us(n),e*Fs(n)).MultiplyV(this.force),this.position.SubtractV(this.velocity)}}},{key:"SetTarget",value:function(t){return this.target=t,this}}]),e}(),Ms=new pt(0,0),Xs=new pt(0,0);n.d(e,"Math",function(){return D}),n.d(e,"Assert",function(){return Ii.a}),n.d(e,"Pool",function(){return ot}),n.d(e,"FlagList",function(){return Ca}),n.d(e,"FlagEnum",function(){return xa}),n.d(e,"Cache",function(){return Li}),n.d(e,"Glob",function(){return Ta.a}),n.d(e,"Maker",function(){return ka}),n.d(e,"Utility",function(){return R}),n.d(e,"Cipher",function(){return i}),n.d(e,"BrowserUtility",function(){return r}),n.d(e,"Style",function(){return v}),n.d(e,"Time",function(){return m}),n.d(e,"CharacterSets",function(){return Ra.a}),n.d(e,"CanvasManager",function(){return Ia}),n.d(e,"Vector2D",function(){return pt}),n.d(e,"Matrix2D",function(){return ko}),n.d(e,"Transform2D",function(){return jo}),n.d(e,"QuadtreeNode",function(){return Fa}),n.d(e,"Ease",function(){return o}),n.d(e,"Collision",function(){return c}),n.d(e,"Geom",function(){return f}),n.d(e,"Path",function(){return b}),n.d(e,"CoreEntity2D",function(){return No}),n.d(e,"Container2D",function(){return Yo}),n.d(e,"Stage2D",function(){return rs}),n.d(e,"Stadium",function(){return as}),n.d(e,"Graphic2D",function(){return ea}),n.d(e,"Sprite",function(){return ua}),n.d(e,"Tilesprite",function(){return fs}),n.d(e,"Char",function(){return ws}),n.d(e,"BitmapText",function(){return Ts}),n.d(e,"Text",function(){return Is}),n.d(e,"Camera2D",function(){return Vs}),n.d(e,"Shader",function(){return g}),n.d(e,"Load",function(){return w}),n.d(e,"Controller",function(){return S}),n.d(e,"CP",function(){return C}),n.d(e,"Motion",function(){return O}),n.d(e,"Particle",function(){return T}),n.d(e,"Texture",function(){return _}),n.d(e,"Animator",function(){return P}),n.d(e,"Debug",function(){return E}),n(18)},function(t,e,n){"use strict";n.r(e),n.d(e,"RandomInteger",function(){return u}),n.d(e,"RandomFloat",function(){return l}),n.d(e,"IsInteger",function(){return c}),n.d(e,"IsFloat",function(){return h}),n.d(e,"IsArray",function(){return f}),n.d(e,"Sign",function(){return d}),n.d(e,"Clamp",function(){return p}),n.d(e,"InverseClamp",function(){return y}),n.d(e,"FlipACoin",function(){return v}),n.d(e,"GenerateSequence",function(){return b}),n.d(e,"RandomInArray",function(){return m}),n.d(e,"MinMaxOrValue",function(){return g}),n.d(e,"UUID",function(){return w}),n.d(e,"ApplyProperties",function(){return A}),n.d(e,"Nested",function(){return S}),n.d(e,"ArrayGetRandom",function(){return C}),n.d(e,"ArrayShuffle",function(){return O}),n.d(e,"Base16ToBase10",function(){return x}),n.d(e,"Base2ToBase10",function(){return T}),n.d(e,"IsObjectEmpty",function(){return _}),n.d(e,"DeepClone",function(){return P}),n.d(e,"CreateIteratorArgs",function(){return k}),n.d(e,"ReplaceArgumentWithObjectValue",function(){return E}),n.d(e,"PRINT_VERSION",function(){return R});var i=n(3),r=n(5);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a=n(19).version,s=Math.random;function u(t,e){return s()*(e-t+1)+t|0}function l(t,e){return s()*(e-t)+t}function c(t){return Number(t)===t&&t%1==0}function h(t){return Number(t)===t&&t%1!=0}function f(t){return"[object Array]"===Object.prototype.toString.call(t)}function d(t,e){return 0===t?!0===e?1:0:t>0?1:-1}function p(t,e,n){return t<e?e:t>n?n:t}function y(t,e,n){return t<e?n:t>n?e:t}function v(t,e){return 1===u(1,2)?t:e}function b(t,e,n,r){for(var o=[],a=0;a<e;a+=n)o.push(Object(i.PrecisionRound)(a,r));return o}function m(t){return t[u(0,t.length-1)]}function g(t,e){return null!=t.min&&null!=t.max?l(t.min,t.max):null!=t.values&&t.values.length>0?m(t.values):null!=e&&t[e].length>0?m(t[e]):t}function w(t,e,n,i){var o,a,s="",l=t/e,h=r.a[n];t=null==t?32:t,e=null==e?4:e,n=null==n?0:n,i=null==i?"-":i;for(var f=0;f<t;++f)0!==(a=f/l)&&c(a)?s+=i:(o=u(1,h.length-1),s+=h.charAt(o));return s}function A(t,e){var n;if(void 0!==e)for(n in e)void 0!==t[n]&&(t[n]=e[n])}function S(t,e,n,i,r,o){var a;if("string"==typeof e&&(o=null==o?".":o,e=e.split(o)),e.length>1){if(void 0!==t[a=e.shift()])return S(t[a],e,n,i,r,o)}else{if(void 0!==t[a=e.shift()])return!0===i?void(t[a]=r):!0===n?t:t[a];if(!0===i)return void(t[a]=r)}}function C(t,e){for(var n=[],i={},r=t.length,o=0;o<e;++o){var a=s()*r|0;void 0===i[a]?(i[a]=null,n.push(t[a])):o--}return n}function O(t){for(var e,n,i=t.length-1;i-- >=0;)n=s()*i|0,e=t[i],t[i]=t[n],t[n]=e}function x(t){return parseInt(t,16)}function T(t){return parseInt(t,2)}function _(t){var e;for(e in t)if(t.hasOwnProperty(e))return!1;return JSON.stringify(t)===JSON.stringify({})}function P(t){var e,n=null,i=!1;if("function"==typeof t)throw new TypeError("Object was of type: function. Not acceptable.");if(f(t))n=[],i=!0;else{if("object"!==o(t))return t;n={}}if(i)for(var r=0;r<t.length;++r)n[r]=P(t[r]);else for(e in t)t.hasOwnProperty(e)&&(n[e]=P(t[e]));return n}function k(t,e,n){for(var i,r,o,a,s=[],u=0;u<t.length;++u)"string"==typeof(i=t[u])&&0===i.indexOf(e)&&i.indexOf(n)===e.length&&(-1!==(a=i.indexOf("|"))?(r=i.slice(i.indexOf("(")+1,a),o=i.slice(a+1,i.indexOf(")")),s.push({mod:r,val:o,iteratorIndex:u})):s.push({iteratorIndex:u}));return s}function E(t,e,n){for(var i,r=0;r<e.length;++r)"string"==typeof(i=e[r])&&0===i.indexOf(n)&&(e[r]=S(t,i.slice(n.length)))}function R(t){t?console.log("nenkraft2 server version "+a):console.log("%cnenkraft2 %cversion %c"+a,"color:#f0f7da;background-color:#234d20;font-family:Arial;font-size:18px;font-weight:900;padding:5px;","color:#f0f7da;background-color:#36802d;font-family:Arial;font-size:18px;font-weight:900;padding:5px;","color:#f0f7da;background-color:#77ab59;font-family:Arial;font-size:18px;font-weight:900;padding:5px;")}},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(t,e){var n=document.getElementById("buttons"),i=document.createElement("input"),r=document.getElementById("back-button");i.setAttribute("value",t),i.setAttribute("type","button"),i.addEventListener("click",function(){n.style.display="none",r.onclick=a,e(o)}),n.appendChild(i);var o={canvas:null,stage:null,stadium:null};function a(){o.canvas&&o.canvas.parentNode.removeChild(o.canvas),o.stage&&o.stage.Destroy(),o.stadium&&(o.stadium.stages.forEach(function(t){t.canvas.parentNode.removeChild(t.canvas)}),o.stadium.Destroy()),o.canvasManager&&o.canvasManager.Destroy(),r.onclick=null,n.style.display=null}}},function(t,e,n){"use strict";n.r(e),n.d(e,"PII",function(){return l}),n.d(e,"PI5",function(){return c}),n.d(e,"DEGREES_TO_RADIANS",function(){return h}),n.d(e,"RADIANS_TO_DEGRESS",function(){return f}),n.d(e,"RADIAN",function(){return d}),n.d(e,"DegreesToRadians",function(){return p}),n.d(e,"RadiansToDegress",function(){return y}),n.d(e,"PrecisionRound",function(){return v}),n.d(e,"Spread",function(){return b}),n.d(e,"AttractRepel",function(){return m}),n.d(e,"Oscillate",function(){return g}),n.d(e,"LineLineIntersection",function(){return w}),n.d(e,"ClosestPointOnLine",function(){return A}),n.d(e,"LikeASquareGrid",function(){return S}),n.d(e,"TriRectArray",function(){return C}),n.d(e,"GreatestCommonDivisor",function(){return O}),n.d(e,"SimplifyAspectRatio",function(){return x}),n.d(e,"IntegerNotation",function(){return T});var i=Math.PI,r=Math.sin,o=Math.cos,a=Math.pow,s=Math.round,u=Math.ceil,l=2*i,c=.5*i,h=i/180,f=180/i,d=h;function p(t){return t*h}function y(t){return t*f}function v(t,e){if(null==e)return t;var n=a(10,e);return s(n*t)/n}function b(t,e,n,i){return t-n*(e-1)*.5+i*n}function m(t,e,n,i,a){var s=e.SubtractVC(t);if(s.GetMagnitudeSquared()<i*i){var u=s.GetAngle();n.Add(o(u)*a,r(u)*a)}}function g(t,e,n,i){var o=.5*(n-e);return e+o+r(p(t*i))*o}function w(t,e,n,i){var r=e.SubtractVC(t),o=i.SubtractVC(n),a=-o.x*r.y+r.x*o.y,s=t.x-n.x,u=t.y-n.y,l=(-r.y*s+r.x*u)/a,c=(o.x*u-o.y*s)/a;return l>=0&&l<=1&&c>=0&&c<=1&&(r.Set(t.x+c*r.x,t.y+c*r.y),r)}function A(t,e,n){var i=e.SubtractVC(t),r=((n.x-t.x)*i.x+(n.y-t.y)*i.y)/i.GetMagnitudeSquared();return r<0?t:r>1?e:(i.Set(t.x+r*i.x,t.y+r*i.y),i)}function S(t,e,n,i){for(var r=e/n|0,o=0;o<t.length;++o)t[o].Set(o%r*n,(o/r|0)*i)}function C(t,e,n,i,r){return null!=r?(r[0]=t,r[1]=e,r[2]=t+n,r[3]=e,r[4]=t,r[5]=e+i,r[6]=t,r[7]=e+i,r[8]=t+n,r[9]=e,r[10]=t+n,r[11]=e+i,r):[t,e,t+n,e,t,e+i,t,e+i,t+n,e,t+n,e+i]}function O(t,e){return 0===e?t:O(e,t%e)}function x(t,e,n){var i=O(t,e),r=null==n?[]:n;return r[0]=t/i,r[1]=e/i,r}function T(t,e,n){var i=t%e,r=t/e;return u(0===i?r+1:r)+n+(1+i)}},function(t,e,n){"use strict";(function(t){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e,n,a){if(void 0==a||"function"!=typeof t.Assert)switch(e){case r.IS:return void function(t,e,n){var i=!1;t!==e&&(i=!0);o(i,t,e,n)}(t,n,e);case r.IS_NOT:return void function(t,e,n){var i=!1;t===e&&(i=!0);o(i,t,e,n)}(t,n,e);case r.IS_SAME_TYPE:return void function(t,e,n){var r=!1;Array.isArray(t)||Array.isArray(e)?!Array.isArray(t)!=!Array.isArray(e)&&(r=!0):null===t||null===e?t!==e&&(r=!0):i(t)!==i(e)?r=!0:"number"!=typeof t&&"number"!=typeof e||(isNaN(t)||isNaN(e))&&t!==e&&(r=!0);o(r,t,e,n)}(t,n,e);case r.IS_NOT_SAME_TYPE:return void function(t,e,n){var r=!1;Array.isArray(t)||Array.isArray(e)?Array.isArray(t)&&Array.isArray(e)&&(r=!0):null===t||null===e?e===t&&(r=!0):i(t)===i(e)?r=!0:"number"!=typeof t&&"number"!=typeof e||(isNaN(t)||isNaN(e))&&isNaN(t)&&isNaN(e)&&(r=!0);o(r,t,e,n)}(t,n,e);case r.IS_INSTANCE_OF:return void function(t,e,n){var i=!1;t instanceof e||(i=!0);o(i,t,e.name,n)}(t,n,e);case r.IS_NOT_INSTANCE_OF:return void function(t,e,n){var i=!1;t instanceof e&&(i=!0);o(i,t,e.name,n)}(t,n,e);case r.IS_LESS_THAN:return void function(t,e,n){var i=!1;t>=e&&(i=!0);o(i,t,e,n)}(t,n,e);case r.IS_GREATER_THAN:return void function(t,e,n){var i=!1;t<=e&&(i=!0);o(i,t,e,n)}(t,n,e);case r.IS_LESS_THAN_OR_EQUAL:return void function(t,e,n){var i=!1;t>e&&(i=!0);o(i,t,e,n)}(t,n,e);case r.IS_GREATER_THAN_OR_EQUAL:return void function(t,e,n){var i=!1;t<e&&(i=!0);o(i,t,e,n)}(t,n,e);default:throw new Error("No comparison: "+e)}else t.Assert(e,n)}function o(t,e,n,i){if(t)throw function(t,e,n){switch(n){case r.IS:n=r.IS_NOT;break;case r.IS_NOT:n=r.IS;break;case r.IS_SAME_TYPE:n=r.IS_NOT_SAME_TYPE;break;case r.IS_NOT_SAME_TYPE:n=r.IS_SAME_TYPE;break;case r.IS_INSTANCE_OF:n=r.IS_NOT_INSTANCE_OF;break;case r.IS_NOT_INSTANCE_OF:n=r.IS_INSTANCE_OF;break;case r.IS_LESS_THAN:n=r.IS_GREATER_THAN_OR_EQUAL;break;case r.IS_GREATER_THAN:n=r.IS_LESS_THAN_OR_EQUAL;break;case r.IS_LESS_THAN_OR_EQUAL:n=r.IS_GREATER_THAN;break;case r.IS_GREATER_THAN_OR_EQUAL:n=r.IS_LESS_THAN;break;default:throw new Error("Unexpected error")}console.error(t,n,e)}(e,n,i),new Error("Assertion failed: "+i);r.LOG&&window&&function(t,e,n){console.log("%c<<||-?START?-||>>","background-color: black; color: #0FF; padding: 0px 25px;"),console.log("%cAssertion success: ","background-color: #333; color: #0F0; padding: 0px 25px;"),console.log(t),console.log(n),console.log(e),console.log("%c>>||-?END?-||<<","background-color: black; color: #FF0; padding: 0px 25px;")}(e,n,i)}n.d(e,"a",function(){return r}),r.IS="I",r.IS_NOT="IN",r.IS_SAME_TYPE="IST",r.IS_NOT_SAME_TYPE="INST",r.IS_INSTANCE_OF="IIO",r.IS_NOT_INSTANCE_OF="INIO",r.IS_LESS_THAN="ILT",r.IS_GREATER_THAN="IGT",r.IS_LESS_THAN_OR_EQUAL="ILTOE",r.IS_GREATER_THAN_OR_EQUAL="IGTOE",r.Assign=function(e){if(window&&!e?e=window:t&&!e&&(e=t),!e)throw new Error("No global namespace");e.IS=r.IS,e.IS_NOT=r.IS_NOT,e.IS_SAME_TYPE=r.IS_SAME_TYPE,e.IS_NOT_SAME_TYPE=r.IS_NOT_SAME_TYPE,e.IS_INSTANCE_OF=r.IS_INSTANCE_OF,e.IS_NOT_INSTANCE_OF=r.IS_NOT_INSTANCE_OF,e.IS_LESS_THAN=r.IS_LESS_THAN,e.IS_GREATER_THAN=r.IS_GREATER_THAN,e.IS_LESS_THAN_OR_EQUAL=r.IS_LESS_THAN_OR_EQUAL,e.IS_GREATER_THAN_OR_EQUAL=r.IS_GREATER_THAN_OR_EQUAL},r.LOG=!1}).call(this,n(6))},function(t,e,n){"use strict";e.a=["0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz!?#$%@&","0123456789","ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","ABCDEFGHJIKLMNOPQRSTUWVXYZ","abcdefghijklmnopqrstuwvxyz","0123456789abcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZ"]},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return a});var i=n(1);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var a=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.functions={},this.values={},this.constants={},this.components={},this.objects={},this.lists={}}return function(t,e,n){e&&o(t.prototype,e),n&&o(t,n)}(e,[{key:"Define",value:function(t,e,n){this.Mark(t,e),this.Set(t,e,n)}},{key:"Mark",value:function(t,e){if("string"!=typeof t)throw new Error("Type needs to be a string!");if("string"!=typeof e)throw new Error("Id needs to be a string!");if(null==this[t])throw new Error("Type does not exist");if((t===l||t===c)&&void 0!==this[t][e])throw new Error("Constants cannot be reassigned!");this[t][e]=null}},{key:"Get",value:function(t,n){if("string"!=typeof t)throw new Error("Type needs to be a string!");if("string"!=typeof n)throw new Error("Id needs to be a string!");if(null==this[t])throw new Error("Type does not exist");if(!1===e.AllowGetNullUndefined&&null==this[t][n])throw new Error("Null or undefined!");return this[t][n]}},{key:"Set",value:function(t,e,n){if("string"!=typeof t)throw new Error("Type needs to be a string!");if("string"!=typeof e)throw new Error("Id needs to be a string!");switch(t){case s:if("function"!=typeof n)throw new Error("Needs to be a function!");if(null!==this.functions[e])throw new Error("No mark!");this.functions[e]=n;break;case u:if(n instanceof Object)throw new Error("Objects are not allowed!");if(null!==this.values[e])throw new Error("No mark!");this.values[e]=n;break;case l:if(n instanceof Object)throw new Error("Objects are not allowed!");if(null!==this.constants[e])throw new Error("No mark!");Object.defineProperty(this.constants,e,{writable:!1,configurable:!1,value:n});break;case c:if("function"!=typeof n)throw new Error("Needs to be a function!");if(null!==this.components[e])throw new Error("No mark!");Object.defineProperty(this.components,e,{writable:!1,configurable:!1,value:n});break;case h:if("object"!==r(n))throw new Error("Needs to be an object");if(!0===Object(i.IsArray)(n))throw new Error("Arrays are not allowed!");if(null!==this.objects[e])throw new Error("No mark!");this.objects[e]=n;break;case f:if(!1===Object(i.IsArray)(n))throw new Error("Needs to be an array!");if(null!==this.lists[e])throw new Error("No mark!");this.lists[e]=n;break;default:throw new Error("Unrecognized type!")}}}],[{key:"Assign",value:function(e){if(window&&!e?e=window:t&&!e&&(e=t),!e)throw new Error("No global namespace");e.FUNC=s,e.VAL=u,e.CONST=l,e.COMP=c,e.OBJ=h,e.LIST=f}},{key:"Create",value:function(n){var i=i||null;if(null==i){if(null==t)throw new Error("Neither window nor global exists!");if(void 0!==t[n])throw new Error("global."+n+" already exists!");t[n]=new e}else{if(void 0!==i[n])throw new Error("window."+n+" already exists!");i[n]=new e}}},{key:"FUNCTION",get:function(){return s}},{key:"VALUE",get:function(){return u}},{key:"CONSTANT",get:function(){return l}},{key:"COMPONENT",get:function(){return c}},{key:"OBJECT",get:function(){return h}},{key:"LIST",get:function(){return f}},{key:"AllowGetNullUndefined",get:function(){return d},set:function(t){(function(t){throw new Error('"'+t+'" is read-only')})("PS_AllowGetNullUndefined"),d=!!t}}]),e}(),s="functions",u="values",l="constants",c="components",h="objects",f="lists",d=!1}).call(this,n(6))},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition0;\r\nattribute vec2 aTexCoord0;\r\n\r\nattribute vec2 aPosition1;\r\nattribute vec2 aTexCoord1;\r\n\r\nattribute vec2 aPosition2;\r\nattribute vec2 aTexCoord2;\r\n\r\nattribute vec2 aPosition3;\r\nattribute vec2 aTexCoord3;\r\n\r\nuniform mat3 uProjection;\r\nuniform mat3 uTranslation;\r\nuniform mat3 uTransformation;\r\n\r\nuniform float uUnitId;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  if ( uUnitId == 0.0 ) {\r\n    gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition0, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vTexCoord = ( uTransformation * vec3( aTexCoord0, 1.0 ) ).xy;\r\n  } else if ( uUnitId == 1.0 ) {\r\n    gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition1, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vTexCoord = ( uTransformation * vec3( aTexCoord1, 1.0 ) ).xy;\r\n  } else if ( uUnitId == 2.0 ) {\r\n    gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition2, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vTexCoord = ( uTransformation * vec3( aTexCoord2, 1.0 ) ).xy;\r\n  } else if ( uUnitId == 3.0 ) {\r\n    gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition3, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vTexCoord = ( uTransformation * vec3( aTexCoord3, 1.0 ) ).xy;\r\n  }\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\nuniform vec4 uTint;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  gl_FragColor = texture2D( uImage, vTexCoord ) * uTint;\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nattribute vec3 aProjection1;\r\nattribute vec3 aProjection2;\r\nattribute vec3 aProjection3;\r\n\r\nattribute vec3 aTranslation1;\r\nattribute vec3 aTranslation2;\r\nattribute vec3 aTranslation3;\r\n\r\nattribute vec3 aTransformation1;\r\nattribute vec3 aTransformation2;\r\nattribute vec3 aTransformation3;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  mat3 projection = mat3( aProjection1, aProjection2, aProjection3 );\r\n  mat3 translation = mat3( aTranslation1, aTranslation2, aTranslation3 );\r\n  mat3 transformation = mat3( aTransformation1, aTransformation2, aTransformation3 );\r\n  gl_Position = vec4( ( projection * translation * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vTexCoord = ( transformation * vec3( aTexCoord, 1.0 ) ).xy;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  gl_FragColor = texture2D( uImage, vTexCoord );\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec3 aProjection1;\r\nattribute vec3 aProjection2;\r\nattribute vec3 aProjection3;\r\nattribute vec2 aPosition;\r\nattribute vec4 aColor;\r\nattribute float aPointSize;\r\n\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  mat3 projection = mat3( aProjection1, aProjection2, aProjection3 );\r\n  gl_Position = vec4( ( projection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  gl_PointSize = aPointSize;\r\n  vColor = aColor;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  gl_FragColor = vColor;\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform lowp vec4 uFillColor;\r\nuniform lowp vec4 uOutlineColor;\r\nuniform vec2 uSize;\r\nuniform float uOutline;\r\n\r\nvarying lowp vec4 vFillColor;\r\nvarying lowp vec4 vOutlineColor;\r\nvarying vec2 vPosition;\r\nvarying float vBorderX;\r\nvarying float vNegBorderX;\r\nvarying float vBorderY;\r\nvarying float vNegBorderY;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vFillColor = uFillColor;\r\n  vOutlineColor = uOutlineColor;\r\n  vPosition = aPosition;\r\n  vBorderX = -uSize.x * 0.5 + uOutline;\r\n  vNegBorderX = uSize.x * 0.5 - uOutline;\r\n  vBorderY = -uSize.y * 0.5 + uOutline;\r\n  vNegBorderY = uSize.y * 0.5 - uOutline;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying lowp vec4 vFillColor;\r\nvarying lowp vec4 vOutlineColor;\r\nvarying vec2 vPosition;\r\nvarying float vBorderX;\r\nvarying float vNegBorderX;\r\nvarying float vBorderY;\r\nvarying float vNegBorderY;\r\n\r\nvoid main() {\r\n  if (\r\n    vPosition.x > vBorderX &&\r\n    vPosition.x < vNegBorderX && \r\n    vPosition.y > vBorderY && \r\n    vPosition.y < vNegBorderY\r\n  ) {\r\n    gl_FragColor = vFillColor;\r\n  } else {\r\n    gl_FragColor = vOutlineColor;\r\n  }\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform lowp vec4 uFillColor;\r\nuniform lowp vec4 uOutlineColor;\r\nuniform float uRadius;\r\nuniform float uOutline;\r\n\r\nvarying lowp vec4 vFillColor;\r\nvarying lowp vec4 vOutlineColor;\r\nvarying vec2 vPosition;\r\nvarying float vRadius;\r\nvarying float vOutline;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vFillColor = uFillColor;\r\n  vOutlineColor = uOutlineColor;\r\n  vPosition = aPosition;\r\n  vRadius = uRadius;\r\n  vOutline = uOutline;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying lowp vec4 vFillColor;\r\nvarying lowp vec4 vOutlineColor;\r\nvarying vec2 vPosition;\r\nvarying float vRadius;\r\nvarying float vOutline;\r\n\r\nvoid main() {\r\n  float d = dot( vPosition, vPosition );\r\n  float rs = vRadius * vRadius;\r\n  float ors = vRadius - vOutline;\r\n  ors = ors * ors;\r\n  if ( d < rs && d > ors ) {\r\n    gl_FragColor = vOutlineColor;\r\n  } else if ( d < rs ) {\r\n    gl_FragColor = vFillColor;\r\n  }\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform lowp vec4 uColor;\r\n\r\nvarying lowp vec4 vColor;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vColor = uColor;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying lowp vec4 vColor;\r\n\r\nvoid main() {\r\n  gl_FragColor = vColor;\r\n}\r\n@fragment-end@"},function(t,e,n){t.exports=n(15)},function(t,e,n){n(16);var i=n(0);console.log(i),i.Utility.PRINT_VERSION(),i.Sprite.BUILD_DEFAULT_TEXTURE(function(){i.Tilesprite.BUILD_DEFAULT_TEXTURE(function(){var t=new i.Load.XHRLoader,e=new i.Load.ImageLoader,r=new i.Load.SpritesheetLoader,o=0;function a(){if(!(o<3)){var i=[];window.testData={xhrloader:t,imgloader:e,ssloader:r};var a=n(20);a.keys().forEach(function(t){i.push(a(t))});for(var s=0,u=i.length;s<u;++s)i[s].default()}}t.Load([{id:"fontdataxml",src:"./assets/xhr/font.fnt",type:"xml"},{id:"fontdatajson",src:"./assets/xhr/font.json",type:"json"},{id:"fontNoK",src:"./assets/xhr/fontNoK.xml",type:"xml"},{id:"particleExplosion",src:"./assets/xhr/particle-explosion.json",type:"json"}]),e.Load([{id:"fontimg",src:"./assets/images/font.png"},{id:"fontNoK",src:"./assets/images/fontNoK.png"},{id:"1to8",src:"./assets/images/1to8.png"},{id:"4dots",src:"./assets/images/4dots.png"},{id:"colors",src:"./assets/images/colors.png"},{id:"glass-of-blueberryjuice",src:"./assets/images/glass-of-blueberryjuice.png"},{id:"raindrop",src:"./assets/images/raindrop.png"},{id:"smudge",src:"./assets/images/smudge.png"}],!0),r.Load([{id:"sheet-default",image:{src:"./../assets/images/invaders/invaders-sheet.png"},data:{src:"./../assets/xhr/invaders.json",type:"json"}}]),t.onComplete.Add(function(t){console.log(t.data),console.log(JSON.stringify(t.data.dataCache.items[0].data)===JSON.stringify(t.data.dataCache.items[1].data)),o++,a()}),e.onComplete.Add(function(t){console.log(t.data),o++,a()}),r.onComplete.Add(function(t){console.log(t.data),o++,a()})})})},function(t,e,n){},,function(t,e){Array.prototype.indexPop=function(t){var e=this.length-1;if(e>1&&t<=e&&t>=0){var n=this[e];return this[e]=this[t],this[t]=n,this.pop()}return this.pop()},Array.prototype.indexShift=function(t){if(this.length>1&&t<=this.length-1&&t>=0){var e=this[0];return this[0]=this[t],this[t]=e,this.shift()}return this.shift()},Array.prototype.popSplice=function(t){var e=this.length-1;if(!(e<1)){for(var n=this[t];t<e;)this[t]=this[t+1],t++;return this.pop(),n}},Array.prototype.shiftSplice=function(t){if(!(this.length<1)){for(var e=this[t];t>0;)this[t]=this[t-1],t--;return this.shift(),e}},Array.prototype.fickleSplice=function(t){return t>.5*this.length|0?this.popSplice(t):this.shiftSplice(t)}},function(t){t.exports={name:"nenkraft2",version:"0.2.0",description:"A small rendering tool",main:"./dist/nenkraft2.js",devDependencies:{"@babel/core":"^7.0.0","@babel/preset-env":"^7.0.0","babel-loader":"^8.0.2","copy-webpack-plugin":"^4.5.2","css-loader":"^1.0.0",eslint:"^5.5.0","file-loader":"^2.0.0","html-loader":"^0.5.5","html-webpack-plugin":"^3.2.0","mini-css-extract-plugin":"^0.4.2","raw-loader":"^0.5.1",rimraf:"^2.6.2",webpack:"^4.17.2","webpack-cli":"^3.1.0","webpack-dev-server":"^3.1.8"},dependencies:{},scripts:{"build-prod":"webpack --env production --mode production","build-bundle-fe":"webpack --env bundle-fe --mode production","build-bundle-be":"webpack --env bundle-be --mode production",start:"webpack-dev-server --env development --mode development","clear-bundle-fe":"rimraf bundle-fe","clear-bundle-be":"rimraf bundle-be","clear-dist":"rimraf dist",ce:"rimraf dist bundle-fe bundle-be",be:"npm run ce && npm run build-prod && npm run build-bundle-be && npm run build-bundle-fe","lint-f":"eslint src tests --fix",lint:"eslint src tests"},keywords:["2d","rendering","command","vector","game","graphic","tween","animation","collision","canvas","web","webgl","utilities"],author:"nuuf",license:"MIT"}},function(t,e,n){var i={"./solid/01.sprite.demo":21,"./solid/02.graphic2d.demo":22,"./solid/03.container2d.demo":23,"./solid/04.bitmap-text.demo":24,"./solid/05.stage2d.demo":25,"./solid/06.stadium.demo":26,"./solid/07.canvas-manager.demo":27,"./solid/08.camera2d.demo":28,"./solid/09.basic-setup.demo":29,"./solid/10.tilesprite.demo":30,"./solid/11.text.demo":31,"./solid/12.geom.demo":32,"./solid/13.collision-aabb2d.demo":33,"./solid/14.collision-circle.demo":34,"./solid/15.collision-polygon2d.demo":35,"./solid/16.collision-line2d-circle.demo":36,"./solid/17.create-texture.demo":37,"./solid/18.animation.demo":38,"./solid/19.quadtree.demo":39,"./solid/20.ray-casting.demo":40,"./solid/21.particle-system.demo":41};function r(t){var e=o(t);return n(e)}function o(t){var e=i[t];if(!(e+1)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return e}r.keys=function(){return Object.keys(i)},r.resolve=o,t.exports=r,r.id=20},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("Sprite",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new r.Sprite(i,o);s.anchor.SetSame(.5),s.Draw(a.getContext("2d"))})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("Graphic2D",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new r.Path.Circle(0,0,50);new r.Graphic2D(i,o,s).Draw(a.getContext("2d"))})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("Container2D",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new r.Sprite(i,o);s.anchor.SetSame(.5);var u=new r.Container2D(0,0);u.AddChild(s),u.Draw(a.getContext("2d"))})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("BitmapText",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute",a.style.backgroundColor="white";var s=a.getContext("2d"),u=new r.BitmapText(0,0,window.testData.imgloader.GetBasicTextureById("fontNoK"),window.testData.xhrloader.GetDataById("fontNoK"),"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.");u.scale.SetSame(.6),u.x=i-.5*u.width,u.y=o-.5*u.height,u.Draw(s)})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("Stage2D",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s={canvas:a,x:i,y:o,halt:!0},u=t.stage=new r.Stage2D(s);u.ticker.StartAF(),u.onProcess.Add(function(){console.log("tick"),u.onProcess.Dump()})})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("Stadium",function(t){var e={className:"mcnvs",width:600,height:400,mode:"2d",x:0,y:0,fill:!1},n=t.stadium=new r.Stadium(e);function i(){this.children.forEach(o)}function o(t){t.position.AddV(t.data.velocity),t.data.velocity.Rotate(t.data.torque)}n.CreateStage2D("stage1"),n.CreateStage2D("stage2"),n.CreateStage2D("stage3"),n.CreateStage2D("stage4"),n.GetStages("stage1","stage2","stage3").forEach(function(t){for(var e=10;e--;){var n=t.AddChild(new r.Graphic2D(r.Utility.RandomFloat(100,500),r.Utility.RandomFloat(50,350),new r.Path.Circle(0,0,r.Utility.RandomInteger(10,50))));n.data.velocity=new r.Vector2D(r.Utility.RandomFloat(-1,1),r.Utility.RandomFloat(-1,1)),n.data.torque=r.Utility.RandomFloat(-r.Math.RADIAN,r.Math.RADIAN)}t.onProcess.Add(i,t)})})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("CanvasManager",function(t){var e=1920,n=1080,i=t.canvas=document.createElement("canvas");document.body.appendChild(i),i.setAttribute("width",e),i.setAttribute("height",n),i.style.display="initial",i.style.position="absolute";var o={canvas:i,x:960,y:540,halt:!1},a=t.stage=new r.Stage2D(o),s=new r.Container2D(0,0);(t.canvasManager=new r.CanvasManager(i,e,n,r.CanvasManager.KEEP_ASPECT_RATIO_FIT)).BindStage(a).BindRootContainer(s).Trigger()})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("Camera2D",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s={canvas:a,x:i,y:o,halt:!0},u=t.stage=new r.Stage2D(s),l=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),c=new r.Container2D(0,0),h=new r.Sprite(0,0);u.AddChild(l).AddChild(c).AddChild(h),u.mouse.AddOffset(l),u.ticker.StartAF(),u.onProcess.Add(function(){l.Process()}),u.mouse.onDown.Add(function(t){l.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("BasicSetup",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1},i=t.stage=new r.Stage2D(n),o=new r.Container2D(0,0),a=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),s=new r.Container2D(300,200),u=new r.Sprite(0,0);a.force.SetSame(5),u.anchor.SetSame(.5),i.AddChild(o).AddChild(a).AddChild(s).AddChild(u),new r.CanvasManager(e,600,400,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(i).BindRootContainer(o).Trigger(),i.mouse.AddOffset(s).AddOffset(a),i.onProcess.Add(function(){a.Process()}),i.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("Tilesprite",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=a.getContext("2d"),u=new r.Tilesprite(i,o,r.Tilesprite.DEFAULT_TEXTURE);u.GeneratePattern(s,640,640),u.x=i-.5*u.width,u.y=o-.5*u.height,u.Draw(s)})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("Text",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute",a.style.backgroundColor="white";var s=a.getContext("2d"),u=new r.Text(i,o,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.");u.style.text.align=r.Style.TextConf.ALIGN_CENTER,u.style.text.baseline=r.Style.TextConf.BASELINE_MIDDLE,u.style.text.lineWidth=.3,u.style.text.font="40px Arial",u.Draw(s)})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("Geom",function(t){var e=window.innerWidth,n=window.innerHeight,i=t.canvas=document.createElement("canvas");document.body.appendChild(i),i.setAttribute("width",e),i.setAttribute("height",n),i.style.display="initial",i.style.position="absolute";var o=i.getContext("2d"),a=new r.Path.Circle(0,0,50),s=new r.Path.AABB2D(0,0,100,100),u=new r.Path.Polygon2D,l=new r.Path.Line2D(0,0,100,100),c=new r.Path.Polygon2D;r.Geom.PolygonConstruction.Butterfly(u,0,0,1e3,50),r.Geom.PolygonConstruction.Star(c,0,0,100,50,5);var h=new r.Graphic2D(100,100,a),f=new r.Graphic2D(200,100,s),d=new r.Graphic2D(350,100,l),p=new r.Graphic2D(600,200,u),y=new r.Graphic2D(100,300,c);h.Draw(o),f.Draw(o),d.Draw(o),p.Draw(o),y.Draw(o)})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("CollisionAABB2D",function(t){var e=1920,n=1080,i=t.canvas=document.createElement("canvas");document.body.appendChild(i),i.setAttribute("width",e),i.setAttribute("height",n),i.style.display="initial",i.style.position="absolute";var o={canvas:i,x:0,y:0,halt:!1},a=t.stage=new r.Stage2D(o),s=new r.Container2D(0,0),u=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),l=new r.Container2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new r.CanvasManager(i,e,n,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u);var c=r.Collision.AABB2DvsAABB2D.CollideRel,h=new r.Collision.AABB2DvsAABB2D.Result,f=l.AddChild(new r.Graphic2D(0,100,new r.Path.AABB2D(0,0,50,50))),d=l.AddChild(new r.Graphic2D(0,0,new r.Path.AABB2D(0,0,400,100))),p={shape:f.path,relative:f.position},y={shape:d.path,relative:d.position},v=new r.Vector2D(0,0),b=new r.Vector2D(0,0),m=null;a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){for(var e=l.children.length,n=t.data.position;e--;)if(l.children[e].IntersectsPoint(n)){v.SetV(n),m=l.children[e],b.SetV(m.position),t.stopPropagation=!0,m.SendToFront();break}m||u.target.position.SetV(n)}),a.mouse.onMove.Add(function(t){if(m){var e=t.data.position;m.position.SetV(e).AddV(b).SubtractV(v),h.Reset(),c(p,y,h),h.occured&&p.relative.AddV(h.mtv)}},a),a.mouse.onUp.Add(function(){m&&(m=null)})})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("CollisionCircle",function(t){var e=5760,n=3240,i=2880,o=1620,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s={canvas:a,x:0,y:0,halt:!1},u=t.stage=new r.Stage2D(s),l=new r.Container2D(0,0),c=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),h=new r.Container2D(i,o);c.force.SetSame(5),u.AddChild(l).AddChild(c).AddChild(h);for(var f=new r.CanvasManager(a,e,n,r.CanvasManager.KEEP_ASPECT_RATIO_FIT),d=[],p=r.Collision.CirclevsCircle.CollideRel,y=r.Collision.CirclevsCircle.ElasticResponse,v=new r.Collision.CirclevsCircle.Result,b=50;b--;){var m=r.Utility.RandomInteger(50,125),g=new r.Path.Circle(0,0,m),w=new r.Graphic2D(r.Utility.RandomFloat(-i,i),r.Utility.RandomFloat(-o,o),g);w.data.body={shape:g,relative:w.position,mass:m,velocity:new r.Vector2D(r.Utility.RandomInteger(-30,30),r.Utility.RandomInteger(-30,30))},d.push(w.data.body),h.AddChild(w)}f.BindStage(u).BindRootContainer(l).Trigger(),u.mouse.AddOffset(h).AddOffset(c),u.onProcess.Add(function(){c.Process();for(var t,e,n=0,r=0,a=d.length;n<a;++n)for((t=d[n]).relative.AddV(t.velocity),t.relative.x>i?(t.relative.x=i,t.velocity.x=-t.velocity.x):t.relative.x<-i&&(t.relative.x=-i,t.velocity.x=-t.velocity.x),t.relative.y>o?(t.relative.y=o,t.velocity.y=-t.velocity.y):t.relative.y<-o&&(t.relative.y=-o,t.velocity.y=-t.velocity.y),r=0;r<a;++r)t!==(e=d[r])&&(v.Reset(),p(t,e,v),v.occured&&y(t,e,v))}),u.mouse.onDown.Add(function(t){c.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("CollisionPolygon2D",function(t){var e=1920,n=1080,i=t.canvas=document.createElement("canvas");document.body.appendChild(i),i.setAttribute("width",e),i.setAttribute("height",n),i.style.display="initial",i.style.position="absolute";var o={canvas:i,x:0,y:0,halt:!1},a=t.stage=new r.Stage2D(o),s=new r.Container2D(0,0),u=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),l=new r.Container2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l);for(var c=new r.CanvasManager(i,e,n,r.CanvasManager.KEEP_ASPECT_RATIO_FIT),h=[],f=r.Collision.PolygonvsPolygon.CollideRel,d=new r.Collision.PolygonvsPolygon.Result,p=new r.Vector2D(0,0),y=new r.Vector2D(0,0),v=null,b=100;b--;){var m=new r.Path.Polygon2D;r.Geom.PolygonConstruction.Cyclic(m,0,0,r.Utility.RandomInteger(30,60),r.Utility.RandomInteger(3,6));var g=new r.Graphic2D(0,0,m);g.data.body={shape:m,relative:g.position},h.push(g.data.body),l.AddChild(g)}c.BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process();for(var t,e,n=0,i=0,r=h.length;n<r;++n)for(t=h[n],i=0;i<r;++i)t!==(e=h[i])&&(d.Reset(),f(t,e,d),d.occured&&(v?(t.relative!==v.position&&t.relative.SubtractV(d.mtv),e.relative!==v.position&&e.relative.AddV(d.mtv)):(d.mtv.Multiply(.5,.5),t.relative.SubtractV(d.mtv),e.relative.AddV(d.mtv))))}),a.mouse.onDown.Add(function(t){for(var e=l.children.length,n=t.data.position;e--;)if(l.children[e].IntersectsPoint(n)){p.SetV(n),v=l.children[e],y.SetV(v.position),t.stopPropagation=!0,v.SendToFront();break}v||u.target.position.SetV(n)}),a.mouse.onMove.Add(function(t){if(v){var e=t.data.position;v.position.SetV(e).AddV(y).SubtractV(p)}},a),a.mouse.onUp.Add(function(){v&&(v=null)})})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("CollisionLine2DCircle",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1},i=t.stage=new r.Stage2D(n),o=new r.Container2D(0,0),a=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),s=new r.Container2D(300,200);a.force.SetSame(5),i.AddChild(o).AddChild(a).AddChild(s),new r.CanvasManager(e,600,400,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(i).BindRootContainer(o).Trigger();for(var u=[],l=[],c=50;c--;){var h=new r.Path.Circle(0,0,r.Utility.RandomInteger(5,8)),f=new r.Graphic2D(0,0,h);f.data.body={shape:h,relative:f.position,velocity:new r.Vector2D(r.Utility.RandomFloat(-4,4),r.Utility.RandomFloat(-4,4))},s.AddChild(f),u.push(f.data.body)}for(var d=50;d--;){var p=new r.Path.Line2D(0,0,r.Utility.RandomInteger(10,25),r.Utility.RandomInteger(10,25)),y=new r.Graphic2D(r.Utility.RandomInteger(-300,300),r.Utility.RandomInteger(-200,200),p);p.Rotate(r.Math.RADIAN*r.Utility.RandomInteger(0,360)),y.data.body={shape:p,relative:y.position},s.AddChild(y),l.push(y.data.body)}var v=r.Collision.CirclevsLine.CollideRel,b=r.Collision.CirclevsLine.ReflectingResponse,m=new r.Collision.CirclevsLine.Result;i.mouse.AddOffset(s).AddOffset(a),i.onProcess.Add(function(){var t,e;a.Process();for(var n=0;n<u.length;++n){(t=u[n]).relative.AddV(t.velocity),t.relative.y<-200&&(t.relative.y=-200,t.velocity.y*=-1),t.relative.y>200&&(t.relative.y=200,t.velocity.y*=-1),t.relative.x<-300&&(t.relative.x=-300,t.velocity.x*=-1),t.relative.x>300&&(t.relative.x=300,t.velocity.x*=-1);for(var i=0;i<l.length;++i)e=l[i],m.Reset(),v(t,e,m),m.occured&&b(t,e,m)}}),i.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("CreateTexture",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new Image;s.onload=function(){var t=new r.Sprite(i,o,new r.Texture.BasicTexture2D(s));t.anchor.Set(.5,.5),t.Draw(a.getContext("2d"))},s.src=r.BrowserUtility.GenerateSimpleBase64PNG(function(){var t=new r.Path.Polygon2D;return r.Geom.PolygonConstruction.Supershape(t,0,0,100,100,6,.3,.3,.3),new r.Graphic2D(Math.abs(t.aabb.tl.x),Math.abs(t.aabb.tl.y),t)},null,null,"white")})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("Animation",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1},i=t.stage=new r.Stage2D(n),o=new r.Container2D(0,0),a=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),s=new r.Container2D(300,200);a.force.SetSame(5),i.AddChild(o).AddChild(a).AddChild(s),new r.CanvasManager(e,600,400,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(i).BindRootContainer(o).Trigger();var u=new r.Sprite(0,0,window.testData.imgloader.GetBasicTextureById("1to8"));u.anchor.SetSame(.5),s.AddChild(u);var l=(u.animationController=new r.Animator.Controller(u)).CreateAnimation("play",25);u.width=64,u.height=64,l.GenerateFrames(64,64,512,64,8,{5:10,3:8,1:6}),l.reverse=!0,l.loop=!0,l.Start(),l.onEnd.Add(function(){console.log("end")}),i.mouse.AddOffset(s).AddOffset(a),i.onProcess.Add(function(){a.Process(),l.Process()}),i.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("Quadtree",function(t){var e=window.innerWidth,n=window.innerHeight,i=t.canvas=document.createElement("canvas");document.body.appendChild(i),i.setAttribute("width",e),i.setAttribute("height",n),i.style.display="initial",i.style.position="absolute";var o={canvas:i,x:0,y:0,halt:!1},a=t.stage=new r.Stage2D(o),s=new r.Geom.AABB2D(0,0,e,n),u=new r.QuadtreeNode(s,0,4,5),l=[],c=[];a.onProcess.Add(function(){l.forEach(function(t){r.Debug.Draw.AABB2D(a.rc,t.aabb)})}),a.mouse.onDown.Add(function(t){var e=new r.Graphic2D(t.data.position.x,t.data.position.y,new r.Path.AABB2D(0,0,10,10));e.ComputeBounds(e.anchor),a.AddChild(e),c.push(e),u.Dump(),c.forEach(function(t){u.Add(t.bounds)}),l.length=0,u.ConcatNodes(l)})})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("RayCasting",function(t){var e=1920,n=1080,i=t.canvas=document.createElement("canvas");document.body.appendChild(i),i.setAttribute("width",e),i.setAttribute("height",n),i.style.display="initial",i.style.position="absolute";var o={canvas:i,x:0,y:0,halt:!1},a=t.stage=new r.Stage2D(o),s=new r.Container2D(0,0),u=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),l=new r.Container2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new r.CanvasManager(i,e,n,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();for(var c=[],h=[],f=100;f--;){var d=new r.Path.Polygon2D;r.Geom.PolygonConstruction.Cyclic(d,r.Utility.RandomInteger(-e,e),r.Utility.RandomInteger(-n,n),r.Utility.RandomInteger(30,60),r.Utility.RandomInteger(3,8)),d.Rotate(r.Utility.RandomFloat(0,r.Math.PII));var p=new r.Graphic2D(0,0,d);c.push(p)}for(var y=180,v=2*Math.PI/y;y--;){var b=v*y,m=new r.Path.Ray2D(0,0,0,0);m.style.stroke.lineWidth=1;var g=new r.Graphic2D(0,0,m);g.interactive=!1,g.data.angle=b,g.data.r=360,h.push(g)}l.Mount(c.concat(h)),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process(),h.forEach(function(t){t.path.s.SetV(a.mouse.position),t.path.e.SetV(t.path.s),t.path.e.Add(t.data.r,t.data.r),t.path.e.RotateAroundV(t.path.s,t.data.angle)});for(var t,e,n,i,o=0,s=0,l=0,f=0,d=h[o],p=h.length,y=c.length,v=0;o<p;d=h[++o])for(t=c[s=0];s<y;t=c[++s])for(l=0,f=(v=t.path.vertices.length)-1;l<v;f=l++)e=t.path.vertices[l],n=t.path.vertices[f],(i=r.Math.LineLineIntersection(d.path.s,d.path.e,e,n))&&h[o].path.e.SetV(i)}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(2),r=n(0);e.default=function(){Object(i.a)("ParticleSystem",function(t){var e=1920,n=1080,i=t.canvas=document.createElement("canvas");document.body.appendChild(i),i.setAttribute("width",e),i.setAttribute("height",n),i.style.display="initial",i.style.position="absolute";var o={canvas:i,x:0,y:0,halt:!1},a=t.stage=new r.Stage2D(o),s=new r.Container2D(0,0),u=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),l=new r.Container2D(960,540),c=new r.Particle.Particle2D.System(0,0),h=window.testData.xhrloader.GetClonedDataById("particleExplosion"),f=new r.Time.Timer(10),d=new r.Geom.Polygon2D;r.Geom.PolygonConstruction.Cyclic(d,0,0,400,72);var p=d.Copy();p.vertices.forEach(function(t){t.Invert(),t.Multiply(.1,.1)}),f.onFinish.Add(function(){c.Emit(h),f.Start()}),f.Start(),h.texture=r.Sprite.DEFAULT_TEXTURE,h.position={points:d.vertices,moduloWrapper:d.vertices.length},h.velocity={points:p.vertices,moduloWrapper:p.vertices.length},u.force.SetSame(.1),a.AddChild(s).AddChild(u).AddChild(l).AddChild(c),new r.CanvasManager(i,e,n,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process(),c.Process(),f.Process()}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}}]);