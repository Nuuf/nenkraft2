/**
* @package     Nenkraft2
* @author      Gustav 'Nuuf' Åberg <gustavrein@gmail.com>
* @version     1.5.1
* @copyright   (C) 2018 Gustav 'Nuuf' Åberg
* @license     {@link https://github.com/Nuuf/nenkraft2/blob/master/LICENSE}
*/!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=22)}([function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"CCH1",function(){return G}),n.d(r,"CCH1Decipher",function(){return V});var i={};n.r(i),n.d(i,"GenerateSimpleBase64PNG",function(){return X}),n.d(i,"ImageFromDataURL",function(){return H}),n.d(i,"ParsedXMLToJSON",function(){return Y}),n.d(i,"XMLToJSON",function(){return W}),n.d(i,"DownloadAsJSON",function(){return q});var o={};n.r(o),n.d(o,"Linear",function(){return $}),n.d(o,"QuadIn",function(){return Z}),n.d(o,"QuadOut",function(){return tt}),n.d(o,"QuadInOut",function(){return et}),n.d(o,"SineIn",function(){return nt}),n.d(o,"SineOut",function(){return rt}),n.d(o,"SineInOut",function(){return it}),n.d(o,"CircIn",function(){return ot}),n.d(o,"CircOut",function(){return at}),n.d(o,"CircInOut",function(){return st});var a={};n.r(a),n.d(a,"Result",function(){return ct}),n.d(a,"Collide",function(){return ht}),n.d(a,"SeparatingResponse",function(){return ft});var s={};n.r(s),n.d(s,"Line2DLine2DCollision",function(){return pt});var u={};n.r(u),n.d(u,"Result",function(){return mt}),n.d(u,"Collide",function(){return bt});var l={};n.r(l),n.d(l,"Result",function(){return Ct}),n.d(l,"Collide",function(){return Tt}),n.d(l,"ElasticResponse",function(){return xt});var c={};n.r(c),n.d(c,"Result",function(){return Bt}),n.d(c,"Collide",function(){return jt}),n.d(c,"ReflectingResponse",function(){return Gt});var h={};n.r(h),n.d(h,"Result",function(){return Mt}),n.d(h,"Collide",function(){return Ut}),n.d(h,"AxisSeparates",function(){return Xt}),n.d(h,"SeparatingResponse",function(){return Ht});var f={};n.r(f),n.d(f,"Body2D",function(){return Wt}),n.d(f,"AABB2DvsAABB2D",function(){return a}),n.d(f,"Line2DvsLine2D",function(){return s}),n.d(f,"AABB2DvsLine2D",function(){return u}),n.d(f,"CirclevsCircle",function(){return l}),n.d(f,"CirclevsLine2D",function(){return c}),n.d(f,"Polygon2DvsPolygon2D",function(){return h});var d={};n.r(d),n.d(d,"Rectangular",function(){return Zt}),n.d(d,"Isosceles",function(){return te}),n.d(d,"Cyclic",function(){return ee}),n.d(d,"Equilateral",function(){return ne}),n.d(d,"Star",function(){return re}),n.d(d,"Butterfly",function(){return ie}),n.d(d,"Rose",function(){return oe}),n.d(d,"Supershape",function(){return ae});var p={};n.r(p),n.d(p,"AABB2D",function(){return ue}),n.d(p,"Circle",function(){return be}),n.d(p,"Line2D",function(){return Se}),n.d(p,"Ray2D",function(){return Se}),n.d(p,"Polygon2D",function(){return Pe}),n.d(p,"PolygonConstruction",function(){return d});var y={};n.r(y),n.d(y,"DEFAULT",function(){return _e}),n.d(y,"SOURCE_OVER",function(){return Oe}),n.d(y,"SOURCE_IN",function(){return Re}),n.d(y,"SOURCE_OUT",function(){return De}),n.d(y,"SOURCE_ATOP",function(){return ke}),n.d(y,"DESTINATION_OVER",function(){return Ie}),n.d(y,"DESTINATION_IN",function(){return Le}),n.d(y,"DESTINATION_OUT",function(){return Be}),n.d(y,"DESTINATION_ATOP",function(){return je}),n.d(y,"LIGHTER",function(){return Ge}),n.d(y,"COPY",function(){return Ve}),n.d(y,"XOR",function(){return Ne}),n.d(y,"MULTIPLY",function(){return Fe}),n.d(y,"OVERLAY",function(){return Me}),n.d(y,"DARKEN",function(){return Ue}),n.d(y,"LIGHTEN",function(){return Xe}),n.d(y,"COLOR_DODGE",function(){return He}),n.d(y,"COLOR_BURN",function(){return Ye}),n.d(y,"HARD_LIGHT",function(){return We}),n.d(y,"SOFT_LIGHT",function(){return qe}),n.d(y,"DIFFERENCE",function(){return ze}),n.d(y,"EXCLUSION",function(){return Ke}),n.d(y,"HUE",function(){return Je}),n.d(y,"SATURATION",function(){return Qe}),n.d(y,"COLOR",function(){return $e}),n.d(y,"LUMINOSITY",function(){return Ze});var v={};n.r(v),n.d(v,"CAP_ROUND",function(){return tn}),n.d(v,"CAP_BUTT",function(){return en}),n.d(v,"CAP_SQUARE",function(){return nn}),n.d(v,"JOIN_BEVEL",function(){return rn}),n.d(v,"JOIN_ROUND",function(){return on}),n.d(v,"JOIN_MITER",function(){return an});var m={};n.r(m),n.d(m,"ALIGN_START",function(){return sn}),n.d(m,"ALIGN_END",function(){return un}),n.d(m,"ALIGN_CENTER",function(){return ln}),n.d(m,"ALIGN_LEFT",function(){return cn}),n.d(m,"ALIGN_RIGHT",function(){return hn}),n.d(m,"BASELINE_ALPHABETIC",function(){return fn}),n.d(m,"BASELINE_TOP",function(){return dn}),n.d(m,"BASELINE_HANGING",function(){return pn}),n.d(m,"BASELINE_MIDDLE",function(){return yn}),n.d(m,"BASELINE_IDEOGRAPHIC",function(){return vn}),n.d(m,"BASELINE_BOTTOM",function(){return mn});var b={};n.r(b),n.d(b,"Fill",function(){return gn}),n.d(b,"Stroke",function(){return An}),n.d(b,"Shadow",function(){return Cn}),n.d(b,"Text",function(){return xn}),n.d(b,"Pixel",function(){return Pn}),n.d(b,"GCO",function(){return y}),n.d(b,"LineConf",function(){return v}),n.d(b,"TextConf",function(){return m}),n.d(b,"All",function(){return En}),n.d(b,"FFSa",function(){return _n}),n.d(b,"SSa",function(){return On}),n.d(b,"FSa",function(){return Rn}),n.d(b,"SaT",function(){return Dn}),n.d(b,"P",function(){return kn});var g={};n.r(g),n.d(g,"AABB2D",function(){return Vn}),n.d(g,"Circle",function(){return Hn}),n.d(g,"Line2D",function(){return Jn}),n.d(g,"Ray2D",function(){return Jn}),n.d(g,"Polygon2D",function(){return nr}),n.d(g,"Pixel",function(){return vr});var w={};n.r(w),n.d(w,"Timer",function(){return Cr}),n.d(w,"Ticker",function(){return xr});var A={};n.r(A),n.d(A,"Uglify",function(){return Qr}),n.d(A,"ParseImports",function(){return $r}),n.d(A,"SNIPPETS",function(){return Zr}),n.d(A,"Parse",function(){return ti}),n.d(A,"TEXTURE_2D",function(){return ei}),n.d(A,"TEXTURE_2D_BATCH",function(){return ni}),n.d(A,"PIXEL_BATCH",function(){return ri}),n.d(A,"RECTANGLE",function(){return ii}),n.d(A,"CIRCLE",function(){return oi}),n.d(A,"LINE2D",function(){return ai}),n.d(A,"UN",function(){return si}),n.d(A,"RENDERTEXTURE_BLACK_WHITE",function(){return ui}),n.d(A,"RENDERTEXTURE_GRAYSCALE",function(){return li}),n.d(A,"RENDERTEXTURE_SEPIA",function(){return ci}),n.d(A,"RENDERTEXTURE_INVERT",function(){return hi}),n.d(A,"DynamicTEXTURE_2D",function(){return fi});var S={};n.r(S),n.d(S,"ImageLoader",function(){return wi}),n.d(S,"SpritesheetLoader",function(){return _i}),n.d(S,"TilesetLoader",function(){return Di}),n.d(S,"XHRLoader",function(){return Si}),n.d(S,"LoaderCombiner",function(){return Ii});var C={};n.r(C),n.d(C,"GLProgramController",function(){return Bi}),n.d(C,"GLCircleProgramController",function(){return Ui}),n.d(C,"GLLine2DProgramController",function(){return zi}),n.d(C,"GLPixelBatchProgramController",function(){return to}),n.d(C,"GLRectangleProgramController",function(){return ao}),n.d(C,"GLTexture2DBatchProgramController",function(){return fo}),n.d(C,"GLTexture2DProgramController",function(){return go}),n.d(C,"GLDynamicTexture2DProgramController",function(){return xo}),n.d(C,"GLUnProgramController",function(){return Do}),n.d(C,"GLRendertextureProgramController",function(){return Go});var T={};n.r(T),n.d(T,"ProgramController",function(){return C});var x={};n.r(x),n.d(x,"Option",function(){return No}),n.d(x,"Command",function(){return Mo}),n.d(x,"Registry",function(){return Wo});var P={};n.r(P),n.d(P,"Motion",function(){return zo}),n.d(P,"Manager",function(){return Qo});var E={};n.r(E),n.d(E,"Particle2D",function(){return ms}),n.d(E,"Oscillation",function(){return ra}),n.d(E,"System",function(){return xs});var _={};n.r(_),n.d(_,"Particle2D",function(){return E});var O={};n.r(O),n.d(O,"BasicTexture2D",function(){return bi}),n.d(O,"Spritesheet",function(){return Pi}),n.d(O,"Tileset",function(){return Oi});var R={};n.r(R),n.d(R,"Animation",function(){return Qa}),n.d(R,"Controller",function(){return Za}),n.d(R,"Frame",function(){return Ti});var D={};n.r(D),n.d(D,"AABB2D",function(){return Ps});var k={};n.r(k),n.d(k,"Draw",function(){return D});var I={};n.r(I),n.d(I,"RectanglePacker",function(){return _s});var L={};n.r(L),n.d(L,"Keyboard",function(){return Ds}),n.d(L,"Mouse",function(){return Is}),n.d(L,"Touch",function(){return Bs});var B=n(3),j=n(4);function G(t,e){var n,r,i=t.split(""),o=[];e=void 0===e?1:e;for(var a=0;a<i.length;++a)n=((n=i[a]).charCodeAt(0)+e).toString(2),r=Object(B.RandomInteger)(1,9),o.push(r+"x"+n.replace(/1/g,r));return o.join(" ")}function V(t,e){var n,r=t.split(" "),i=[];e=void 0===e?1:e;for(var o=0;o<r.length;++o)n=(n=r[o]).slice(2-n.length),i.push(String.fromCharCode(parseInt(n.replace(/[2-9]/g,"1"),2)-e));return i.join("")}var N,F,M,U=Math.ceil;function X(t,e,n,r){var i=t();return null==N&&(N=document.createElement("canvas"),F=N.getContext("2d")),N.width=U(i.w),N.height=U(i.h),null!=e&&(N.width=e),null!=n&&(N.height=n),null!=r?(F.fillStyle=r,F.fillRect(0,0,N.width,N.height)):F.clearRect(0,0,N.width,N.height),F.setTransform(1,0,0,1,0,0),i.Render(F),N.toDataURL("image/png")}function H(t,e,n,r){var i=new Image;return i.width=e,i.height=n,i.onload=r,i.src=t,i}function Y(t,e){var n,r,i,o,a,s,u={},l=t.childNodes,c=l.length;if(1===t.nodeType){if((c=(r=t.attributes).length)>0)for(u.attributes={},n=0,i=r.item(n);n<c;i=r.item(++n))u.attributes[i.nodeName]=i.nodeValue}else 3===t.nodeType&&(/^\s*$/g.exec(t.nodeValue)||(u=t.nodeValue,!0===e&&(u=u.replace(/^\s+|\s+&|\n/gim,""))));if(null!=l)for(c=l.length,n=0,o=l.item(n);n<c;o=l.item(++n))void 0===u[o.nodeName]?u[o.nodeName]=Y(o,e):(void 0===u[o.nodeName].push&&(s=u[o.nodeName],u[o.nodeName]=[],Object(B.IsObjectEmpty)(s)||u[o.nodeName].push(s)),a=Y(o,e),Object(B.IsObjectEmpty)(a)||u[o.nodeName].push(a));return u["#text"]&&0===u["#text"].length&&delete u["#text"],u}function W(t,e){return null==M&&(M=new DOMParser),Y(M.parseFromString(t,"text/xml"),e)}function q(t,e){var n="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t)),r=document.createElement("a");r.setAttribute("href",n),r.setAttribute("download",e+".json"),r.click()}var z=Math.sin,K=Math.cos,J=Math.sqrt,Q=Math.PI,$=function(t,e,n,r){return n*t/r+e},Z=function(t,e,n,r){return n*(t/=r)*t+e},tt=function(t,e,n,r){return-n*(t/=r)*(t-2)+e},et=function(t,e,n,r){return(t/=.5*r)<1?.5*n*t*t+e:.5*-n*(--t*(t-2)-1)+e},nt=function(t,e,n,r){return-n*K(t/r*(.5*Q))+n+e},rt=function(t,e,n,r){return n*z(t/r*(.5*Q))+e},it=function(t,e,n,r){return.5*-n*(K(Q*t/r)-1)+e},ot=function(t,e,n,r){return-n*(J(1-(t/=r)*t)-1)+e},at=function(t,e,n,r){return t/=r,n*J(1- --t*t)+e},st=function(t,e,n,r){return(t/=.5*r)<1?.5*-n*(J(1-t*t)-1)+e:.5*n*(J(1-(t-=2)*t)+1)+e},ut=n(1);function lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ct=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new ut.a(0,0),this.occured=!1}var e,n,r;return e=t,(n=[{key:"Reset",value:function(){this.mtv.SetSame(0),this.occured=!1}}])&&lt(e.prototype,n),r&&lt(e,r),t}(),ht=function(t,e,n){var r=t.shape,i=e.shape;return r.tl.x<i.br.x&&i.tl.x<r.br.x&&r.tl.y<i.br.y&&i.tl.y<r.br.y&&(dt[0].Set(r.tl.x-i.br.x,0),dt[1].Set(r.br.x-i.tl.x,0),dt[2].Set(0,r.tl.y-i.br.y),dt[3].Set(0,r.br.y-i.tl.y),dt.sort(ut.a.SortMinMag),n.mtv.SetV(dt[0]),n.occured=!0,!0)},ft=function(t,e,n){n.mtv.Multiply(.5,.5),t.relative.SubtractV(n.mtv),e.relative.AddV(n.mtv)},dt=[new ut.a(0,0),new ut.a(0,0),new ut.a(0,0),new ut.a(0,0)];function pt(t,e,n,r,i){i.SetV(e).SubtractV(t),yt.SetV(r).SubtractV(n);var o=-yt.x*i.y+i.x*yt.y,a=t.x-n.x,s=t.y-n.y,u=(-i.y*a+i.x*s)/o,l=(yt.x*s-yt.y*a)/o;return u>=0&&u<=1&&l>=0&&l<=1?(i.Set(t.x+l*i.x,t.y+l*i.y),!0):(i.SetSame(0),!1)}var yt=new ut.a(0,0);function vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var mt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.poc={a:new ut.a(0,0),b:new ut.a(0,0),c:new ut.a(0,0),d:new ut.a(0,0)},this.top=!1,this.right=!1,this.bottom=!1,this.left=!1}var e,n,r;return e=t,(n=[{key:"Reset",value:function(){this.poc.a.SetSame(0),this.poc.b.SetSame(0),this.poc.c.SetSame(0),this.poc.d.SetSame(0),this.top=!1,this.right=!1,this.bottom=!1,this.left=!1}}])&&vt(e.prototype,n),r&&vt(e,r),t}(),bt=function(t,e,n){var r=t.shape,i=e.shape;gt.Set(r.tl.x+(r.br.x-r.tl.x),r.tl.y),wt.Set(r.tl.x,r.tl.y+(r.br.y-r.tl.y)),n.top=pt(i.s,i.e,r.tl,gt,n.poc.a),n.right=pt(i.s,i.e,r.br,gt,n.poc.b),n.bottom=pt(i.s,i.e,r.br,wt,n.poc.c),n.left=pt(i.s,i.e,r.tl,wt,n.poc.d)},gt=new ut.a(0,0),wt=new ut.a(0,0);function At(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var St=Math.sqrt,Ct=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new ut.a(0,0),this.poc={a:new ut.a(0,0),b:new ut.a(0,0),c:new ut.a(0,0)},this.mtd=0,this.delta=new ut.a(0,0),this.occured=!1}var e,n,r;return e=t,(n=[{key:"Reset",value:function(){this.poc.a.SetSame(0),this.poc.b.SetSame(0),this.poc.c.SetSame(0),this.mtv.SetSame(0),this.mtd=0,this.delta.SetSame(0),this.occured=!1}}])&&At(e.prototype,n),r&&At(e,r),t}(),Tt=function(t,e,n){var r=t.shape,i=e.shape,o=r.radius+i.radius;Dt.SetV(r.center).SubtractV(i.center);var a=Dt.GetMagnitudeSquared();if(o*o>a){var s=St(a),u=(r.radiusSquared-i.radiusSquared+a)/(s+s),l=St(r.radiusSquared-u*u)/s,c=-Dt.y*l,h=Dt.x*l,f=s-r.radius-i.radius;return _t.Set(r.center.x+Dt.x*u/s,r.center.y+Dt.y*u/s),Ot.Set(_t.x+c,_t.y+h),Rt.Set(_t.x-c,_t.y-h),n.mtv.SetV(Dt).Divide(o,o),n.poc.a.SetV(_t),n.poc.b.SetV(Ot),n.poc.c.SetV(Rt),n.mtd=f,n.delta.SetV(Dt),n.occured=!0,!0}return!1},xt=function(t,e,n){Pt.SetV(n.delta).Normalize(),Et.SetV(n.mtv);var r=t.mass,i=e.mass,o=t.velocity,a=e.velocity,s=2*(o.GetDotV(Pt)-a.GetDotV(Pt))/(r+i);o.Set(o.x-s*i*Pt.x,o.y-s*i*Pt.y),a.Set(a.x+s*r*Pt.x,a.y+s*r*Pt.y),Et.Multiply(n.mtd,n.mtd).Multiply(.5,.5),t.relative.SubtractV(Et),e.relative.AddV(Et)},Pt=new ut.a(0,0),Et=new ut.a(0,0),_t=new ut.a(0,0),Ot=new ut.a(0,0),Rt=new ut.a(0,0),Dt=new ut.a(0,0),kt=n(7);function It(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Lt=Math.sqrt,Bt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new ut.a(0,0),this.cp=new ut.a(0,0),this.sOrE=0,this.occured=!1}var e,n,r;return e=t,(n=[{key:"Reset",value:function(){this.mtv.SetSame(0),this.cp.SetSame(0),this.sOrE=0,this.occured=!1}}])&&It(e.prototype,n),r&&It(e,r),t}(),jt=function(t,e,n){var r=t.shape,i=e.shape,o=r.center,a=Object(kt.ClosestPoint2DOnLine2D)(i.s,i.e,o);Vt.Set(o.x-a.x,o.y-a.y);var s=Vt.GetMagnitudeSquared();if(s<r.radiusSquared){var u=r.radius-Lt(s);return n.mtv.SetV(Vt).Normalize().Multiply(u,u),n.cp.SetV(a),n.occured=!0,a===i.s?n.sOrE=1:a===i.e&&(n.sOrE=-1),!0}return!1},Gt=function(t,e,n){var r,i,o=e.shape,a=t.velocity,s=t.relative,u=n.cp;0!==n.sOrE?(r=u.SubtractVC(s)).Normalize():r=o.GetNormalA(),i=a.GetReflectionV(r),a.SetV(i),s.AddV(n.mtv)},Vt=new ut.a(0,0);function Nt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ft=Math.abs,Mt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new ut.a(0,0),this.olAxis=new ut.a(0,0),this.mtd=1/0,this.occured=!1}var e,n,r;return e=t,(n=[{key:"Reset",value:function(){this.occured=!1,this.mtv.Set(0,0),this.mtd=1/0,this.olAxis.Set(0,0)}}])&&Nt(e.prototype,n),r&&Nt(e,r),t}(),Ut=function(t,e,n){for(var r=0,i=t.shape,o=t.shape,a=i.normals,s=o.normals,u=a.length,l=s.length;r<u;++r)if(!0===Xt(t,e,a[r],n))return!1;for(r=0;r<l;++r)if(!0===Xt(t,e,s[r],n))return!1;return null!=n&&(n.mtv.SetV(n.olAxis),n.mtv.Multiply(n.mtd,n.mtd),n.occured=!0),!0},Xt=function(t,e,n,r){var i=n.GetMinMaxDot(t.shape.vertices),o=n.GetMinMaxDot(e.shape.vertices),a=e.relative.SubtractVC(t.relative).GetDotV(n);if(o.Add(a,a),i.x>o.y||o.x>i.y)return!0;if(null!=r){var s=0,u=0,l=0,c=i.x,h=i.y,f=o.x,d=o.y;s=c<f?h<d?h-f:(u=h-f)<(l=d-c)?u:-l:h>d?c-d:(u=h-f)<(l=d-c)?u:-l;var p=Ft(s);p<r.mtd&&(r.mtd=p,r.olAxis.SetV(n),s<0&&r.olAxis.Invert())}return!1},Ht=function(t,e,n){n.mtv.Multiply(.5,.5),t.relative.SubtractV(n.mtv),e.relative.AddV(n.mtv)};function Yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Wt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.shape=e,this.mass=0,this.relative=null,this.velocity=new ut.a(0,0)}var e,n,r;return e=t,(n=[{key:"SetMass",value:function(t){return this.mass=t,this}},{key:"SetVelocity",value:function(t,e){return this.velocity.Set(t,e),this}},{key:"SetVelocityV",value:function(t){return this.velocity.SetV(t),this}},{key:"GetPosition",value:function(){return this.shape.GetPosition()}},{key:"SetPosition",value:function(t,e){this.shape.SetPosition(t,e)}},{key:"SetPositionV",value:function(t){return this.shape.SetPosition(t.x,t.y),this}},{key:"SetRelative",value:function(t){return this.relative=t,this}}])&&Yt(e.prototype,n),r&&Yt(e,r),t}(),qt=Math.PI,zt=Math.cos,Kt=Math.sin,Jt=Math.abs,Qt=Math.pow,$t=Math.exp,Zt=function(t,e,n,r,i){var o=new ut.a(e,n),a=new ut.a(e+r,n),s=new ut.a(e+r,n+i),u=new ut.a(e,n+i);return t.Recreate([o,a,s,u]),t.ComputeBounds(),t.GetNormalsA(),t},te=function(t,e,n,r,i){var o=new ut.a(e,n),a=new ut.a(e+.5*r,n+i),s=new ut.a(e-.5*r,n+i);return t.Recreate([o,a,s]),t.ComputeBounds(),t.GetNormalsA(),t},ee=function(t,e,n,r,i){var o,a,s,u=0,l=i,c=2*qt/l;for(t.Recreate([]);u<l;++u)o=zt(s=c*u)*r,a=Kt(s)*r,t.AddVertex(new ut.a(e+o,n+a));return t.ComputeBounds(),t.GetNormalsA(),t},ne=function(t,e,n,r){var i,o,a=2.0943951023931953;return t.Recreate([]),i=r,o=0,t.AddVertex(new ut.a(e+i,n+o)),i=zt(a)*r,o=Kt(a)*r,t.AddVertex(new ut.a(e+i,n+o)),i=zt(2*a)*r,o=Kt(2*a)*r,t.AddVertex(new ut.a(e+i,n+o)),t.Rotate(-90*new Math.RADIAN),t.ComputeBounds(),t.GetNormalsA(),t},re=function(t,e,n,r,i,o){var a,s,u,l,c=0,h=2*o,f=2*Math.PI/h;for(t.Recreate([]);c<h;++c)l=0==(1&c)?r:i,u=f*c,a=Math.cos(u)*l,s=Math.sin(u)*l,t.AddVertex(new ut.a(e+a,n+s));return t.ComputeBounds(),t.GetNormalsA(),t},ie=function t(e,n,r,i,o){var a,s,u,l=0,c=t.C;for(e.Recreate([]);l<i;++l)u=l*c._1*qt/i,a=zt(u)*($t(zt(u))-c._2*zt(c._3*u)-Qt(Kt(u/c._4),c._5))*o,s=Kt(u)*($t(zt(u))-c._2*zt(c._3*u)-Qt(Kt(u/c._4),c._5))*o,e.AddVertex(new ut.a(n+a,r+s));return e.ComputeBounds(),e.GetNormalsA(),e};ie.C={_1:24,_2:2,_3:4,_4:12,_5:5};var oe=function(t,e,n,r,i,o,a){var s,u,l,c,h=0,f=o,d=2*qt/f*a;for(t.Recreate([]);h<f;++h)c=zt(i*(l=d*h))*r,s=zt(l)*c,u=Kt(l)*c,t.AddVertex(new ut.a(e+s,n+u));return t.ComputeBounds(),t.GetNormalsA(),t},ae=function t(e,n,r,i,o,a,s,u,l){var c,h,f,d,p,y,v=0,m=o,b=t.C;for(s=null==s?1:s,u=null==u?1:u,l=null==l?1:l,e.Recreate([]);v<m;++v)p=zt(a*(f=v*qt*2/o)/4)/b._A,p=Jt(p),p=Qt(p,u),y=Kt(a*f/4)/b._B,y=Jt(y),y=Qt(y,l),d=Qt(p+y,1/s),0===Jt(d)?(c=0,h=0):(d=1/d,c=zt(f)*d*i,h=Kt(f)*d*i),e.AddVertex(new ut.a(n+c,r+h));return e.ComputeBounds(),e.GetNormalsA(),e};function se(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}ae.C={_A:1,_B:1};var ue=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tl=new ut.a(e,n),this.br=new ut.a(r,i),this.w=0,this.h=0,this.hw=0,this.hh=0,this.area=0,this.belongsTo=null,this.TYPE=de,this.ComputeWH()}var e,n,r;return e=t,r=[{key:"TYPE",get:function(){return de}}],(n=[{key:"Set",value:function(t,e,n,r){return this.tl.Set(t,e),this.br.Set(n,r),this.ComputeWH()}},{key:"SetC",value:function(t){return this.Set(t.tl.x,t.tl.y,t.br.x,t.br.y),this}},{key:"SetXYWH",value:function(t,e,n,r){return this.Set(t,e,t+n,e+r)}},{key:"SetPosition",value:function(t,e){return this.tl.Set(t,e),this.br.Set(t+this.w,e+this.h),this}},{key:"GetPosition",value:function(){return this.tl}},{key:"Scale",value:function(t,e,n){return!1!==n&&this.tl.Multiply(t,e),this.br.Multiply(t,e),this.ComputeWH()}},{key:"ScaleV",value:function(t,e){return!1!==e&&this.tl.MultiplyV(t),this.br.MultiplyV(t),this.ComputeWH()}},{key:"ComputeWH",value:function(){return this.w=this.br.x-this.tl.x,this.h=this.br.y-this.tl.y,this.hw=.5*this.w,this.hh=.5*this.h,this.area=this.w*this.h,this}},{key:"IntersectsPoint2D",value:function(t){return!(t.x<this.tl.x||t.x>this.br.x||t.y<this.tl.y||t.y>this.br.y)}},{key:"ContainsPoint",value:function(t){return!(t.x<=this.tl.x||t.x>=this.br.x||t.y<=this.tl.y||t.y>=this.br.y)}},{key:"IntersectsAABB2D",value:function(t){return!(t.tl.x>=this.br.x||t.tl.y>=this.br.y||t.br.x<=this.tl.x||t.br.y<=this.tl.y)}},{key:"ContainsAABB2D",value:function(t){return!(t.area>this.area)&&(t.tl.x>this.tl.x&&t.tl.y>this.tl.y&&t.br.x<this.br.x&&t.br.y<this.br.y)}},{key:"GetQuadrant",value:function(e){var n=this.tl,r=this.br;switch(e){case le:return new t(n.x,n.y,n.x+this.hw,n.y+this.hh);case ce:return new t(n.x+this.hw,n.y,r.x,n.y+this.hh);case he:return new t(n.x,n.y+this.hh,n.x+this.hw,r.y);case fe:return new t(n.x+this.hw,n.y+this.hh,r.x,r.y);default:return null}}}])&&se(e.prototype,n),r&&se(e,r),t}(),le="TL",ce="TR",he="BL",fe="BR",de=1;function pe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ye=Math.PI,ve=Math.sin,me=Math.cos,be=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.center=new ut.a(e,n),this.diameter=0,this.w=0,this.h=0,this.radiusSquared=0,this.radiusUnsquared=0,this.area=0,this.radius=r,this.belongsTo=null,this.TYPE=ge}var e,n,r;return e=t,r=[{key:"TYPE",get:function(){return ge}}],(n=[{key:"Set",value:function(t,e,n){return this.center.Set(t,e),this.radius=n,this}},{key:"SetC",value:function(t){return this.center.SetV(t),this.radius=t.radius,this}},{key:"SetPosition",value:function(t,e){return this.center.Set(t,e),this}},{key:"GetPosition",value:function(){return this.center}},{key:"Scale",value:function(t){return this.radius*=t,this}},{key:"IntersectsCircle",value:function(t){var e=this.radius+t.radius;return e*e>=this.center.GetDistanceSquaredV(t.center)}},{key:"ContainsCircle",value:function(t){return this.radius-t.radius>this.center.GetDistanceV(t.center)}},{key:"IntersectsPoint2D",value:function(t){return this.radiusSquared>=this.center.GetDistanceSquaredV(t)}},{key:"GenerateRandomPoints",value:function(t,e,n){var r=B.RandomFloat,i=new ut.a(this.x-this.radius,this.y-this.radius),o=new ut.a(this.x+this.radius,this.y+this.radius),a=[];n=!!n,!0===e&&(r=B.RandomInteger);for(var s=0;s<t;++s){for(var u=new ut.a(r(i.x,o.x),r(i.y,o.y));this.IntersectsPoint2D(u)===n;)u.Set(r(i.x,o.x),r(i.y,o.y));a.push(u)}return a}},{key:"GeneratePerimeterPoints",value:function(t,e){var n=[];t*=e;for(var r=0;r<t;r+=e)n.push(new ut.a(this.x+me(Object(j.DegreesToRadians)(r))*this.radius,this.y+ve(Object(j.DegreesToRadians)(r))*this.radius));return n}},{key:"x",get:function(){return this.center.x},set:function(t){this.center.x=t}},{key:"y",get:function(){return this.center.y},set:function(t){this.center.y=t}},{key:"radius",get:function(){return this.radiusUnsquared},set:function(t){this.radiusUnsquared=t,this.radiusSquared=t*t,this.diameter=this.w=this.h=2*t,this.area=ye*t*t}}])&&pe(e.prototype,n),r&&pe(e,r),t}(),ge=2;function we(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ae=Math.abs,Se=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.s=new ut.a(e,n),this.e=new ut.a(r,i),this.epsilon=1e3,this.belongsTo=null,this.TYPE=Ce}var e,n,r;return e=t,(n=[{key:"Set",value:function(t,e,n,r){return this.s.Set(t,e),this.e.Set(n,r),this}},{key:"SetC",value:function(t){return this.s.SetV(t.s),this.e.SetV(t.e),this}},{key:"SetPosition",value:function(t,e){var n=t+Ae(this.e.x-this.s.x),r=e+Ae(this.e.y-this.s.y);return this.s.Set(t,e),this.e.Set(n,r),this}},{key:"GetPosition",value:function(){return this.s}},{key:"Stretch",value:function(t){var e=.5*t;return this.s.PushFromV(this.e,e),this.e.PushFromV(this.s,e),this}},{key:"Rotate",value:function(t,e,n){return e=null==e?.5:e,Te.SetV(this.s).AddV(this.e).Multiply(e,null==n?e:n),this.s.RotateAroundV(Te,t),this.e.RotateAroundV(Te,t),this}},{key:"Cut",value:function(t,e){null==e&&(e=[]);for(var n=0;n<t.length;++n)e.push(this.s.GetWeightedAverageV(this.e,t[n]));return e}},{key:"GetLength",value:function(){return this.s.GetDistanceV(this.e)}},{key:"GetLengthSquared",value:function(){return this.s.GetDistanceSquaredV(this.e)}},{key:"IntersectsPoint2D",value:function(t){var e=this.s,n=this.e,r=(t.y-e.y)*(n.x-e.x)-(t.x-e.x)*(n.y-e.y);if(Math.abs(r)>this.epsilon)return!1;var i=(t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y);return!(i<0)&&!(i>this.GetLengthSquared())}},{key:"IntersectsLine2D",value:function(t){return Object(kt.Line2DLine2DIntersection)(this.s,this.e,t.s,t.e)}},{key:"GetClosestPoint2DTo",value:function(t){return Object(kt.ClosestPoint2DOnLine2D)(this.s,this.e,t)}},{key:"GetNormalA",value:function(){return this.s.GetNormalAV(this.e)}},{key:"GetNormalB",value:function(){return this.s.GetNormalBV(this.e)}}])&&we(e.prototype,n),r&&we(e,r),t}(),Ce=0,Te=new ut.a(0,0);function xe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Pe=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertices=[],this.normals=[],this.perimeterMidPoints=[],this.centroid=new ut.a(0,0),this.aabb=new ue(0,0,0,0),this.dirtyBounds=!0,this.dirtyCentroid=!0,this.belongsTo=null,this.TYPE=Ee,null!=e&&this.AddVertices(e)}var e,n,r;return e=t,(n=[{key:"Copy",value:function(){for(var e=new t,n=this.vertices,r=0;r<n.length;++r)e.AddVertex(n[r].Copy());return e.ComputeBounds(),e.ComputeCentroid(),e}},{key:"SetC",value:function(t){for(var e=t.vertices,n=0;n<e.length;++n)this.AddVertex(e[n].Copy());return this.ComputeBounds(),this.ComputeCentroid(),this}},{key:"ExtractSegments",value:function(t){var e=this.vertices,n=e.length-1;null==t&&(t=[]);for(var r=0;r<n;++r)t.push(new Se(e[r],e[r+1]));return t.push(new Se(e[n],e[0])),t}},{key:"GenerateRandomPoints",value:function(t,e,n){this.ComputeBounds(),n=!!n;var r=B.RandomFloat,i=this.aabb.tl,o=this.aabb.br,a=[];!0===e&&(r=B.RandomInteger);for(var s=0;s<t;++s){for(var u=new ut.a(r(i.x,o.x),r(i.y,o.y));this.IntersectsPoint2D(u)===n;)u.Set(r(i.x,o.x),r(i.y,o.y));a.push(u)}return a}},{key:"AddVertex",value:function(t){return this.vertices.push(t),this.dirtyBounds=!0,this.dirtyCentroid=!0,this}},{key:"AddVertices",value:function(t){if(t[0]instanceof ut.a)this.vertices.push.apply(this.vertices,t);else if("number"==typeof t[0])for(var e=0;e<t.length;e+=2)this.AddVertex(new ut.a(t[e],t[e+1]));else if(null!=t[0].x)for(e=0;e<t.length;++e)this.AddVertex(new ut.a(t[e].x,t[e].y));return this}},{key:"Recreate",value:function(t){return this.vertices.length=0,null!=t&&this.vertices.push.apply(this.vertices,t),this.dirtyBounds=!0,this.dirtyCentroid=!0,this}},{key:"ComputeBounds",value:function(){for(var t,e=1/0,n=-e,r=e,i=-e,o=this.vertices,a=0;a<o.length;++a)(t=o[a]).x<e&&(e=t.x),t.x>n&&(n=t.x),t.y<r&&(r=t.y),t.y>i&&(i=t.y);return this.aabb.Set(e,r,n,i),this.dirtyBounds=!1,this}},{key:"Rotate",value:function(t,e,n){!0===this.dirtyBounds&&this.ComputeBounds();var r=0,i=this.aabb,o=i.tl.Copy(),a=this.vertices,s=a.length;for(e=null==e?.5:e,o.AddV(i.br),o.Multiply(e,null==n?e:n);r<s;++r)a[r].RotateAroundV(o,t);this.dirtyCentroid=!0,this.dirtyBounds=!0}},{key:"SetPosition",value:function(t,e){!0===this.dirtyCentroid&&this.ComputeCentroid();for(var n=this.vertices,r=this.centroid,i=0;i<n.length;++i)n[i].SubtractV(r).Add(t,e);return this.dirtyCentroid=!0,this.dirtyBounds=!0,this}},{key:"ComputeCentroid",value:function(){var t=this.vertices,e=this.centroid;e.Set(0,0);for(var n=0;n<t.length;++n)e.AddV(t[n]);return e.Divide(t.length,t.length),this.dirtyCentroid=!1,this}},{key:"GetNormalsA",value:function(){var t=this.vertices,e=t.length-1,n=this.normals;n.length=0;for(var r=0;r<e;++r)n.push(t[r].GetNormalAV(t[r+1]));return n.push(t[e].GetNormalAV(t[0])),n}},{key:"GetNormalsA",value:function(){var t=this.vertices,e=t.length-1,n=this.normals;n.length=0;for(var r=0;r<e;++r)n.push(t[r].GetNormalBV(t[r+1]));return n.push(t[e].GetNormalBV(t[0])),n}},{key:"GetPerimeterMidPoints",value:function(){var t=this.vertices,e=t.length-1,n=this.perimeterMidPoints;n.length=0;for(var r=0;r<e;++r)n.push(t[r].GetMidPointV(t[r+1]));return n.push(t[e].GetMidPointV(t[0])),n}},{key:"IntersectsPoint2D",value:function(t){if(!0===this.dirtyBounds&&this.ComputeBounds(),!1===this.aabb.IntersectsPoint2D(t))return!1;for(var e,n,r=!1,i=this.vertices,o=t.x,a=t.y,s=0,u=i.length-1;s<i.length;u=s++)e=i[s],n=i[u],e.y>a!=n.y>a&&o<(n.x-e.x)*(a-e.y)/(n.y-e.y)+e.x&&(r=!r);return r}}])&&xe(e.prototype,n),r&&xe(e,r),t}(),Ee=3,_e="source-over",Oe="source-over",Re="source-in",De="source-out",ke="source-atop",Ie="destination-over",Le="destination-in",Be="destination-out",je="destination-atop",Ge="lighter",Ve="copy",Ne="xor",Fe="multiply",Me="overlay",Ue="darken",Xe="lighten",He="color-dodge",Ye="color-burn",We="hard-light",qe="soft-light",ze="difference",Ke="exclusion",Je="hue",Qe="saturation",$e="color",Ze="luminosity",tn="round",en="butt",nn="square",rn="bevel",on="round",an="miter",sn="start",un="end",ln="center",cn="left",hn="right",fn="alphabetic",dn="top",pn="hanging",yn="middle",vn="ideographic",mn="bottom";function bn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var gn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#36802d",this.applied=!0,Object(B.ApplyProperties)(this,e)}var e,n,r;return e=t,(n=[{key:"Apply",value:function(t){t.fillStyle=this.color}}])&&bn(e.prototype,n),r&&bn(e,r),t}();function wn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var An=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#c9df8a",this.lineCap=tn,this.lineJoin=on,this.lineWidth=2,this.miterLimit=10,this.applied=!0,Object(B.ApplyProperties)(this,e)}var e,n,r;return e=t,(n=[{key:"Apply",value:function(t){t.strokeStyle=this.color,t.lineCap=this.lineCap,t.lineJoin=this.lineJoin,t.lineWidth=this.lineWidth,t.miterLimit=this.miterLimit}}])&&wn(e.prototype,n),r&&wn(e,r),t}();function Sn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Cn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#234d20",this.blur=5,this.offsetX=0,this.offsetY=0,this.applied=!1,Object(B.ApplyProperties)(this,e)}var e,n,r;return e=t,(n=[{key:"Apply",value:function(t){t.shadowColor=this.color,t.shadowBlur=this.blur,t.shadowOffsetX=this.offsetX,t.shadowOffsetY=this.offsetY}}])&&Sn(e.prototype,n),r&&Sn(e,r),t}();function Tn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fillColor="#36802d",this.strokeColor="#36802d",this.fontSize=45,this.font=null,this.fontFamily="Arial",this.align=cn,this.baseline=dn,this.lineWidth=.5,this.applied=!0,Object(B.ApplyProperties)(this,e),this.ConcatFont()}var e,n,r;return e=t,(n=[{key:"Apply",value:function(t){t.fillStyle=this.fillColor,t.strokeStyle=this.strokeColor,t.font=this.font,t.textAlign=this.align,t.textBaseline=this.baseline,t.lineWidth=this.lineWidth}},{key:"ConcatFont",value:function(){this.font=this.fontSize+"px "+this.fontFamily}}])&&Tn(e.prototype,n),r&&Tn(e,r),t}();var Pn=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#c9df8a",this.size=1,Object(B.ApplyProperties)(this,e)},En=function(t){return{fill:new gn(t?t.fill:null),stroke:new An(t?t.stroke:null),shadow:new Cn(t?t.shadow:null),text:new xn(t?t.text:null),pixel:new Pn(t?t.pixel:null)}},_n=function(t){return{fill:new gn(t?t.fill:null),stroke:new An(t?t.stroke:null),shadow:new Cn(t?t.shadow:null)}},On=function(t){return{stroke:new An(t?t.stroke:null),shadow:new Cn(t?t.shadow:null)}},Rn=function(t){return{fill:new gn(t?t.fill:null),shadow:new Cn(t?t.shadow:null)}},Dn=function(t){return{shadow:new Cn(t?t.shadow:null),text:new xn(t?t.text:null)}},kn=function(t){return{pixel:new Pn(t?t.pixel:null)}};function In(t){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ln(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Bn(t,e){return!e||"object"!==In(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jn(t){return(jn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gn(t,e){return(Gn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vn=function(t){function e(t,n,r,i,o){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=Bn(this,jn(e).call(this,t,n,r,i))).programController=null,a.style=_n(o),a}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gn(t,e)}(e,ue),n=e,(r=[{key:"Render",value:function(t){var e=this.tl,n=this.br,r=this.style;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(n.x,e.y),t.lineTo(n.x,n.y),t.lineTo(e.x,n.y),t.closePath(),!0===r.shadow.applied&&r.shadow.Apply(t),!0===r.fill.applied&&(r.fill.Apply(t),t.fill()),!0===r.stroke.applied&&(r.stroke.Apply(t),t.stroke())}},{key:"GLRender",value:function(t,e){null!==this.programController&&this.programController.Execute(e.globalTransform.AsArray(!0),this.tl.x,this.tl.y,this.w,this.h)}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.fillColor&&null!==t.outlineColor&&null!==t.outline&&(t.fillColor.SetHex(this.style.fill.color),t.fillColor.Normalize(),t.outlineColor.SetHex(this.style.stroke.color),t.outlineColor.Normalize(),t.outline=this.style.stroke.lineWidth+.2),this}}])&&Ln(n.prototype,r),i&&Ln(n,i),e}();function Nn(t){return(Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mn(t,e){return!e||"object"!==Nn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Un(t){return(Un=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xn(t,e){return(Xn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hn=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Mn(this,Un(e).call(this,t,n,r))).programController=null,o.style=_n(i),o}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xn(t,e)}(e,be),n=e,(r=[{key:"Render",value:function(t){var e=this.style;t.beginPath(),t.arc(this.x,this.y,this.radius,0,j.PII,!1),t.closePath(),!0===e.shadow.applied&&e.shadow.Apply(t),!0===e.fill.applied&&(e.fill.Apply(t),t.fill()),!0===e.stroke.applied&&(e.stroke.Apply(t),t.stroke())}},{key:"GLRender",value:function(t,e){null!==this.programController&&this.programController.Execute(e.globalTransform.AsArray(!0),this.x,this.y,this.radius)}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.fillColor&&null!==t.outlineColor&&null!==t.outline&&(t.fillColor.SetHex(this.style.fill.color),t.fillColor.Normalize(),t.outlineColor.SetHex(this.style.stroke.color),t.outlineColor.Normalize(),t.outline=this.style.stroke.lineWidth+.2),this}}])&&Fn(n.prototype,r),i&&Fn(n,i),e}();function Yn(t){return(Yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qn(t,e){return!e||"object"!==Yn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zn(t){return(zn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kn(t,e){return(Kn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jn=function(t){function e(t,n,r,i,o){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=qn(this,zn(e).call(this,t,n,r,i))).programController=null,a.style=On(o),a}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kn(t,e)}(e,Se),n=e,(r=[{key:"Render",value:function(t){var e=this.s,n=this.e,r=this.style;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(n.x,n.y),t.closePath(),!0===r.shadow.applied&&r.shadow.Apply(t),!0===r.stroke.applied&&(r.stroke.Apply(t),t.stroke())}},{key:"GLRender",value:function(t,e){null!==this.programController&&this.programController.Execute(e.globalTransform.AsArray(!0),this.s,this.e)}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.color&&(t.color.SetHex(this.style.stroke.color),t.color.Normalize()),this}}])&&Wn(n.prototype,r),i&&Wn(n,i),e}();function Qn(t){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zn(t,e){return!e||"object"!==Qn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tr(t){return(tr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function er(t,e){return(er=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nr=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Zn(this,tr(e).call(this,t))).programController=null,r.style=_n(n),r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&er(t,e)}(e,Pe),n=e,(r=[{key:"Render",value:function(t){var e=this.vertices,n=this.style;t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var r=1;r<e.length;++r)t.lineTo(e[r].x,e[r].y);t.closePath(),!0===n.shadow.applied&&n.shadow.Apply(t),!0===n.fill.applied&&(n.fill.Apply(t),t.fill()),!0===n.stroke.applied&&(n.stroke.Apply(t),t.stroke())}}])&&$n(n.prototype,r),i&&$n(n,i),e}();function rr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ir=Math.max,or=Math.min,ar=Math.round,sr=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.channel=new Float32Array([null==e?0:e,null==n?0:n,null==r?0:r,null==i?1:i]),this.value="",this.currentConversion="rgb",this.ComputeValueRGBA()}var e,n,r;return e=t,(n=[{key:"Copy",value:function(){var e=new t(this.channel[0],this.channel[1],this.channel[2],this.channel[3]);return e.value=this.value,e.currentConversion=this.currentConversion,e}},{key:"ComputeValueRGBA",value:function(){return this.value="rgba(".concat(this.channel.join(",").concat(")")),this.value}},{key:"ComputeValueHSLA",value:function(){return this.value="hsla("+this.channel[0]+","+this.channel[1]+"%,"+this.channel[2]+"%,"+this.channel[3]+")",this.value}},{key:"ComputeValueHex",value:function(){return this.value="#"+this.channel[0].toString(16)+this.channel[1].toString(16)+this.channel[2].toString(16),this.value}},{key:"ConvertToHSLA",value:function(t){var e=0,n=0,r=this.channel[0]/ur,i=this.channel[1]/ur,o=this.channel[2]/ur,a=ir(r,i,o),s=or(r,i,o),u=a-s,l=.5*(a+s);a!==s&&(n=l>.5?u/(2-a-s):u/(a+s),e=a===r?(i-o)/u+(i<o?6:0):a===i?(o-r)/u+2:(r-i)/u+4,e/=6),this.channel[0]=360*e,this.channel[1]=100*n,this.channel[2]=100*l,!0===t&&(this.channel[0]=ar(this.channel[0]),this.channel[1]=ar(this.channel[1]),this.channel[2]=ar(this.channel[2])),this.currentConversion="hsl",this.ComputeValueHSLA()}},{key:"SetRGB",value:function(t,e,n,r){this.channel[0]=Object(B.Clamp)(t,lr,ur),this.channel[1]=Object(B.Clamp)(e,lr,ur),this.channel[2]=Object(B.Clamp)(n,lr,ur),this.currentConversion="rgb",r||this.ComputeValueRGBA()}},{key:"SetRGBA",value:function(t,e,n,r){this.SetRGB(t,e,n,!0),this.channel[3]=Object(B.Clamp)(r,0,1),this.ComputeValueRGBA()}},{key:"SetHex",value:function(t){var e=(t=t.replace(/#/g,"")).match(/.{2}/g);null==(e=e.map(B.Base16ToBase10))[3]&&(e[3]=1),this.SetRGBA(e[0],e[1],e[2],e[3])}},{key:"IncreaseChannel",value:function(t,e){this.channel[t]+=e,"rgb"===this.currentConversion?this.ComputeValueRGBA():"hsl"===this.currentConversion&&this.ComputeValueHSLA()}},{key:"SetChannel",value:function(t,e){this.channel[t]=e,"rgb"===this.currentConversion?this.ComputeValueRGBA():"hsl"===this.currentConversion&&this.ComputeValueHSLA()}},{key:"Normalize",value:function(){this.channel[0]=cr*this.channel[0],this.channel[1]=cr*this.channel[1],this.channel[2]=cr*this.channel[2]}},{key:"r",get:function(){return this.channel[0]},set:function(t){this.channel[0]=t}},{key:"g",get:function(){return this.channel[1]},set:function(t){this.channel[1]=t}},{key:"b",get:function(){return this.channel[2]},set:function(t){this.channel[2]=t}},{key:"a",get:function(){return this.channel[3]},set:function(t){this.channel[3]=t}}])&&rr(e.prototype,n),r&&rr(e,r),t}(),ur=255,lr=0,cr=1/ur;function hr(t){return(hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function dr(t,e){return!e||"object"!==hr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pr(t){return(pr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yr(t,e){return(yr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vr=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=dr(this,pr(e).call(this,t,n))).style=kn(r),i.color=new sr,i.programController=null,i.bufferData=null,i}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yr(t,e)}(e,ut["a"]),n=e,(r=[{key:"GLRender",value:function(t,e){null!==this.programController&&this.programController.Execute(e.worldTransform.AsArray(!0),this.x,this.y)}},{key:"LinkProgramController",value:function(t){this.programController=t,this.LinkStyle()}},{key:"UseProgramController",value:function(t){this.programController=t}},{key:"LinkStyle",value:function(){var t=this.programController;null!==t&&null!==t.color&&(t.color.SetHex(this.style.pixel.color),t.color.Normalize())}},{key:"GetBufferData",value:function(){null==this.bufferData&&(this.bufferData=[]);var t=this.bufferData,e=this.color;return t[0]=this.x,t[1]=this.y,t[2]=e.r,t[3]=e.g,t[4]=e.b,t[5]=e.a,t[6]=this.style.pixel.size,t}},{key:"UpdateInBuffer",value:function(t,e){var n=this.color;t[e]=this.x,t[e+1]=this.y,t[e+2]=n.r,t[e+3]=n.g,t[e+4]=n.b,t[e+5]=n.a,t[e+6]=this.style.pixel.size}}])&&fr(n.prototype,r),i&&fr(n,i),e}();function mr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var br=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=n,this.holderContext=e,this.handle=r,this.removeOnNextCall=i}var e,n,r;return e=t,(n=[{key:"Execute",value:function(){this.handle.apply(this.context,arguments),!0===this.removeOnNextCall&&this.Remove()}},{key:"Remove",value:function(){this.holderContext.Remove(this.handle,this.context)}}])&&mr(e.prototype,n),r&&mr(e,r),t}();function gr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var wr=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.listeners=[],this.stopPropagation=!1,this.target=null,this.data=null}var e,n,r;return e=t,(n=[{key:"GetListenerIndex",value:function(t,e){var n,r=this.listeners;if(0===r.length)return-1;for(var i=0;i<r.length;++i)if((n=r[i]).context===e&&n.handle===t)return i;return-1}},{key:"Add",value:function(t,e,n){this.listeners.push(new br(this,e,t,n))}},{key:"Once",value:function(t,e){this.Add(t,e,!0)}},{key:"Remove",value:function(t,e){var n=this.GetListenerIndex(t,e);-1!==n&&this.listeners.fickleSplice(n)}},{key:"Dump",value:function(t){var e=this.listeners;if(void 0!==t)for(var n=0;n<e.length;++n)e[n].context===t&&e.splice(n);else e.length=0}},{key:"Dispatch",value:function(t,e){var n=this.listeners.slice();if(0!==n.length){this.stopPropagation=!1,this.target=t,this.data=e;for(var r=0;r<n.length&&(n[r].Execute(this),!0!==this.stopPropagation);++r);this.target=null,this.data=null}}}])&&gr(e.prototype,n),r&&gr(e,r),t}();function Ar(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Sr=Math.round,Cr=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.stopTime=Sr(null==e?0:e),this.time=0,this.isRunning=!1,this.canResume=!1,this.count=0,this.onStop=new wr,this.onFinish=new wr,this.onStart=new wr,this.onReset=new wr,this.onPause=new wr,this.onResume=new wr}var e,n,r;return e=t,(n=[{key:"Reset",value:function(){this.onReset.Dispatch(this,null),this.count=0,this.time=0,this.isRunning=!1,this.canResume=!1}},{key:"Start",value:function(t){this.stopTime=Sr(null==t?this.stopTime:t),this.stopTime>0&&(this.time=0,this.isRunning=!0,this.canResume=!1,this.onStart.Dispatch(this,{stopTime:this.stopTime}))}},{key:"Stop",value:function(){!0===this.isRunning&&(this.isRunning=!1,this.onStop.Dispatch(this,null))}},{key:"Pause",value:function(){!0===this.isRunning&&!1===this.canResume&&(this.isRunning=!1,this.canResume=!0,this.onPause.Dispatch(this,null))}},{key:"Resume",value:function(){!0===this.canResume&&(this.isRunning=!0,this.canResume=!1,this.onResume.Dispatch(this,null))}},{key:"Process",value:function(){this.time<this.stopTime&&!0===this.isRunning&&++this.time>=this.stopTime&&(this.isRunning=!1,this.count++,this.onFinish.Dispatch(this,null))}}])&&Ar(e.prototype,n),r&&Ar(e,r),t}();function Tr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xr=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.SetDesiredRate(n),this.onProcess=e,this.intervalId=null,this.afId=null,this.delta=0,this.then=0,this.now=0,this.desiredRate=0,this.supplyDelta=!0,r||this.StartAF()}var e,n,r;return e=t,r=[{key:"LOG",get:function(){return Pr},set:function(t){(function(t){throw new Error('"'+t+'" is read-only')})("PS_LOG"),Pr=!!t}}],(n=[{key:"Process",value:function(){this.onProcess(this.ComputeDelta())}},{key:"ProcessAF",value:function(){this.onProcess(this.ComputeDelta()),null!==this.afId&&(this.afId=requestAnimationFrame(this.ProcessAF))}},{key:"ComputeDelta",value:function(){return this.now=Date.now(),this.delta=this.now-this.then,this.then=this.now,this.delta}},{key:"GetTPS",value:function(){return Object(j.PrecisionRound)(1/this.delta*1e3,2)}},{key:"SetDesiredRate",value:function(t){this.desiredRate=void 0===t?16.66:1e3/t}},{key:"Start",value:function(t){if(null!==this.afId)return _r("%cTicker: RAF is running!","color:red;".concat(Er)),null;null!==this.intervalId?!0===t?(this.Stop(),this.intervalId=setInterval(this.Process.bind(this),this.desiredRate),_r("%cTicker: Starting interval!","color:#0F0;".concat(Er))):_r("%cTicker: Interval already running!","color:#F00;".concat(Er)):(this.intervalId=setInterval(this.Process.bind(this),this.desiredRate),_r("%cTicker: Starting interval!","color:#0F0;".concat(Er)))}},{key:"StartAF",value:function(t){if(null!==this.intervalId)return _r("%cTicker: Interval is running!","color:#F00;".concat(Er)),null;null!==this.afId?!0===t?(this.Stop(),this.ProcessAF=this.ProcessAF.bind(this),this.afId=requestAnimationFrame(this.ProcessAF),_r("%cTicker: Starting RAF!","color:#0F0;".concat(Er))):_r("%cTicker: RAF already running!","color:#F00;".concat(Er)):(this.ProcessAF=this.ProcessAF.bind(this),this.afId=requestAnimationFrame(this.ProcessAF),_r("%cTicker: Starting RAF!","color:#0F0;".concat(Er)))}},{key:"Stop",value:function(){null!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null,_r("%cTicker: Stopping interval!","color:cyan;".concat(Er))),null!==this.afId&&(cancelAnimationFrame(this.afId),this.afId=null,_r("%cTicker: Stopping RAF!","color:cyan;".concat(Er)))}}])&&Tr(e.prototype,n),r&&Tr(e,r),t}(),Pr=!0,Er="background-color:#36802d;font-family:Arial;font-size:18px;font-weight:900;padding:5px;",_r=function(){!1!==Pr&&console.log.apply(null,arguments)},Or=n(11),Rr=n.n(Or),Dr=n(12),kr=n.n(Dr),Ir=n(13),Lr=n.n(Ir),Br=n(14),jr=n.n(Br),Gr=n(15),Vr=n.n(Gr),Nr=n(16),Fr=n.n(Nr),Mr=n(17),Ur=n.n(Mr),Xr=n(18),Hr=n.n(Xr),Yr=n(19),Wr=n.n(Yr),qr=n(20),zr=n.n(qr),Kr=n(21),Jr=n.n(Kr),Qr=function(t){return t.replace(/\/\*[\s\S]*?\*\//g,"").replace(/[\r\t]/g," ").replace(/[ ]{2,}/g," ").replace(/[\n ]{2,}/g,"\n").replace(/\/\/.*/g,"").replace(/\s*(\=|\+|\-|\*|\/|\<|\>|\(|\)|\{|\}|\,|\:|\;|\?)\s*/g,"$1").trim()},$r=function(t){var e,n,r,i,o=t.match(/\((import .[\s\S]*?)\/\)/);if(null==o)return null;if((e=o[1].match(/\[([\s\S]*?)\]/))&&(o[1]=o[1].replace(e[0],""),e=JSON.parse(e[1])),r=o[1].match(/\'(.[\s\S]*?)\'/)[1],i=Zr[r],null!=e){if(null!=e.replace)for(n in e.replace)i=i.replace(new RegExp(n,"g"),e.replace[n]);if(null!=e.set)for(n in e.set){var a=i.match(new RegExp("("+n+"\\s*=\\s*.*?;)",""));if(a){var s=a[1].match(/=([\s\S]*?);/);s[1]=a[1].replace(s[1],e.set[n]),i=i.replace(a[1],s[1])}}}return{imp:o,snippet:i}},Zr={PI:Qr(n(27)),RADIAN:Qr(n(28)),RSEEDS:Qr(n(29)),VRSEEDS:Qr(n(30)),mod289:Qr(n(31)),permute:Qr(n(32)),rotate2d:Qr(n(33)),scale2d:Qr(n(34)),plot:Qr(n(35)),ridge:Qr(n(36)),pixelate:Qr(n(37)),random:Qr(n(38)),vrandom:Qr(n(39)),noise:Qr(n(40)),gnoise:Qr(n(41)),snoise:Qr(n(42)),fbm:Qr(n(43)),abs_fbm:Qr(n(44)),rot_fbm:Qr(n(45)),rmf:Qr(n(46)),aabb:Qr(n(47)),cruciform:Qr(n(48)),circle:Qr(n(49))},ti=function(t){var e,n,r="@vertex@",i="@fragment@";e=t.indexOf(r)+r.length,n=t.indexOf("@vertex-end@");var o=t.substring(e,n).replace(/\/\*[\s\S]*?\*\//g,"");e=t.indexOf(i)+i.length,n=t.indexOf("@fragment-end@");for(var a=t.substring(e,n).replace(/\/\*[\s\S]*?\*\//g,""),s=!0;!0===s;){s=!1;var u=$r(o);null!=u&&(o=o.replace(u.imp[0],u.snippet),s=!0);var l=$r(a);null!=l&&(a=a.replace(l.imp[0],l.snippet),s=!0)}return{vertex:Qr(o),fragment:Qr(a)}},ei=ti(Rr.a),ni=ti(kr.a),ri=ti(Lr.a),ii=ti(jr.a),oi=ti(Vr.a),ai=ti(Fr.a),si=ti(Ur.a),ui=ti(Hr.a),li=ti(Wr.a),ci=ti(zr.a),hi=ti(Jr.a),fi=function(t){var e,n=[];for(n.push("precision mediump float;"),e=0;e<t;++e)n.push("attribute vec2 aPosition"+e+";","attribute vec2 aTexCoord"+e+";");for(n.push("uniform mat3 uProjection;","uniform mat3 uTranslation;","uniform mat3 uTransformation;","uniform int uUnitId;","varying vec2 vTexCoord;","void main () {","if ( uUnitId == 0 ) {","gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition0, 1.0 ) ).xy, 0.0, 1.0 );","vTexCoord = ( uTransformation * vec3( aTexCoord0, 1.0 ) ).xy;","}"),e=1;e<t;++e)n.push("else if ( uUnitId == "+e+" ) {","gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition"+e+", 1.0 ) ).xy, 0.0, 1.0 );","vTexCoord = ( uTransformation * vec3( aTexCoord"+e+", 1.0 ) ).xy;","}");return n.push("}"),{vertex:n.join(""),fragment:ei.fragment}},di=n(5);function pi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var yi=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,this.items=[]}var e,n,r;return e=t,(n=[{key:"Store",value:function(t){var e=!1;return null==t?(console.warn("Item is null."),null):(null!=t.id&&""!==t.id?e=!this.Contains(t,t.id):t.data&&null!=t.data.id&&""!==t.data.id&&(e=!this.Contains(t,t.data.id)),!1===e?(console.warn("Invalid item. Check the item id. The item has not been stored"),!1):(this.items.push(t),!0))}},{key:"StoreSafe",value:function(t){return null!=this.type&&Object(di.a)(t,di.a.IS_INSTANCE_OF,this.type),Object(di.a)(t,di.a.IS_SAME_TYPE,vi),t.id?(Object(di.a)(t.id,di.a.IS_SAME_TYPE,mi),Object(di.a)(t.id,di.a.IS_NOT,"")):(Object(di.a)(t.data,di.a.IS_SAME_TYPE,vi),Object(di.a)(t.data.id,di.a.IS_SAME_TYPE,mi),Object(di.a)(t.data.id,di.a.IS_NOT,"")),this.Store(t)}},{key:"GetById",value:function(t){for(var e=this.items,n=e[0],r=0;r<e.length;n=e[++r])if(null!=n&&(n.id===t||null!=n.data&&n.data.id===t))return n;return null}},{key:"Contains",value:function(t,e){for(var n=this.items,r=n[0],i=0;i<n.length;r=n[++i])if(null!=r){if(r===t)return!0;if(r.id===e)return!0;if(null!=r.data&&r.data.id===e)return!0}return!1}}])&&pi(e.prototype,n),r&&pi(e,r),t}(),vi=Object.create(null),mi="string";var bi=function t(e,n,r,i,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.image=e,this.id=null,this.w=0,this.h=0,this.fw=0,this.fh=0,this.uniformId=0,this.id=null!=n?n:e.id,this.w=null!=r?r:e.naturalWidth,this.h=null!=i?i:e.naturalHeight,this.fw=null!=o?o:e.naturalWidth,this.fh=null!=a?a:e.naturalHeight};function gi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var wi=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.imageCache=new yi(Image),this.basicTextureCache=new yi(bi),this.onImageLoaded=new wr,this.onComplete=new wr,this.onError=new wr,this.count=0,this.loading=!1,this.toLoad=null,this.createTextures=!1,null!=r&&this.onComplete.Add(r,this,!0),null!=e&&this.Load(e,n)}var e,n,r;return e=t,(n=[{key:"Load",value:function(t,e){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),null!=e&&(this.createTextures=e),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))}},{key:"Haul",value:function(t){var e=this.toLoad[t];if(null!=e){var n=new Image;n.onload=this.OnLoad.bind(this),n.onerror=this.OnError.bind(this),n.src=e.src,n.id=e.id,n.data=Object.create(null),n.data.w=e.w,n.data.h=e.h,n.data.fw=e.fw,n.data.fh=e.fh}else this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{imageCache:this.imageCache,basicTextureCache:this.basicTextureCache})}},{key:"OnLoad",value:function(t){var e=t.currentTarget;e.onload=null,e.onerror=null,this.imageCache.StoreSafe(e),!0===this.createTextures&&this.basicTextureCache.StoreSafe(new bi(e,null,e.data.w,e.data.h,e.data.fw,e.data.fh)),this.onImageLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count)}},{key:"OnError",value:function(t){this.onError.Dispatch(null,t)}},{key:"GetImageById",value:function(t){return this.imageCache.GetById(t)}},{key:"GetBasicTextureById",value:function(t){return this.basicTextureCache.GetById(t)}}])&&gi(e.prototype,n),r&&gi(e,r),t}();function Ai(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Si=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.XHRcache=new yi(XMLHttpRequest),this.dataCache=new yi,this.onXHRLoaded=new wr,this.onComplete=new wr,this.onNetworkError=new wr,this.onLoadError=new wr,this.count=0,this.loading=!1,this.toLoad=null,null!=n&&this.onComplete.Add(n,this,!0),null!=e&&this.Load(e)}var e,n,r;return e=t,(n=[{key:"Load",value:function(t){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))}},{key:"Haul",value:function(t){var e=this.toLoad[t];if(null!=e){var n=new XMLHttpRequest;switch(n.open("GET",e.src),e.type){case"json":n.onreadystatechange=this.OnLoadJSON.bind(this);break;default:n.onreadystatechange=this.OnLoadXML.bind(this)}n.onerror=this.OnNetworkError.bind(this),null!=n.data?n.data.id=e.id:n.data={id:e.id},n.send()}else this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{XHRcache:this.XHRcache,dataCache:this.dataCache})}},{key:"OnLoadXML",value:function(t){var e=t.currentTarget;200!==e.status&&null==e.responseText||4!==e.readyState?404!==e.status&&500!==e.status&&0!==e.status||this.onLoadError.Dispatch(e):(e.onload=null,e.onerror=null,this.XHRcache.StoreSafe(e),this.dataCache.Store({id:e.data.id,data:W(e.responseText,!0)}),this.onXHRLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count),e.abort())}},{key:"OnLoadJSON",value:function(t){var e=t.currentTarget;200!==e.status&&null==e.responseText||4!==e.readyState?404!==e.status&&500!==e.status&&0!==e.status||this.onLoadError.Dispatch(e):(e.onload=null,e.onerror=null,this.XHRcache.StoreSafe(e),this.dataCache.Store({id:e.data.id,data:JSON.parse(e.responseText)}),this.onXHRLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count),e.abort())}},{key:"OnNetworkError",value:function(t){this.onNetworkError.Dispatch(null,t)}},{key:"GetXHRById",value:function(t){return this.XHRcache.GetById(t)}},{key:"GetDataById",value:function(t){return this.dataCache.GetById(t).data}},{key:"GetClonedDataById",value:function(t){return Object(B.DeepClone)(this.GetDataById(t))}}])&&Ai(e.prototype,n),r&&Ai(e,r),t}();function Ci(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ti=function(){function t(e,n,r,i,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rate=o,this.timer=o,this.x=e,this.y=n,this.w=r,this.h=i,this.id=null,null!=a&&(this.id=a)}var e,n,r;return e=t,(n=[{key:"Process",value:function(){return this.timer--<=0&&(this.Reset(),!0)}},{key:"Apply",value:function(t){t.ClipReconfigure(this.x,this.y,this.w,this.h)}},{key:"FullApply",value:function(t){this.Apply(t),t.w=this.w,t.h=this.h,t.scale.SetSame(1)}},{key:"Reset",value:function(){this.timer=this.rate}}])&&Ci(e.prototype,n),r&&Ci(e,r),t}();function xi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Pi=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.id,this.basicTexture=e,this.data=n,this.frameCache=new yi(Ti)}var e,n,r;return e=t,(n=[{key:"GenerateFrames",value:function(){for(var t,e,n,r=this.data,i=r.frames,o=r.meta.frameTags,a=0;a<i.length;++a)e=(t=i[a]).frame,n=o[a],this.frameCache.Store(new Ti(e.x,e.y,e.w,e.h,t.duration,n?n.name:i[a].filename))}},{key:"GetFrameById",value:function(t){return this.frameCache.GetById(t)}}])&&xi(e.prototype,n),r&&xi(e,r),t}();function Ei(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _i=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.spritesheetCache=new yi(Pi),this.xhrLoader=new Si,this.imageLoader=new wi,this.onComplete=new wr,this.onSpritesheetLoaded=new wr,this.count=0,this.loading=!1,this.toLoad=null,this.pairCount=0,this.tempBasicTexture=null,this.tempData=null,this.xhrLoader.onXHRLoaded.Add(this.OnPartXHRLoaded,this),this.imageLoader.onImageLoaded.Add(this.OnPartImageLoaded,this),null!=n&&this.onComplete.Add(n,this,!0),null!=e&&this.Load(e)}var e,n,r;return e=t,(n=[{key:"Load",value:function(t){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))}},{key:"Haul",value:function(t){var e=this.toLoad[t];null!=e?(e.data.id=e.image.id=e.id,this.xhrLoader.Load([e.data]),this.imageLoader.Load([e.image],!0)):(this.count=0,this.loading=!1,this.toLoad=null,this.tempBasicTexture=null,this.tempData=null,this.xhrLoader.onXHRLoaded.Dump(),this.imageLoader.onImageLoaded.Dump(),this.onComplete.Dispatch(this,{spritesheetCache:this.spritesheetCache}))}},{key:"OnPartLoaded",value:function(){if(2==++this.pairCount){var t=new Pi(this.tempBasicTexture,this.tempData);this.spritesheetCache.StoreSafe(t),this.pairCount=0,this.onSpritesheetLoaded.Dispatch(t,{count:this.count}),this.Haul(++this.count)}}},{key:"OnPartXHRLoaded",value:function(t){this.tempData=this.xhrLoader.GetDataById(t.target.data.id),this.OnPartLoaded()}},{key:"OnPartImageLoaded",value:function(t){this.tempBasicTexture=this.imageLoader.GetBasicTextureById(t.target.id),this.OnPartLoaded()}},{key:"GetSpritesheetById",value:function(t){return this.spritesheetCache.GetById(t)}}])&&Ei(e.prototype,n),r&&Ei(e,r),t}();var Oi=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.id,this.basicTexture=e,this.data=n};function Ri(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Di=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tilesetCache=new yi(Oi),this.xhrLoader=new Si,this.imageLoader=new wi,this.onComplete=new wr,this.onTilesetLoaded=new wr,this.count=0,this.loading=!1,this.toLoad=null,this.pairCount=0,this.tempBasicTexture=null,this.tempData=null,this.xhrLoader.onXHRLoaded.Add(this.OnPartXHRLoaded,this),this.imageLoader.onImageLoaded.Add(this.OnPartImageLoaded,this),null!=n&&this.onComplete.Add(n,this,!0),null!=e&&this.Load(e)}var e,n,r;return e=t,(n=[{key:"Load",value:function(t){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))}},{key:"Haul",value:function(t){var e=this.toLoad[t];null!=e?(e.data.id=e.image.id=e.id,this.xhrLoader.Load([e.data]),this.imageLoader.Load([e.image],!0)):(this.count=0,this.loading=!1,this.toLoad=null,this.tempBasicTexture=null,this.tempData=null,this.xhrLoader.onXHRLoaded.Dump(),this.imageLoader.onImageLoaded.Dump(),this.onComplete.Dispatch(this,{tilesetCache:this.tilesetCache}))}},{key:"OnPartLoaded",value:function(){if(2==++this.pairCount){var t=new Oi(this.tempBasicTexture,this.tempData);this.tilesetCache.StoreSafe(t),this.pairCount=0,this.onTilesetLoaded.Dispatch(t,{count:this.count}),this.Haul(++this.count)}}},{key:"OnPartXHRLoaded",value:function(t){this.tempData=this.xhrLoader.GetDataById(t.target.data.id),this.OnPartLoaded()}},{key:"OnPartImageLoaded",value:function(t){this.tempBasicTexture=this.imageLoader.GetBasicTextureById(t.target.id),this.OnPartLoaded()}},{key:"GetTilesetById",value:function(t){return this.tilesetCache.GetById(t)}}])&&Ri(e.prototype,n),r&&Ri(e,r),t}();function ki(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ii=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.loaders=e,this.count=0,this.onComplete=new wr}var e,n,r;return e=t,(n=[{key:"Load",value:function(){for(var t=this.loaders,e=t[0],n=0;n<t.length;e=t[++n])e.loader.onComplete.Add(this.OnLoaderComplete,this,!0),e.loader.Load.apply(e.loader,e.args)}},{key:"OnLoaderComplete",value:function(){if(++this.count===this.loaders.length){for(var t=this.loaders,e=t[0],n=0;n<t.length;e=t[++n])t[n]=e.loader;this.onComplete.Dispatch()}}}])&&ki(e.prototype,n),r&&ki(e,r),t}();function Li(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Bi=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.data={},this.program=null,this.attributes=null,this.uniforms=null,null!=e&&null!=n&&this.Init(n.vertex,n.fragment)}var e,n,r;return e=t,r=[{key:"LAST_USED_CONTROLLER",get:function(){return ji},set:function(t){ji=t}}],(n=[{key:"Init",value:function(t,e){var n=this.gl,r=this.CreateShader(t,n.VERTEX_SHADER),i=this.CreateShader(e,n.FRAGMENT_SHADER),o=this.program=n.createProgram();if(n.attachShader(o,r),n.attachShader(o,i),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS)){var a=n.getProgramInfoLog(o);throw new Error("Program link failed:"+a)}n.detachShader(o,r),n.detachShader(o,i),n.deleteShader(r),n.deleteShader(i),this.attributes={},this.uniforms={}}},{key:"CreateShader",value:function(t,e){var n=this.gl,r=n.createShader(e);if(n.shaderSource(r,t),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS)){var i=n.getShaderInfoLog(r);throw new Error("Shader compilation failed:"+i)}return r}},{key:"AssignAttribute",value:function(t){this.attributes[t]=this.gl.getAttribLocation(this.program,t)}},{key:"AssignUniform",value:function(t){this.uniforms[t]=this.gl.getUniformLocation(this.program,t)}},{key:"Execute",value:function(){}}])&&Li(e.prototype,n),r&&Li(e,r),t}(),ji=null;function Gi(t){return(Gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ni(t,e){return!e||"object"!==Gi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fi(t){return(Fi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mi(t,e){return(Mi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ui=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ni(this,Fi(e).call(this,t,oi))).essenceBuffer=null,n.vertices=null,n.fillColor=null,n.outlineColor=null,n.outline=5,n.Initialise(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mi(t,e)}(e,Bi),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array(Object(j.TriRectArray)(0,0,1,1)),this.fillColor=new sr,this.outlineColor=new sr,t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uFillColor"),this.AssignUniform("uOutlineColor"),this.AssignUniform("uRadius"),this.AssignUniform("uOutline")}},{key:"Execute",value:function(t,e,n,r){var i=this.gl,o=this.attributes,a=this.uniforms,s=this.vertices,u=this.fillColor.channel,l=this.outlineColor.channel;Object(j.TriRectArray)(e-r,n-r,2*r,2*r,s),this!==Bi.LAST_USED_CONTROLLER&&(i.useProgram(this.program),Bi.LAST_USED_CONTROLLER=this),i.bindBuffer(i.ARRAY_BUFFER,this.essenceBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,s),i.enableVertexAttribArray(o.aPosition),i.vertexAttribPointer(o.aPosition,2,i.FLOAT,!1,0,0),i.uniformMatrix3fv(a.uProjection,!1,t),i.uniform4f(a.uFillColor,u[0],u[1],u[2],u[3]),i.uniform4f(a.uOutlineColor,l[0],l[1],l[2],l[3]),i.uniform1f(a.uOutline,this.outline),i.uniform1f(a.uRadius,r),i.drawArrays(i.TRIANGLE_STRIP,0,6)}}])&&Vi(n.prototype,r),i&&Vi(n,i),e}();function Xi(t){return(Xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yi(t,e){return!e||"object"!==Xi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wi(t){return(Wi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qi(t,e){return(qi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zi=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Yi(this,Wi(e).call(this,t,ai))).essenceBuffer=null,n.vertices=null,n.color=null,n.Initialise(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qi(t,e)}(e,Bi),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array([-1,0,1,0]),this.color=new sr,t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uColor")}},{key:"Execute",value:function(t,e,n){var r=this.gl,i=this.attributes,o=this.uniforms,a=this.vertices,s=this.color.channel;a[0]=e.x,a[1]=e.y,a[2]=n.x,a[3]=n.y,this!==Bi.LAST_USED_CONTROLLER&&(r.useProgram(this.program),Bi.LAST_USED_CONTROLLER=this),r.bindBuffer(r.ARRAY_BUFFER,this.essenceBuffer),r.bufferSubData(r.ARRAY_BUFFER,0,a),r.enableVertexAttribArray(i.aPosition),r.vertexAttribPointer(i.aPosition,2,r.FLOAT,!1,0,0),r.uniformMatrix3fv(o.uProjection,!1,t),r.uniform4f(o.uColor,s[0],s[1],s[2],s[3]),r.drawArrays(r.LINES,0,2)}}])&&Hi(n.prototype,r),i&&Hi(n,i),e}();function Ki(t){return(Ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ji(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qi(t,e){return!e||"object"!==Ki(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $i(t){return($i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zi(t,e){return(Zi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var to=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Qi(this,$i(e).call(this,t,ri))).dataBuffer=null,n.previousNumberOfElements=0,n.Initialise(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zi(t,e)}(e,Bi),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.dataBuffer=t.createBuffer(),this.AssignAttribute("aProjection1"),this.AssignAttribute("aProjection2"),this.AssignAttribute("aProjection3"),this.AssignAttribute("aPosition"),this.AssignAttribute("aColor"),this.AssignAttribute("aPointSize")}},{key:"Execute",value:function(t,e){var n=this.gl,r=this.attributes;Bi.LAST_USED_CONTROLLER!==this&&(n.useProgram(this.program),Bi.LAST_USED_CONTROLLER=this),n.bindBuffer(n.ARRAY_BUFFER,this.dataBuffer),e!==this.previousNumberOfElements?n.bufferData(n.ARRAY_BUFFER,t,n.DYNAMIC_DRAW):n.bufferSubData(n.ARRAY_BUFFER,0,t);n.enableVertexAttribArray(r.aProjection1),n.vertexAttribPointer(r.aProjection1,3,n.FLOAT,!1,64,0),n.enableVertexAttribArray(r.aProjection2),n.vertexAttribPointer(r.aProjection2,3,n.FLOAT,!1,64,12),n.enableVertexAttribArray(r.aProjection3),n.vertexAttribPointer(r.aProjection3,3,n.FLOAT,!1,64,24),n.enableVertexAttribArray(r.aPosition),n.vertexAttribPointer(r.aPosition,2,n.FLOAT,!1,64,36),n.enableVertexAttribArray(r.aColor),n.vertexAttribPointer(r.aColor,4,n.FLOAT,!1,64,44),n.enableVertexAttribArray(r.aPointSize),n.vertexAttribPointer(r.aPointSize,1,n.FLOAT,!1,64,60),n.drawArrays(n.POINTS,0,e),this.previousNumberOfElements=e}}])&&Ji(n.prototype,r),i&&Ji(n,i),e}();function eo(t){return(eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function no(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ro(t,e){return!e||"object"!==eo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function io(t){return(io=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oo(t,e){return(oo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ao=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ro(this,io(e).call(this,t,ii))).essenceBuffer=null,n.vertices=null,n.fillColor=null,n.outlineColor=null,n.outline=5,n.Initialise(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oo(t,e)}(e,Bi),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array(Object(j.TriRectArray)(0,0,1,1)),this.fillColor=new sr,this.outlineColor=new sr,t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uFillColor"),this.AssignUniform("uOutlineColor"),this.AssignUniform("uSize"),this.AssignUniform("uOutline")}},{key:"Execute",value:function(t,e,n,r,i){var o=this.gl,a=this.attributes,s=this.uniforms,u=this.vertices,l=this.fillColor.channel,c=this.outlineColor.channel;Object(j.TriRectArray)(e,n,r,i,u),this!==Bi.LAST_USED_CONTROLLER&&(o.useProgram(this.program),Bi.LAST_USED_CONTROLLER=this),o.bindBuffer(o.ARRAY_BUFFER,this.essenceBuffer),o.bufferSubData(o.ARRAY_BUFFER,0,u),o.enableVertexAttribArray(a.aPosition),o.vertexAttribPointer(a.aPosition,2,o.FLOAT,!1,0,0),o.uniformMatrix3fv(s.uProjection,!1,t),o.uniform4f(s.uFillColor,l[0],l[1],l[2],l[3]),o.uniform4f(s.uOutlineColor,c[0],c[1],c[2],c[3]),o.uniform1f(s.uOutline,this.outline),o.uniform2f(s.uSize,r,i),o.drawArrays(o.TRIANGLE_STRIP,0,6)}}])&&no(n.prototype,r),i&&no(n,i),e}();function so(t){return(so="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function lo(t,e){return!e||"object"!==so(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function co(t){return(co=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ho(t,e){return(ho=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fo=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=lo(this,co(e).call(this,t,ni))).originalTexture=null,n.texture=null,n.essenceBuffer=null,n.dataBuffer=null,n.indexBuffer=null,n.previousNumberOfElements=0,n.Initialise(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ho(t,e)}(e,Bi),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.texture=t.createTexture(),this.essenceBuffer=t.createBuffer(),this.dataBuffer=t.createBuffer(),this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignAttribute("aProjection1"),this.AssignAttribute("aProjection2"),this.AssignAttribute("aProjection3"),this.AssignAttribute("aTranslation1"),this.AssignAttribute("aTranslation2"),this.AssignAttribute("aTranslation3"),this.AssignAttribute("aTransformation1"),this.AssignAttribute("aTransformation2"),this.AssignAttribute("aTransformation3"),this.AssignUniform("uImage")}},{key:"BindBasicTexture",value:function(t,e){var n=this.gl,r=Object(j.TriRectArray)(0,0,t.w,t.h);e=null!=e?e:n.LINEAR,this.aia=n.getExtension("ANGLE_instanced_arrays"),this.originalTexture=t,r.push.apply(r,Object(j.TriRectArray)(0,0,1,1)),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t.image),n.bindBuffer(n.ARRAY_BUFFER,this.essenceBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(r),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindTexture(n.TEXTURE_2D,null)}},{key:"Execute",value:function(t,e){var n=this.gl,r=this.aia,i=this.attributes,o=this.uniforms;this!==Bi.LAST_USED_CONTROLLER&&(n.useProgram(this.program),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.texture),n.uniform1i(o.uImage,0),n.bindBuffer(n.ARRAY_BUFFER,this.essenceBuffer),n.enableVertexAttribArray(i.aPosition),n.vertexAttribPointer(i.aPosition,2,n.FLOAT,!1,0,0),r.vertexAttribDivisorANGLE(i.aPosition,0),n.enableVertexAttribArray(i.aTexCoord),n.vertexAttribPointer(i.aTexCoord,2,n.FLOAT,!1,0,48),r.vertexAttribDivisorANGLE(i.aTexCoord,0),Bi.LAST_USED_CONTROLLER=this),n.bindBuffer(n.ARRAY_BUFFER,this.dataBuffer),e!==this.previousNumberOfElements?n.bufferData(n.ARRAY_BUFFER,t,n.DYNAMIC_DRAW):n.bufferSubData(n.ARRAY_BUFFER,0,t),n.enableVertexAttribArray(i.aProjection1),n.vertexAttribPointer(i.aProjection1,3,n.FLOAT,!1,108,0),r.vertexAttribDivisorANGLE(i.aProjection1,1),n.enableVertexAttribArray(i.aProjection2),n.vertexAttribPointer(i.aProjection2,3,n.FLOAT,!1,108,12),r.vertexAttribDivisorANGLE(i.aProjection2,1),n.enableVertexAttribArray(i.aProjection3),n.vertexAttribPointer(i.aProjection3,3,n.FLOAT,!1,108,24),r.vertexAttribDivisorANGLE(i.aProjection3,1),n.enableVertexAttribArray(i.aTranslation1),n.vertexAttribPointer(i.aTranslation1,3,n.FLOAT,!1,108,36),r.vertexAttribDivisorANGLE(i.aTranslation1,1),n.enableVertexAttribArray(i.aTranslation2),n.vertexAttribPointer(i.aTranslation2,3,n.FLOAT,!1,108,48),r.vertexAttribDivisorANGLE(i.aTranslation2,1),n.enableVertexAttribArray(i.aTranslation3),n.vertexAttribPointer(i.aTranslation3,3,n.FLOAT,!1,108,60),r.vertexAttribDivisorANGLE(i.aTranslation3,1),n.enableVertexAttribArray(i.aTransformation1),n.vertexAttribPointer(i.aTransformation1,3,n.FLOAT,!1,108,72),r.vertexAttribDivisorANGLE(i.aTransformation1,1),n.enableVertexAttribArray(i.aTransformation2),n.vertexAttribPointer(i.aTransformation2,3,n.FLOAT,!1,108,84),r.vertexAttribDivisorANGLE(i.aTransformation2,1),n.enableVertexAttribArray(i.aTransformation3),n.vertexAttribPointer(i.aTransformation3,3,n.FLOAT,!1,108,96),r.vertexAttribDivisorANGLE(i.aTransformation3,1),r.drawArraysInstancedANGLE(n.TRIANGLE_STRIP,0,6,e)}}])&&uo(n.prototype,r),i&&uo(n,i),e}();function po(t){return(po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vo(t,e){return!e||"object"!==po(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mo(t){return(mo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bo(t,e){return(bo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var go=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=vo(this,mo(e).call(this,t,ei))).originalTexture=null,n.texture=null,n.essenceBuffer=null,n.Initialise(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bo(t,e)}(e,Bi),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.texture=t.createTexture(),this.essenceBuffer=t.createBuffer(),this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignUniform("uImage"),this.AssignUniform("uProjection"),this.AssignUniform("uTranslation"),this.AssignUniform("uTransformation"),this.AssignUniform("uTint")}},{key:"BindBasicTexture",value:function(t,e){var n=this.gl,r=Object(j.TriRectArray)(0,0,t.w,t.h);e=null!=e?e:n.LINEAR,this.originalTexture=t,r.push.apply(r,Object(j.TriRectArray)(0,0,1,1)),n.bindTexture(n.TEXTURE_2D,this.texture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t.image),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e),n.bindBuffer(n.ARRAY_BUFFER,this.essenceBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(r),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindTexture(n.TEXTURE_2D,null)}},{key:"Execute",value:function(t,e,n,r){var i=this.gl,o=this.attributes,a=this.uniforms;this!==Bi.LAST_USED_CONTROLLER&&(i.useProgram(this.program),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.texture),i.bindBuffer(i.ARRAY_BUFFER,this.essenceBuffer),i.enableVertexAttribArray(o.aPosition),i.vertexAttribPointer(o.aPosition,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(o.aTexCoord),i.vertexAttribPointer(o.aTexCoord,2,i.FLOAT,!1,0,48),i.uniform1i(a.uImage,0),Bi.LAST_USED_CONTROLLER=this),i.uniform4fv(a.uTint,r),i.uniformMatrix3fv(a.uProjection,!1,t),i.uniformMatrix3fv(a.uTranslation,!1,e),i.uniformMatrix3fv(a.uTransformation,!1,n),i.drawArrays(i.TRIANGLE_STRIP,0,6)}}])&&yo(n.prototype,r),i&&yo(n,i),e}();function wo(t){return(wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ao(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function So(t,e){return!e||"object"!==wo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Co(t){return(Co=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function To(t,e){return(To=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xo=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),.5*t.getParameter(t.MAX_VERTEX_ATTRIBS)<n&&console.error(.5*t.getParameter(t.MAX_VERTEX_ATTRIBS),"MAX"),(r=So(this,Co(e).call(this,t,fi(n)))).units=n,r.originalTextures=[],r.textures=[],r.essenceBuffers=[],r.lastUsedUnit=0,r.Initialise(),r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&To(t,e)}(e,Bi),n=e,(r=[{key:"Initialise",value:function(){for(var t=0;t<this.units;++t)this.AssignAttribute("aPosition"+t),this.AssignAttribute("aTexCoord"+t);this.AssignUniform("uImage"),this.AssignUniform("uUnitId"),this.AssignUniform("uProjection"),this.AssignUniform("uTranslation"),this.AssignUniform("uTransformation"),this.AssignUniform("uTint")}},{key:"BindBasicTexture",value:function(t,e,n){var r=this.gl,i=Object(j.TriRectArray)(0,0,t.w,t.h);null==e&&(e=0),n=null!=n?n:r.LINEAR,t.uniformId=e,this.originalTextures[e]=t,this.textures[e]=r.createTexture(),this.essenceBuffers[e]=r.createBuffer(),i.push.apply(i,Object(j.TriRectArray)(0,0,1,1)),r.bindTexture(r.TEXTURE_2D,this.textures[e]),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t.image),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n),r.bindBuffer(r.ARRAY_BUFFER,this.essenceBuffers[e]),r.bufferData(r.ARRAY_BUFFER,new Float32Array(i),r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,null),r.bindTexture(r.TEXTURE_2D,null)}},{key:"BindUnit",value:function(t,e,n,r){null!=this.textures[r]&&(t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,this.textures[r]),t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffers[r]),t.enableVertexAttribArray(n["aPosition"+r]),t.vertexAttribPointer(n["aPosition"+r],2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(n["aTexCoord"+r]),t.vertexAttribPointer(n["aTexCoord"+r],2,t.FLOAT,!1,0,48))}},{key:"Execute",value:function(t,e,n,r,i){var o=this.gl,a=this.attributes,s=this.uniforms;if(this!==Bi.LAST_USED_CONTROLLER){o.useProgram(this.program);for(var u=0;u<this.units;++u)this.BindUnit(o,s,a,u);o.uniform1i(s.uUnitId,i),o.uniform1i(s.uImage,i),Bi.LAST_USED_CONTROLLER=this,this.lastUsedUnit=i}else i!==this.lastUsedUnit&&(o.uniform1i(s.uUnitId,i),o.uniform1i(s.uImage,i),this.lastUsedUnit=i);o.uniform4fv(s.uTint,r),o.uniformMatrix3fv(s.uProjection,!1,t),o.uniformMatrix3fv(s.uTranslation,!1,e),o.uniformMatrix3fv(s.uTransformation,!1,n),o.drawArrays(o.TRIANGLE_STRIP,0,6)}}])&&Ao(n.prototype,r),i&&Ao(n,i),e}();function Po(t){return(Po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Eo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _o(t,e){return!e||"object"!==Po(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Oo(t){return(Oo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ro(t,e){return(Ro=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Do=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=_o(this,Oo(e).call(this,t,n))).essenceBuffer=null,r.vertices=null,r.Initialise(),r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ro(t,e)}(e,Bi),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array(Object(j.TriRectArray)(0,0,1,1)),t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("a_v2Position"),this.AssignUniform("u_m3Projection"),this.AssignUniform("u_fTime"),this.AssignUniform("u_v2Resolution")}},{key:"Execute",value:function(t,e,n,r,i,o){var a=this.gl,s=this.attributes,u=this.uniforms,l=this.vertices;Object(j.TriRectArray)(e,n,r,i,l),this!==Bi.LAST_USED_CONTROLLER&&(a.useProgram(this.program),Bi.LAST_USED_CONTROLLER=this),a.bindBuffer(a.ARRAY_BUFFER,this.essenceBuffer),a.bufferSubData(a.ARRAY_BUFFER,0,l),a.enableVertexAttribArray(s.a_v2Position),a.vertexAttribPointer(s.a_v2Position,2,a.FLOAT,!1,0,0),a.uniformMatrix3fv(u.u_m3Projection,!1,t),a.uniform2f(u.u_v2Resolution,r,i),a.uniform1f(u.u_fTime,o),a.drawArrays(a.TRIANGLE_STRIP,0,6)}}])&&Eo(n.prototype,r),i&&Eo(n,i),e}();function ko(t){return(ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Io(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Lo(t,e){return!e||"object"!==ko(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bo(t){return(Bo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jo(t,e){return(jo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Go=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Lo(this,Bo(e).call(this,t,n))).essenceBuffer=null,r.frameBuffer=null,r.renderBuffer=null,r.texture=null,r.w=0,r.h=0,r.Initialise(),r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jo(t,e)}(e,Bi),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.frameBuffer=t.createFramebuffer(),this.renderBuffer=t.createRenderbuffer(),this.texture=t.createTexture(),this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignUniform("uImage")}},{key:"Config",value:function(t,e,n){this.w=t,this.h=e;var r=this.gl,i=Object(j.TriRectArray)(-1,-1,2,2);n=null!=n?n:r.LINEAR,i.push.apply(i,Object(j.TriRectArray)(0,0,1,1)),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.w,this.h,0,r.RGBA,r.UNSIGNED_BYTE,null),r.bindRenderbuffer(r.RENDERBUFFER,this.renderBuffer),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,this.w,this.h),r.bindFramebuffer(r.FRAMEBUFFER,this.frameBuffer),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,this.texture,0),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,this.renderBuffer),r.bindBuffer(r.ARRAY_BUFFER,this.essenceBuffer),r.bufferData(r.ARRAY_BUFFER,new Float32Array(i),r.STATIC_DRAW),r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindRenderbuffer(r.RENDERBUFFER,null)}},{key:"Execute",value:function(){var t=this.gl,e=this.attributes;this!==Bi.LAST_USED_CONTROLLER&&(t.useProgram(this.program),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.texture),t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.enableVertexAttribArray(e.aPosition),t.vertexAttribPointer(e.aPosition,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(e.aTexCoord),t.vertexAttribPointer(e.aTexCoord,2,t.FLOAT,!1,0,48),t.uniform1i(this.uniforms.uImage,0),Bi.LAST_USED_CONTROLLER=this),t.drawArrays(t.TRIANGLE_STRIP,0,6)}}])&&Io(n.prototype,r),i&&Io(n,i),e}();function Vo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var No=function(){function t(e,n,r,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.split(" "),this.handle=n,this.info=r,this.priority=i,this.breakIfExecuted=!!o,this.data={},this.command=null}var e,n,r;return e=t,(n=[{key:"Execute",value:function(t,e,n){return this.handle(t,e,n),this.breakIfExecuted}}])&&Vo(e.prototype,n),r&&Vo(e,r),t}();function Fo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Mo=function(){function t(e,n,r,i,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.split(" "),this.handle=n,this.info=r,this.data={},this.options=null,this.registry=null,this.optionPrefix=null==a?Uo:a,this.dataSeparator="=",this.allOptionIds=null,this.fullInfo=null,this.continueToPrime=!!i,this.filterNull=!!o,this.jsonPrefix="(JSON)"}var e,n,r;return e=t,r=[{key:"OPTION_PREFIX",get:function(){return Uo},set:function(t){Uo=t}}],(n=[{key:"Execute",value:function(t,e,n){this.HandleData(t,e),!0===this.filterNull&&(t=t.filter(Ho)),!0===this.HandleOptions(t,e,n)&&this.handle(t,e,n)}},{key:"AddOption",value:function(t,e,n,r,i,o){null!=(o=null==o?this.optionPrefix:o)&&(t=t.replace(/\S+/g,o+"$&")),null==this.options&&(this.options=[]),r=null==r?0:r;var a=this.options,s=a[0],u=new No(t,e,n,r,i);u.command=this;for(var l=0;l<a.length;s=a[++l])if(s.priority<=r)return a.splice(l,0,u),this.allOptionIds=this.GetAllOptionIds(),this;return this.options.push(u),this.allOptionIds=this.GetAllOptionIds(),this}},{key:"HandleData",value:function(t,e){var n,r=this.dataSeparator,i=Xo,o=this.jsonPrefix,a=o.length;i.push.apply(i,t);for(var s=i[0],u=0;u<i.length;s=i[++u])2===(n=s.split(r)).length&&(t[u]=null,n[0].substring(0,a)===o?e[n[0].substring(a)]=JSON.parse(n[1]):e[n[0]]=n[1]);i.length=0}},{key:"HandleOptions",value:function(t,e,n){if(0===t.length)return this.continueToPrime;var r=this.GetAndRemoveMatchingOptionIds(t);if(null==r)return this.continueToPrime;for(var i=0;i<r.length;++i)if(!0===this.GetOptionById(r[i]).Execute(t,e,n))return!1;return this.continueToPrime}},{key:"GetOptionById",value:function(t){for(var e=this.options,n=e[0],r=0;r<e.length;n=e[++r])if(-1!==n.id.indexOf(t))return n;return null}},{key:"GetAllOptionIds",value:function(){for(var t=this.options,e=[],n=0;n<t.length;++n)e.push.apply(e,t[n].id);return e}},{key:"GetAndRemoveMatchingOptionIds",value:function(t){var e,n=this.allOptionIds;if(null==n)return null;for(var r=[],i=0;i<n.length;++i)-1!==(e=t.indexOf(n[i]))&&r.push(t.fickleSplice(e));return r}},{key:"GenerateInfoString",value:function(){for(var t="COMMAND: "+this.id.join(", ")+" -> "+this.info+"\n",e=this.options,n=e[0],r=0;r<e.length;n=e[++r])t+="OPTION: "+n.id.join(", ")+" -> "+n.info+"\n";return t}}])&&Fo(e.prototype,n),r&&Fo(e,r),t}(),Uo="",Xo=[],Ho=function(t){return null!=t};function Yo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Wo=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.commands=[],this.splitter=" "}var e,n,r;return e=t,(n=[{key:"AddCommand",value:function(t){if(null==t.registry)return this.commands.push(t),t.registry=this,t}},{key:"RemoveCommand",value:function(t){var e=this.commands,n=e.indexOf(t);if(-1!==n)return t.registry=null,e.fickleSplice(n)}},{key:"GetCommandById",value:function(t){for(var e=this.commands,n=e[0],r=0;r<e.length;n=e[++r])if(n)for(var i=0;i<n.id.length;++i)if(n.id[i]===t)return n;return null}},{key:"Parse",value:function(t,e){var n=String(t).split(this.splitter),r=n.shift(),i=this.GetCommandById(r);return i?(i.Execute(n,{},e),null):r}}])&&Yo(e.prototype,n),r&&Yo(e,r),t}();function qo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var zo=function(){function t(e,n,r,i,a,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.target=n,this.propertyString=r,this.value=i,this.duration=a,this.easing=o[null==s?Ko:s],this.time=0,this.startValue=0,this.change=0,this.property=null,this.properyObject=null,this.running=!1,this.onStart=new wr,this.onEnd=new wr,this.onStop=new wr,this.onReconfigure=new wr,this.onReset=new wr}var e,n,r;return e=t,(n=[{key:"Start",value:function(){var t=this.propertyString.split(".");this.property=t[t.length-1],this.propertyObject=Object(B.Nested)(this.target,this.propertyString,!0),this.startValue=this.propertyObject[this.property],this.change=this.value-this.startValue,this.time=0,this.running=!0,this.onStart.Dispatch(this,null)}},{key:"Stop",value:function(){this.property=null,this.propertyObject=null,this.startValue=0,this.change=0,this.time=0,this.running=!1,this.onStop.Dispatch(this,null)}},{key:"Process",value:function(){!0===this.running&&(this.propertyObject[this.property]=this.easing(this.time,this.startValue,this.change,this.duration),++this.time>=this.duration&&(this.running=!1,this.propertyObject[this.property]=this.value,this.onEnd.Dispatch(this,null)))}},{key:"Reconfigure",value:function(t,e,n,r){null!=t&&(this.propertyString=t),this.value=e,this.duration=n,this.easing=o[null==r?Ko:r],this.onReconfigure.Dispatch(this,null)}},{key:"NewValue",value:function(t){this.value=t,this.Start()}},{key:"Reset",value:function(){if(null==this.propertyObject||null==this.property)return!1;this.propertyObject[this.property]=this.startValue,this.property=null,this.propertyObject=null,this.startValue=0,this.change=0,this.time=0,this.running=!1,this.onReset.Dispatch(this,null)}}])&&qo(e.prototype,n),r&&qo(e,r),t}(),Ko="Linear";function Jo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Qo=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.motions=[],this.target=e}var e,n,r;return e=t,(n=[{key:"Create",value:function(t,e,n,r,i){if(null==this.GetMotionById(t)){var o=new zo(t,this.target,e,n,r,i);return this.motions.push(o),o}return null}},{key:"Add",value:function(t){null==this.GetMotionById(t.id)&&this.motions.push(t)}},{key:"Start",value:function(t){var e=this.GetMotionById(t);return null!==e&&e.Start(),e}},{key:"StartMultiple",value:function(t){t=t.split(" ");for(var e=0;e<t.length;++e)this.Start(t[e])}},{key:"Stop",value:function(t){var e=this.GetMotionById(t);return null!==e&&e.Stop(),e}},{key:"StopMultiple",value:function(t){t=t.split(" ");for(var e=0;e<t.length;++e)this.Stop(t[e])}},{key:"Reset",value:function(t){var e=this.GetMotionByid(t);return null!==e&&e.Reset(),e}},{key:"ResetMultiple",value:function(t){t=t.split(" ");for(var e=0;e<t.length;++e)this.Reset(t[e])}},{key:"Process",value:function(){for(var t=this.motions,e=0;e<t.length;++e)t[e].Process()}},{key:"GetMotionById",value:function(t){for(var e=this.motions,n=0;n<e.length;++n)if(e[n].id===t)return e[n];return null}}])&&Jo(e.prototype,n),r&&Jo(e,r),t}(),$o=n(6);function Zo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ta(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ea(t,e,n){return e&&ta(t.prototype,e),n&&ta(t,n),t}var na=function(){function t(e,n,r){Zo(this,t),this.Set(e,n,r)}return ea(t,[{key:"Set",value:function(t,e,n){this.from=t,this.to=e,this.amplitude=n,this.active=!0}},{key:"Inactivate",value:function(){this.active=!1}}]),t}(),ra=function(){function t(){Zo(this,t),this.velocityX=null,this.velocityY=null,this.torque=null,this.accelerationX=null,this.accelerationY=null,this.spin=null,this.growthX=null,this.growthY=null,this.gravityX=null,this.gravityY=null,this.active=!0}return ea(t,[{key:"CreateOscillatingObject",value:function(t,e,n,r){if(null!==this[t])throw new Error("Invalid key");this[t]=new na(e,n,r)}},{key:"SetOscillatingObject",value:function(t,e,n,r){var i=this[t];if(null==i)return this.CreateOscillatingObject(t,e,n,r);i.Set(e,n,r)}},{key:"Nullify",value:function(t){null!=this[t]&&this[t].Inactivate()}}]),t}();function ia(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var oa=Math.cos,aa=Math.sin,sa=Math.atan2,ua=Math.sqrt,la=Math.abs,ca=Math.PI,ha=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.array=new Float32Array(9),this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}var e,n,r;return e=t,(n=[{key:"Identity",value:function(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}},{key:"Copy",value:function(){var e=new t;return e.Set(this.a,this.b,this.c,this.d,this.e,this.f),e}},{key:"Set",value:function(t,e,n,r,i,o){return this.a=t,this.b=e,this.c=n,this.d=r,this.e=i,this.f=o,this}},{key:"SetTransform",value:function(t,e,n,r,i,o,a,s,u){t=null==t?0:t,e=null==e?0:e,n=null==n?1:n,r=null==r?1:r,o=null==o?0:o,a=null==a?0:a,s=null==s?0:s,u=null==u?0:u;var l=aa(i=null==i?0:i),c=oa(i),h=-aa(o),f=oa(o),d=aa(a),p=oa(a),y=c*n,v=l*n,m=-l*r,b=c*r;return this.a=p*y+d*m,this.b=p*v+d*b,this.c=h*y+f*m,this.d=h*v+f*b,this.e=t+s*y+u*m,this.f=e+s*v+u*b,this}},{key:"Translate",value:function(t,e){this.e+=t,this.f+=e}},{key:"TranslateTo",value:function(t,e){this.e=t,this.f=e}},{key:"ApplyTranslation",value:function(t,e){this.e=t*this.a+e*this.c+this.e,this.f=t*this.b+e*this.d+this.f}},{key:"ApplyScale",value:function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e}},{key:"Scale",value:function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e}},{key:"Rotate",value:function(t){var e=Math.sin(t),n=Math.cos(t),r=this.a,i=this.c,o=this.e;this.a=r*n-this.b*e,this.b=r*e+this.b*n,this.c=i*n-this.d*e,this.d=i*e+this.d*n,this.e=o*n-this.f*e,this.f=o*e+this.f*n}},{key:"Decompose",value:function(t){var e=this.a,n=this.b,r=this.c,i=this.d,o=-sa(-r,i),a=sa(n,e);la(o+a)<fa?(t.rotation=a,e<0&&i>=0&&(t.rotation+=ca),t.skew.SetSame(0)):t.skew.Set(o,a),t.scale.Set(ua(e*e+n*n),ua(r*r+i*i)),t.position.Set(this.e,this.f)}},{key:"ApplyToContext",value:function(t){t.setTransform(this.a,this.b,this.c,this.d,this.e,this.f)}},{key:"AsArray",value:function(t){var e=this.array;return!0===t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.e,e[7]=this.f,e[8]=1):(e[0]=this.a,e[1]=this.c,e[2]=this.e,e[3]=this.b,e[4]=this.d,e[5]=this.f,e[6]=0,e[7]=0,e[8]=1),e}}])&&ia(e.prototype,n),r&&ia(e,r),t}(),fa=1e-5;function da(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var pa=Math.cos,ya=Math.sin,va=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.position=new ut.a(e,n),this.scale=new ut.a(1,1),this.skew=new ut.a(0,0),this.pivot=new ut.a(0,0),this.localTransform=new ha,this.globalTransform=new ha,this.rotation=0,this.skewCX=1,this.skewSX=0,this.skewCY=0,this.skewSY=1}var e,n,r;return e=t,(n=[{key:"SetMatrix",value:function(t){t.Decompose(this),this.UpdateSkew()}},{key:"UpdateLocal",value:function(){var t=this.localTransform,e=this.position,n=this.scale,r=this.pivot;t.a=this.skewCX*n.x,t.b=this.skewSX*n.x,t.c=this.skewCY*n.y,t.d=this.skewSY*n.y,t.e=e.x-r.x*t.a+r.y*t.c,t.f=e.y-r.y*t.b+r.y*t.d}},{key:"UpdateGlobal",value:function(t){var e=this.localTransform,n=this.globalTransform,r=this.position,i=this.scale,o=this.pivot;e.a=this.skewCX*i.x,e.b=this.skewSX*i.x,e.c=this.skewCY*i.y,e.d=this.skewSY*i.y,e.e=r.x-o.x*e.a+o.y*e.c,e.f=r.y-o.y*e.b+o.y*e.d,n.a=e.a*t.a+e.b*t.c,n.b=e.a*t.b+e.b*t.d,n.c=e.c*t.a+e.d*t.c,n.d=e.c*t.b+e.d*t.d,n.e=e.e*t.a+e.f*t.c+t.e,n.f=e.e*t.b+e.f*t.d+t.f}},{key:"UpdateSkew",value:function(){var t=this.skew,e=this.rotation;this.skewCX=pa(e+t.y),this.skewSX=ya(e+t.y),this.skewCY=-ya(e-t.x),this.skewSY=pa(e-t.x)}},{key:"ApplyGlobal",value:function(t){this.globalTransform.ApplyToContext(t)}}])&&da(e.prototype,n),r&&da(e,r),t}();function ma(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ba=Math.abs,ga=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.local=null,this.localDirty=!0,this.global=null,this.globalDirty=!0}var e,n,r;return e=t,(n=[{key:"ComputeLocal",value:function(t,e,n,r,i,o){return null!=i&&(t-=n*i.x,e-=r*i.y),null===this.local?(this.local=new ue(t,e,t+n,e+r),this.local.belongsTo=o):this.local.Set(t,e,t+n,e+r),this.localDirty=!1,this.local}},{key:"ComputeGlobal",value:function(t,e,n,r,i,o,a){return null!=a&&(t-=a.e,e-=a.f,t/=a.a,e/=a.d,n=ba(n/a.a),r=ba(r/a.d)),null!=i&&(t-=n*i.x,e-=r*i.y),null===this.global?(this.global=new ue(t,e,t+n,e+r),this.global.belongsTo=o):this.global.Set(t,e,t+n,e+r),this.globalDirty=!1,this.global}}])&&ma(e.prototype,n),r&&ma(e,r),t}();function wa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Aa=Math.abs,Sa=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.transform=new va(e,n),this.data={},this.w=0,this.h=0,this.bounds=new ga,this.globalPosition=null,this.transformShouldUpdate=!0,this.transformAutomaticUpdate=!0,this.render=!0,this.motionManager=null,this.__inside__=null}var e,n,r;return e=t,(n=[{key:"UpdateTransform",value:function(t){null!=t?this.transform.UpdateGlobal(t.transform.globalTransform):this.transform.UpdateGlobal(Ca.globalTransform)}},{key:"ProcessTransform",value:function(t){!0===this.transformShouldUpdate&&(this.UpdateTransform(t),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1))}},{key:"RequestTransformUpdate",value:function(){this.transformShouldUpdate=!0}},{key:"GetGlobalPosition",value:function(){var t=this.transform.globalTransform;return null===this.globalPosition?this.globalPosition=new ut.a(t.e,t.f):this.globalPosition.Set(t.e,t.f),this.globalPosition}},{key:"ComputeLocalBounds",value:function(t){return this.bounds.ComputeLocal(this.x,this.y,this.width,this.height,t,this)}},{key:"ComputeGlobalBounds",value:function(t,e){var n=this.transform.globalTransform;return this.bounds.ComputeGlobal(n.e,n.f,Aa(this.w*n.a),Aa(this.h*n.d),t,this,e)}},{key:"rotation",get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t,this.transform.UpdateSkew()}},{key:"scale",get:function(){return this.transform.scale}},{key:"position",get:function(){return this.transform.position}},{key:"pivot",get:function(){return this.transform.pivot}},{key:"x",get:function(){return this.transform.position.x},set:function(t){this.transform.position.x=t}},{key:"y",get:function(){return this.transform.position.y},set:function(t){this.transform.position.y=t}},{key:"width",get:function(){return this.w*this.scale.x},set:function(t){this.scale.x=t/this.w}},{key:"height",get:function(){return this.h*this.scale.y},set:function(t){this.scale.y=t/this.h}}])&&wa(e.prototype,n),r&&wa(e,r),t}(),Ca=new va;function Ta(t){return(Ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pa(t,e){return!e||"object"!==Ta(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ea(t){return(Ea=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _a(t,e){return(_a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Oa=Math.abs,Ra=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Pa(this,Ea(e).call(this,t,n))).parent=null,r.children=[],r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_a(t,e)}(e,Sa),n=e,(r=[{key:"Render",value:function(){!0===this.render&&(this.ProcessTransform(this.parent),this.children.length>0&&this.RenderChildren())}},{key:"RenderChildren",value:function(){for(var t=this.children,e=0;e<t.length;++e)t[e].Render()}},{key:"AddChild",value:function(t){var e=t.parent;return null!=e&&e.RemoveChild(t),this.children.push(t),t.parent=this,t}},{key:"AddChildren",value:function(){var t=arguments;Object(B.IsArray)(t[0])&&(t=t[0]);for(var e=0;e<t.length;++e)this.AddChild(t[e])}},{key:"AddSibling",value:function(t){var e=this.parent;return null!=e&&e.AddChild(t),t}},{key:"RemoveChild",value:function(t){var e=this.children,n=e.indexOf(t);if(-1!==n)return t.parent=null,e.fickleSplice(n)}},{key:"RemoveChildren",value:function(){var t,e,n=arguments;Object(B.IsArray)(r[0])&&(function(t){throw new Error('"'+t+'" is read-only')}("children"),r=r[0]);for(var r=this.children,i=[],o=0;o<n.length;++o)t=n[o],-1!==(e=r.indexOf(t))&&(i.push(r.fickleSplice(e)),t.parent=null);return i}},{key:"Swap",value:function(t){if(null!=this.parent){var e=this.parent.children,n=e.indexOf(this);if(-1!==n){-1===t&&(t=e.length-1);var r=e[t];e[t]=this,e[n]=r}}}},{key:"SendToFront",value:function(){this.Swap(-1)}},{key:"SendToBack",value:function(){this.Swap(0)}},{key:"Dump",value:function(){for(var t=this.children,e=0;e<t.length;++e)t[e].parent=null;t.length=0}},{key:"Destroy",value:function(){this.Dump(),null!=this.parent&&this.parent.RemoveChild(this)}},{key:"AttachTo",value:function(t){t.AddChild(this)}},{key:"Detach",value:function(){return null!=this.parent?this.parent.RemoveChild(this):null}},{key:"GetChildClosestTo",value:function(t,e){var n,r,i,o=1/0,a=this.children;if(0!==a.length){for(var s=0;s<a.length;++s)n=a[s],void 0!==e&&!1===e(n)||(r=Oa(n.position.GetDistanceSquared(t.x,t.y)))<o&&(o=r,i=n);return i}return null}},{key:"GetChildFurthestFrom",value:function(t,e){var n,r,i,o=0,a=this.children;if(0!==a.length){for(var s=0;s<a.length;++s)n=a[s],void 0!==e&&!1===e(n)||(r=Oa(n.position.GetDistanceSquared(t.x,t.y)))>o&&(o=r,i=n);return i}return null}}])&&xa(n.prototype,r),i&&xa(n,i),e}();function Da(t){return(Da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ka(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ia(t,e){return!e||"object"!==Da(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function La(t){return(La=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ba(t,e){return(Ba=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Ra.prototype.Mount=Ra.prototype.AddChildren;var ja=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Ia(this,La(e).call(this,t,n))).interactive=!0,r.display=!0,r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ba(t,e)}(e,Ra),n=e,(r=[{key:"PreRender",value:function(){}},{key:"GLPreRender",value:function(){}},{key:"PostRender",value:function(){}},{key:"GLPostRender",value:function(){}},{key:"Render",value:function(t){this.PreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),this.children.length>0&&!0===this.display&&this.RenderChildren(t)),this.PostRender(t)}},{key:"GLRender",value:function(t){this.GLPreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),this.children.length>0&&!0===this.display&&this.GLRenderChildren(t)),this.GLPostRender(t)}},{key:"RenderChildren",value:function(t){for(var e=this.children,n=0;n<e.length;++n)e[n].Render(t)}},{key:"GLRenderChildren",value:function(t){for(var e=this.children,n=0;n<e.length;++n)e[n].GLRender(t)}}])&&ka(n.prototype,r),i&&ka(n,i),e}();function Ga(t){return(Ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Va(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Na(t,e){return!e||"object"!==Ga(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fa(t){return(Fa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ma(t,e){return(Ma=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Ra.prototype.Mount=Ra.prototype.AddChildren;var Ua=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Na(this,Fa(e).call(this,t,n))).isBatchParent=!1,r.childDataBuffer=null,r.bufferData=null,r.programController=null,r.bufferStartIndex=0,r.bufferEndIndex=0,r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ma(t,e)}(e,ja),n=e,(r=[{key:"Render",value:function(t){this.PreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),this.children.length>0&&!0===this.display&&this.RenderChildren(t)),this.PostRender(t)}},{key:"GLRender",value:function(t){this.GLPreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchRenderChildren():this.GLRenderChildren(t))),this.GLPostRender(t)}},{key:"GLBatchRenderChildren",value:function(){null!=this.childDataBuffer&&null!=this.programController&&this.programController.Execute(this.childDataBuffer,this.children.length)}},{key:"ComputeBatchBuffer",value:function(t){for(var e,n,r=this.children,i=[],o=0;o<r.length;++o)e=r[o],n=null!=t?t(e):e.GetBufferData(),e.bufferStartIndex=i.length,e.bufferEndIndex=i.length+n.length,i.push.apply(i,n);this.childDataBuffer=new Float32Array(i)}},{key:"UpdateInBuffer",value:function(){throw new Error(Xa)}},{key:"GetBufferData",value:function(){throw new Error(Xa)}},{key:"UseAsBatchParent",value:function(t){this.isBatchParent=!0,this.programController=t}}])&&Va(n.prototype,r),i&&Va(n,i),e}(),Xa="Cannot access buffer data directly on Container2D!";function Ha(t){return(Ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ya(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wa(t,e){return!e||"object"!==Ha(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qa(t){return(qa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function za(t,e){return(za=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ka=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Wa(this,qa(e).call(this,t,n))).anchor=new ut.a(0,0),o.shape=new ue(0,0,0,0),o.clip=new ue(0,0,0,0),o.textureTransformation=new ha,o.textureTranslation=new ha,o.originalShape=new ue(0,0,0,0),o.tint=new sr(1,1,1,1),o.texture=null,o.gco=_e,o.programController=null,r instanceof go?(o.programController=r,o.SetTexture(r.originalTexture)):r instanceof xo?(o.programController=r,null!=i?o.SetTexture(r.originalTextures[i]):o.SetTexture(r.originalTextures[0])):null!=r&&o.SetTexture(r),o}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&za(t,e)}(e,Ua),n=e,(r=[{key:"Render",value:function(t){if(this.PreRender(t),!0===this.render){if(this.ProcessTransform(this.parent),!0===this.display){var e=this.clip,n=e.tl,r=e.br,i=this.textureTranslation;this.transform.ApplyGlobal(t),t.globalAlpha=this.tint.channel[3],t.globalCompositeOperation=this.gco,t.drawImage(this.texture.image,n.x,n.y,r.x,r.y,i.e,i.f,this.w,this.h)}this.children.length>0&&this.RenderChildren(t)}this.PostRender(t)}},{key:"GLRender",value:function(t){this.GLPreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),!0===this.display&&(null!==this.programController&&this.programController.Execute(this.transform.globalTransform.AsArray(!0),this.textureTranslation.AsArray(!0),this.textureTransformation.AsArray(!0),this.tint.channel,this.texture.uniformId),this.children.length>0&&(!0===this.isBatchParent?this.GLBatchRenderChildren(t):this.GLRenderChildren(t)))),this.GLPostRender(t)}},{key:"UpdateTextureTransform",value:function(){this.textureTranslation.TranslateTo(-this.w*this.anchor.x,-this.h*this.anchor.y),this.textureTransformation.TranslateTo(this.w/this.texture.fw*this.clip.tl.x/this.w,this.h/this.texture.fh*this.clip.tl.y/this.h)}},{key:"UpdateShape",value:function(t){null!=t&&(this.originalShape=t),this.shape.SetC(this.originalShape),this.shape.Scale(this.scale.x,this.scale.y)}},{key:"ClipReconfigure",value:function(t,e,n,r){var i=n/this.texture.fw,o=r/this.texture.fh,a=this.width,s=this.height;this.clip.Set(t,e,n,r),this.w=n,this.h=r,0!==a&&0!==s&&(this.width=a,this.height=s),this.textureTranslation.SetTransform(-n*this.anchor.x,-r*this.anchor.y,i,o),this.textureTransformation.SetTransform(i*this.clip.tl.x/n,o*this.clip.tl.y/r,i,o)}},{key:"SetTexture",value:function(t){this.texture=t,this.ClipReconfigure(0,0,t.w,t.h),this.shape.SetC(this.clip),this.originalShape.SetC(this.shape)}},{key:"alpha",get:function(){return this.tint.channel[3]},set:function(t){this.tint.channel[3]=t}}])&&Ya(n.prototype,r),i&&Ya(n,i),e}();function Ja(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Qa=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.frames=[],this.controller=e,this.sprite=e.sprite,this.id=n,this.onEnd=new wr,this.onStop=new wr,this.onStart=new wr,this.currentFrame=0,this.currentFrameIndex=0,this.playing=!1,this.rate=60,this.timer=0,this.reverse=!1,this.overrideFrameRate=!1,this.loop=!1,this.autoFrame=!0,null!=r&&(this.rate=r)}var e,n,r;return e=t,(n=[{key:"CreateFrame",value:function(t,e,n,r,i){i=null==i?this.rate:i,this.frames.push(new Ti(t,e,n,r,i))}},{key:"AddFrame",value:function(t){(null==t.rate||t.rate<=0)&&(t.rate=this.rate),this.frames.push(t)}},{key:"GenerateFrames",value:function(t,e,n,r,i,o){var a,s=n/r;o=null==o?{}:o;for(var u=0;u<i;++u)a=o[u],this.CreateFrame(u%s*t,(u/s|0)*e,t,e,a)}},{key:"SetFrame",value:function(t){t=null==t?0:t;var e=this.frames[t];void 0!==e&&(this.currentFrame=e,this.currentFrameIndex=t,this.currentFrame.Apply(this.sprite))}},{key:"GetFrameById",value:function(t,e){for(var n=this.frames,r=0;r<n.length;++r)if(n[r].id===t)return!0===e?r:n[r]}},{key:"SetFrameById",value:function(t){var e=this.GetFrameById(t,!0);this.SetFrame(e)}},{key:"Start",value:function(t){null==t&&this.autoFrame&&(t=this.reverse?this.frames.length-1:0),this.SetFrame(t),this.ResetAllFrames(),this.timer=this.rate,this.playing=!0,this.onStart.Dispatch()}},{key:"Stop",value:function(){this.playing=!1,this.onStop.Dispatch()}},{key:"Process",value:function(){!0===this.playing&&(!0===this.overrideFrameRate?--this.timer<=0&&(this.timer=this.rate,this.NextFrame()):!0===this.currentFrame.Process()&&this.NextFrame())}},{key:"NextFrame",value:function(){var t=!1,e=this.frames,n=e.length;!1===this.reverse?++this.currentFrameIndex:--this.currentFrameIndex,this.currentFrameIndex>=n?(!0===this.loop?this.currentFrameIndex=0:this.currentFrameIndex=n-1,t=!0):this.currentFrameIndex<0&&(!0===this.loop?this.currentFrameIndex=n-1:this.currentFrameIndex=0,t=!0),this.currentFrame=e[this.currentFrameIndex],this.currentFrame.Apply(this.sprite),!0===t&&(this.onEnd.Dispatch(),!1===this.loop&&this.Stop())}},{key:"Clear",value:function(){this.frames=[],this.currentFrame=null,this.playing=!1,this.currentFrameIndex=0,this.timer=this.rate}},{key:"Reset",value:function(){this.SetFrame(0),this.ResetAllFrames(),this.timer=this.rate,this.playing=!1}},{key:"ResetAllFrames",value:function(){for(var t=this.frames,e=0;e<t.length;++e)t[e].Reset()}}])&&Ja(e.prototype,n),r&&Ja(e,r),t}();function $a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Za=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.animations=[],this.sprite=null,this.currentAnimation=null,null!=e&&(this.sprite=e)}var e,n,r;return e=t,(n=[{key:"CreateAnimation",value:function(t,e){var n=new Qa(this,t,e);return this.animations.push(n),n}},{key:"AddAnimation",value:function(t){t.controller=this,this.animations.push(t)}},{key:"GetAnimationById",value:function(t){for(var e=this.animations,n=e[0],r=0;r<e.length;n=e[++r])if(n&&n.id===t)return n;return null}},{key:"PlayAnimation",value:function(t,e){var n=this.GetAnimationById(t);null!==n&&(this.currentAnimation=n,n.Start(e))}},{key:"StopCurrentAnimation",value:function(){null!==this.currentAnimation&&this.currentAnimation.Stop()}},{key:"Process",value:function(){null!==this.currentAnimation&&this.currentAnimation.Process()}}])&&$a(e.prototype,n),r&&$a(e,r),t}();function ts(t){return(ts="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function es(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ns(t,e){return!e||"object"!==ts(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function rs(t){return(rs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function is(t,e){return(is=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var os=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=ns(this,rs(e).call(this,t,n))).anchor=new ut.a(0,0),i.SetPath(r),i.alpha=1,i}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&is(t,e)}(e,Ua),n=e,(r=[{key:"Render",value:function(t){if(this.PreRender(t),!0===this.render){this.ProcessTransform(this.parent),this.transform.ApplyGlobal(t);var e=this.path;e&&e.Render&&!0===this.display&&(t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,e.Render(t)),this.children.length>0&&this.RenderChildren(t)}this.PostRender(t)}},{key:"GLRender",value:function(t){if(this.GLPreRender(t),!0===this.render){this.ProcessTransform(this.parent);var e=this.path;e&&e.GLRender&&!0===this.display&&e.GLRender(t,this.transform),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchRenderChildren(t):this.GLRenderChildren(t))}this.GLPostRender(t)}},{key:"GetBufferData",value:function(){this.UpdateTransform(this.parent);var t=this.transform.globalTransform.AsArray(!0);null==this.bufferData&&(this.bufferData=[]);var e=this.bufferData;return e.length=0,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this.path&&this.path.GetBufferData&&e.push.apply(e,this.path.GetBufferData()),e}},{key:"UpdateInBuffer",value:function(){this.UpdateTransform(this.parent);var t=this.transform.globalTransform.AsArray(!0),e=this.parent.childDataBuffer,n=this.bufferStartIndex;e[n]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=t[3],e[n+4]=t[4],e[n+5]=t[5],e[n+6]=t[6],e[n+7]=t[7],e[n+8]=t[8],this.path&&this.path.UpdateInBuffer&&this.path.UpdateInBuffer(e,n+9)}},{key:"IntersectsPoint2D",value:function(t){return!1!==this.interactive&&(as.SetV(t),as.SubtractV(this.position),this.path.IntersectsPoint2D(as))}},{key:"SetPath",value:function(t){void 0!==t&&(void 0!==t.w&&void 0!==t.h?(this.w=t.w,this.h=t.h):void 0!==t.GetLength?this.w=this.h=t.GetLength():void 0!==t.diameter?this.w=this.h=t.diameter:void 0!==t.aabb&&(this.w=t.aabb.w,this.h=t.aabb.h),this.path=t)}}])&&es(n.prototype,r),i&&es(n,i),e}(),as=new ut.a(0,0);function ss(t){return(ss="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function us(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ls(t,e){return!e||"object"!==ss(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cs(t){return(cs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hs(t,e){return(hs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fs=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=ls(this,cs(e).call(this,t,n,r,i))).animationController=null,null==r&&o.SetTexture(ps),o}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hs(t,e)}(e,Ka),n=e,i=[{key:"BUILD_DEFAULT_TEXTURE",value:function(t){if(!0===ys)throw new Error("Function can only be called once!");ps=new bi(H(X(function(){var t=new nr([0,0,64,0,64,64,0,64,0,0,32,32,64,0,32,32,64,64,32,32,0,64]);return t.ComputeBounds(),t.style.stroke.lineWidth=3,new os(0,0,t)}),64,64,t),"__DEFAULT_SPRITE_TEXTURE__",64,64,64,64),ys=!0}},{key:"DEFAULT_TEXTURE",get:function(){return ps}}],(r=[{key:"GetBufferData",value:function(){this.UpdateTransform(this.parent),this.UpdateTextureTransform();var t=this.transform.globalTransform.AsArray(!0),e=this.textureTranslation.AsArray(!0),n=this.textureTransformation.AsArray(!0);null==this.bufferData&&(this.bufferData=[]);var r=this.bufferData;return r.length=0,r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=e[0],r[10]=e[1],r[11]=e[2],r[12]=e[3],r[13]=e[4],r[14]=e[5],r[15]=e[6],r[16]=e[7],r[17]=e[8],r[18]=n[0],r[19]=n[1],r[20]=n[2],r[21]=n[3],r[22]=n[4],r[23]=n[5],r[24]=n[6],r[25]=n[7],r[26]=n[8],r}},{key:"UpdateInBuffer",value:function(){this.UpdateTransform(this.parent),this.UpdateTextureTransform();var t=this.transform.globalTransform.AsArray(!0),e=this.textureTranslation.AsArray(!0),n=this.textureTransformation.AsArray(!0),r=this.parent.childDataBuffer,i=this.bufferStartIndex;r[i]=t[0],r[i+1]=t[1],r[i+2]=t[2],r[i+3]=t[3],r[i+4]=t[4],r[i+5]=t[5],r[i+6]=t[6],r[i+7]=t[7],r[i+8]=t[8],r[i+9]=e[0],r[i+10]=e[1],r[i+11]=e[2],r[i+12]=e[3],r[i+13]=e[4],r[i+14]=e[5],r[i+15]=e[6],r[i+16]=e[7],r[i+17]=e[8],r[i+18]=n[0],r[i+19]=n[1],r[i+20]=n[2],r[i+21]=n[3],r[i+22]=n[4],r[i+23]=n[5],r[i+24]=n[6],r[i+25]=n[7],r[i+26]=n[8]}},{key:"CreateAnimation",value:function(t){var e;null===this.animationController&&(this.animationController=new Za(this));var n=this.animationController.CreateAnimation(t.id,t.rate);if(null!=t.spritesheet){var r=null;for(e=0;e<t.frames.length;++e)r=t.spritesheet.GetFrameById(t.frames[e].id||t.frames[e]),null!=t.frames[e].rate&&(r.rate=t.frames[e].rate),n.CreateFrame(r.x,r.y,r.w,r.h,r.rate)}else for(e=0;e<t.frames.length;++e)n.AddFrame(t.frames[e]);return n.loop=!!t.loop,n.overrideFrameRate=!!t.overrideFrameRate,n.reverse=!!t.reverse,n}},{key:"PlayAnimation",value:function(t,e){this.animationController.PlayAnimation(t,e)}},{key:"StopCurrentAnimation",value:function(){this.animationController.StopCurrentAnimation()}},{key:"IntersectsPoint2D",value:function(t){return!1!==this.interactive&&(ds.SetV(t),ds.SubtractV(this.position),ds.Add(this.width*this.anchor.x,this.height*this.anchor.y),this.shape.IntersectsPoint2D(ds))}}])&&us(n.prototype,r),i&&us(n,i),e}(),ds=new ut.a(0,0),ps=null,ys=!1;function vs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ms=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.velocity=new ut.a(0,0),this.torque=0,this.spin=0,this.growth=new ut.a(1,1),this.acceleration=new ut.a(1,1),this.initialScale=new ut.a(1,1),this.fade=!1,this.deflate=!1,this.gravity=new ut.a(0,0),this.lifespan=0,this.lifespanTotal=0,this.dead=!1,this.entity=null,this.system=null,this.oscillation=null,this.oscillationOffset=0,this.Renew(e,n)}var e,n,r;return e=t,r=[{key:"USE_POOL",get:function(){return gs},set:function(t){gs=!!t}},{key:"Pool",get:function(){return bs}}],(n=[{key:"Process",value:function(){if(!0!==this.dead)if(this.lifespan++<this.lifespanTotal){var t=this.entity,e=this.velocity,n=1-this.lifespan/this.lifespanTotal,r=this.oscillation;if(e.AddV(this.gravity).MultiplyV(this.acceleration),0!==this.torque&&e.Rotate(this.torque),t.position.AddV(e),!0===this.fade&&(t.alpha=n),!0===this.deflate?t.scale.Set(n*this.initialScale.x,n*this.initialScale.y):t.scale.MultiplyV(this.growth),t.rotation+=this.spin,null!==r&&!0===r.active){var i=this.lifespan+this.oscillationOffset;null!=r.torque&&!0===r.torque.active&&(this.torque=Object(j.Oscillate)(i,r.torque.from,r.torque.to,r.torque.amplitude)),null!=r.spin&&!0===r.spin.active&&(this.spin=Object(j.Oscillate)(i,r.spin.from,r.spin.to,r.spin.amplitude)),null!=r.velocityX&&!0===r.velocityX.active&&(this.velocity.x=Object(j.Oscillate)(i,r.velocityX.from,r.velocityX.to,r.velocityX.amplitude)),null!=r.velocityY&&!0===r.velocityY.active&&(this.velocity.y=Object(j.Oscillate)(i,r.velocityY.from,r.velocityY.to,r.velocityY.amplitude)),null!=r.gravityX&&!0===r.gravityX.active&&(this.gravity.x=Object(j.Oscillate)(i,r.gravityX.from,r.gravityX.to,r.gravityX.amplitude)),null!=r.gravityY&&!0===r.gravityY.active&&(this.gravity.y=Object(j.Oscillate)(i,r.gravityY.from,r.gravityY.to,r.gravityY.amplitude)),null!=r.accelerationX&&!0===r.accelerationX.active&&(this.acceleration.x=Object(j.Oscillate)(i,r.accelerationX.from,r.accelerationX.to,r.accelerationX.amplitude)),null!=r.accelerationY&&!0===r.accelerationY.active&&(this.acceleration.y=Object(j.Oscillate)(i,r.accelerationY.from,r.accelerationY.to,r.accelerationY.amplitude)),null!=r.growthX&&!0===r.growthX.active&&(this.growth.x=Object(j.Oscillate)(i,r.growthX.from,r.growthX.to,r.growthX.amplitude)),null!=r.growthY&&!0===r.growthY.active&&(this.growth.y=Object(j.Oscillate)(i,r.growthY.from,r.growthY.to,r.growthY.amplitude))}}else this.dead=!0,this.entity.display=!1}},{key:"Renew",value:function(t,e){if(null!=t){this.dead=!1;var n=this.entity;if(null==t.texture)throw new Error("No texture or controller provided!");if(null===n?(n=this.entity=new fs(0,0,t.texture,t.unitId),null!=t.anchor&&(n.anchor.SetV(t.anchor),n.UpdateTextureTransform())):this.ResetEntity(t.unitId),null!=t.frames&&(t.frames[Object(B.RandomInteger)(0,t.frames.length-1)].Apply(n),n.scale.SetSame(1),n.UpdateTextureTransform()),this.RenewVector(t.position,n.position,e,0,0),this.RenewVector(t.velocity,this.velocity,e,0,0),this.RenewVector(t.gravity,this.gravity,e,0,0),this.RenewVector(t.acceleration,this.acceleration,e,1,1),this.RenewVector(t.growth,this.growth,e,1,1),this.RenewVector(t.scale,n.scale,e,1,1),this.RenewVector(t.scale,this.initialScale,e,1,1),null!=t.rotation?n.rotation=Object(B.MinMaxOrValue)(t.rotation):n.rotation=0,null!=t.lifespan?this.SetLifespan(t.lifespan):this.SetLifespan(0),null!=t.torque?this.torque=Object(B.MinMaxOrValue)(t.torque):this.torque=0,null!=t.spin?this.spin=Object(B.MinMaxOrValue)(t.spin):this.spin=0,null!=t.fade?this.fade=t.fade:this.fade=!1,null!=t.deflate?this.deflate=t.deflate:this.deflate=!1,null!=t.oscillation){var r=t.oscillation,i=this.oscillation;null===i&&(i=this.oscillation=new ra),i.active=!0,null!=r.offset?this.oscillationOffset=Object(B.MinMaxOrValue)(r.offset):this.oscillationOffset=0,null!=r.torque?i.SetOscillatingObject("torque",r.torque.from,r.torque.to,r.torque.amplitude):i.Nullify("torque"),null!=r.spin?i.SetOscillatingObject("spin",r.spin.from,r.spin.to,r.spin.amplitude):i.Nullify("spin"),null!=r.velocity&&(null!=r.velocity.x?i.SetOscillatingObject("velocityX",r.velocity.x.from,r.velocity.x.to,r.velocity.x.amplitude):i.Nullify("velocityX"),null!=r.velocity.y?i.SetOscillatingObject("velocityY",r.velocity.y.from,r.velocity.y.to,r.velocity.y.amplitude):i.Nullify("velocityY")),null!=r.gravity&&(null!=r.gravity.x?i.SetOscillatingObject("gravityX",r.gravity.x.from,r.gravity.x.to,r.gravity.x.amplitude):i.Nullify("gravityX"),null!=r.gravity.y?i.SetOscillatingObject("gravityY",r.gravity.y.from,r.gravity.y.to,r.gravity.y.amplitude):i.Nullify("gravityY")),null!=r.acceleration&&(null!=r.acceleration.x?i.SetOscillatingObject("accelerationX",r.acceleration.x.from,r.acceleration.x.to,r.acceleration.x.amplitude):i.Nullify("accelerationX"),null!=r.acceleration.y?i.SetOscillatingObject("accelerationY",r.acceleration.y.from,r.acceleration.y.to,r.acceleration.y.amplitude):i.Nullify("accelerationY")),null!=r.growth&&(null!=r.growth.x?i.SetOscillatingObject("growthX",r.growth.x.from,r.growth.x.to,r.growth.x.amplitude):i.Nullify("growthX"),null!=r.growth.y?i.SetOscillatingObject("growthY",r.growth.y.from,r.growth.y.to,r.growth.y.amplitude):i.Nullify("growthY"))}else null!==this.oscillation&&(this.oscillation.active=!1)}}},{key:"RenewVector",value:function(t,e,n,r,i){null!=t?null!=t.points?null!=t.moduloWrapper?(null!=t.indexGap&&(n+=t.indexGap),e.SetV(t.points[n%t.moduloWrapper])):e.SetV(Object(B.RandomInArray)(t.points)):null!=t.xy?e.SetSame(Object(B.MinMaxOrValue)(t.xy)):(null!=t.x?e.x=Object(B.MinMaxOrValue)(t.x):e.x=r,null!=t.y?e.y=Object(B.MinMaxOrValue)(t.y):e.y=i):e.Set(r,i)}},{key:"SetLifespan",value:function(t){this.lifespan=0,this.lifespanTotal=Object(B.MinMaxOrValue)(t)}},{key:"ResetEntity",value:function(t){var e=this.entity;null!=t&&e.SetTexture(e.programController["originalTexture"+t]),e.scale.SetSame(1),e.alpha=1,e.display=!0,e.rotation=0}},{key:"Destroy",value:function(t){return(!0!==t||!1!==this.dead)&&(null!==this.system&&this.system.RemoveParticle(this),gs&&bs.Store(this),!0)}}])&&vs(e.prototype,n),r&&vs(e,r),t}(),bs=new $o.a,gs=!0;function ws(t){return(ws="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function As(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ss(t){return(Ss=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cs(t,e){return(Cs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ts(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}bs.Retrieve=function(t,e){this.PreRetrieve();var n=this.objects.pop();return n.Renew(t,e),n},bs.Flood(function(){return new ms},1e3);var xs=function(t){function e(t,n){var r,i,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i=this,(r=!(o=Ss(e).call(this,t,n))||"object"!==ws(o)&&"function"!=typeof o?Ts(i):o).particles=[],r.deletionTimer=new Cr(60),r.deletionTimer.onFinish.Add(r.HandleParticleDeletion,Ts(Ts(r))),r.deletionTimer.Start(),r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cs(t,e)}(e,ja),n=e,(r=[{key:"Process",value:function(){this.HandleParticles(),this.deletionTimer.Process()}},{key:"HandleParticles",value:function(){for(var t=this.particles,e=0;e<t.length;++e)t[e].Process()}},{key:"HandleParticleDeletion",value:function(){for(var t=this.particles,e=t[0],n=0;n<t.length;e=t[++n])e&&e.Destroy(!0)&&n--;this.deletionTimer.Start()}},{key:"AddParticle",value:function(t){return t.system=this,this.AddChild(t.entity),this.particles.push(t),t}},{key:"RemoveParticle",value:function(t){var e=this.particles,n=e.indexOf(t);if(-1!==n)return t.system=null,this.RemoveChild(t.entity),e.fickleSplice(n)}},{key:"Emit",value:function(t){for(var e=0;e<t.amount;++e)!0===ms.USE_POOL?this.AddParticle(ms.Pool.Retrieve(t,e)):this.AddParticle(new ms(t,e))}}])&&As(n.prototype,r),i&&As(n,i),e}(),Ps=function(t,e,n){t.setTransform(1,0,0,1,0,0),t.globalAlpha=.25,t.strokeStyle="rgba(255, 0, 255, 1)",t.fillStyle="rgba(0, 255, 0, 1)",null!=n&&(null!=n.alpha&&(t.globalAlpha=n.alpha),null!=n.strokeStyle&&(t.strokeStyle=n.strokeStyle),null!=n.fillStyle&&(t.fillStyle=n.fillStyle)),t.lineWidth=2,t.beginPath(),t.moveTo(e.tl.x,e.tl.y),t.lineTo(e.br.x,e.tl.y),t.lineTo(e.br.x,e.br.y),t.lineTo(e.tl.x,e.br.y),t.closePath(),null!=n?(null==n.noStroke&&t.stroke(),null==n.noFill&&t.fill()):(t.stroke(),t.fill())};function Es(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _s=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.root=null,this.propW="width",this.propH="height",this.w=e,this.h=n,this.__dynamic=!e,this.padding=new ut.a(0,0)}var e,n,r;return e=t,(n=[{key:"Pack",value:function(t,e){var n=t.length,r=this.propW,i=this.propH,o=this.padding.x,a=this.padding.y,s=t[0],u=s[r]+o,l=s[i]+a,c=null,h=[];this.root=new ue(0,0,0,0).SetXYWH(0,0,this.w,this.h);for(var f=0;f<n;s=t[++f])if(u=s[r]+o,l=s[i]+a,f===n-1&&(u-=o,l-=a),(c=this.Find(this.root,u,l))&&(h[f]=this.Partition(c,u,l)),null==h[f]&&!0!==e)throw new Error(Os);return h}},{key:"PackDynamic",value:function(t,e){var n=t.length,r=this.propW,i=this.propH,o=this.padding.x,a=this.padding.y,s=t[0],u=s[r]+o,l=s[i]+a,c=null,h=[];this.root=new ue(0,0,0,0).SetXYWH(0,0,u,l);for(var f=0;f<n;s=t[++f])if(u=s[r]+o,l=s[i]+a,f===n-1&&(u-=o,l-=a),c=this.Find(this.root,u,l),h[f]=c?this.Partition(c,u,l):this.Extend(u,l),null==h[f]&&!0!==e)throw new Error(Os);return h}},{key:"Find",value:function(t,e,n){return t.vertical&&t.horizontal?this.Find(t.horizontal,e,n)||this.Find(t.vertical,e,n):e<=t.w&&n<=t.h?t:null}},{key:"Partition",value:function(t,e,n){return t.vertical=new ue(0,0,0,0).SetXYWH(t.tl.x,t.tl.y+n,t.w,t.h-n),t.horizontal=new ue(0,0,0,0).SetXYWH(t.tl.x+e,t.tl.y,t.w-e,n),t}},{key:"Extend",value:function(t,e){var n=t<=this.root.w,r=e<=this.root.h,i=n&&this.root.w>=this.root.h+e;return r&&this.root.h>=this.root.w+t?this.ExtendAxis(t,e):i?this.ExtendAxis(t,e,!0):r?this.ExtendAxis(t,e):n?this.ExtendAxis(t,e,!0):null}},{key:"ExtendAxis",value:function(t,e,n){var r=null;n?((r=new ue(0,0,0,0).SetXYWH(0,0,this.root.w,this.root.h+e)).horizontal=this.root,r.vertical=new ue(0,0,0,0).SetXYWH(0,this.root.h,this.root.w,e)):((r=new ue(0,0,0,0).SetXYWH(0,0,this.root.w+t,this.root.h)).vertical=this.root,r.horizontal=new ue(0,0,0,0).SetXYWH(this.root.w,0,t,this.root.h)),this.root=r;var i=this.Find(this.root,t,e);return i?this.Partition(i,t,e):null}},{key:"UseProp",value:function(t,e){return this.propW=t,this.propH=e,this}},{key:"SetSize",value:function(t,e){return this.w=t,this.h=e,this.dynamic=!0,this}},{key:"SetPadding",value:function(t,e){return this.padding.Set(t,e),this}}])&&Es(e.prototype,n),r&&Es(e,r),t}(),Os="Size error!";function Rs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ds=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.element.setAttribute&&this.element.setAttribute("tabindex","1"),this.element.focus&&this.element.focus(),this.___bound___OnKeyDown=this.OnKeyDown.bind(this),this.___bound___OnKeyUp=this.OnKeyUp.bind(this),this.element.addEventListener("keydown",this.___bound___OnKeyDown),this.element.addEventListener("keyup",this.___bound___OnKeyUp),this.onDown=new wr,this.onUp=new wr}var e,n,r;return e=t,(n=[{key:"OnKeyDown",value:function(t){t.stopPropagation(),this.onDown.Dispatch(this.element,t)}},{key:"OnKeyUp",value:function(t){t.stopPropagation(),this.onUp.Dispatch(this.element,t)}},{key:"Destroy",value:function(){this.element.removeEventListener("keydown",this.___bound___OnKeyDown),this.element.removeEventListener("keyup",this.___bound___OnKeyUp)}}])&&Rs(e.prototype,n),r&&Rs(e,r),t}();function ks(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Is=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.position=new ut.a,this.scale=new ut.a(1,1),this.offset=new ut.a(n,r),this.eventData={position:this.position,native:null},this.offsets=[],this.___bound___OnMove=this.OnMove.bind(this),this.___bound___OnDown=this.OnDown.bind(this),this.___bound___OnUp=this.OnUp.bind(this),this.___bound___OnLeave=this.OnLeave.bind(this),this.___bound___OnWheel=this.OnWheel.bind(this),this.element.addEventListener("mousemove",this.___bound___OnMove),this.element.addEventListener("mousedown",this.___bound___OnDown),this.element.addEventListener("mouseup",this.___bound___OnUp),this.element.addEventListener("mouseleave",this.___bound___OnLeave),this.element.addEventListener("wheel",this.___bound___OnWheel,{passive:!0}),this.onMove=new wr,this.onDown=new wr,this.onUp=new wr,this.onLeave=new wr,this.onWheel=new wr}var e,n,r;return e=t,(n=[{key:"OnMove",value:function(t){return this.CalculatePosition(t.clientX,t.clientY),this.eventData.native=t,this.onMove.Dispatch(this.element,this.eventData),!1}},{key:"OnDown",value:function(t){t.stopPropagation(),this.CalculatePosition(t.clientX,t.clientY),this.eventData.native=t,this.onDown.Dispatch(this.element,this.eventData)}},{key:"OnUp",value:function(t){t.stopPropagation(),this.CalculatePosition(t.clientX,t.clientY),this.eventData.native=t,this.onUp.Dispatch(this.element,this.eventData)}},{key:"OnLeave",value:function(t){t.stopPropagation(),this.CalculatePosition(t.clientX,t.clientY),this.eventData.native=t,this.onLeave.Dispatch(this.element,this.eventData)}},{key:"OnWheel",value:function(t){t.stopPropagation(),this.CalculatePosition(t.clientX,t.clientY),this.eventData.native=t,this.onWheel.Dispatch(this.element,this.eventData)}},{key:"CalculatePosition",value:function(t,e){var n=this.offsets,r=this.position,i=this.element.getBoundingClientRect();r.Set(t,e).Subtract(i.left,i.top).SubtractV(this.offset).DivideV(this.scale);for(var o=0;o<n.length;++o)r.SubtractV(n[o])}},{key:"AddOffset",value:function(t){return this.offsets.push(t),this}},{key:"Destroy",value:function(){this.element.removeEventListener("mousemove",this.___bound___OnMove),this.element.removeEventListener("mousedown",this.___bound___OnDown),this.element.removeEventListener("mouseup",this.___bound___OnUp),this.element.removeEventListener("mouseleave",this.___bound___OnLeave),this.element.removeEventListener("wheel",this.___bound___OnWheel)}},{key:"x",get:function(){return this.position.x}},{key:"y",get:function(){return this.position.y}}])&&ks(e.prototype,n),r&&ks(e,r),t}();function Ls(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Bs=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.position=new ut.a,this.scale=new ut.a(1,1),this.offset=new ut.a(n,r),this.eventData={position:this.position,native:null},this.offsets=[],this.___bound___OnMove=this.OnMove.bind(this),this.___bound___OnStart=this.OnStart.bind(this),this.___bound___OnEnd=this.OnEnd.bind(this),this.___bound___OnCancel=this.OnCancel.bind(this),this.element.addEventListener("touchmove",this.___bound___OnMove),this.element.addEventListener("touchstart",this.___bound___OnStart),this.element.addEventListener("touchend",this.___bound___OnEnd),this.element.addEventListener("touchcancel",this.___bound___OnCancel),this.onMove=new wr,this.onStart=new wr,this.onEnd=new wr,this.onCancel=new wr}var e,n,r;return e=t,(n=[{key:"OnMove",value:function(t){return t.stopPropagation(),this.CalculatePosition(t.touches.item(0).clientX,t.touches.item(0).clientY),this.eventData.native=t,this.onMove.Dispatch(this.element,this.eventData),!1}},{key:"OnStart",value:function(t){t.stopPropagation(),this.CalculatePosition(t.touches.item(0).clientX,t.touches.item(0).clientY),this.eventData.native=t,this.onStart.Dispatch(this.element,this.eventData)}},{key:"OnEnd",value:function(t){t.stopPropagation(),this.eventData.native=t,this.onEnd.Dispatch(this.element,this.eventData)}},{key:"OnCancel",value:function(t){t.stopPropagation(),this.eventData.native=t,this.onCancel.Dispatch(this.element,this.eventData)}},{key:"CalculatePosition",value:function(t,e){var n=this.offsets,r=this.position,i=this.element.getBoundingClientRect();r.Set(t,e).Subtract(i.left,i.top).SubtractV(this.offset).DivideV(this.scale);for(var o=0;o<n.length;++o)r.SubtractV(n[o])}},{key:"AddOffset",value:function(t){return this.offsets.push(t),this}},{key:"Destroy",value:function(){this.element.removeEventListener("touchmove",this.___bound___OnMove),this.element.removeEventListener("touchstart",this.___bound___OnStart),this.element.removeEventListener("touchend",this.___bound___OnEnd),this.element.removeEventListener("touchcancel",this.___bound___OnCancel)}},{key:"x",get:function(){return this.position.x}},{key:"y",get:function(){return this.position.y}}])&&Ls(e.prototype,n),r&&Ls(e,r),t}();function js(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Gs=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=0}var e,n,r;return e=t,(n=[{key:"Add",value:function(t){this.value|=t}},{key:"Remove",value:function(t){this.value=this.value&~t}},{key:"Compare",value:function(t){return 0!=(this.value&t)}},{key:"Holds",value:function(t){return(this.value&t)===t}},{key:"Toggle",value:function(t){this.value^=t}}])&&js(e.prototype,n),r&&js(e,r),t}();function Vs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ns=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.NONE=0,this.next=1}var e,n,r;return e=t,(n=[{key:"Add",value:function(t){void 0===this[t=t.toUpperCase()]&&(this[t]=this.next,this.next=this.next<<1)}}])&&Vs(e.prototype,n),r&&Vs(e,r),t}(),Fs=n(10);function Ms(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Us=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.orders=[],this.classUsed=null,this.amount=1,this.locked=!1}var e,n,r;return e=t,(n=[{key:"Many",value:function(t){return this.amount=t,this}},{key:"Bind",value:function(t,e){return e&&(this.orders.length=0),this.orders.push(t),this}},{key:"Make",value:function(t){var e=this.amount,n=Object(B.CreateIteratorArgs)(arguments,"@","i");if(!0===this.locked)throw new Error('"Make" called twice before end!');this.locked=!0,this.orders.length=0,this.classUsed=t;for(var r=0;r<e;++r)Xs(arguments,n,r),this.orders.push(new(Function.prototype.bind.apply(t,arguments)));return this}},{key:"Call",value:function(t,e,n){var r,i,o,a=this.orders,s=Object(B.IsArray)(e),u="string"==typeof t,l=a[0];!0===s&&(o=Object(B.CreateIteratorArgs)(e,"@","i"));for(var c=0;c<a.length;l=a[++c])!0===s&&(i=e.slice(),Object(B.ReplaceArgumentWithObjectValue)(l,i,"$"),Xs(i,o,c)),!1===u&&null!=n?("$"===n[0]&&(n=n.slice(1),console.warn("No need for '$' on property arguments")),Object(B.Nested)(l,n,!1,!0,t.apply(null,i))):!1===u?t.apply(null,i):(r=Object(B.Nested)(l,t,!0),Object(B.Nested)(l,t).apply(r,i));return this}},{key:"Cast",value:function(t,e){for(var n=this.orders,r="string"==typeof e,i=0;i<n.length;++i)!0===r&&"$"===e[0]&&(e=Object(B.Nested)(n[i],e)),Object(B.Nested)(n[i],t,!1,!0,e);return this}},{key:"Done",value:function(){return this.amount=1,this.locked=!1,this.orders[0]}},{key:"Mass",value:function(){return this.amount=1,this.locked=!1,this.orders}},{key:"Ship",value:function(t){this.amount=1,this.locked=!1;var e=!0===t?this.orders.slice():this.orders[0];return this.orders.length=0,e}}])&&Ms(e.prototype,n),r&&Ms(e,r),t}(),Xs=function(t,e,n){if(null!=e)for(var r=0,i=e[r];r<e.length;i=e[++r])if(-1!==i.iteratorIndex)if(i.mod&&i.val)switch(i.mod){case"+":t[i.iteratorIndex]=n+parseInt(i.val);break;case"*":t[i.iteratorIndex]=n*parseInt(i.val);break;case"-":t[i.iteratorIndex]=n-parseInt(i.val);break;case"/":t[i.iteratorIndex]=n/parseInt(i.val);break;case"%":t[i.iteratorIndex]=n%parseInt(i.val);break;default:throw new Error("Bad mod!")}else t[i.iteratorIndex]=n},Hs=n(8);function Ys(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ws=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=e,this.w=n,this.h=r,this.aspectRatio=Object(j.SimplifyAspectRatio)(n,r),this.onChange=new wr,this.mode=i,this.stage=null,this.culler=null,this.cullerAabbOrig=null,this.rootContainer=null,this.currentWidth=0,this.currentHeight=0,e.setAttribute("width",n),e.setAttribute("height",r),this.___bound___OnWindowRsize=this.OnWindowResize.bind(this),window.addEventListener("resize",this.___bound___OnWindowRsize)}var e,n,r;return e=t,r=[{key:"FILL_SCREEN",get:function(){return qs}},{key:"KEEP_ASPECT_RATIO",get:function(){return zs}},{key:"KEEP_ASPECT_RATIO_MIN",get:function(){return Ks}},{key:"KEEP_ASPECT_RATIO_MAX",get:function(){return Js}},{key:"KEEP_ASPECT_RATIO_FIT",get:function(){return Qs}}],(n=[{key:"OnWindowResize",value:function(){this[this.mode]()}},{key:"Trigger",value:function(){return this.OnWindowResize(),this}},{key:"Reconfigure",value:function(t,e,n){return this.w=t,this.h=e,this.mode=n,this}},{key:"BindStage",value:function(t){return this.stage=t,this}},{key:"BindRootContainer",value:function(t){return this.rootContainer=t,this}},{key:"BindCuller",value:function(t){return this.culler=t,this.cullerAabbOrig=new ue(0,0,0,0),this.cullerAabbOrig.SetC(t.bounds),this}},{key:"SetCurrent",value:function(t,e){t|=0,e|=0,this.canvas.setAttribute("width",t),this.canvas.setAttribute("height",e),this.currentWidth=t,this.currentHeight=e;var n=t/this.w,r=e/this.h;null!==this.stage&&(this.stage.w=t,this.stage.h=e,this.stage.mouse&&this.stage.mouse.scale.Set(n,r),this.stage.touch&&this.stage.touch.scale.Set(n,r),!0===this.stage.usingWebGL&&this.stage.GLConfig()),null!==this.rootContainer&&this.rootContainer.scale.Set(n,r),null!==this.culler&&(this.culler.bounds.SetC(this.cullerAabbOrig),this.culler.bounds.Scale(n,r))}},{key:"FillScreen",value:function(){this.SetCurrent(window.innerWidth,window.innerHeight)}},{key:"KeepAspectRatio",value:function(){var t=window.innerWidth,e=t/this.aspectRatio[0]*this.aspectRatio[1];this.SetCurrent(t,e)}},{key:"KeepAspectRatioMIN",value:function(){var t,e=window.innerWidth;e<=this.w&&(e=this.w),t=e/this.aspectRatio[0]*this.aspectRatio[1],this.SetCurrent(e,t)}},{key:"KeepAspectRatioMAX",value:function(){var t,e=window.innerWidth;e>=this.w&&(e=this.w),t=e/this.aspectRatio[0]*this.aspectRatio[1],this.SetCurrent(e,t)}},{key:"KeepAspectRatioFIT",value:function(){var t=window.innerWidth,e=t/this.aspectRatio[0]*this.aspectRatio[1];e>=window.innerHeight&&(t=(e=window.innerHeight)/this.aspectRatio[1]*this.aspectRatio[0]),this.SetCurrent(t,e)}},{key:"Destroy",value:function(){window.removeEventListener("resize",this.___bound___OnWindowRsize)}}])&&Ys(e.prototype,n),r&&Ys(e,r),t}(),qs="FillScreen",zs="KeepAspectRatio",Ks="KeepAspectRatioMIN",Js="KeepAspectRatioMAX",Qs="KeepAspectRatioFIT";function $s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Zs=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nodes={},this.objects=[],this.convergence=[],this.objectCap=0,this.levelCap=0,this.level=0,this.aabb=null,this.hasSplit=!1,this.Set(e,n,r,i)}var e,n,r;return e=t,r=[{key:"pool",get:function(){return iu}},{key:"USE_POOL",get:function(){return ou},set:function(t){ou=!!t}}],(n=[{key:"Set",value:function(t,e,n,r){return this.aabb=t,this.level=e,this.objectCap=n,this.levelCap=r,this}},{key:"FromPool",value:function(e,n,r,i){return!0===ou?iu.Retrieve(e,n,r,i):new t(e,n,r,i)}},{key:"Store",value:function(){iu.Store(this)}},{key:"Add",value:function(t){var e=0,n="",r=this.objects,i=this.nodes;if(!0!==this.hasSplit||null===(n=this.Marking(t))){if(r.push(t),this.level<this.levelCap&&r.length>this.objectCap)for(!1===this.hasSplit&&this.Split();e<r.length;)null!==(n=this.Marking(r[e]))?i[n].Add(r.fickleSplice(e)):++e}else i[n].Add(t)}},{key:"Converge",value:function(t){var e="",n=this.nodes,r=this.convergence;return r.length=0,r.push.apply(r,this.objects),!0===this.hasSplit&&(null!==(e=this.Marking(t))?r.push.apply(r,n[e].Converge(t)):(r.push.apply(r,n[tu].Converge(t)),r.push.apply(r,n[eu].Converge(t)),r.push.apply(r,n[nu].Converge(t)),r.push.apply(r,n[ru].Converge(t)))),r}},{key:"Split",value:function(){var t=this.level+1,e=this.objectCap,n=this.levelCap,r=this.nodes,i=this.aabb;r[tu]=this.FromPool(i.GetQuadrant(tu),t,e,n),r[eu]=this.FromPool(i.GetQuadrant(eu),t,e,n),r[nu]=this.FromPool(i.GetQuadrant(nu),t,e,n),r[ru]=this.FromPool(i.GetQuadrant(ru),t,e,n),this.hasSplit=!0}},{key:"Dump",value:function(){var t=this.nodes;this.objects.length=0,!0===this.hasSplit&&(t[tu].Dump(),t[eu].Dump(),t[nu].Dump(),t[ru].Dump(),!0===ou&&(t[tu].Store(),t[eu].Store(),t[nu].Store(),t[ru].Store())),this.nodes={},this.hasSplit=!1}},{key:"Marking",value:function(t){var e=this.nodes;return!0===e[tu].aabb.ContainsAABB2D(t)?tu:!0===e[eu].aabb.ContainsAABB2D(t)?eu:!0===e[nu].aabb.ContainsAABB2D(t)?nu:!0===e[ru].aabb.ContainsAABB2D(t)?ru:null}},{key:"ConcatNodes",value:function(t){var e=this.nodes;return void 0===t&&(t=[]),t.push(this),!1===this.hasSplit?t:(e[tu].ConcatNodes(t),e[eu].ConcatNodes(t),e[nu].ConcatNodes(t),e[ru].ConcatNodes(t),t)}}])&&$s(e.prototype,n),r&&$s(e,r),t}(),tu="TL",eu="TR",nu="BL",ru="BR",iu=new $o.a,ou=!0;function au(t){return(au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function su(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function uu(t){return(uu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lu(t,e){return(lu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function cu(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}iu.Retrieve=function(t,e,n,r){return this.PreRetrieve(),this.objects.pop().Set(t,e,n,r)},iu.Flood(function(){return new Zs(null,0,0,0)},500);var hu=function(t){function e(t){var n,r,i;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,n=!(i=uu(e).call(this,0,0))||"object"!==au(i)&&"function"!=typeof i?cu(r):i,"string"==typeof t.canvas&&(t.canvas=document.getElementById(t.canvas)),n.canvas=t.canvas,n.w=t.canvas.width,n.h=t.canvas.height,n.id=null,n.backgroundColor="rgba(10,20,30,1)",n.clear=!0,n.fill=!0,n.usingWebGL=!1,n.canvasManager=null,n.mouse=null,n.touch=null,n.ticker=null,null==t.mode||"webgl2"!==t.mode.toLowerCase()&&"webgl"!==t.mode.toLowerCase())n.rc=t.canvas.getContext("2d"),console.log("%cCanvas 2D!","color:#f0f7da;background-color:#234d20;font-family:Arial;font-size:18px;font-weight:900;padding:5px;"),!0!==t.noTicker&&(n.ticker=new xr(n.Process.bind(cu(cu(n))),60,t.halt));else{if(n.gl=t.canvas.getContext(t.mode.toLowerCase(),{antialias:t.antialias,powerPreference:t.powerPreference,preserveDrawingBuffer:!0}),null!=n.gl?console.log("%cWebGL!","color:#f0f7da;background-color:#234d20;font-family:Arial;font-size:18px;font-weight:900;padding:5px;"):(n.gl=t.canvas.getContext("experimental-webgl"),null!=n.gl&&console.warn("Experimental WebGL!")),null==n.gl)throw new Error("WebGL is not supported!");n.gl.clearColor(.0392156862745098,.0784313725490196,.11764705882352941,1),n.usingWebGL=!0,!0!==t.noTicker&&(n.ticker=new xr(n.GLProcess.bind(cu(cu(n))),60,t.halt)),n.GLConfig(n.gl)}return null!=t.backgroundColor&&(n.backgroundColor=t.backgroundColor),!1===t.clear&&(n.clear=!1),!1===t.fill&&(n.fill=!1),null!=t.id&&(n.id=t.id),n.onProcess=new wr,!0!==t.noMouse&&(n.mouse=new Is(t.canvas,0,0)),!0!==t.noKeyboard&&(n.keyboard=new Ds(t.canvas)),!0!==t.noTouch&&(n.touch=new Bs(t.canvas,0,0)),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lu(t,e)}(e,ja),n=e,(r=[{key:"PreRender",value:function(t){t.setTransform(1,0,0,1,0,0),t.globalAlpha=1,t.globalCompositeOperation=_e,!0===this.fill?(t.fillStyle=this.backgroundColor,t.fillRect(0,0,this.w,this.h)):!0===this.clear&&t.clearRect(0,0,this.w,this.h)}},{key:"GLConfig",value:function(t){null==t&&(t=this.gl),this.position.Set(-1,1),this.scale.Set(2/this.w,-2/this.h),this.UpdateTransform(),t.viewport(0,0,this.w,this.h),t.enable(t.BLEND),t.disable(t.DEPTH_TEST),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)}},{key:"GLPreRender",value:function(t){!0===this.clear&&t.clear(t.COLOR_BUFFER_BIT)}},{key:"GLPostRender",value:function(t){t.flush()}},{key:"Process",value:function(t){this.Render(this.rc),this.onProcess.Dispatch(this,t)}},{key:"GLProcess",value:function(t){this.GLRender(this.gl),this.onProcess.Dispatch(this,t)}},{key:"MixedProcess",value:function(t){!0===this.usingWebGL?this.GLRender(this.gl):this.Render(this.rc),this.onProcess.Dispatch(this,t)}},{key:"SetFramebuffer",value:function(t,e){null==t&&(t=this.gl),null==e?(t.viewport(0,0,this.w,this.h),t.bindFramebuffer(t.FRAMEBUFFER,null)):(t.viewport(0,0,e.w,e.h),t.bindFramebuffer(t.FRAMEBUFFER,e.frameBuffer),t.clear(t.COLOR_BUFFER_BIT))}},{key:"Destroy",value:function(){this.Dump(),null!==this.keyboard&&this.keyboard.Destroy(),null!==this.mouse&&this.mouse.Destroy(),null!==this.touch&&this.touch.Destroy(),null!==this.ticker&&this.ticker.Stop()}}])&&su(n.prototype,r),i&&su(n,i),e}();function fu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var du=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.stages=[],this.currentStage=null,this.onlyCurrent=!1,this.options=null,this.ticker=new xr(this.Process.bind(this),60,e.halt),this.SetOptions(e)}var e,n,r;return e=t,(n=[{key:"SetOptions",value:function(t){null!=t&&(this.options=t)}},{key:"CreateStage2D",value:function(t){var e,n=document.createElement("canvas");"string"==typeof t&&(e=t,t=null),null==t&&(t=this.options),null==t&&(t={}),null!==e&&(t.id=e),null!=t.width&&(n.width=t.width),null!=t.height&&(n.height=t.height),null!=t.className&&(n.className=t.className),null==t.rootNode&&(t.rootNode=document.body),t.rootNode.appendChild(n),t.canvas=n,t.noTicker=!0,t.halt=!0;var r=new hu(t);return t.id=null,t.canvas=null,this.stages.push(r),r}},{key:"GetStages",value:function(){for(var t=this.stages,e=[],n=0;n<t.length;++n)for(var r=0;r<arguments.length;++r)t[n].id===arguments[r]&&e.push(t[n]);return e}},{key:"Process",value:function(t){for(var e=this.stages,n=0;n<e.length;++n)e[n].MixedProcess(t)}},{key:"Destroy",value:function(){for(var t=this.stages,e=0;e<t.length;++e)t[e].Destroy();this.ticker.Stop()}}])&&fu(e.prototype,n),r&&fu(e,r),t}();function pu(t){return(pu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vu(t,e){return!e||"object"!==pu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mu(t){return(mu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bu(t,e){return(bu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gu=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=vu(this,mu(e).call(this,t,n,null==r?wu:r,i))).pattern=null,o.patternOffset=new ut.a(0,0),o}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bu(t,e)}(e,Ka),n=e,i=[{key:"BUILD_DEFAULT_TEXTURE",value:function(t){if(!0===Au)throw new Error("Function can only be called once!");wu=new bi(H(X(function(){var t=new nr([0,0,64,0,64,64,0,64,0,0,32,32,64,0,32,32,64,64,32,32,0,64]);return t.ComputeBounds(),t.style.stroke.lineWidth=3,new os(0,0,t)}),64,64,t),"__DEFAULT_TILESPRITE_TEXTURE__",64,64,64,64),Au=!0}},{key:"DEFAULT_TEXTURE",get:function(){return wu}}],(r=[{key:"Render",value:function(t){this.PreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),!0===this.display&&null!==this.pattern&&(this.transform.ApplyGlobal(t),t.globalAlpha=this.tint.channel[3],t.globalCompositeOperation=this.gco,t.fillStyle=this.pattern,t.beginPath(),t.rect(0,0,this.w,this.h),t.closePath(),t.translate(this.patternOffset.x,this.patternOffset.y),t.fill()),this.children.length>0&&this.RenderChildren(t)),this.PostRender(t)}},{key:"GeneratePattern",value:function(t,e,n){null==this.programController?(this.pattern=t.createPattern(this.texture.image,null),this.w=e,this.h=n,this.scale.SetSame(1)):(this.width=e,this.height=n,this.textureTransformation.SetTransform(0,0,this.scale.x,this.scale.y))}},{key:"OffsetPattern",value:function(t,e){this.patternOffset.Add(t,e),this.textureTransformation.Translate(-t/this.w,-e/this.h)}},{key:"SetPatternOffset",value:function(t,e){this.patternOffset.Set(t,e),this.textureTransformation.TranslateTo(-t/this.w,-e/this.h)}},{key:"GetPatternOffset",value:function(){return this.patternOffset}}])&&yu(n.prototype,r),i&&yu(n,i),e}(),wu=null,Au=!1;function Su(t){return(Su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cu(t,e){return!e||"object"!==Su(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tu(t){return(Tu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xu(t,e){return(xu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pu=function(t){function e(t,n,r,i,o,a,s,u,l,c,h,f){var d;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(d=Cu(this,Tu(e).call(this,n,r))).index=t,d.clipX=i,d.clipY=o,d.w=l,d.h=c,d.textureTranslation=new ha,d.textureTransformation=new ha,d.textureTransformation.SetTransform(h*i/l,f*o/c,h,f),a&&s&&u?(d.textureTranslation.SetTransform(-l,-c,h,f),d.rotation=90*-j.RADIAN,d.scale.y=-1):a&&s?(d.textureTranslation.SetTransform(-l,-c,h,f),d.scale.Set(-1,-1)):a&&u?(d.textureTranslation.SetTransform(0,-c,h,f),d.rotation=90*j.RADIAN):s&&u?(d.textureTranslation.SetTransform(-l,0,h,f),d.rotation=90*-j.RADIAN):a?(d.textureTranslation.SetTransform(-l,0,h,f),d.scale.x=-1):s?(d.textureTranslation.SetTransform(0,-c,h,f),d.scale.y=-1):u?(d.textureTranslation.SetTransform(0,0,h,f),d.rotation=90*j.RADIAN,d.scale.y=-1):d.textureTranslation.SetTransform(0,0,h,f),d}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xu(t,e)}(e,Sa),e}();function Eu(t){return(Eu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ou(t,e){return!e||"object"!==Eu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ru(t){return(Ru=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Du(t,e){return(Du=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ku=function(t){function e(t,n,r,i,o,a){var s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(s=Ou(this,Ru(e).call(this,t,n,r,a))).w=0,s.h=0,s.tileW=0,s.tileH=0,s.columns=0,s.cull=!1,s.tiles=[],s.mapData=i,s.Config(i),s.SetMapLayer(i.layers[o]),s}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Du(t,e)}(e,Ka),n=e,(r=[{key:"Config",value:function(t){this.tileW=t.tilewidth,this.tileH=t.tileheight,this.w=this.tileW*t.width,this.h=this.tileH*t.height,this.columns=this.w/this.tileW|0}},{key:"SetMapLayer",value:function(t){var e=t.data;if(t.width*t.height!==e.length)throw new Error(Iu);this.tiles.length=0,this.alpha=t.opacity,this.mapData.orientation===Lu&&this.SetOrthogonal(e)}},{key:"Cull",value:function(t){this.culler=t,this.cull=!0}},{key:"SetOrthogonal",value:function(t){for(var e=t.length,n=this.tileW,r=this.tileH,i=this.texture.fw/n|0,o=this.w/n|0,a=n/this.texture.fw,s=r/this.texture.fh,u=0,l=0,c=0,h=0,f=0,d=0,p=0;p<e;++p)0!==(l=t[p])&&(c=p%o*n,h=(p/o|0)*r,f=(u=Object(B.ClearBit)(31,Object(B.ClearBit)(30,Object(B.ClearBit)(29,l)))-1)%i*n,d=(u/i|0)*r,this.tiles.push(new Pu(u,c,h,f,d,Object(B.IsBitSet)(31,l),Object(B.IsBitSet)(30,l),Object(B.IsBitSet)(29,l),n,r,a,s)))}},{key:"Render",value:function(t){this.PreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),!0===this.display&&(!0===this.cull?this.CullRender(t):this.NoCullRender(t),this.children.length>0&&this.RenderChildren(t))),this.PostRender(t)}},{key:"GLRender",value:function(t){this.GLPreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),!0===this.display&&(!0===this.cull?this.GLCullRender(t):this.GLNoCullRender(t),this.children.length>0&&this.GLRenderChildren(t))),this.GLPostRender(t)}},{key:"CullRender",value:function(t){for(var e=this.texture.image,n=this.tiles,r=this.tileW,i=this.tileH,o=this.culler,a=o.bounds.tl,s=o.bounds.br,u=o.rootMatrix.e,l=o.rootMatrix.f,c=o.rootMatrix.a,h=o.rootMatrix.d,f=n[0],d=null,p=0;p<n.length;f=n[++p])f.ProcessTransform(this),(d=f.GetGlobalPosition()).Subtract(u,l),d.Divide(c,h),d.x>s.x||d.y>s.y||d.x<a.x||d.y<a.y||(f.transform.ApplyGlobal(t),t.drawImage(e,f.clipX,f.clipY,r,i,f.textureTranslation.e,f.textureTranslation.f,r,i))}},{key:"NoCullRender",value:function(t){for(var e=this.texture.image,n=this.tiles,r=this.tileW,i=this.tileH,o=n[0],a=0;a<n.length;o=n[++a])o.ProcessTransform(this),o.transform.ApplyGlobal(t),t.drawImage(e,o.clipX,o.clipY,r,i,o.textureTranslation.e,o.textureTranslation.f,r,i)}},{key:"GLCullRender",value:function(){for(var t=this.programController,e=this.texture.uniformId,n=this.tint.channel,r=this.tiles,i=this.culler,o=i.bounds.tl,a=i.bounds.br,s=i.rootMatrix.e,u=i.rootMatrix.f,l=i.rootMatrix.a,c=i.rootMatrix.d,h=r[0],f=null,d=0;d<r.length;h=r[++d])h.ProcessTransform(this),(f=h.GetGlobalPosition()).Subtract(s,u),f.Divide(l,c),f.x>a.x||f.y>a.y||f.x<o.x||f.y<o.y||t.Execute(h.transform.globalTransform.AsArray(!0),h.textureTranslation.AsArray(!0),h.textureTransformation.AsArray(!0),n,e)}},{key:"GLNoCullRender",value:function(){for(var t=this.programController,e=this.texture.uniformId,n=this.tint.channel,r=this.tiles,i=r[0],o=0;o<r.length;i=r[++o])i.ProcessTransform(this),t.Execute(i.transform.globalTransform.AsArray(!0),i.textureTranslation.AsArray(!0),i.textureTransformation.AsArray(!0),n,e)}}])&&_u(n.prototype,r),i&&_u(n,i),e}(),Iu="Size error!",Lu="orthogonal";function Bu(t){return(Bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ju(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Gu(t,e){return!e||"object"!==Bu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vu(t){return(Vu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nu(t,e){return(Nu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fu=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Gu(this,Vu(e).call(this,t,n))).id=parseInt(r.id),i.cx=parseInt(r.x),i.cy=parseInt(r.y),i.w=parseInt(r.width),i.h=parseInt(r.height),i.xoffset=parseInt(r.xoffset),i.yoffset=parseInt(r.yoffset),i.xadvance=parseInt(r.xadvance),i.yadvance=0,i.kernings=[],i.translation=new ha,i.transformation=new ha,i}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nu(t,e)}(e,Sa),n=e,(r=[{key:"Render",value:function(t,e){t.drawImage(e,this.cx,this.cy,this.width,this.height,this.position.x,this.position.y,this.width,this.height)}},{key:"GLRenderAuto",value:function(t,e,n){this.UpdateMatrices(),t.Execute(this.transform.globalTransform.AsArray(!0),this.translation.AsArray(!0),this.transformation.AsArray(!0),e,n)}},{key:"GLRender",value:function(t,e,n){t.Execute(this.transform.globalTransform.AsArray(!0),this.translation.AsArray(!0),this.transformation.AsArray(!0),e,n)}},{key:"ApplyKernings",value:function(t){for(var e,n=0;n<t.length;++n)e=t[n].attributes,parseInt(e.first)===this.id&&this.kernings.push(parseInt(e.first),parseInt(e.second),parseInt(e.amount))}},{key:"Crunch",value:function(t){if(this.position.SetSame(0),null!=t&&(this.x=t.x+t.xadvance,this.y=this.yadvance=t.yadvance,t.kernings&&t.kernings.length>0&&this.kernings.length>0))for(var e=this.kernings,n=0;n<e.length;n+=3)if(e[n+1]===t.id){this.x+=e[n+2];break}this.position.Add(this.xoffset,this.yoffset)}},{key:"UpdateMatrices",value:function(){if(null!=this.parent){var t=this.parent.texture,e=this.width/t.fw,n=this.height/t.fh;this.UpdateTransform(this.parent),this.translation.SetTransform(0,0,e,n),this.transformation.SetTransform(e*this.cx/this.width,n*this.cy/this.height,e,n)}}}])&&ju(n.prototype,r),i&&ju(n,i),e}();function Mu(t){return(Mu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xu(t,e){return!e||"object"!==Mu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hu(t){return(Hu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yu(t,e){return(Yu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wu=function(t){function e(t,n,r,i,o,a){var s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(s=Xu(this,Hu(e).call(this,t,n,r,a))).fontData=i,s.lineHeight=i.font.common.attributes.lineHeight,s.chars=[],s.maxWidth=1024,s.text="",s.autoUpdateChars=!0,null!=o&&(s.text=o),s.ComputeText(),s}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yu(t,e)}(e,Ka),n=e,(r=[{key:"Render",value:function(t){this.PreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),this.transform.ApplyGlobal(t),!0===this.display&&(t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,this.RenderText(t)),this.children.length>0&&this.RenderChildren(t)),this.PostRender(t)}},{key:"GLRender",value:function(t){this.GLPreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),!0===this.display&&null!==this.programController&&this.GLRenderText(t),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchRenderChildren(t):this.GLRenderChildren(t))),this.GLPostRender(t)}},{key:"RenderText",value:function(t){for(var e=this.chars,n=this.texture.image,r=0;r<e.length;++r)e[r].Render(t,n)}},{key:"GLRenderText",value:function(){var t=this.chars;if(!0===this.autoUpdateChars)for(var e=0;e<t.length;++e)t[e].GLRenderAuto(this.programController,this.tint.channel,this.texture.uniformId);else for(e=0;e<t.length;++e)t[e].GLRender(this.programController,this.tint.channel,this.texture.uniformId)}},{key:"ComputeText",value:function(){var t,e,n,r=0,i=0,o=!1,a=0,s=0,u=0,l=0,c=this.chars,h=this.text;this.UpdateTransform(this.parent),c.length=0,this.fontData.font.kernings&&(t=this.fontData.font.kernings.kerning);for(var f=0;f<h.length;++f){var d=h.charCodeAt(f);n=c[f-1-i],10!==d?(e=new Fu(0,0,this.GetCharDataById(d)),null!=t&&e.ApplyKernings(t),e.Crunch(n),u=e.position.x+e.width,l=e.position.y+e.height,(u>this.maxWidth||!0===o)&&(e.position.SetSame(0),e.yadvance=this.lineHeight*++r,e.position.Add(e.xoffset,e.yoffset+e.yadvance),o=!1),u>a&&(a=u),l>s&&(s=l),e.parent=this,e.UpdateMatrices(),c.push(e)):(i++,o=!0)}this.w=a,this.h=s}},{key:"UpdateChars",value:function(){for(var t=this.chars,e=0;e<t.length;++e)t[e].UpdateMatrices()}},{key:"GetCharDataById",value:function(t){for(var e=this.fontData.font.chars.char,n=0;n<e.length;++n)if(parseInt(e[n].attributes.id)===t)return e[n].attributes}},{key:"UpdateInBuffer",value:function(){throw new Error(qu)}},{key:"GetBufferData",value:function(){throw new Error(qu)}}])&&Uu(n.prototype,r),i&&Uu(n,i),e}(),qu="Cannot access buffer data directly on BitmapText!";function zu(t){return(zu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ku(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ju(t,e){return!e||"object"!==zu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qu(t){return(Qu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $u(t,e){return($u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zu=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Ju(this,Qu(e).call(this,t,n))).text=r,o.style=Dn(i),o.maxWidth=void 0,o.alpha=1,o.gco=_e,o}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$u(t,e)}(e,ja),n=e,(r=[{key:"Render",value:function(t){if(this.PreRender(t),!0===this.render){if(this.ProcessTransform(this.parent),this.transform.ApplyGlobal(t),!0===this.display){var e=this.style;!0===e.shadow.applied&&e.shadow.Apply(t),!0===e.text.applied&&(e.text.Apply(t),t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,t.fillText(this.text,0,0,this.maxWidth),t.strokeText(this.text,0,0,this.maxWidth))}this.children.length>0&&this.RenderChildren(t)}}},{key:"IntersectsPoint2D",value:function(){return!1}}])&&Ku(n.prototype,r),i&&Ku(n,i),e}();function tl(t){return(tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function el(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nl(t,e){return!e||"object"!==tl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function rl(t){return(rl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function il(t,e){return(il=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ol=Math.cos,al=Math.sin,sl=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=nl(this,rl(e).call(this,0,0))).focus=t,r.target=n,r.velocity=new ut.a(0,0),r.force=new ut.a(1,1),r.stopRadiusSq=1e3,r.EPSILON=2e-4,r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&il(t,e)}(e,ja),n=e,(r=[{key:"Process",value:function(){var t=this.target;if(null!=t){ll.SetV(t.position),ll.Invert(),ll.AddV(this.focus),ul.SetV(this.position).SubtractV(ll);var e=ul.GetMagnitudeSquared();if(e<this.stopRadiusSq)return;e*=this.EPSILON;var n=ul.GetAngle();this.velocity.Set(e*ol(n),e*al(n)).MultiplyV(this.force),this.position.SubtractV(this.velocity)}}},{key:"SetTarget",value:function(t){return this.target=t,this}}])&&el(n.prototype,r),i&&el(n,i),e}(),ul=new ut.a(0,0),ll=new ut.a(0,0);function cl(t){return(cl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fl(t,e){return!e||"object"!==cl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dl(t){return(dl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pl(t,e){return(pl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yl=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=fl(this,dl(e).call(this,t,n))).programController=r,i.w=128,i.h=128,i.time=0,i.timeInc=.1,i.transformShouldUpdate=!1,i.transformAutomaticUpdate=!1,i}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pl(t,e)}(e,Sa),n=e,(r=[{key:"GLPreRender",value:function(){}},{key:"GLPostRender",value:function(){}},{key:"GLRender",value:function(t){this.GLPreRender(t),this.ProcessTransform(this.parent);var e=this.bounds.local;this.programController.Execute(this.transform.globalTransform.AsArray(!0),e.tl.x,e.tl.y,e.w,e.h,this.time),this.time+=this.timeInc,this.GLPostRender(t)}}])&&hl(n.prototype,r),i&&hl(n,i),e}();function vl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ml=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.bounds=new ue(e,n,r,i),this.container=null,this.entities=null,this.rootMatrix=null,this.onOut=new wr,this.onIn=new wr}var e,n,r;return e=t,(n=[{key:"BindContainer",value:function(t){return this.container=t,this.entities=t.children,this}},{key:"SetRootMatrix",value:function(t){return this.rootMatrix=t,this}},{key:"Process",value:function(){for(var t=this.entities,e=t[0],n=this.bounds,r=this.rootMatrix,i=0;i<t.length;e=t[++i])e.ComputeGlobalBounds(e.anchor,r),!1===n.IntersectsAABB2D(e.bounds.global)?!1!==e.__inside__&&(e.__inside__=!1,this.onOut.Dispatch(e)):!0!==e.__inside__&&(e.__inside__=!0,this.onIn.Dispatch(e))}}])&&vl(e.prototype,n),r&&vl(e,r),t}();n.d(e,"Math",function(){return j}),n.d(e,"Assert",function(){return di.a}),n.d(e,"Pool",function(){return $o.a}),n.d(e,"FlagList",function(){return Gs}),n.d(e,"FlagEnum",function(){return Ns}),n.d(e,"Cache",function(){return yi}),n.d(e,"Glob",function(){return Fs.a}),n.d(e,"Maker",function(){return Us}),n.d(e,"Color",function(){return sr}),n.d(e,"Utility",function(){return B}),n.d(e,"Cipher",function(){return r}),n.d(e,"BrowserUtility",function(){return i}),n.d(e,"Style",function(){return b}),n.d(e,"Time",function(){return w}),n.d(e,"CharacterSets",function(){return Hs.a}),n.d(e,"CanvasManager",function(){return Ws}),n.d(e,"Vector2D",function(){return ut.a}),n.d(e,"Matrix2D",function(){return ha}),n.d(e,"Transform2D",function(){return va}),n.d(e,"Bounds2D",function(){return ga}),n.d(e,"QuadtreeNode",function(){return Zs}),n.d(e,"Ease",function(){return o}),n.d(e,"Collision",function(){return f}),n.d(e,"Geom",function(){return p}),n.d(e,"Packing",function(){return I}),n.d(e,"Path",function(){return g}),n.d(e,"CoreEntity2D",function(){return Sa}),n.d(e,"Container2D",function(){return Ra}),n.d(e,"VisualContainer2D",function(){return ja}),n.d(e,"BatchableContainer2D",function(){return Ua}),n.d(e,"TextureEntity2D",function(){return Ka}),n.d(e,"Stage2D",function(){return hu}),n.d(e,"Stadium",function(){return du}),n.d(e,"Graphic2D",function(){return os}),n.d(e,"Sprite",function(){return fs}),n.d(e,"Tilesprite",function(){return gu}),n.d(e,"Tile",function(){return Pu}),n.d(e,"Tilemap",function(){return ku}),n.d(e,"Char",function(){return Fu}),n.d(e,"BitmapText",function(){return Wu}),n.d(e,"Text",function(){return Zu}),n.d(e,"Camera2D",function(){return sl}),n.d(e,"GLEntity2D",function(){return yl}),n.d(e,"Culler2D",function(){return ml}),n.d(e,"Shader",function(){return A}),n.d(e,"Load",function(){return S}),n.d(e,"Controller",function(){return T}),n.d(e,"CP",function(){return x}),n.d(e,"Motion",function(){return P}),n.d(e,"Particle",function(){return _}),n.d(e,"Texture",function(){return O}),n.d(e,"Animator",function(){return R}),n.d(e,"Debug",function(){return k}),n.d(e,"Input",function(){return L}),n(25)},function(t,e,n){"use strict";n.d(e,"a",function(){return f});var r=n(6);function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=Math.ceil,a=Math.round,s=Math.abs,u=Math.sqrt,l=Math.atan2,c=Math.cos,h=Math.sin,f=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=n}var e,n,r;return e=t,r=[{key:"SortMinMag",value:function(t,e){return t.GetMagnitudeSquared()-e.GetMagnitudeSquared()}},{key:"pool",get:function(){return d}},{key:"USE_POOL",get:function(){return p},set:function(t){p=!!t}}],(n=[{key:"Copy",value:function(){return!0===p?d.Retrieve(this.x,this.y):new t(this.x,this.y)}},{key:"FromPool",value:function(e,n){return!0===p?d.Retrieve(e,n):new t(e,n)}},{key:"AbsoluteCopy",value:function(){var t=this.Copy();return t.Positive(),t}},{key:"SetV",value:function(t){return this.x=t.x,this.y=t.y,this}},{key:"Set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"SetSame",value:function(t){return this.x=t,this.y=t,this}},{key:"Is0",value:function(){return 0===this.x&&0===this.y}},{key:"AddVC",value:function(t){return this.Copy().AddV(t)}},{key:"AddV",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"Add",value:function(t,e){return this.x+=t,this.y+=e,this}},{key:"SubtractVC",value:function(t){return this.Copy().SubtractV(t)}},{key:"SubtractV",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"Subtract",value:function(t,e){return this.x-=t,this.y-=e,this}},{key:"MultiplyVC",value:function(t){return this.Copy().MultiplyV(t)}},{key:"MultiplyV",value:function(t){return this.x*=t.x,this.y*=t.y,this}},{key:"Multiply",value:function(t,e){return this.x*=t,this.y*=e,this}},{key:"DivideVC",value:function(t){return this.Copy().DivideV(t)}},{key:"DivideV",value:function(t){return this.x/=t.x,this.y/=t.y,this}},{key:"Divide",value:function(t,e){return this.x/=t,this.y/=e,this}},{key:"Normalize",value:function(){var t=this.GetMagnitude();return this.Divide(t,t)}},{key:"Positive",value:function(){return this.x=s(this.x),this.y=s(this.y),this}},{key:"Negative",value:function(){return this.x=-s(this.x),this.y=-s(this.y),this}},{key:"Invert",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"Rotate",value:function(t){var e=h(t),n=c(t),r=this.x,i=this.y;return this.x=r*n-i*e,this.y=r*e+i*n,this}},{key:"RotateAroundV",value:function(t,e){return this.SubtractV(t).Rotate(e).AddV(t)}},{key:"RotateAround",value:function(t,e,n){return this.SubtractV(t,e).Rotate(n).AddV(t,e)}},{key:"RotateAbsolute",value:function(t){return this.Rotate(t-this.GetAngle())}},{key:"RotateAbsoluteAroundV",value:function(t,e){return this.SubtractV(t).RotateAbsolute(e).AddV(t)}},{key:"RotateAbsoluteAround",value:function(t,e,n){return this.SubtractV(t,e).RotateAbsolute(n).AddV(t,e)}},{key:"PushFromV",value:function(t,e){var n=this.Copy();return n.SubtractV(t).Normalize().Multiply(e,e),this.AddV(n)}},{key:"PushFrom",value:function(t,e,n){var r=this.Copy();return r.SubtractV(t,e).Normalize().Multiply(n,n),this.AddV(r)}},{key:"GetWeightedAverageV",value:function(t,e){return this.FromPool(this.x*(1-e)+t.x*e,this.y*(1-e)+t.y*e)}},{key:"GetWeightedAverage",value:function(t,e,n){return this.FromPool(this.x*(1-n)+t*n,this.y*(1-n)+e*n)}},{key:"GetAngle",value:function(){return l(this.y,this.x)}},{key:"GetAngleBetweenV",value:function(t){return l(this.y-t.y,this.x-t.x)}},{key:"GetAngleBetween",value:function(t,e){return l(this.y-e,this.x-t)}},{key:"GetDotV",value:function(t){return this.x*t.x+this.y*t.y}},{key:"GetDot",value:function(t,e){return this.x*t+this.y*e}},{key:"GetCrossV",value:function(t){return this.x*t.y+this.y*t.x}},{key:"GetCross",value:function(t,e){return this.x*e+this.y*t}},{key:"GetMagnitudeSquared",value:function(){return this.x*this.x+this.y*this.y}},{key:"GetMagnitude",value:function(){return u(this.x*this.x+this.y*this.y)}},{key:"GetDistanceSquaredV",value:function(t){return this.Copy().SubtractV(t).GetMagnitudeSquared()}},{key:"GetDistanceSquared",value:function(t,e){return this.Copy().Subtract(t,e).GetMagnitudeSquared()}},{key:"GetDistanceV",value:function(t){return this.Copy().SubtractV(t).GetMagnitude()}},{key:"GetDistance",value:function(t,e){return this.Copy().Subtract(t,e).GetMagnitude()}},{key:"GetPerpendicularCCWV",value:function(t){return this.FromPool(-(t.y-this.y),t.x-this.x)}},{key:"GetPerpendicularCCW",value:function(t,e){return this.FromPool(-(e-this.y),t-this.x)}},{key:"GetPerpendicularCWV",value:function(t){return this.FromPool(t.y-this.y,-(t.x-this.x))}},{key:"GetPerpendicularCW",value:function(t,e){return this.FromPool(e-this.y,-(t-this.x))}},{key:"GetNormalAV",value:function(t){return this.GetPerpendicularCCWV(t).Normalize()}},{key:"GetNormalA",value:function(t,e){return this.GetPerpendicularCCW(t,e).Normalize()}},{key:"GetNormalBV",value:function(t){return this.GetPerpendicularCWV(t).Normalize()}},{key:"GetNormalB",value:function(t,e){return this.GetPerpendicularCW(t,e).Normalize()}},{key:"GetMidpointV",value:function(t){return this.Copy().AddV(t).Divide(2,2)}},{key:"GetMidpoint",value:function(t,e){return this.Copy().Add(t,e).Multiply(.5,.5)}},{key:"IsEqualToV",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"IsEqualTo",value:function(t,e){return this.x===t&&this.y===e}},{key:"GetProjectionOntoV",value:function(t){var e=this.GetDotV(t);if(0===e)return this.FromPool(0,0);var n=t.GetMagnitude(),r=e/(n*n);return t.Copy().Multiply(r,r)}},{key:"GetProjectionOnto",value:function(t,e){var n=this.Copy();n.Set(t,e);var r=this.GetDotV(n);if(0===r)return this.FromPool(0,0);var i=n.GetMagnitude(),o=r/(i*i);return n.Multiply(o,o),n}},{key:"GetReflectionV",value:function(t){var e=t.Copy(),n=this.GetDotV(e);return e.Multiply(2,2).Multiply(n,n),this.SubtractVC(e)}},{key:"GetReflection",value:function(t,e){var n=this.Copy();n.Set(t,e);var r=this.GetDotV(n);return n.Multiply(2,2).Multiply(r,r),this.SubtractVC(n)}},{key:"Store",value:function(){return d.Store(this),this}},{key:"AddTo",value:function(t){for(var e=0;e<t.length;++e)t[e].AddV(this);return this}},{key:"Floor",value:function(){return this.x=0|this.x,this.y=0|this.y,this}},{key:"Ceil",value:function(){return this.x=o(this.x),this.y=o(this.y),this}},{key:"Round",value:function(){return this.x=a(this.x),this.y=a(this.y),this}},{key:"GetMinMaxDot",value:function(t){for(var e=1/0,n=-e,r=0,i=this.Copy(),o=0;o<t.length;++o)(r=t[o].GetDotV(this))>n&&(n=r),r<e&&(e=r);return i.Set(e,n),i}}])&&i(e.prototype,n),r&&i(e,r),t}(),d=new r.a,p=!0;d.Retrieve=function(t,e){return this.PreRetrieve(),this.objects.pop().Set(t,e)},d.Flood(function(){return new f(0,0)},1e3)},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(t,e){var n=document.getElementById("buttons"),r=document.createElement("input"),i=document.getElementById("back-button");r.setAttribute("value",t),r.setAttribute("type","button"),r.addEventListener("click",function(){n.style.display="none",i.onclick=a,e(o)}),n.appendChild(r);var o={canvas:null,stage:null,stadium:null,ticker:null};function a(){o.canvas&&o.canvas.parentNode.removeChild(o.canvas),o.stage&&o.stage.Destroy(),o.stadium&&(o.stadium.stages.forEach(function(t){t.canvas.parentNode.removeChild(t.canvas)}),o.stadium.Destroy()),o.canvasManager&&o.canvasManager.Destroy(),o.ticker&&o.ticker.Stop(),i.onclick=null,n.style.display=null}}},function(t,e,n){"use strict";n.r(e),n.d(e,"RandomInteger",function(){return l}),n.d(e,"RandomFloat",function(){return c}),n.d(e,"IsInteger",function(){return h}),n.d(e,"IsFloat",function(){return f}),n.d(e,"IsArray",function(){return d}),n.d(e,"Sign",function(){return p}),n.d(e,"IsBitSet",function(){return y}),n.d(e,"SetBit",function(){return v}),n.d(e,"ClearBit",function(){return m}),n.d(e,"ToggleBit",function(){return b}),n.d(e,"Clamp",function(){return g}),n.d(e,"InverseClamp",function(){return w}),n.d(e,"FlipACoin",function(){return A}),n.d(e,"NearestPow2Floor",function(){return S}),n.d(e,"NearestPow2Ceil",function(){return C}),n.d(e,"NearestPow2Round",function(){return T}),n.d(e,"GenerateSequence",function(){return x}),n.d(e,"RandomInArray",function(){return P}),n.d(e,"MinMaxOrValue",function(){return E}),n.d(e,"UUID",function(){return _}),n.d(e,"ApplyProperties",function(){return O}),n.d(e,"Nested",function(){return R}),n.d(e,"ArrayGetRandom",function(){return D}),n.d(e,"ArrayShuffle",function(){return k}),n.d(e,"Base16ToBase10",function(){return I}),n.d(e,"Base2ToBase10",function(){return L}),n.d(e,"IsObjectEmpty",function(){return B}),n.d(e,"DeepClone",function(){return j}),n.d(e,"CreateIteratorArgs",function(){return G}),n.d(e,"ReplaceArgumentWithObjectValue",function(){return V}),n.d(e,"PRINT_VERSION",function(){return N});var r=n(4),i=n(8);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a=n(26).version,s=Math.random,u=Math.clz32;function l(t,e){return s()*(e-t+1)+t|0}function c(t,e){return s()*(e-t)+t}function h(t){return Number(t)===t&&t%1==0}function f(t){return Number(t)===t&&t%1!=0}function d(t){return"[object Array]"===Object.prototype.toString.call(t)}function p(t,e){return 0===t?!0===e?1:0:t>0?1:-1}function y(t,e){return 0!=(e&1<<t)}function v(t,e){return e|1<<t}function m(t,e){return e&~(1<<t)}function b(t,e){return e^1<<t}function g(t,e,n){return t<e?e:t>n?n:t}function w(t,e,n){return t<e?n:t>n?e:t}function A(t,e){return 1===l(1,2)?t:e}function S(t){return 1<<31-u(t)}function C(t){return 1<<31-u(2*t)}function T(t){return 1<<31-u(1.5*t)}function x(t,e,n,i){for(var o=[],a=0;a<e;a+=n)o.push(Object(r.PrecisionRound)(a,i));return o}function P(t){return t[l(0,t.length-1)]}function E(t,e){return null!=t.min&&null!=t.max?c(t.min,t.max):null!=t.values&&t.values.length>0?P(t.values):null!=e&&t[e].length>0?P(t[e]):t}function _(t,e,n,r){var o,a,s="",u=t/e,c=i.a[n];t=null==t?32:t,e=null==e?4:e,n=null==n?0:n,r=null==r?"-":r;for(var f=0;f<t;++f)0!==(a=f/u)&&h(a)?s+=r:(o=l(1,c.length-1),s+=c.charAt(o));return s}function O(t,e){var n;if(void 0!==e)for(n in e)void 0!==t[n]&&(t[n]=e[n])}function R(t,e,n,r,i,o){var a;if("string"==typeof e&&(o=null==o?".":o,e=e.split(o)),e.length>1){if(void 0!==t[a=e.shift()])return R(t[a],e,n,r,i,o)}else{if(void 0!==t[a=e.shift()])return!0===r?void(t[a]=i):!0===n?t:t[a];if(!0===r)return void(t[a]=i)}}function D(t,e){for(var n=[],r={},i=t.length,o=0;o<e;++o){var a=s()*i|0;void 0===r[a]?(r[a]=null,n.push(t[a])):o--}return n}function k(t){for(var e,n,r=t.length-1;r-- >=0;)n=s()*r|0,e=t[r],t[r]=t[n],t[n]=e}function I(t){return parseInt(t,16)}function L(t){return parseInt(t,2)}function B(t){var e;for(e in t)if(t.hasOwnProperty(e))return!1;return JSON.stringify(t)===JSON.stringify({})}function j(t){var e,n=null,r=!1;if("function"==typeof t)throw new TypeError("Object was of type: function. Not acceptable.");if(d(t))n=[],r=!0;else{if("object"!==o(t))return t;n={}}if(r)for(var i=0;i<t.length;++i)n[i]=j(t[i]);else for(e in t)t.hasOwnProperty(e)&&(n[e]=j(t[e]));return n}function G(t,e,n){for(var r,i,o,a,s=[],u=0;u<t.length;++u)"string"==typeof(r=t[u])&&0===r.indexOf(e)&&r.indexOf(n)===e.length&&(-1!==(a=r.indexOf("|"))?(i=r.slice(r.indexOf("(")+1,a),o=r.slice(a+1,r.indexOf(")")),s.push({mod:i,val:o,iteratorIndex:u})):s.push({iteratorIndex:u}));return s}function V(t,e,n){for(var r,i=0;i<e.length;++i)"string"==typeof(r=e[i])&&0===r.indexOf(n)&&(e[i]=R(t,r.slice(n.length)))}function N(t){t?console.log("nenkraft2 server version "+a):console.log("%cnenkraft2 %cversion %c"+a,"color:#f0f7da;background-color:#234d20;font-family:Arial;font-size:18px;font-weight:900;padding:5px;","color:#f0f7da;background-color:#36802d;font-family:Arial;font-size:18px;font-weight:900;padding:5px;","color:#f0f7da;background-color:#77ab59;font-family:Arial;font-size:18px;font-weight:900;padding:5px;")}},function(t,e,n){"use strict";n.r(e),n.d(e,"PII",function(){return c}),n.d(e,"PI5",function(){return h}),n.d(e,"DEGREES_TO_RADIANS",function(){return f}),n.d(e,"RADIANS_TO_DEGRESS",function(){return d}),n.d(e,"RADIAN",function(){return p}),n.d(e,"DegreesToRadians",function(){return y}),n.d(e,"RadiansToDegress",function(){return v}),n.d(e,"PrecisionRound",function(){return m}),n.d(e,"Spread",function(){return b}),n.d(e,"AttractRepel",function(){return g}),n.d(e,"Oscillate",function(){return w}),n.d(e,"LikeASquareGrid",function(){return A}),n.d(e,"TriRectArray",function(){return S}),n.d(e,"GreatestCommonDivisor",function(){return C}),n.d(e,"SimplifyAspectRatio",function(){return T}),n.d(e,"IntegerNotation",function(){return x});var r=n(7);n.d(e,"Misc",function(){return r});var i=Math.PI,o=Math.sin,a=Math.cos,s=Math.pow,u=Math.round,l=Math.ceil,c=2*i,h=.5*i,f=i/180,d=180/i,p=f;function y(t){return t*f}function v(t){return t*d}function m(t,e){if(null==e)return t;var n=s(10,e);return u(n*t)/n}function b(t,e,n,r){return t-n*(e-1)*.5+r*n}function g(t,e,n,r,i){var s=e.SubtractVC(t);if(s.GetMagnitudeSquared()<r*r){var u=s.GetAngle();n.Add(a(u)*i,o(u)*i)}}function w(t,e,n,r){var i=.5*(n-e);return e+i+o(y(t*r))*i}function A(t,e,n,r){for(var i=e/n|0,o=0;o<t.length;++o)t[o].Set(o%i*n,(o/i|0)*r)}function S(t,e,n,r,i){return null!=i?(i[0]=t,i[1]=e,i[2]=t+n,i[3]=e,i[4]=t,i[5]=e+r,i[6]=t,i[7]=e+r,i[8]=t+n,i[9]=e,i[10]=t+n,i[11]=e+r,i):[t,e,t+n,e,t,e+r,t,e+r,t+n,e,t+n,e+r]}function C(t,e){return 0===e?t:C(e,t%e)}function T(t,e,n){var r=C(t,e),i=null==n?[]:n;return i[0]=t/r,i[1]=e/r,i}function x(t,e,n){var r=t%e,i=t/e;return l(0===r?i+1:i)+n+(1+r)}},function(t,e,n){"use strict";(function(t){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e,n,a){if(null==a||"function"!=typeof t.Assert)switch(e){case i.IS:return void function(t,e,n){var r=!1;t!==e&&(r=!0);o(r,t,e,n)}(t,n,e);case i.IS_NOT:return void function(t,e,n){var r=!1;t===e&&(r=!0);o(r,t,e,n)}(t,n,e);case i.IS_SAME_TYPE:return void function(t,e,n){var i=!1;Array.isArray(t)||Array.isArray(e)?!Array.isArray(t)!=!Array.isArray(e)&&(i=!0):null===t||null===e?t!==e&&(i=!0):r(t)!==r(e)?i=!0:"number"!=typeof t&&"number"!=typeof e||(isNaN(t)||isNaN(e))&&t!==e&&(i=!0);o(i,t,e,n)}(t,n,e);case i.IS_NOT_SAME_TYPE:return void function(t,e,n){var i=!1;Array.isArray(t)||Array.isArray(e)?Array.isArray(t)&&Array.isArray(e)&&(i=!0):null===t||null===e?e===t&&(i=!0):r(t)===r(e)?i=!0:"number"!=typeof t&&"number"!=typeof e||(isNaN(t)||isNaN(e))&&isNaN(t)&&isNaN(e)&&(i=!0);o(i,t,e,n)}(t,n,e);case i.IS_INSTANCE_OF:return void function(t,e,n){var r=!1;t instanceof e||(r=!0);o(r,t,e.name,n)}(t,n,e);case i.IS_NOT_INSTANCE_OF:return void function(t,e,n){var r=!1;t instanceof e&&(r=!0);o(r,t,e.name,n)}(t,n,e);case i.IS_LESS_THAN:return void function(t,e,n){var r=!1;t>=e&&(r=!0);o(r,t,e,n)}(t,n,e);case i.IS_GREATER_THAN:return void function(t,e,n){var r=!1;t<=e&&(r=!0);o(r,t,e,n)}(t,n,e);case i.IS_LESS_THAN_OR_EQUAL:return void function(t,e,n){var r=!1;t>e&&(r=!0);o(r,t,e,n)}(t,n,e);case i.IS_GREATER_THAN_OR_EQUAL:return void function(t,e,n){var r=!1;t<e&&(r=!0);o(r,t,e,n)}(t,n,e);default:throw new Error("No comparison: "+e)}else t.Assert(e,n)}function o(t,e,n,r){if(t)throw function(t,e,n){switch(n){case i.IS:n=i.IS_NOT;break;case i.IS_NOT:n=i.IS;break;case i.IS_SAME_TYPE:n=i.IS_NOT_SAME_TYPE;break;case i.IS_NOT_SAME_TYPE:n=i.IS_SAME_TYPE;break;case i.IS_INSTANCE_OF:n=i.IS_NOT_INSTANCE_OF;break;case i.IS_NOT_INSTANCE_OF:n=i.IS_INSTANCE_OF;break;case i.IS_LESS_THAN:n=i.IS_GREATER_THAN_OR_EQUAL;break;case i.IS_GREATER_THAN:n=i.IS_LESS_THAN_OR_EQUAL;break;case i.IS_LESS_THAN_OR_EQUAL:n=i.IS_GREATER_THAN;break;case i.IS_GREATER_THAN_OR_EQUAL:n=i.IS_LESS_THAN;break;default:throw new Error("Unexpected error")}console.error(t,n,e)}(e,n,r),new Error("Assertion failed: "+r);i.LOG&&window&&function(t,e,n){console.log("%c<<||-?START?-||>>","background-color: black; color: #0FF; padding: 0px 25px;"),console.log("%cAssertion success: ","background-color: #333; color: #0F0; padding: 0px 25px;"),console.log(t),console.log(n),console.log(e),console.log("%c>>||-?END?-||<<","background-color: black; color: #FF0; padding: 0px 25px;")}(e,n,r)}n.d(e,"a",function(){return i}),i.IS="I",i.IS_NOT="IN",i.IS_SAME_TYPE="IST",i.IS_NOT_SAME_TYPE="INST",i.IS_INSTANCE_OF="IIO",i.IS_NOT_INSTANCE_OF="INIO",i.IS_LESS_THAN="ILT",i.IS_GREATER_THAN="IGT",i.IS_LESS_THAN_OR_EQUAL="ILTOE",i.IS_GREATER_THAN_OR_EQUAL="IGTOE",i.Assign=function(e){if(window&&!e?e=window:t&&!e&&(e=t),!e)throw new Error("No global namespace");e.IS=i.IS,e.IS_NOT=i.IS_NOT,e.IS_SAME_TYPE=i.IS_SAME_TYPE,e.IS_NOT_SAME_TYPE=i.IS_NOT_SAME_TYPE,e.IS_INSTANCE_OF=i.IS_INSTANCE_OF,e.IS_NOT_INSTANCE_OF=i.IS_NOT_INSTANCE_OF,e.IS_LESS_THAN=i.IS_LESS_THAN,e.IS_GREATER_THAN=i.IS_GREATER_THAN,e.IS_LESS_THAN_OR_EQUAL=i.IS_LESS_THAN_OR_EQUAL,e.IS_GREATER_THAN_OR_EQUAL=i.IS_GREATER_THAN_OR_EQUAL},i.LOG=!1}).call(this,n(9))},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,"a",function(){return i});var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.objects=[],this.floodFunction=null,this.floodAmount=null,this.context=null,this.arguments=null}var e,n,i;return e=t,(n=[{key:"Store",value:function(t){this.objects.push(t)}},{key:"PreRetrieve",value:function(){0===this.objects.length&&this.Flood()}},{key:"Retrieve",value:function(){return this.PreRetrieve(),this.objects.pop()}},{key:"Flood",value:function(t,e,n){t&&(this.floodFunction=t),e&&(this.floodAmount=e),n&&(this.context=n);for(var r=0;r<this.floodAmount;++r)this.Store(this.floodFunction.call(this.context))}},{key:"Flush",value:function(){this.objects.length=0}},{key:"Clean",value:function(){var t=this.objects.length;this.Flush(),this.Flood(void 0,t)}}])&&r(e.prototype,n),i&&r(e,i),t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"Line2DLine2DIntersection",function(){return i}),n.d(e,"ClosestPoint2DOnLine2D",function(){return o});var r=n(1);function i(t,e,n,r){a.SetV(e).SubtractV(t),s.SetV(r).SubtractV(n);var i=-s.x*a.y+a.x*s.y,o=t.x-n.x,u=t.y-n.y,l=(-a.y*o+a.x*u)/i,c=(s.x*u-s.y*o)/i;return l>=0&&l<=1&&c>=0&&c<=1}function o(t,e,n){var r=e.SubtractVC(t),i=((n.x-t.x)*r.x+(n.y-t.y)*r.y)/r.GetMagnitudeSquared();return i<0?t:i>1?e:(r.Set(t.x+i*r.x,t.y+i*r.y),r)}var a=new r.a(0,0),s=new r.a(0,0)},function(t,e,n){"use strict";e.a=["0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz!?#$%@&","0123456789","ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","ABCDEFGHJIKLMNOPQRSTUWVXYZ","abcdefghijklmnopqrstuwvxyz","0123456789abcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZ"]},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return a});var r=n(3);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.functions={},this.values={},this.constants={},this.components={},this.objects={},this.lists={}}var n,a,p;return n=e,p=[{key:"Assign",value:function(e){if(window&&!e?e=window:t&&!e&&(e=t),!e)throw new Error("No global namespace");e.FUNC=s,e.VAL=u,e.CONST=l,e.COMP=c,e.OBJ=h,e.LIST=f}},{key:"Create",value:function(n){var r=r||null;if(null==r){if(null==t)throw new Error("Neither window nor global exists!");if(void 0!==t[n])throw new Error("global."+n+" already exists!");t[n]=new e}else{if(void 0!==r[n])throw new Error("window."+n+" already exists!");r[n]=new e}}},{key:"FUNCTION",get:function(){return s}},{key:"VALUE",get:function(){return u}},{key:"CONSTANT",get:function(){return l}},{key:"COMPONENT",get:function(){return c}},{key:"OBJECT",get:function(){return h}},{key:"LIST",get:function(){return f}},{key:"AllowGetNullUndefined",get:function(){return d},set:function(t){(function(t){throw new Error('"'+t+'" is read-only')})("PS_AllowGetNullUndefined"),d=!!t}}],(a=[{key:"Define",value:function(t,e,n){this.Mark(t,e),this.Set(t,e,n)}},{key:"Mark",value:function(t,e){if("string"!=typeof t)throw new Error("Type needs to be a string!");if("string"!=typeof e)throw new Error("Id needs to be a string!");if(null==this[t])throw new Error("Type does not exist");if((t===l||t===c)&&void 0!==this[t][e])throw new Error("Constants cannot be reassigned!");this[t][e]=null}},{key:"Get",value:function(t,n){if("string"!=typeof t)throw new Error("Type needs to be a string!");if("string"!=typeof n)throw new Error("Id needs to be a string!");if(null==this[t])throw new Error("Type does not exist");if(!1===e.AllowGetNullUndefined&&null==this[t][n])throw new Error("Null or undefined!");return this[t][n]}},{key:"Set",value:function(t,e,n){if("string"!=typeof t)throw new Error("Type needs to be a string!");if("string"!=typeof e)throw new Error("Id needs to be a string!");switch(t){case s:if("function"!=typeof n)throw new Error("Needs to be a function!");if(null!==this.functions[e])throw new Error("No mark!");this.functions[e]=n;break;case u:if(n instanceof Object)throw new Error("Objects are not allowed!");if(null!==this.values[e])throw new Error("No mark!");this.values[e]=n;break;case l:if(n instanceof Object)throw new Error("Objects are not allowed!");if(null!==this.constants[e])throw new Error("No mark!");Object.defineProperty(this.constants,e,{writable:!1,configurable:!1,value:n});break;case c:if("function"!=typeof n)throw new Error("Needs to be a function!");if(null!==this.components[e])throw new Error("No mark!");Object.defineProperty(this.components,e,{writable:!1,configurable:!1,value:n});break;case h:if("object"!==i(n))throw new Error("Needs to be an object");if(!0===Object(r.IsArray)(n))throw new Error("Arrays are not allowed!");if(null!==this.objects[e])throw new Error("No mark!");this.objects[e]=n;break;case f:if(!1===Object(r.IsArray)(n))throw new Error("Needs to be an array!");if(null!==this.lists[e])throw new Error("No mark!");this.lists[e]=n;break;default:throw new Error("Unrecognized type!")}}}])&&o(n.prototype,a),p&&o(n,p),e}(),s="functions",u="values",l="constants",c="components",h="objects",f="lists",d=!1}).call(this,n(9))},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nuniform mat3 uProjection;\r\nuniform mat3 uTranslation;\r\nuniform mat3 uTransformation;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vTexCoord = ( uTransformation * vec3( aTexCoord, 1.0 ) ).xy;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\nuniform vec4 uTint;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  gl_FragColor = TEX( uImage, vTexCoord ) * uTint;\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nattribute vec3 aProjection1;\r\nattribute vec3 aProjection2;\r\nattribute vec3 aProjection3;\r\n\r\nattribute vec3 aTranslation1;\r\nattribute vec3 aTranslation2;\r\nattribute vec3 aTranslation3;\r\n\r\nattribute vec3 aTransformation1;\r\nattribute vec3 aTransformation2;\r\nattribute vec3 aTransformation3;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  mat3 projection = mat3( aProjection1, aProjection2, aProjection3 );\r\n  mat3 translation = mat3( aTranslation1, aTranslation2, aTranslation3 );\r\n  mat3 transformation = mat3( aTransformation1, aTransformation2, aTransformation3 );\r\n  gl_Position = vec4( ( projection * translation * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vTexCoord = ( transformation * vec3( aTexCoord, 1.0 ) ).xy;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  gl_FragColor = TEX( uImage, vTexCoord );\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec3 aProjection1;\r\nattribute vec3 aProjection2;\r\nattribute vec3 aProjection3;\r\nattribute vec2 aPosition;\r\nattribute vec4 aColor;\r\nattribute float aPointSize;\r\n\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  mat3 projection = mat3( aProjection1, aProjection2, aProjection3 );\r\n  gl_Position = vec4( ( projection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  gl_PointSize = aPointSize;\r\n  vColor = aColor;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  gl_FragColor = vColor;\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform vec2 uSize;\r\nuniform float uOutline;\r\n\r\nvarying vec2 vPosition;\r\nvarying float vBorderX;\r\nvarying float vNegBorderX;\r\nvarying float vBorderY;\r\nvarying float vNegBorderY;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vPosition = aPosition;\r\n  vBorderX = -uSize.x * 0.5 + uOutline;\r\n  vNegBorderX = uSize.x * 0.5 - uOutline;\r\n  vBorderY = -uSize.y * 0.5 + uOutline;\r\n  vNegBorderY = uSize.y * 0.5 - uOutline;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform lowp vec4 uFillColor;\r\nuniform lowp vec4 uOutlineColor;\r\n\r\nvarying vec2 vPosition;\r\nvarying float vBorderX;\r\nvarying float vNegBorderX;\r\nvarying float vBorderY;\r\nvarying float vNegBorderY;\r\n\r\nvoid main() {\r\n  if (\r\n    vPosition.x > vBorderX &&\r\n    vPosition.x < vNegBorderX && \r\n    vPosition.y > vBorderY && \r\n    vPosition.y < vNegBorderY\r\n  ) {\r\n    gl_FragColor = uFillColor;\r\n  } else {\r\n    gl_FragColor = uOutlineColor;\r\n  }\r\n  \r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\n\r\nvarying vec2 vPosition;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vPosition = aPosition;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform lowp vec4 uFillColor;\r\nuniform lowp vec4 uOutlineColor;\r\nuniform float uRadius;\r\nuniform float uOutline;\r\n\r\nvarying vec2 vPosition;\r\n\r\nvoid main() {\r\n  float d = dot( vPosition, vPosition );\r\n  float rs = uRadius * uRadius;\r\n  float ors = uRadius - uOutline;\r\n  ors = ors * ors;\r\n  if ( d < rs && d > ors ) {\r\n    gl_FragColor = uOutlineColor;\r\n  } else if ( d < rs ) {\r\n    gl_FragColor = uFillColor;\r\n  }\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform lowp vec4 uColor;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform lowp vec4 uColor;\r\n\r\nvoid main() {\r\n  gl_FragColor = uColor;\r\n}\r\n@fragment-end@"},function(t,e){t.exports='/**\r\n* @author Gustav \'Nuuf\' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision highp float;\r\n\r\nattribute vec2 a_v2Position;\r\n\r\nuniform mat3 u_m3Projection;\r\n\r\nvarying vec2 v_v2Position;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( u_m3Projection * vec3( a_v2Position, 1.0 ) ).xy, 0.0, 1.0 );\r\n  v_v2Position = a_v2Position;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n\r\n(import \'RADIAN\' /)\r\n\r\nprecision highp float;\r\n\r\nuniform float u_fTime;\r\nuniform vec2 u_v2Resolution;\r\n\r\nvarying vec2 v_v2Position;\r\n\r\n(import \'rotate2d\' /)\r\n(import \'mod289\' /)\r\n(import \'permute\' /)\r\n(import \'snoise\' /)\r\n(import \'ridge\' /)\r\n(import \'pixelate\' /)\r\n(import \'rmf\' [\r\n  {\r\n    "set": {\r\n      "OFFSET": "1.0 + 0.1 * abs( sin( u_fTime ) )",\r\n      "OCTAVES": "19"\r\n    }\r\n  }\r\n] /)\r\n(import \'rmf\' [\r\n  {\r\n    "replace": {\r\n      "rmf": "rmf2"\r\n    },\r\n    "set": {\r\n      "OFFSET": "0.5 + 0.1 * abs( sin( u_fTime ) )",\r\n      "OCTAVES": "3"\r\n    }\r\n  }\r\n] /)\r\n\r\nvoid main() {\r\n\r\n  vec2 pos = v_v2Position / u_v2Resolution;\r\n\r\n  float sp = 4.0 * u_fTime;\r\n\r\n  pos *= -1.0; \r\n\r\n  pos = pixelate( pos, 1028 );\r\n\r\n  // pos *= rotate2d( RADIAN * sp );\r\n  \r\n  pos += sp / 100.0;\r\n\r\n  vec3 color = vec3( 0.0, rmf2( pos * 10.0 ) * rmf( pos * 0.4 ), 0.0 );\r\n\r\n  color = mix( color * rmf( pos ), vec3( 0.9, 0.0, 0.9 ), 0.2 );\r\n\r\n  gl_FragColor = vec4( color, 1.0 );\r\n  \r\n}\r\n\r\n@fragment-end@'},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( aPosition, 1.0, 1.0 );\r\n    vTexCoord = aTexCoord;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  vec4 color = TEX( uImage, vTexCoord );\r\n  gl_FragColor = vec4( vec3( step( 1.0, color.r + color.g + color.b / 3.0 ) ), color.a );\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( aPosition, 1.0, 1.0 );\r\n    vTexCoord = aTexCoord;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  vec4 color = TEX( uImage, vTexCoord );\r\n  gl_FragColor = vec4( vec3( color.r + color.g + color.b / 3.0 ), color.a );\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( aPosition, 1.0, 1.0 );\r\n    vTexCoord = aTexCoord;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  vec4 color = TEX( uImage, vTexCoord );\r\n  gl_FragColor = vec4( vec3(\r\n    ( color.r * 0.393 ) + ( color.g * 0.769 ) + ( color.b * 0.189 ),\r\n    ( color.r * 0.349 ) + ( color.g * 0.686 ) + ( color.b * 0.168 ),\r\n    ( color.r * 0.272 ) + ( color.g * 0.534 ) + ( color.b * 0.131 )\r\n  ), color.a );\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( aPosition, 1.0, 1.0 );\r\n    vTexCoord = aTexCoord;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  vec4 color = TEX( uImage, vTexCoord );\r\n  gl_FragColor = vec4( vec3(\r\n    1.0 - color.r,\r\n    1.0 - color.g,\r\n    1.0 - color.b\r\n  ), color.a );\r\n}\r\n@fragment-end@"},function(t,e,n){t.exports=n(23)},function(t,e,n){n(24);var r=n(0);console.log(r,r.Shader.UN),r.Utility.PRINT_VERSION(),r.Sprite.BUILD_DEFAULT_TEXTURE(function(){r.Tilesprite.BUILD_DEFAULT_TEXTURE(function(){var t=new r.Load.LoaderCombiner([{loader:new r.Load.ImageLoader,args:[[{id:"fontimg",src:"./assets/images/font.png"},{id:"fontNoK",src:"./assets/images/fontNoK.png"},{id:"1to8",src:"./assets/images/1to8.png"},{id:"4dots",src:"./assets/images/4dots.png"},{id:"colors",src:"./assets/images/colors.png"},{id:"glass-of-blueberryjuice",src:"./assets/images/glass-of-blueberryjuice.png"},{id:"raindrop",src:"./assets/images/raindrop.png"},{id:"smudge",src:"./assets/images/smudge.png"}],!0]},{loader:new r.Load.XHRLoader,args:[[{id:"fontdataxml",src:"./assets/xhr/font.fnt",type:"xml"},{id:"fontdatajson",src:"./assets/xhr/font.json",type:"json"},{id:"fontNoK",src:"./assets/xhr/fontNoK.xml",type:"xml"},{id:"particleExplosion",src:"./assets/xhr/particle-explosion.json",type:"json"}]]},{loader:new r.Load.SpritesheetLoader,args:[[{id:"sheet-default",image:{src:"./../assets/images/invaders/invaders-sheet.png"},data:{src:"./../assets/xhr/invaders.json",type:"json"}}]]},{loader:new r.Load.TilesetLoader,args:[[{id:"tileset",image:{src:"./../assets/images/spritesheet-tiles.png"},data:{src:"./../assets/xhr/spritesheet-tiles.json",type:"json"}}]]}]);t.onComplete.Add(function(){console.log(t),function(){var e=[];window.testData={xhrloader:t.loaders[1],imgloader:t.loaders[0],ssloader:t.loaders[2],tsloader:t.loaders[3],invadersSpritesheet:t.loaders[2].GetSpritesheetById("sheet-default"),tileset:t.loaders[3].GetTilesetById("tileset")},window.testData.invadersSpritesheet.GenerateFrames();var r=n(50);r.keys().forEach(function(t){e.push(r(t))});for(var i=0,o=e.length;i<o;++i)e[i].default()}()},null,!0),t.Load()})})},function(t,e,n){},function(t,e){Array.prototype.indexPop=function(t){var e=this.length-1;if(e>1&&t<=e&&t>=0){var n=this[e];return this[e]=this[t],this[t]=n,this.pop()}return this.pop()},Array.prototype.indexShift=function(t){if(this.length>1&&t<=this.length-1&&t>=0){var e=this[0];return this[0]=this[t],this[t]=e,this.shift()}return this.shift()},Array.prototype.popSplice=function(t){var e=this.length-1;if(!(e<1)){for(var n=this[t];t<e;)this[t]=this[t+1],t++;return this.pop(),n}},Array.prototype.shiftSplice=function(t){if(!(this.length<1)){for(var e=this[t];t>0;)this[t]=this[t-1],t--;return this.shift(),e}},Array.prototype.fickleSplice=function(t){return t>.5*this.length|0?this.popSplice(t):this.shiftSplice(t)}},function(t){t.exports={name:"nenkraft2",version:"1.5.1",description:"A small rendering tool",main:"./bundle-fe/nk2.js",devDependencies:{"@babel/core":"^7.0.0","@babel/preset-env":"^7.0.0","babel-loader":"^8.0.2","copy-webpack-plugin":"^4.5.2","css-loader":"^1.0.0",eslint:"^5.5.0","file-loader":"^2.0.0","html-loader":"^0.5.5","html-webpack-plugin":"^3.2.0","mini-css-extract-plugin":"^0.4.2","raw-loader":"^0.5.1",rimraf:"^2.6.2",webpack:"^4.17.2","webpack-cli":"^3.1.0","webpack-dev-server":"^3.1.8"},dependencies:{},scripts:{"build-prod":"webpack --env production --mode production","build-bundle-fe":"webpack --env bundle-fe --mode production","build-bundle-be":"webpack --env bundle-be --mode production",start:"webpack-dev-server --env development --mode development","clear-bundle-fe":"rimraf bundle-fe/dist","clear-bundle-be":"rimraf bundle-be/dist","clear-dist":"rimraf dist",ce:"rimraf dist bundle-fe/dist bundle-be/dist",be:"yarn run ce && yarn run build-prod && yarn run build-bundle-be && yarn run build-bundle-fe","lint-f":"eslint src demos --fix",lint:"eslint src demos"},keywords:["2d","rendering","command","vector","game","graphic","tween","animation","collision","canvas","web","webgl","utilities"],author:"nuuf",license:"MIT"}},function(t,e){t.exports="#define PI 3.141592653589793\r\n"},function(t,e){t.exports="#define RADIAN 0.017453292519943295"},function(t,e){t.exports="#define RSEED1 46.1964987\r\n#define RSEED2 71.7294374\r\n#define RSEED3 94638.4836"},function(t,e){t.exports="#define VRSEED1 127.1\r\n#define VRSEED2 311.7\r\n#define VRSEED3 269.5\r\n#define VRSEED4 183.3\r\n#define VRSEED5 43758.5453123"},function(t,e){t.exports="float mod289( float n ) {\r\n     return ( n - floor( n * ( 1.0 / 289.0 ) ) * 289.0 );\r\n}\r\nvec2 mod289( vec2 p ) {\r\n     return ( p - floor( p * ( 1.0 / 289.0 ) ) * 289.0 );\r\n}\r\nvec3 mod289( vec3 p ) {\r\n     return ( p - floor( p * ( 1.0 / 289.0 ) ) * 289.0 );\r\n}"},function(t,e){t.exports="float permute( float n ) { \r\n    return ( mod289( ( ( n * 34.0 ) +1.0 ) * n ) );\r\n}\r\nvec2 permute( vec2 p ) { \r\n    return ( mod289( ( ( p * 34.0 ) +1.0 ) * p ) );\r\n}\r\nvec3 permute( vec3 p ) { \r\n    return ( mod289( ( ( p * 34.0 ) +1.0 ) * p ) );\r\n}"},function(t,e){t.exports="mat2 rotate2d ( float a ) {\r\n    float ca = cos( a );\r\n    float sa = sin( a );\r\n    return mat2( ca, sa, -sa, ca );\r\n}"},function(t,e){t.exports="mat2 scale2d ( vec2 scl ) {\r\n    return mat2( scl.x, 0.0, 0.0, scl.y );\r\n}"},function(t,e){t.exports="float plot ( float n, float pct, float prec ) {\r\n    return (\r\n        smoothstep( pct - prec, pct, n ) -\r\n        smoothstep( pct, pct + prec, n )\r\n    );\r\n}"},function(t,e){t.exports="float ridge( float h, float offset ) {\r\n    h = abs( h );\r\n    h = offset - h;\r\n    h *= h;\r\n    return h;\r\n}"},function(t,e){t.exports="vec2 pixelate( vec2 p, int pixels ) {\r\n    return floor( p * float( pixels ) );\r\n}"},function(t,e){t.exports="float random( float n ) {\r\n    return ( fract( sin( n ) * RSEED3 ) );\r\n}\r\nfloat random( vec2 p ) {\r\n    return ( fract( sin( dot( p, vec2( RSEED1, RSEED2 ) ) ) * RSEED3 ) );\r\n}\r\n"},function(t,e){t.exports="vec2 vrandom( vec2 p ) {\r\n    p = vec2( \r\n        dot( p, vec2( VRSEED1, VRSEED2 ) ),\r\n        dot( p, vec2( VRSEED3, VRSEED4 ) )\r\n    );\r\n    return ( -1.0 + 2.0 * fract( sin ( p ) * VRSEED5 ) );\r\n}"},function(t,e){t.exports="float noise( float n ) {\r\n    float fl = floor( n );\r\n    return( mix( random( fl ), random( fl + 1.0 ), fract( n ) ) );\r\n}\r\nfloat noise ( vec2 p ) {\r\n    vec2 fl = floor( p );\r\n    vec2 fr = fract( p );\r\n    float a = random( fl );\r\n    float b = random( fl + vec2( 1.0, 0.0 ) );\r\n    float c = random( fl + vec2( 0.0, 1.0 ) );\r\n    float d = random( fl + vec2( 1.0, 1.0 ) );\r\n    vec2 sm = fr * fr * ( 3.0 - 2.0 * fr );\r\n    return ( \r\n        mix( a, b, sm.x ) + \r\n        ( c -a ) * sm.y * \r\n        ( 1.0 - sm.x ) + \r\n        ( d - b ) * sm.x * sm.y\r\n    );\r\n}"},function(t,e){t.exports="float gnoise( vec2 p ) {\r\n    vec2 fl = floor( p );\r\n    vec2 fr = fract( p );\r\n    vec2 sm = fr * fr * ( 3.0 - 2.0 * fr );\r\n    return ( mix( \r\n            mix( \r\n                dot( vrandom( fl ), fr ), \r\n                dot( vrandom( fl + vec2( 1.0, 0.0 ) ), fr - vec2( 1.0, 0.0 ) ), sm.x\r\n            ),\r\n            mix( \r\n                dot( vrandom( fl + vec2( 0.0, 1.0 ) ), fr - vec2( 0.0, 1.0 ) ), \r\n                dot( vrandom( fl + vec2( 1.0, 1.0 ) ), fr - vec2( 1.0, 1.0 ) ), sm.x\r\n            ),\r\n            sm.y\r\n        )\r\n    );\r\n}"},function(t,e){t.exports="float snoise( vec2 v ) {\r\n    vec4 C = vec4(\r\n        0.211324865405187,\r\n        0.366025403784439,\r\n        -0.577350269189626,\r\n        0.024390243902439\r\n    );\r\n    vec2 i  = floor( v + dot( v, C.yy ) );\r\n    vec2 x0 = v - i + dot( i, C.xx );\r\n    vec2 i1 = vec2( 0.0 );\r\n    i1 = ( x0.x > x0.y ) ? vec2( 1.0, 0.0 ) : vec2( 0.0, 1.0 );\r\n    vec2 x1 = x0.xy + C.xx - i1;\r\n    vec2 x2 = x0.xy + C.zz;\r\n    i = mod289( i );\r\n    vec3 p = permute(\r\n        permute( i.y + vec3( 0.0, i1.y, 1.0 ) ) + i.x + vec3( 0.0, i1.x, 1.0 )\r\n    );\r\n    vec3 m = max( \r\n        0.5 - vec3(\r\n            dot( x0, x0 ),\r\n            dot( x1, x1 ),\r\n            dot( x2, x2 )\r\n        ),\r\n    0.0);\r\n    m = m * m ;\r\n    m = m * m ;\r\n    vec3 x = 2.0 * fract( p * C.www ) - 1.0;\r\n    vec3 h = abs( x ) - 0.5;\r\n    vec3 ox = floor( x + 0.5 );\r\n    vec3 a0 = x - ox;\r\n    m *= 1.79284291400159 - 0.85373472095314 * ( a0 * a0 + h * h );\r\n    vec3 g = vec3( 0.0 );\r\n    g.x  = a0.x  * x0.x  + h.x  * x0.y;\r\n    g.yz = a0.yz * vec2( x1.x, x2.x ) + h.yz * vec2( x1.y, x2.y );\r\n    return ( 130.0 * dot( m, g ) );\r\n}"},function(t,e){t.exports="float fbm ( vec2 p ) {\r\n    float v = 0.0;\r\n    float AMP = 0.5;\r\n    float MULT = 2.0;\r\n    float AMP_MULT = 0.5;\r\n    const int OCTAVES = 3;\r\n    for ( int i = 0; i < OCTAVES; ++i ) {\r\n        v += AMP * NOISE( p );\r\n        AMP *= AMP_MULT;\r\n        p *= MULT;\r\n    }\r\n    return v;\r\n}"},function(t,e){t.exports="float abs_fbm ( vec2 p ) {\r\n    float v = 0.0;\r\n    float AMP = 0.5;\r\n    float LACUNARITY = 2.0;\r\n    float GAIN = 0.5;\r\n    const int OCTAVES = 3;\r\n    for ( int i = 0; i < OCTAVES; ++i ) {\r\n        v += AMP * abs( NOISE( p ) );\r\n        AMP *= GAIN;\r\n        p *= LACUNARITY;\r\n    }\r\n    return v;\r\n}"},function(t,e){t.exports="float rot_fbm_3 ( vec2 p, float a ) {\r\n    float v = 0.0;\r\n    vec2 s = vec2( 100.0 );\r\n    mat2 r = rotate2d( a );\r\n    v += 0.500000 * NOISE( p ); p = p * r * 2.0043 + s;\r\n    v += 0.250000 * NOISE( p ); p = p * r * 2.0310 + s;\r\n    v += 0.125000 * NOISE( p );\r\n    return v;\r\n}"},function(t,e){t.exports="float rmf ( vec2 p ) {\r\n    float LACUNARITY = 2.0;\r\n    float GAIN = 0.5;\r\n    float OFFSET = 0.9;\r\n    float v = 0.0;\r\n    float f = 1.0;\r\n    float AMP = 0.5;\r\n    float prev = 1.0;\r\n    const int OCTAVES = 3;\r\n    for ( int i = 0; i < OCTAVES; ++i ) {\r\n        float n = ridge( snoise( p * f ), OFFSET );\r\n        v += ( n * AMP ) + ( n * AMP * prev );\r\n        prev = n;\r\n        f *= LACUNARITY;\r\n        AMP *= GAIN;\r\n    }\r\n    return v;\r\n}"},function(t,e){t.exports="float aabb( vec2 pos, vec2 size, float blur ){\r\n    size = 0.5 - size * 0.5;\r\n    vec2 dim = smoothstep( size, size + blur, pos ) *\r\n               smoothstep( size - blur, size, 1.0 - pos - blur );\r\n    return dim.x * dim.y;\r\n}"},function(t,e){t.exports="float cruciform( vec2 pos, float size, float armSize, float blur ) {\r\n  return aabb( pos, vec2( size, armSize ), blur ) +\r\n         aabb( pos, vec2( armSize, size ), blur );\r\n}"},function(t,e){t.exports="float circle( vec2 pos, float r, float blur ) {\r\n  return ( 1.0 - smoothstep( r - blur, r, dot( pos , pos ) * 4.0 ) );\r\n}"},function(t,e,n){var r={"./playground/pg.cameradrag.demo":51,"./playground/pg.packing.demo":52,"./playground/pg.un.demo":53,"./solid/1.0.sprite.demo":54,"./solid/1.1.graphic2d.demo":55,"./solid/1.10.text.demo":56,"./solid/1.11.geom.demo":57,"./solid/1.2.container2d.demo":58,"./solid/1.3.bitmap-text.demo":59,"./solid/1.4.stage2d.demo":60,"./solid/1.5.stadium.demo":61,"./solid/1.6.canvas-manager.demo":62,"./solid/1.7.camera2d.demo":63,"./solid/1.8.basic-setup.demo":64,"./solid/1.9.tilesprite.demo":65,"./solid/2.0.collision-aabb2d.demo":66,"./solid/2.1.collision-circle.demo":67,"./solid/2.2.collision-polygon2d.demo":68,"./solid/2.3.collision-aabb2d-line2d.demo":69,"./solid/2.4.collision-line2d-circle.demo":70,"./solid/3.0.create-texture.demo":71,"./solid/3.1.animation.demo":72,"./solid/4.0.quadtree.demo":73,"./solid/4.1.ray-casting.demo":74,"./solid/4.2.particle-system.demo":75,"./solid/4.3.motion.demo":76,"./solid/4.4.utilities.demo":77,"./solid/4.5.interaction.demo":78,"./solid/4.6.spritesheet.demo":79,"./solid/4.7.culler.demo":80,"./solid/4.8.tilemap.demo":81,"./solid/5.0.webgl-animation.demo":82,"./solid/5.1.webgl-circle.demo":83,"./solid/5.2.webgl-rectangle.demo":84,"./solid/5.3.webgl-line2d.demo":85,"./solid/5.4.webgl-pixelbatch.demo":86,"./solid/5.5.webgl-texture2dbatch.demo":87,"./solid/5.6.webgl-bitmap-text.demo":88,"./solid/5.6.webgl-tilesprite.demo":89,"./solid/6.0.stresstest.demo":90,"./solid/6.1.webgl-stresstest.demo":91,"./solid/6.2.webgl-rendertexture.demo":92};function i(t){var e=o(t);return n(e)}function o(t){var e=r[t];if(!(e+1)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return e}i.keys=function(){return Object.keys(r)},i.resolve=o,t.exports=i,i.id=50},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("PGCAMERADRAG",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s={canvas:a,halt:!0},u=t.stage=new i.Stage2D(s),l=new i.Camera2D(new i.Vector2D(r,o),{position:new i.Vector2D(0,0)}),c=new i.VisualContainer2D(0,0),h=new i.Sprite(0,0),f=new i.Vector2D(0,0),d=new i.Vector2D(0,0),p=!1;u.AddChild(l).AddChild(c).AddChild(h),u.ticker.StartAF(),u.mouse.onDown.Add(function(t){p=!0,f.SetV(t.data.position),d.SetV(l.position)}),u.mouse.onUp.Add(function(){p=!1}),u.mouse.onMove.Add(function(t){p&&l.position.SetV(t.data.position).AddV(d).SubtractV(f)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("PGPACKING",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";for(var s={canvas:a,halt:!0},u=t.stage=new i.Stage2D(s),l=new i.Camera2D(new i.Vector2D(r,o),{position:new i.Vector2D(0,0)}),c=new i.VisualContainer2D(0,0),h=new i.Vector2D(0,0),f=new i.Vector2D(0,0),d=!1,p=15,y=[];p--;){var v=new i.Sprite(0,0);v.w=100+100*Math.random()|0,v.h=100+10*Math.random()|0,y.push(v)}y.sort(function(t,e){return e.w-t.w}),(new i.Packing.RectanglePacker).SetPadding(10,10).PackDynamic(y).forEach(function(t,e){t&&y[e].position.SetV(t.tl)}),u.AddChild(l).AddChild(c).AddChildren(y),u.ticker.StartAF(),u.mouse.onDown.Add(function(t){d=!0,h.SetV(t.data.position),f.SetV(l.position)}),u.mouse.onUp.Add(function(){d=!1}),u.mouse.onMove.Add(function(t){d&&l.position.SetV(t.data.position).AddV(f).SubtractV(h)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("PGUNDEMO",function(t){var e=600,n=400,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"WebGL"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(300,200);a.gl.clearColor(.9,.9,.9,1),u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();for(var c=new i.Controller.ProgramController.GLUnProgramController(a.gl,i.Shader.UN),h=1;h--;){var f=new i.GLEntity2D(0,0,c);f.transformAutomaticUpdate=!0,f.transformShouldUpdate=!0;f.w=f.h=384,f.w=e,f.h=n,f.timeInc=.05/12,f.ComputeLocalBounds({x:.5,y:.5}),f.position.Set(i.Utility.RandomInteger(-300,300),i.Utility.RandomInteger(-200,200)),f.position.Set(300,200),s.AddChild(f)}a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Sprite",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new i.Sprite(r,o),u=new i.Graphic2D(r,o,new i.Path.Line2D(-r,0,r,0)),l=new i.Graphic2D(r,o,new i.Path.Line2D(0,-o,0,o));s.anchor.SetSame(.5),s.UpdateTextureTransform();var c=a.getContext("2d");s.Render(c),u.Render(c),l.Render(c)})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Graphic2D",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new i.Path.Circle(0,0,50);new i.Graphic2D(r,o,s).Render(a.getContext("2d"))})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Text",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute",a.style.backgroundColor="white";var s=a.getContext("2d"),u=new i.Text(r,o,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.");u.style.text.align=i.Style.TextConf.ALIGN_CENTER,u.style.text.baseline=i.Style.TextConf.BASELINE_MIDDLE,u.style.text.lineWidth=.3,u.style.text.font="40px Arial",u.Render(s)})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Geom",function(t){var e=window.innerWidth,n=window.innerHeight,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o=r.getContext("2d"),a=new i.Path.Circle(0,0,50),s=new i.Path.AABB2D(0,0,100,100),u=new i.Path.Polygon2D,l=new i.Path.Line2D(0,0,100,100),c=new i.Path.Polygon2D,h=new i.Path.Polygon2D;i.Geom.PolygonConstruction.Butterfly(u,0,0,1e3,50),i.Geom.PolygonConstruction.Star(c,0,0,100,50,5),i.Geom.PolygonConstruction.Rose(h,0,0,100,7/9,1e3,9);var f=new i.Graphic2D(100,100,a),d=new i.Graphic2D(200,100,s),p=new i.Graphic2D(350,100,l),y=new i.Graphic2D(600,200,u),v=new i.Graphic2D(100,300,c),m=new i.Graphic2D(400,400,h);f.Render(o),d.Render(o),p.Render(o),y.Render(o),v.Render(o),m.Render(o)})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("VisualContainer2D",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new i.Sprite(r,o);s.anchor.SetSame(.5),s.UpdateTextureTransform();var u=new i.VisualContainer2D(0,0);u.AddChild(s),u.Render(a.getContext("2d"))})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("BitmapText",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute",a.style.backgroundColor="white";var s=a.getContext("2d"),u=new i.BitmapText(0,0,window.testData.imgloader.GetBasicTextureById("fontNoK"),window.testData.xhrloader.GetDataById("fontNoK"),"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.");u.scale.SetSame(.6),u.x=r-.5*u.width,u.y=o-.5*u.height,u.Render(s)})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Stage2D",function(t){var e=window.innerWidth,n=window.innerHeight,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!0},a=t.stage=new i.Stage2D(o);a.ticker.StartAF(),a.onProcess.Add(function(){console.log("tick"),a.onProcess.Dump()})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Stadium",function(t){var e={className:"mcnvs",width:600,height:400,mode:"2d",fill:!1},n=t.stadium=new i.Stadium(e);function r(){this.children.forEach(o)}function o(t){t.position.AddV(t.data.velocity),t.data.velocity.Rotate(t.data.torque)}n.CreateStage2D("stage1"),n.CreateStage2D("stage2"),n.CreateStage2D("stage3"),n.CreateStage2D("stage4"),n.GetStages("stage1","stage2","stage3").forEach(function(t){for(var e=10;e--;){var n=t.AddChild(new i.Graphic2D(i.Utility.RandomFloat(100,500),i.Utility.RandomFloat(50,350),new i.Path.Circle(0,0,i.Utility.RandomInteger(10,50))));n.data.velocity=new i.Vector2D(i.Utility.RandomFloat(-1,1),i.Utility.RandomFloat(-1,1)),n.data.torque=i.Utility.RandomFloat(-i.Math.RADIAN,i.Math.RADIAN)}t.onProcess.Add(r,t)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("CanvasManager",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",1920),e.setAttribute("height",1080),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0);(t.canvasManager=new i.CanvasManager(e,1920,1080,i.CanvasManager.KEEP_ASPECT_RATIO_FIT)).BindStage(r).BindRootContainer(o).Trigger()})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Camera2D",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s={canvas:a,halt:!0},u=t.stage=new i.Stage2D(s),l=new i.Camera2D(new i.Vector2D(r,o),{position:new i.Vector2D(0,0)}),c=new i.VisualContainer2D(0,0),h=new i.Sprite(0,0);u.AddChild(l).AddChild(c).AddChild(h),u.mouse.AddOffset(l),u.ticker.StartAF(),u.onProcess.Add(function(){l.Process()}),u.mouse.onDown.Add(function(t){l.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("BasicSetup",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200),u=new i.Sprite(0,0);a.force.SetSame(5),u.anchor.SetSame(.5),u.UpdateTextureTransform(),r.AddChild(o).AddChild(a).AddChild(s).AddChild(u),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger(),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Tilesprite",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=a.getContext("2d"),u=new i.Tilesprite(r,o,i.Tilesprite.DEFAULT_TEXTURE);u.GeneratePattern(s,640,640),u.x=r-.5*u.width,u.y=o-.5*u.height,u.Render(s)})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("CollisionAABB2D",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u);var c=new i.Vector2D(0,0),h=new i.Vector2D(0,0),f=null,d=new i.Collision.Body2D(new i.Geom.AABB2D(0,0,50,200)),p=new i.Collision.Body2D(new i.Geom.AABB2D(0,0,100,200)),y=new i.Graphic2D(100,0,new i.Path.AABB2D(0,0,0,0).SetC(d.shape)),v=new i.Graphic2D(0,100,new i.Path.AABB2D(0,0,0,0).SetC(p.shape));d.SetRelative(y.position),p.SetRelative(v.position);var m=i.Collision.AABB2DvsAABB2D.Collide,b=i.Collision.AABB2DvsAABB2D.SeparatingResponse,g=new i.Collision.AABB2DvsAABB2D.Result;l.Mount(y,v),a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){for(var e=l.children.length,n=t.data.position;e--;)if(l.children[e].IntersectsPoint2D(n)){c.SetV(n),f=l.children[e],h.SetV(f.position),t.stopPropagation=!0,f.SendToFront();break}f||u.target.position.SetV(n)}),a.mouse.onMove.Add(function(t){if(f){var e=t.data.position;f.position.SetV(e).AddV(h).SubtractV(c),d.SetPositionV(y),p.SetPositionV(v),g.Reset(),m(d,p,g),g.occured&&b(d,p,g)}},a),a.mouse.onUp.Add(function(){f&&(f=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("CollisionCircle",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u);var c=new i.Vector2D(0,0),h=new i.Vector2D(0,0),f=null,d=new i.Collision.Body2D(new i.Geom.Circle(0,0,25)),p=new i.Collision.Body2D(new i.Geom.Circle(0,0,50)),y=new i.Graphic2D(100,0,new i.Path.Circle(0,0,0).SetC(d.shape)),v=new i.Graphic2D(0,100,new i.Path.Circle(0,0,0).SetC(p.shape));d.SetRelative(y.position).SetVelocity(10,10).SetMass(30),p.SetRelative(v.position).SetVelocity(10,10).SetMass(20);var m=i.Collision.CirclevsCircle.Collide,b=i.Collision.CirclevsCircle.ElasticResponse,g=new i.Collision.CirclevsCircle.Result;l.Mount(y,v),a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){for(var e=l.children.length,n=t.data.position;e--;)if(l.children[e].IntersectsPoint2D(n)){c.SetV(n),f=l.children[e],h.SetV(f.position),t.stopPropagation=!0,f.SendToFront();break}f||u.target.position.SetV(n)}),a.mouse.onMove.Add(function(t){if(f){var e=t.data.position;f.position.SetV(e).AddV(h).SubtractV(c),d.SetPositionV(y),p.SetPositionV(v),g.Reset(),m(d,p,g),g.occured&&b(d,p,g)}},a),a.mouse.onUp.Add(function(){f&&(f=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("CollisionPolygon2D",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u);var c=new i.Vector2D(0,0),h=new i.Vector2D(0,0),f=null,d=new i.Collision.Body2D(new i.Geom.Polygon2D),p=new i.Collision.Body2D(new i.Geom.Polygon2D);i.Geom.PolygonConstruction.Cyclic(d.shape,0,0,i.Utility.RandomInteger(30,60),i.Utility.RandomInteger(3,6)),i.Geom.PolygonConstruction.Cyclic(p.shape,0,0,i.Utility.RandomInteger(30,60),i.Utility.RandomInteger(3,6));var y=new i.Graphic2D(0,0,(new i.Path.Polygon2D).SetC(d.shape)),v=new i.Graphic2D(0,0,(new i.Path.Polygon2D).SetC(p.shape));d.SetRelative(y.position),p.SetRelative(v.position);var m=i.Collision.Polygon2DvsPolygon2D.Collide,b=new i.Collision.Polygon2DvsPolygon2D.Result;l.Mount(y,v),a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){for(var e=l.children.length,n=t.data.position;e--;)if(l.children[e].IntersectsPoint2D(n)){c.SetV(n),f=l.children[e],h.SetV(f.position),t.stopPropagation=!0,f.SendToFront();break}f||u.target.position.SetV(n)}),a.mouse.onMove.Add(function(t){if(f){var e=t.data.position;f.position.SetV(e).AddV(h).SubtractV(c),b.Reset(),m(d,p,b),b.occured&&y.position.SubtractV(b.mtv)}},a),a.mouse.onUp.Add(function(){f&&(f=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("CollisionAABB2DLine2D",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u);var c=new i.Vector2D(0,0),h=new i.Vector2D(0,0),f=null,d=new i.Collision.Body2D(new i.Geom.AABB2D(0,0,40,100)),p=new i.Collision.Body2D(new i.Geom.Line2D(0,0,100,100)),y=new i.Graphic2D(0,0,new i.Path.AABB2D(0,0,0,0).SetC(d.shape)),v=new i.Graphic2D(0,0,new i.Path.Line2D(0,0,0,0).SetC(p.shape)),m=i.Collision.AABB2DvsLine2D.Collide,b=new i.Collision.AABB2DvsLine2D.Result,g=new i.Graphic2D(0,0,new i.Path.Circle(0,0,10)),w=new i.Graphic2D(0,0,new i.Path.Circle(0,0,10)),A=new i.Graphic2D(0,0,new i.Path.Circle(0,0,10)),S=new i.Graphic2D(0,0,new i.Path.Circle(0,0,10));l.Mount(y,v,g,w,A,S),a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){for(var e=l.children.length,n=t.data.position;e--;)if(l.children[e].IntersectsPoint2D(n)){c.SetV(n),f=l.children[e],h.SetV(f.position),t.stopPropagation=!0,f.SendToFront();break}f||u.target.position.SetV(n)}),a.mouse.onMove.Add(function(t){if(f){var e=t.data.position;f.position.SetV(e).AddV(h).SubtractV(c),d.SetPositionV(y),p.SetPositionV(v),m(d,p,b),b.top&&g.position.SetV(b.poc.a),b.right&&w.position.SetV(b.poc.b),b.bottom&&A.position.SetV(b.poc.c),b.left&&S.position.SetV(b.poc.d)}},a),a.mouse.onUp.Add(function(){f&&(f=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("CollisionLine2DCircle",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u);var c=new i.Vector2D(0,0),h=new i.Vector2D(0,0),f=null,d=new i.Collision.Body2D(new i.Geom.Circle(0,0,50)),p=new i.Collision.Body2D(new i.Geom.Line2D(0,0,100,100)),y=new i.Graphic2D(0,0,new i.Path.Circle(0,0,0).SetC(d.shape)),v=new i.Graphic2D(0,0,new i.Path.Line2D(0,0,0,0).SetC(p.shape));d.SetRelative(y.position);var m=i.Collision.CirclevsLine2D.Collide,b=i.Collision.CirclevsLine2D.ReflectingResponse,g=new i.Collision.CirclevsLine2D.Result;l.Mount(y,v),a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){for(var e=l.children.length,n=t.data.position;e--;)if(l.children[e].IntersectsPoint2D(n)){c.SetV(n),f=l.children[e],h.SetV(f.position),t.stopPropagation=!0,f.SendToFront();break}f||u.target.position.SetV(n)}),a.mouse.onMove.Add(function(t){if(f){var e=t.data.position;f.position.SetV(e).AddV(h).SubtractV(c),d.SetPositionV(y),p.SetPositionV(v),g.Reset(),m(d,p,g),g.occured&&b(d,p,g)}},a),a.mouse.onUp.Add(function(){f&&(f=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("CreateTexture",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new Image;s.onload=function(){var t=new i.Sprite(r,o,new i.Texture.BasicTexture2D(s));t.anchor.Set(.5,.5),t.Render(a.getContext("2d"))},s.src=i.BrowserUtility.GenerateSimpleBase64PNG(function(){var t=new i.Path.Polygon2D;return i.Geom.PolygonConstruction.Supershape(t,0,0,100,100,6,.3,.3,.3),new i.Graphic2D(Math.abs(t.aabb.tl.x),Math.abs(t.aabb.tl.y),t)},null,null,"white")})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Animation",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.Sprite(0,0,window.testData.imgloader.GetBasicTextureById("1to8"));u.anchor.SetSame(.5),u.UpdateTextureTransform(),s.AddChild(u);var l=(u.animationController=new i.Animator.Controller(u)).CreateAnimation("play",25);u.width=64,u.height=64,l.GenerateFrames(64,64,512,64,8,{5:10,3:8,1:6}),l.reverse=!0,l.loop=!0,l.Start(),l.onEnd.Add(function(){console.log("end")}),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process(),l.Process()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Quadtree",function(t){var e=window.innerWidth,n=window.innerHeight,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.Geom.AABB2D(0,0,e,n),u=new i.QuadtreeNode(s,0,4,5),l=[],c=[];a.onProcess.Add(function(){l.forEach(function(t){i.Debug.Draw.AABB2D(a.rc,t.aabb)})}),a.mouse.onDown.Add(function(t){var e=new i.Graphic2D(t.data.position.x,t.data.position.y,new i.Path.AABB2D(0,0,10,10));e.ComputeLocalBounds(e.anchor),a.AddChild(e),c.push(e),u.Dump(),c.forEach(function(t){u.Add(t.bounds.local)}),l.length=0,u.ConcatNodes(l)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("RayCasting",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();for(var c=[],h=[],f=100;f--;){var d=new i.Path.Polygon2D;i.Geom.PolygonConstruction.Cyclic(d,i.Utility.RandomInteger(-e,e),i.Utility.RandomInteger(-n,n),i.Utility.RandomInteger(30,60),i.Utility.RandomInteger(3,8)),d.Rotate(i.Utility.RandomFloat(0,i.Math.PII));var p=new i.Graphic2D(0,0,d);c.push(p)}for(var y=180,v=2*Math.PI/y;y--;){var m=v*y,b=new i.Path.Ray2D(0,0,0,0);b.style.stroke.lineWidth=1;var g=new i.Graphic2D(0,0,b);g.interactive=!1,g.data.angle=m,g.data.r=360,h.push(g)}l.Mount(c.concat(h)),a.mouse.AddOffset(l).AddOffset(u);var w=new i.Vector2D(0,0);a.onProcess.Add(function(){u.Process(),h.forEach(function(t){t.path.s.SetV(a.mouse.position),t.path.e.SetV(t.path.s),t.path.e.Add(t.data.r,t.data.r),t.path.e.RotateAroundV(t.path.s,t.data.angle)});for(var t,e,n,r=0,o=0,s=0,l=0,f=h[r],d=h.length,p=c.length,y=0;r<d;f=h[++r])for(t=c[o=0];o<p;t=c[++o])for(s=0,l=(y=t.path.vertices.length)-1;s<y;l=s++)e=t.path.vertices[s],n=t.path.vertices[l],i.Collision.Line2DvsLine2D.Line2DLine2DCollision(f.path.s,f.path.e,e,n,w)&&h[r].path.e.SetV(w)}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("ParticleSystem",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540),c=new i.Particle.Particle2D.System(0,0),h=window.testData.xhrloader.GetClonedDataById("particleExplosion"),f=new i.Time.Timer(10),d=new i.Geom.Polygon2D;i.Geom.PolygonConstruction.Cyclic(d,0,0,400,72);var p=d.Copy();p.vertices.forEach(function(t){t.Invert(),t.Multiply(.1,.1)}),f.onFinish.Add(function(){c.Emit(h),f.Start()}),f.Start(),h.texture=i.Sprite.DEFAULT_TEXTURE,h.position={points:d.vertices,moduloWrapper:d.vertices.length},h.velocity={points:p.vertices,moduloWrapper:p.vertices.length},u.force.SetSame(.1),a.AddChild(s).AddChild(u).AddChild(l).AddChild(c),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process(),c.Process(),f.Process()}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}e.default=function(){Object(r.a)("Motion",function(t){var e=function(t){function e(t,n,a){var u,h,f;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),h=this,(u=!(f=s(e).call(this,0,0,new i.Path.Line2D(t.x,t.y,n.x,n.y)))||"object"!==o(f)&&"function"!=typeof f?l(h):f).path.style.stroke.color=new i.Color(i.Utility.RandomInteger(u.w,200),i.Utility.RandomInteger(u.w,150),i.Utility.RandomInteger(0,20),1).value,u.path.style.stroke.lineWidth=u.w/12,a.AddChild(l(l(u))),u.x=i.Utility.RandomFloat(-c,c),u.y=i.Utility.RandomFloat(0,r),u.rotation=i.Utility.RandomInteger(0,i.Math.PII),u.rotation=i.Utility.FlipACoin(u.rotation,-u.rotation);var d=u.motionManager=new i.Motion.Manager(l(l(u))),p=d.Create("moveX","x",0,120,"SineInOut"),y=d.Create("moveY","y",0,120,"SineInOut"),v=d.Create("rotate","rotation",0,120,"SineInOut");return d.Start("moveX"),p.onEnd.Add(function(){v.Start()}),v.onEnd.Add(function(){y.Start()}),u.w>12&&u.Grow(),u}var n,h,f;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(e,i["Graphic2D"]),n=e,(h=[{key:"Grow",value:function(){var t=this.path.e.SubtractVC(this.path.s),n=t.Copy();t.Rotate(50*i.Math.RADIAN+i.Utility.RandomFloat(20*-i.Math.RADIAN,20*i.Math.RADIAN)),n.Rotate(50*-i.Math.RADIAN+i.Utility.RandomFloat(20*-i.Math.RADIAN,20*i.Math.RADIAN)),t.Multiply(.67,.67),n.Multiply(.67,.67),t.AddV(this.path.e),n.AddV(this.path.e),new e(this.path.e,t,this.parent),new e(this.path.e,n,this.parent)}}])&&a(n.prototype,h),f&&a(n,f),e}(),n=1920,r=1080,c=960,h=t.canvas=document.createElement("canvas");document.body.appendChild(h),h.setAttribute("width",n),h.setAttribute("height",r),h.style.display="initial",h.style.position="absolute";var f={canvas:h,halt:!1},d=t.stage=new i.Stage2D(f),p=new i.VisualContainer2D(0,0),y=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),v=new i.VisualContainer2D(c,r);v.scale.Set(1,-1),y.force.SetSame(5),d.AddChild(p).AddChild(y).AddChild(v),new i.CanvasManager(h,n,r,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(d).BindRootContainer(p).Trigger(),d.mouse.AddOffset(v).AddOffset(y),new e(new i.Vector2D(0,0),new i.Vector2D(0,300),v);var m=new i.Time.Timer(500);m.onFinish.Add(function(){d.ticker.Stop()}),m.Start(),d.onProcess.Add(function(){y.Process(),v.children.forEach(function(t){t.motionManager.Process()}),m.Process()}),d.mouse.onDown.Add(function(t){y.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.default=function(){Object(r.a)("Utilities",function(t){var e=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mem1=e,this.mem2=n,this.mem3=null,this.mem4=null,this.deep={deeper:{deepest:0}}}var e,n,r;return e=t,(n=[{key:"Some",value:function(t){this.mem3=t,this.mem4=this.mem1+this.mem2}}])&&o(e.prototype,n),r&&o(e,r),t}(),n=new i.Maker;console.log(n.Many(15).Make(e,"@i(*|2)","@i(%|3)").Call(Math.random,null,"deep.deeper.deepest").Call("Some",["@i"]).Call(console.log,["$deep.deeper.deepest"]).Ship(!0)),console.log(n),i.Glob.Create("myGlob");var r=window.myGlob;r.Define(i.Glob.CONSTANT,"myConstant","someValue"),r.Define(i.Glob.FUNCTION,"myFunction",function(){}),r.Define(i.Glob.VALUE,"myValue","someValue");try{r.Mark(i.Glob.CONSTANT,"myConstant")}catch(t){console.error(t)}r.Mark(i.Glob.OBJECT,"myObject");try{r.Set(i.Glob.OBJECT,"myObject",0)}catch(t){console.error(t)}r.Set(i.Glob.OBJECT,"myObject",{}),console.log(r),window.myGlob=void 0,i.Assert.LOG=!0,i.Assert(0,i.Assert.IS_SAME_TYPE,1),i.Assert("myString",i.Assert.IS,"myString"),i.Assert(10,i.Assert.IS_GREATER_THAN,9);try{i.Assert(10,i.Assert.IS_LESS_THAN,9)}catch(t){console.error(t)}try{i.Assert([],i.Assert.IS_SAME_TYPE,Object)}catch(t){console.error(t)}i.Assert([],i.Assert.IS_INSTANCE_OF,Object);var a=new i.CP.Registry;i.CP.Command.OPTION_PREFIX="--",a.AddCommand(new i.CP.Command("myCommand mycmd",function(t,e,n){console.log(t,e,n,"prime")},"some info about this command",!0,!0).AddOption("anOption anopt",function(t,e,n){console.log(t,e,n,"priorty 0")},"some info about this option",0,!1).AddOption("op2",function(){console.log("op2 called.","priorty 99")},"brrrr",99,!1)),console.log(a),a.Parse('myCommand --anopt someData=myData someString --op2 (JSON)myJsonData={"someJsonData":"value"}',{someStatic:"data"}),null!=a.Parse("what?")&&console.error("Unknown command");var s=a.Parse("hmmm...");s&&console.error(s,"- is not a recognized command")})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Interaction",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute",e.style.top="50%",e.style.transform="translateY(-50%)";var n={canvas:e,halt:!1,mode:"webgl2"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200),u=new i.Controller.ProgramController.GLTexture2DProgramController(r.gl),l=new i.Controller.ProgramController.GLCircleProgramController(r.gl),c=new i.Controller.ProgramController.GLLine2DProgramController(r.gl);u.BindBasicTexture(i.Sprite.DEFAULT_TEXTURE);var h=new i.Sprite(0,0,u),f=new i.Graphic2D(-100,-100,new i.Path.Circle(0,0,50)),d=new i.Graphic2D(100,100,new i.Path.Line2D(-100,0,100,0));f.path.LinkProgramController(l),d.path.LinkProgramController(c);var p=new i.Vector2D(0,0),y=new i.Vector2D(0,0),v=null;d.path.Rotate(23/180*Math.PI),a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s).AddChildren(h,f,d),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger(),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process()}),r.mouse.onDown.Add(function(t){for(var e=s.children.length,n=t.data.position;e--;)if(s.children[e].IntersectsPoint2D(n)){p.SetV(n),v=s.children[e],y.SetV(v.position),t.stopPropagation=!0,v.SendToFront();break}v||a.target.position.SetV(n)}),r.mouse.onMove.Add(function(t){if(v){var e=t.data.position;v.position.SetV(e).AddV(y).SubtractV(p)}},r),r.mouse.onUp.Add(function(){v&&(v=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Spritesheet",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,backgroundColor:"white"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200),u=new i.Sprite(0,0,window.testData.invadersSpritesheet.basicTexture),l=new i.Sprite(0,50,window.testData.invadersSpritesheet.basicTexture);window.testData.invadersSpritesheet.GetFrameById("Ship").FullApply(u),window.testData.invadersSpritesheet.GetFrameById("Explo-f1").FullApply(l),l.CreateAnimation({spritesheet:window.testData.invadersSpritesheet,id:"explode",frames:[{id:"Explo-f1",rate:14},{id:"Explo-f2",rate:2},{id:"Explo-f3",rate:10},{id:"Explo-f4",rate:2}],loop:!0,reverse:!1}),l.PlayAnimation("explode"),l.anchor.SetSame(.5),l.UpdateTextureTransform(),l.scale.SetSame(5),a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s).AddChildren(u,l),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger(),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process(),l.animationController.Process()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Culler",function(t){var e=600,n=400,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"webgl2"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(300,200),c=new i.Culler2D(0,0,e,n),h=new i.Controller.ProgramController.GLTexture2DProgramController(a.gl);h.BindBasicTexture(i.Sprite.DEFAULT_TEXTURE);var f=new i.Sprite(0,0,h);f.anchor.SetSame(.5),f.UpdateTextureTransform(),c.BindContainer(l),c.SetRootMatrix(a.transform.globalTransform),c.onIn.Add(function(t){t.target.display=!0,console.log("in")}),c.onOut.Add(function(t){t.target.display=!1,console.log("out")}),u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l).AddChildren(f),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).BindCuller(c).Trigger(),console.log(c),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process(),c.Process()}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Tilemap",function(t){var e=600,n=400,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"webgl2"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(300,200),c=new i.Controller.ProgramController.GLTexture2DProgramController(a.gl);c.BindBasicTexture(window.testData.tileset.basicTexture);var h=new i.Culler2D(0,0,568,368);h.SetRootMatrix(a.transform.globalTransform),u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).BindCuller(h).Trigger();var f=new i.Tilemap(-300,-200,c,window.testData.tileset.data,0);f.Cull(h),f.scale.SetSame(1),l.AddChild(f),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("WebGLAnimation",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,mode:"WebGL2",antialias:!0},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger(),r.mouse.AddOffset(s).AddOffset(a);var u=new i.Controller.ProgramController.GLDynamicTexture2DProgramController(r.gl,2);u.BindBasicTexture(i.Sprite.DEFAULT_TEXTURE,0),u.BindBasicTexture(window.testData.imgloader.GetBasicTextureById("1to8"),1);var l=new i.Sprite(0,0,u,1),c=new i.Sprite(0,0,u,0);l.anchor.SetSame(.5),c.anchor.SetSame(.5),c.UpdateTextureTransform(),c.alpha=.5,s.AddChildren(l,c);var h=(l.animationController=new i.Animator.Controller(l)).CreateAnimation("play",25);l.width=64,l.height=64,h.GenerateFrames(64,64,512,64,8,{5:10,3:8,1:6}),h.loop=!0,h.Start(),r.onProcess.Add(function(){a.Process(),h.Process()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("WebGLCircle",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"WebGL"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();for(var c=new i.Controller.ProgramController.GLCircleProgramController(a.gl),h=1e3;h--;){var f=new i.Path.Circle(0,0,50);f.style.stroke.lineWidth=1,f.LinkProgramController(c);var d=new i.Graphic2D(i.Utility.RandomInteger(-960,960),i.Utility.RandomInteger(-540,540),f);l.Mount(d)}a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("WebGLRectangle",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.Controller.ProgramController.GLRectangleProgramController(r.gl),l=new i.Path.AABB2D(-100,-100,100,100);l.style.stroke.lineWidth=1,l.LinkProgramController(u);var c=new i.Graphic2D(0,0,l);s.Mount(c),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process(),c.rotation+=i.Math.RADIAN}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("WebGLLine2D",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.Controller.ProgramController.GLLine2DProgramController(r.gl),l=new i.Path.Line2D(-100,-100,100,100);l.style.stroke.lineWidth=1,l.LinkProgramController(u);var c=new i.Graphic2D(0,0,l);s.Mount(c),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process(),c.rotation+=i.Math.RADIAN}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("WebGLPixelBatch",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.BatchableContainer2D(0,0),l=new i.Controller.ProgramController.GLPixelBatchProgramController(r.gl);s.AddChild(u),u.UseAsBatchParent(l);for(var c=1e4;c--;){var h=new i.Path.Pixel(0,0);h.color.r=.2,h.color.g=Math.random(),h.color.b=.8,h.color.a=i.Utility.RandomFloat(.1,.6),h.style.pixel.size=i.Utility.RandomFloat(1,5);var f=new i.Graphic2D(0,0,h);f.data.velocity=new i.Vector2D(i.Utility.RandomFloat(-2,2),i.Utility.RandomFloat(-2,2)),f.data.torque=i.Utility.RandomFloat(20*-i.Math.RADIAN,20*i.Math.RADIAN),u.Mount(f),f.UpdateTransform(f.parent)}u.ComputeBatchBuffer(),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){var t;a.Process();for(var e=0;e<u.children.length;++e)(t=u.children[e]).data.velocity.Rotate(t.data.torque),t.position.AddV(t.data.velocity),t.UpdateInBuffer()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("WebGLTexture2DBatch",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200),u=new i.Sprite(0,0);a.force.SetSame(5),u.anchor.SetSame(.5),u.UpdateTextureTransform(),r.AddChild(o).AddChild(a).AddChild(s).AddChild(u),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var l=new i.BatchableContainer2D(0,0),c=new i.Controller.ProgramController.GLTexture2DBatchProgramController(r.gl);c.BindBasicTexture(window.testData.imgloader.GetBasicTextureById("colors")),s.AddChild(l),l.UseAsBatchParent(c);for(var h=1e4;h--;){var f=new i.Sprite(0,0,c.originalTexture);f.w=64,f.h=64,f.scale.SetSame(.05),f.anchor.SetSame(.5),f.animationController=new i.Animator.Controller(f);var d=f.animationController.CreateAnimation("animation",60);d.GenerateFrames(64,64,1024,64,16),d.SetFrame(i.Utility.RandomInteger(0,15)),f.data.velocity=new i.Vector2D(i.Utility.RandomFloat(-2,2),i.Utility.RandomFloat(-2,2)),f.data.torque=i.Utility.RandomFloat(20*-i.Math.RADIAN,20*i.Math.RADIAN),l.Mount(f),f.UpdateTransform(f.parent)}l.ComputeBatchBuffer(),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){var t;a.Process();for(var e=0;e<l.children.length;++e)(t=l.children[e]).data.velocity.Rotate(t.data.torque),t.position.AddV(t.data.velocity),t.UpdateInBuffer()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("WebGLBitmapText",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);r.gl.clearColor(1,1,1,1),a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.Controller.ProgramController.GLTexture2DProgramController(r.gl);u.BindBasicTexture(window.testData.imgloader.GetBasicTextureById("fontimg"));var l=new i.BitmapText(0,0,u,window.testData.xhrloader.GetDataById("fontdataxml"),"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.");l.scale.SetSame(.3),l.x=.5*-l.width,l.y=.5*-l.height,s.AddChild(l),r.mouse.AddOffset(s).AddOffset(a),r.onProcess.Add(function(){a.Process()}),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("WebGLTilesprite",function(t){var e=960,n=540,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"WebGL"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(480,270);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();var c=new i.Controller.ProgramController.GLTexture2DProgramController(a.gl);c.BindBasicTexture(i.Tilesprite.DEFAULT_TEXTURE);var h=new i.Tilesprite(-240,-135,c);h.GeneratePattern(null,480,270),l.AddChild(h),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process(),h.OffsetPattern(1,1)}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Stresstest",function(t){var e=window.innerWidth,n=window.innerHeight,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o=r.getContext("2d"),a=new i.VisualContainer2D(0,0),s=t.ticker=new i.Time.Ticker(function(){o.setTransform(1,0,0,1,0,0),o.fillStyle="rgba(0,0,0,1)",o.fillRect(0,0,e,n),a.Render(o),d.Process()},1e3,!0),u=20,l=0,c=35,h=[],f=new i.Pool,d=new i.Time.Timer;f.Flood(function(){var t=new i.Sprite(Math.random()*e,Math.random()*n);return t.transformAutomaticUpdate=!1,t},2e4),d.onFinish.Add(function(){var t=c;for(c=c<3?3:c--;t--;)a.AddChild(f.Retrieve());if(s.GetTPS()>40||l++<20)this.Start(1);else{var e=a.children.length;console.log(e,s.GetTPS()),a.children.forEach(function(t){f.Store(t)}),a.Dump(),l=0,h.push(e),--u>0?this.Start(120):(h.sort(function(t,e){return t-e}),console.log(h,"\nMIN: "+h[0],"MED: "+h[Math.round(h.length/2)],"MAX: "+h[h.length-1]))}},d),s.Start(),d.Start(120)})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("WebGLStresstest",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=a.getContext("webgl2"),u=new i.VisualContainer2D(0,0),l=t.ticker=new i.Time.Ticker(function(){s.viewport(0,0,e,n),s.clear(s.COLOR_BUFFER_BIT),s.enable(s.BLEND),s.disable(s.DEPTH_TEST),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),u.GLRender(s),y.Process(),s.flush()},1e3,!0),c=20,h=0,f=35,d=[],p=new i.Pool(i.Sprite),y=new i.Time.Timer,v=new i.Controller.ProgramController.GLTexture2DProgramController(s);v.BindBasicTexture(i.Sprite.DEFAULT_TEXTURE,s.NEAREST),u.scale.Set(2/e,-2/n),u.position.Add(0,0),u.UpdateTransform(u.parent),p.Flood(function(){var t=new i.Sprite(Math.random()*e-r,Math.random()*n-o,v);return t.transformAutomaticUpdate=!1,t},4e4),y.onFinish.Add(function(){var t=f;for(f=f<3?3:f--;t--;)u.AddChild(p.Retrieve());if(l.GetTPS()>40||h++<20)this.Start(1);else{var e=u.children.length;console.log(e,l.GetTPS()),u.children.forEach(function(t){p.Store(t)}),u.Dump(),h=0,d.push(e),--c>0?this.Start(120):(d.sort(function(t,e){return t-e}),console.log(d,"\nMIN: "+d[0],"MED: "+d[Math.round(d.length/2)],"MAX: "+d[d.length-1]))}},y),l.Start(),y.Start(120)})}},function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(0);e.default=function(){Object(r.a)("Rendertexture",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"WebGL2"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540),c=new i.VisualContainer2D(960,540),h=new i.Controller.ProgramController.GLTexture2DProgramController(a.gl);h.BindBasicTexture(i.Sprite.DEFAULT_TEXTURE);var f=new i.Controller.ProgramController.GLRendertextureProgramController(a.gl,i.Shader.RENDERTEXTURE_INVERT);f.Config(e,n,a.gl.LINEAR);var d=new i.Sprite(0,0,h),p=new i.Sprite(0,0,h);d.anchor.SetSame(.5),p.anchor.SetSame(.5),d.alpha=.5,d.UpdateTextureTransform(),p.UpdateTextureTransform(),a.gl.clearColor(.3,.3,.3,1),s.GLPreRender=function(t){a.SetFramebuffer(t,f)},s.GLPostRender=function(){a.SetFramebuffer(),f.Execute()},u.force.SetSame(5),a.AddChild(s).AddChild(u).Mount(l,c),l.Mount(d),c.Mount(p),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u);var y=0;a.onProcess.Add(function(){u.Process(),d.x=128*Math.cos(y),d.y=128*Math.sin(y),y+=i.Math.RADIAN}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}}]);