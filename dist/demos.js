/**
* @package     Nenkraft2
* @author      Gustav 'Nuuf' Åberg <gustavrein@gmail.com>
* @version     1.0.2
* @copyright   (C) 2018 Gustav 'Nuuf' Åberg
* @license     {@link https://github.com/Nuuf/nenkraft2/blob/master/LICENSE}
*/!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=16)}([function(t,e,n){"use strict";n.r(e);var i={};n.r(i),n.d(i,"CCH1",function(){return I}),n.d(i,"CCH1Decipher",function(){return L});var r={};n.r(r),n.d(r,"GenerateSimpleBase64PNG",function(){return N}),n.d(r,"ImageFromDataURL",function(){return F}),n.d(r,"ParsedXMLToJSON",function(){return M}),n.d(r,"XMLToJSON",function(){return V}),n.d(r,"DownloadAsJSON",function(){return X});var o={};n.r(o),n.d(o,"Linear",function(){return z}),n.d(o,"QuadIn",function(){return K}),n.d(o,"QuadOut",function(){return J}),n.d(o,"QuadInOut",function(){return Q}),n.d(o,"SineIn",function(){return $}),n.d(o,"SineOut",function(){return Z}),n.d(o,"SineInOut",function(){return tt}),n.d(o,"CircIn",function(){return et}),n.d(o,"CircOut",function(){return nt}),n.d(o,"CircInOut",function(){return it});var a={};n.r(a),n.d(a,"Result",function(){return bt}),n.d(a,"CollideRel",function(){return gt});var s={};n.r(s),n.d(s,"Result",function(){return xt}),n.d(s,"CollideRel",function(){return Ot}),n.d(s,"ElasticResponse",function(){return _t});var u={};n.r(u),n.d(u,"Result",function(){return Ut}),n.d(u,"CollideRel",function(){return Nt}),n.d(u,"ReflectingResponse",function(){return Ft});var l={};n.r(l),n.d(l,"Result",function(){return Wt}),n.d(l,"CollideRel",function(){return qt}),n.d(l,"AxisSeparates",function(){return zt});var c={};n.r(c),n.d(c,"AABB2DvsAABB2D",function(){return a}),n.d(c,"CirclevsCircle",function(){return s}),n.d(c,"CirclevsLine",function(){return u}),n.d(c,"PolygonvsPolygon",function(){return l});var h={};n.r(h),n.d(h,"Rectangular",function(){return ee}),n.d(h,"Isosceles",function(){return ne}),n.d(h,"Cyclic",function(){return ie}),n.d(h,"Equilateral",function(){return re}),n.d(h,"Star",function(){return oe}),n.d(h,"Butterfly",function(){return ae}),n.d(h,"Rose",function(){return se}),n.d(h,"Supershape",function(){return ue});var f={};n.r(f),n.d(f,"AABB2D",function(){return ce}),n.d(f,"Circle",function(){return we}),n.d(f,"Line2D",function(){return Ce}),n.d(f,"Ray2D",function(){return Ce}),n.d(f,"Polygon2D",function(){return Oe}),n.d(f,"PolygonConstruction",function(){return h});var d={};n.r(d),n.d(d,"DEFAULT",function(){return Pe}),n.d(d,"SOURCE_OVER",function(){return Ee}),n.d(d,"SOURCE_IN",function(){return ke}),n.d(d,"SOURCE_OUT",function(){return Re}),n.d(d,"SOURCE_ATOP",function(){return De}),n.d(d,"DESTINATION_OVER",function(){return Ie}),n.d(d,"DESTINATION_IN",function(){return Le}),n.d(d,"DESTINATION_OUT",function(){return je}),n.d(d,"DESTINATION_ATOP",function(){return Be}),n.d(d,"LIGHTER",function(){return Ge}),n.d(d,"COPY",function(){return Ue}),n.d(d,"XOR",function(){return Ne}),n.d(d,"MULTIPLY",function(){return Fe}),n.d(d,"OVERLAY",function(){return Me}),n.d(d,"DARKEN",function(){return Ve}),n.d(d,"LIGHTEN",function(){return Xe}),n.d(d,"COLOR_DODGE",function(){return Ye}),n.d(d,"COLOR_BURN",function(){return He}),n.d(d,"HARD_LIGHT",function(){return We}),n.d(d,"SOFT_LIGHT",function(){return qe}),n.d(d,"DIFFERENCE",function(){return ze}),n.d(d,"EXCLUSION",function(){return Ke}),n.d(d,"HUE",function(){return Je}),n.d(d,"SATURATION",function(){return Qe}),n.d(d,"COLOR",function(){return $e}),n.d(d,"LUMINOSITY",function(){return Ze});var p={};n.r(p),n.d(p,"CAP_ROUND",function(){return tn}),n.d(p,"CAP_BUTT",function(){return en}),n.d(p,"CAP_SQUARE",function(){return nn}),n.d(p,"JOIN_BEVEL",function(){return rn}),n.d(p,"JOIN_ROUND",function(){return on}),n.d(p,"JOIN_MITER",function(){return an});var y={};n.r(y),n.d(y,"ALIGN_START",function(){return sn}),n.d(y,"ALIGN_END",function(){return un}),n.d(y,"ALIGN_CENTER",function(){return ln}),n.d(y,"ALIGN_LEFT",function(){return cn}),n.d(y,"ALIGN_RIGHT",function(){return hn}),n.d(y,"BASELINE_ALPHABETIC",function(){return fn}),n.d(y,"BASELINE_TOP",function(){return dn}),n.d(y,"BASELINE_HANGING",function(){return pn}),n.d(y,"BASELINE_MIDDLE",function(){return yn}),n.d(y,"BASELINE_IDEOGRAPHIC",function(){return vn}),n.d(y,"BASELINE_BOTTOM",function(){return mn});var v={};n.r(v),n.d(v,"Fill",function(){return gn}),n.d(v,"Stroke",function(){return An}),n.d(v,"Shadow",function(){return Cn}),n.d(v,"Text",function(){return xn}),n.d(v,"Pixel",function(){return On}),n.d(v,"GCO",function(){return d}),n.d(v,"LineConf",function(){return p}),n.d(v,"TextConf",function(){return y}),n.d(v,"All",function(){return _n}),n.d(v,"FFSa",function(){return Pn}),n.d(v,"SSa",function(){return En}),n.d(v,"FSa",function(){return kn}),n.d(v,"SaT",function(){return Rn}),n.d(v,"P",function(){return Dn});var m={};n.r(m),n.d(m,"AABB2D",function(){return Un}),n.d(m,"Circle",function(){return Yn}),n.d(m,"Line2D",function(){return Jn}),n.d(m,"Ray2D",function(){return Jn}),n.d(m,"Polygon2D",function(){return ni}),n.d(m,"Pixel",function(){return vi});var b={};n.r(b),n.d(b,"Timer",function(){return Ci}),n.d(b,"Ticker",function(){return xi});var g={};n.r(g),n.d(g,"TEXTURE_2D",function(){return Yi}),n.d(g,"TEXTURE_2D_BATCH",function(){return Hi}),n.d(g,"PIXEL_BATCH",function(){return Wi}),n.d(g,"RECTANGLE",function(){return qi}),n.d(g,"CIRCLE",function(){return zi}),n.d(g,"LINE2D",function(){return Ki}),n.d(g,"UN",function(){return Ji}),n.d(g,"DynamicTEXTURE_2D",function(){return Qi});var w={};n.r(w),n.d(w,"ImageLoader",function(){return or}),n.d(w,"SpritesheetLoader",function(){return dr}),n.d(w,"XHRLoader",function(){return sr});var A={};n.r(A),n.d(A,"GLProgramController",function(){return yr}),n.d(A,"GLCircleProgramController",function(){return Sr}),n.d(A,"GLLine2DProgramController",function(){return Pr}),n.d(A,"GLPixelBatchProgramController",function(){return Lr}),n.d(A,"GLRectangleProgramController",function(){return Fr}),n.d(A,"GLTexture2DBatchProgramController",function(){return Wr}),n.d(A,"GLTexture2DProgramController",function(){return $r}),n.d(A,"GLDynamicTexture2DProgramController",function(){return ro}),n.d(A,"GLUnProgramController",function(){return co});var S={};n.r(S),n.d(S,"ProgramController",function(){return A});var C={};n.r(C),n.d(C,"Option",function(){return fo}),n.d(C,"Command",function(){return yo}),n.d(C,"Registry",function(){return go});var T={};n.r(T),n.d(T,"Motion",function(){return Ao}),n.d(T,"Manager",function(){return To});var x={};n.r(x),n.d(x,"Particle2D",function(){return ba}),n.d(x,"Oscillation",function(){return Oo}),n.d(x,"System",function(){return Oa});var O={};n.r(O),n.d(O,"Particle2D",function(){return x});var _={};n.r(_),n.d(_,"BasicTexture2D",function(){return ir}),n.d(_,"Spritesheet",function(){return hr});var P={};n.r(P),n.d(P,"Animation",function(){return $o}),n.d(P,"Controller",function(){return ta}),n.d(P,"Frame",function(){return lr});var E={};n.r(E),n.d(E,"AABB2D",function(){return _a});var k={};n.r(k),n.d(k,"Draw",function(){return E});var R=n(2),D=n(3);function I(t,e){var n,i,r=t.split(""),o=[];e=void 0===e?1:e;for(var a=0;a<r.length;++a)n=((n=r[a]).charCodeAt(0)+e).toString(2),i=Object(R.RandomInteger)(1,9),o.push(i+"x"+n.replace(/1/g,i));return o.join(" ")}function L(t,e){var n,i=t.split(" "),r=[];e=void 0===e?1:e;for(var o=0;o<i.length;++o)n=(n=i[o]).slice(2-n.length),r.push(String.fromCharCode(parseInt(n.replace(/[2-9]/g,"1"),2)-e));return r.join("")}var j,B,G,U=Math.ceil;function N(t,e,n,i){var r=t();return null==j&&(j=document.createElement("canvas"),B=j.getContext("2d")),j.width=U(r.w),j.height=U(r.h),null!=e&&(j.width=e),null!=n&&(j.height=n),null!=i?(B.fillStyle=i,B.fillRect(0,0,j.width,j.height)):B.clearRect(0,0,j.width,j.height),B.setTransform(1,0,0,1,0,0),r.Draw(B),j.toDataURL("image/png")}function F(t,e,n,i){var r=new Image;return r.width=e,r.height=n,r.onload=i,r.src=t,r}function M(t,e){var n,i,r,o,a,s,u={},l=t.childNodes,c=l.length;if(1===t.nodeType){if((c=(i=t.attributes).length)>0)for(u.attributes={},n=0,r=i.item(n);n<c;r=i.item(++n))u.attributes[r.nodeName]=r.nodeValue}else 3===t.nodeType&&(/^\s*$/g.exec(t.nodeValue)||(u=t.nodeValue,!0===e&&(u=u.replace(/^\s+|\s+&|\n/gim,""))));if(null!=l)for(c=l.length,n=0,o=l.item(n);n<c;o=l.item(++n))void 0===u[o.nodeName]?u[o.nodeName]=M(o,e):(void 0===u[o.nodeName].push&&(s=u[o.nodeName],u[o.nodeName]=[],Object(R.IsObjectEmpty)(s)||u[o.nodeName].push(s)),a=M(o,e),Object(R.IsObjectEmpty)(a)||u[o.nodeName].push(a));return u["#text"]&&0===u["#text"].length&&delete u["#text"],u}function V(t,e){return null==G&&(G=new DOMParser),M(G.parseFromString(t,"text/xml"),e)}function X(t,e){var n="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t)),i=document.createElement("a");i.setAttribute("href",n),i.setAttribute("download",e+".json"),i.click()}var Y=Math.sin,H=Math.cos,W=Math.sqrt,q=Math.PI,z=function(t,e,n,i){return n*t/i+e},K=function(t,e,n,i){return n*(t/=i)*t+e},J=function(t,e,n,i){return-n*(t/=i)*(t-2)+e},Q=function(t,e,n,i){return(t/=.5*i)<1?.5*n*t*t+e:.5*-n*(--t*(t-2)-1)+e},$=function(t,e,n,i){return-n*H(t/i*(.5*q))+n+e},Z=function(t,e,n,i){return n*Y(t/i*(.5*q))+e},tt=function(t,e,n,i){return.5*-n*(H(q*t/i)-1)+e},et=function(t,e,n,i){return-n*(W(1-(t/=i)*t)-1)+e},nt=function(t,e,n,i){return t/=i,n*W(1- --t*t)+e},it=function(t,e,n,i){return(t/=.5*i)<1?.5*-n*(W(1-t*t)-1)+e:.5*n*(W(1-(t-=2)*t)+1)+e};function rt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ot=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.objects=[],this.floodFunction=null,this.floodAmount=null,this.context=null,this.arguments=null}return function(t,e,n){e&&rt(t.prototype,e),n&&rt(t,n)}(t,[{key:"Store",value:function(t){this.objects.push(t)}},{key:"PreRetrieve",value:function(){0===this.objects.length&&this.Flood()}},{key:"Retrieve",value:function(){return this.PreRetrieve(),this.objects.pop()}},{key:"Flood",value:function(t,e,n){t&&(this.floodFunction=t),e&&(this.floodAmount=e),n&&(this.context=n);for(var i=0;i<this.floodAmount;++i)this.Store(this.floodFunction.call(this.context))}},{key:"Flush",value:function(){this.objects.length=0}},{key:"Clean",value:function(){var t=this.objects.length;this.Flush(),this.Flood(void 0,t)}}]),t}();function at(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var st=Math.ceil,ut=Math.round,lt=Math.abs,ct=Math.sqrt,ht=Math.atan2,ft=Math.cos,dt=Math.sin,pt=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=n}return function(t,e,n){e&&at(t.prototype,e),n&&at(t,n)}(t,[{key:"Copy",value:function(){return!0===vt?yt.Retrieve(this.x,this.y):new t(this.x,this.y)}},{key:"FromPool",value:function(e,n){return!0===vt?yt.Retrieve(e,n):new t(e,n)}},{key:"AbsoluteCopy",value:function(){var t=this.Copy();return t.Positive(),t}},{key:"SetV",value:function(t){return this.x=t.x,this.y=t.y,this}},{key:"Set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"SetSame",value:function(t){return this.x=t,this.y=t,this}},{key:"Is0",value:function(){return 0===this.x&&0===this.y}},{key:"AddVC",value:function(t){return this.Copy().AddV(t)}},{key:"AddV",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"Add",value:function(t,e){return this.x+=t,this.y+=e,this}},{key:"SubtractVC",value:function(t){return this.Copy().SubtractV(t)}},{key:"SubtractV",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"Subtract",value:function(t,e){return this.x-=t,this.y-=e,this}},{key:"MultiplyVC",value:function(t){return this.Copy().MultiplyV(t)}},{key:"MultiplyV",value:function(t){return this.x*=t.x,this.y*=t.y,this}},{key:"Multiply",value:function(t,e){return this.x*=t,this.y*=e,this}},{key:"DivideVC",value:function(t){return this.Copy().DivideV(t)}},{key:"DivideV",value:function(t){return this.x/=t.x,this.y/=t.y,this}},{key:"Divide",value:function(t,e){return this.x/=t,this.y/=e,this}},{key:"Normalize",value:function(){var t=this.GetMagnitude();return this.Divide(t,t)}},{key:"Positive",value:function(){return this.x=lt(this.x),this.y=lt(this.y),this}},{key:"Negative",value:function(){return this.x=-lt(this.x),this.y=-lt(this.y),this}},{key:"Invert",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"Rotate",value:function(t){var e=dt(t),n=ft(t),i=this.x,r=this.y;return this.x=i*n-r*e,this.y=i*e+r*n,this}},{key:"RotateAroundV",value:function(t,e){return this.SubtractV(t).Rotate(e).AddV(t)}},{key:"RotateAround",value:function(t,e,n){return this.SubtractV(t,e).Rotate(n).AddV(t,e)}},{key:"RotateAbsolute",value:function(t){return this.Rotate(t-this.GetAngle())}},{key:"RotateAbsoluteAroundV",value:function(t,e){return this.SubtractV(t).RotateAbsolute(e).AddV(t)}},{key:"RotateAbsoluteAround",value:function(t,e,n){return this.SubtractV(t,e).RotateAbsolute(n).AddV(t,e)}},{key:"PushFromV",value:function(t,e){var n=this.Copy();return n.SubtractV(t).Normalize().Multiply(e,e),this.AddV(n)}},{key:"PushFrom",value:function(t,e,n){var i=this.Copy();return i.SubtractV(t,e).Normalize().Multiply(n,n),this.AddV(i)}},{key:"GetWeightedAverageV",value:function(t,e){return this.FromPool(this.x*(1-e)+t.x*e,this.y*(1-e)+t.y*e)}},{key:"GetWeightedAverage",value:function(t,e,n){return this.FromPool(this.x*(1-n)+t*n,this.y*(1-n)+e*n)}},{key:"GetAngle",value:function(){return ht(this.y,this.x)}},{key:"GetAngleBetweenV",value:function(t){return ht(this.y-t.y,this.x-t.x)}},{key:"GetAngleBetween",value:function(t,e){return ht(this.y-e,this.x-t)}},{key:"GetDotV",value:function(t){return this.x*t.x+this.y*t.y}},{key:"GetDot",value:function(t,e){return this.x*t+this.y*e}},{key:"GetCrossV",value:function(t){return this.x*t.y+this.y*t.x}},{key:"GetCross",value:function(t,e){return this.x*e+this.y*t}},{key:"GetMagnitudeSquared",value:function(){return this.x*this.x+this.y*this.y}},{key:"GetMagnitude",value:function(){return ct(this.x*this.x+this.y*this.y)}},{key:"GetDistanceSquaredV",value:function(t){return this.Copy().SubtractV(t).GetMagnitudeSquared()}},{key:"GetDistanceSquared",value:function(t,e){return this.Copy().Subtract(t,e).GetMagnitudeSquared()}},{key:"GetDistanceV",value:function(t){return this.Copy().SubtractV(t).GetMagnitude()}},{key:"GetDistance",value:function(t,e){return this.Copy().Subtract(t,e).GetMagnitude()}},{key:"GetPerpendicularCCWV",value:function(t){return this.FromPool(-(t.y-this.y),t.x-this.x)}},{key:"GetPerpendicularCCW",value:function(t,e){return this.FromPool(-(e-this.y),t-this.x)}},{key:"GetPerpendicularCWV",value:function(t){return this.FromPool(t.y-this.y,-(t.x-this.x))}},{key:"GetPerpendicularCW",value:function(t,e){return this.FromPool(e-this.y,-(t-this.x))}},{key:"GetNormalAV",value:function(t){return this.GetPerpendicularCCWV(t).Normalize()}},{key:"GetNormalA",value:function(t,e){return this.GetPerpendicularCCW(t,e).Normalize()}},{key:"GetNormalBV",value:function(t){return this.GetPerpendicularCWV(t).Normalize()}},{key:"GetNormalB",value:function(t,e){return this.GetPerpendicularCW(t,e).Normalize()}},{key:"GetMidpointV",value:function(t){return this.Copy().AddV(t).Divide(2,2)}},{key:"GetMidpoint",value:function(t,e){return this.Copy().Add(t,e).Multiply(.5,.5)}},{key:"IsEqualToV",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"IsEqualTo",value:function(t,e){return this.x===t&&this.y===e}},{key:"GetProjectionOntoV",value:function(t){var e=this.GetDotV(t);if(0===e)return this.FromPool(0,0);var n=t.GetMagnitude(),i=e/(n*n),r=t.Copy();return r.Multiply(i,i),r}},{key:"GetProjectionOnto",value:function(t,e){var n=this.Copy();n.Set(t,e);var i=this.GetDotV(n);if(0===i)return this.FromPool(0,0);var r=n.GetMagnitude(),o=i/(r*r);return n.Multiply(o,o),n}},{key:"GetReflectionV",value:function(t){var e=t.Copy(),n=this.GetDotV(e);return e.Multiply(2,2).Multiply(n,n),this.SubtractVC(e)}},{key:"GetReflection",value:function(t,e){var n=this.Copy();n.Set(t,e);var i=this.GetDotV(n);return n.Multiply(2,2).Multiply(i,i),this.SubtractVC(n)}},{key:"Store",value:function(){return yt.Store(this),this}},{key:"AddTo",value:function(t){for(var e=0;e<t.length;++e)t[e].AddV(this);return this}},{key:"Floor",value:function(){return this.x=0|this.x,this.y=0|this.y,this}},{key:"Ceil",value:function(){return this.x=st(this.x),this.y=st(this.y),this}},{key:"Round",value:function(){return this.x=ut(this.x),this.y=ut(this.y),this}},{key:"GetMinMaxDot",value:function(t){for(var e=1/0,n=-e,i=0,r=this.Copy(),o=0;o<t.length;++o)(i=t[o].GetDotV(this))>n&&(n=i),i<e&&(e=i);return r.Set(e,n),r}}],[{key:"SortMinMag",value:function(t,e){return t.GetMagnitudeSquared()-e.GetMagnitudeSquared()}},{key:"pool",get:function(){return yt}},{key:"USE_POOL",get:function(){return vt},set:function(t){vt=!!t}}]),t}(),yt=new ot,vt=!0;function mt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}yt.Retrieve=function(t,e){return this.PreRetrieve(),this.objects.pop().Set(t,e)},yt.Flood(function(){return new pt(0,0)},1e3);var bt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new pt(0,0),this.occured=!1}return function(t,e,n){e&&mt(t.prototype,e),n&&mt(t,n)}(t,[{key:"Reset",value:function(){this.mtv.SetSame(0),this.occured=!1}}]),t}(),gt=function(t,e,n){var i=t.shape,r=i.w,o=i.h,a=t.anchor,s=e.shape,u=s.w,l=s.h,c=e.anchor;wt.SetV(i.tl).SubtractV(t.relative),At.SetV(s.tl).SubtractV(e.relative);var h=At.x+r,f=wt.x+u,d=At.y+o,p=wt.y+l;return void 0!=a&&(wt.x+=a.x*r,wt.y+=a.y*o),void 0!=c&&(At.x+=c.x*u,At.y+=c.y*l),wt.x<h&&At.x<f&&wt.y<d&&At.y<p&&(void 0!=n&&(St[0].Set(wt.x-h,0),St[1].Set(f-At.x,0),St[2].Set(0,wt.y-d),St[3].Set(0,p-At.y),St.sort(pt.SortMinMag),n.mtv.SetV(St[0]),n.occured=!0),!0)},wt=new pt(0,0),At=new pt(0,0),St=[new pt(0,0),new pt(0,0),new pt(0,0),new pt(0,0)];function Ct(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Tt=Math.sqrt,xt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new pt(0,0),this.poc={a:new pt(0,0),b:new pt(0,0),c:new pt(0,0)},this.mtd=0,this.delta=new pt(0,0),this.occured=!1}return function(t,e,n){e&&Ct(t.prototype,e),n&&Ct(t,n)}(t,[{key:"Reset",value:function(){this.poc.a.SetSame(0),this.poc.b.SetSame(0),this.poc.c.SetSame(0),this.mtv.SetSame(0),this.mtd=0,this.delta.SetSame(0),this.occured=!1}}]),t}(),Ot=function(t,e,n){var i=t.shape,r=e.shape,o=i.radius,a=r.radius,s=o+a,u=t.anchor,l=e.anchor;kt.SetV(t.relative),Rt.SetV(e.relative),jt.SetV(Rt).SubtractV(kt);var c=jt.GetMagnitudeSquared();if(void 0!=u&&(kt.x+=u.x*i.diameter,kt.y+=u.y*i.diameter),void 0!=l&&(Rt.x+=l.x*r.diameter,Rt.y+=l.y*r.diameter),s*s>c){if(void 0!=n){var h=Tt(c),f=(i.radiusSquared-r.radiusSquared+c)/(h+h),d=Tt(i.radiusSquared-f*f)/h,p=-jt.y*d,y=jt.x*d;Dt.Set(kt.x+jt.x*f/h,kt.y+jt.y*f/h),It.Set(Dt.x+p,Dt.y+y),Lt.Set(Dt.x-p,Dt.y-y),kt.SubtractV(Rt).Divide(s,s);var v=h-o-a;n.poc.a.SetV(Dt),n.poc.b.SetV(It),n.poc.c.SetV(Lt),n.mtv.SetV(kt),n.mtd=v,n.delta.SetV(jt),n.occured=!0}return!0}return!1},_t=function(t,e,n){Pt.SetV(n.delta).Normalize(),Et.SetV(n.mtv);var i=t.mass,r=e.mass,o=t.velocity,a=e.velocity,s=2*(o.GetDotV(Pt)-a.GetDotV(Pt))/(i+r);o.Set(o.x-s*r*Pt.x,o.y-s*r*Pt.y),a.Set(a.x+s*i*Pt.x,a.y+s*i*Pt.y),Et.Multiply(n.mtd,n.mtd).Divide(2,2),t.relative.SubtractV(Et),e.relative.AddV(Et)},Pt=new pt(0,0),Et=new pt(0,0),kt=new pt(0,0),Rt=new pt(0,0),Dt=new pt(0,0),It=new pt(0,0),Lt=new pt(0,0),jt=new pt(0,0);function Bt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Gt=Math.sqrt,Ut=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new pt(0,0),this.cp=new pt(0,0),this.sOrE=0,this.occured=!1}return function(t,e,n){e&&Bt(t.prototype,e),n&&Bt(t,n)}(t,[{key:"Reset",value:function(){this.mtv.SetSame(0),this.cp.SetSame(0),this.sOrE=0,this.occured=!1}}]),t}(),Nt=function(t,e,n){var i=e.shape,r=t.shape,o=e.relative,a=t.relative;Mt.Set(i.s.x+o.x,i.s.y+o.y),Vt.Set(i.e.x+o.x,i.e.y+o.y);var s=Object(D.ClosestPointOnLine)(Mt,Vt,a);Xt.Set(a.x-s.x,a.y-s.y);var u=Xt.GetMagnitudeSquared();if(u<r.radiusSquared){if(n){var l=r.radius-Gt(u);Xt.Normalize().Multiply(l,l),n.mtv.SetV(Xt),n.cp.SetV(s),n.occured=!0,s===Mt?n.sOrE=1:s===Vt&&(n.sOrE=-1)}return!0}return!1},Ft=function(t,e,n){var i,r,o=e.shape,a=t.velocity,s=t.relative,u=n.cp;0!==n.sOrE?(i=u.SubtractVC(s)).Normalize():i=o.GetNormalA(),r=a.GetReflectionV(i),a.SetV(r),s.AddV(n.mtv)},Mt=new pt(0,0),Vt=new pt(0,0),Xt=new pt(0,0);function Yt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ht=Math.abs,Wt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new pt(0,0),this.olAxis=new pt(0,0),this.mtd=1/0,this.occured=!1}return function(t,e,n){e&&Yt(t.prototype,e),n&&Yt(t,n)}(t,[{key:"Reset",value:function(){this.occured=!1,this.mtv.Set(0,0),this.mtd=1/0,this.olAxis.Set(0,0)}}]),t}(),qt=function(t,e,n){for(var i=0,r=t.shape,o=e.shape,a=r.normals,s=o.normals,u=a.length,l=s.length;i<u;++i)if(!0===zt(t,e,a[i],n))return!1;for(i=0;i<l;++i)if(!0===zt(t,e,s[i],n))return!1;return void 0!=n&&(n.mtv.SetV(n.olAxis),n.mtv.Multiply(n.mtd,n.mtd),n.occured=!0),!0},zt=function(t,e,n,i){var r=n.GetMinMaxDot(t.shape.vertices),o=n.GetMinMaxDot(e.shape.vertices),a=e.relative.SubtractVC(t.relative).GetDotV(n);if(o.Add(a,a),r.x>o.y||o.x>r.y)return!0;if(void 0!=i){var s=0,u=0,l=0,c=r.x,h=r.y,f=o.x,d=o.y;s=c<f?h<d?h-f:(u=h-f)<(l=d-c)?u:-l:h>d?c-d:(u=h-f)<(l=d-c)?u:-l;var p=Ht(s);p<i.mtd&&(i.mtd=p,i.olAxis.SetV(n),s<0&&i.olAxis.Invert())}return!1},Kt=Math.PI,Jt=Math.cos,Qt=Math.sin,$t=Math.abs,Zt=Math.pow,te=Math.exp,ee=function(t,e,n,i,r){var o=new pt(e,n),a=new pt(e+i,n),s=new pt(e+i,n+r),u=new pt(e,n+r);return t.Recreate([o,a,s,u]),t.ComputeBounds(),t.GetNormalsA(),t},ne=function(t,e,n,i,r){var o=new pt(e,n),a=new pt(e+.5*i,n+r),s=new pt(e-.5*i,n+r);return t.Recreate([o,a,s]),t.ComputeBounds(),t.GetNormalsA(),t},ie=function(t,e,n,i,r){var o,a,s,u=0,l=r,c=2*Kt/l;for(t.Recreate([]);u<l;++u)o=Jt(s=c*u)*i,a=Qt(s)*i,t.AddVertex(new pt(e+o,n+a));return t.ComputeBounds(),t.GetNormalsA(),t},re=function(t,e,n,i){var r,o,a=2.0943951023931953;return t.Recreate([]),r=i,o=0,t.AddVertex(new pt(e+r,n+o)),r=Jt(a)*i,o=Qt(a)*i,t.AddVertex(new pt(e+r,n+o)),r=Jt(2*a)*i,o=Qt(2*a)*i,t.AddVertex(new pt(e+r,n+o)),t.Rotate(-90*new Math.RADIAN),t.ComputeBounds(),t.GetNormalsA(),t},oe=function(t,e,n,i,r,o){var a,s,u,l,c=0,h=2*o,f=2*Math.PI/h;for(t.Recreate([]);c<h;++c)l=0==(1&c)?i:r,u=f*c,a=Math.cos(u)*l,s=Math.sin(u)*l,t.AddVertex(new pt(e+a,n+s));return t.ComputeBounds(),t.GetNormalsA(),t},ae=function t(e,n,i,r,o){var a,s,u,l=0,c=t.C;for(e.Recreate([]);l<r;++l)u=l*c._1*Kt/r,a=Jt(u)*(te(Jt(u))-c._2*Jt(c._3*u)-Zt(Qt(u/c._4),c._5))*o,s=Qt(u)*(te(Jt(u))-c._2*Jt(c._3*u)-Zt(Qt(u/c._4),c._5))*o,e.AddVertex(new pt(n+a,i+s));return e.ComputeBounds(),e.GetNormalsA(),e};ae.C={_1:24,_2:2,_3:4,_4:12,_5:5};var se=function(t,e,n,i,r,o,a){var s,u,l,c,h=0,f=o,d=2*Kt/f*a;for(t.Recreate([]);h<f;++h)c=Jt(r*(l=d*h))*i,s=Jt(l)*c,u=Qt(l)*c,t.AddVertex(new pt(e+s,n+u));return t.ComputeBounds(),t.GetNormalsA(),t},ue=function t(e,n,i,r,o,a,s,u,l){var c,h,f,d,p,y,v=0,m=o,b=t.C;for(s=void 0===s?1:s,u=void 0===u?1:u,l=void 0===l?1:l,e.Recreate([]);v<m;++v)p=Jt(a*(f=v*Kt*2/o)/4)/b._A,p=$t(p),p=Zt(p,u),y=Qt(a*f/4)/b._B,y=$t(y),y=Zt(y,l),d=Zt(p+y,1/s),0===$t(d)?(c=0,h=0):(d=1/d,c=Jt(f)*d*r,h=Qt(f)*d*r),e.AddVertex(new pt(n+c,i+h));return e.ComputeBounds(),e.GetNormalsA(),e};function le(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}ue.C={_A:1,_B:1};var ce=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tl=new pt(e,n),this.br=new pt(i,r),this.w=0,this.h=0,this.hw=0,this.hh=0,this.area=0,this.belongsTo=null,this.TYPE=ye,this.ComputeWH()}return function(t,e,n){e&&le(t.prototype,e),n&&le(t,n)}(t,[{key:"Set",value:function(t,e,n,i){this.tl.Set(t,e),this.br.Set(n,i),this.ComputeWH()}},{key:"SetC",value:function(t){this.Set(t.tl.x,t.tl.y,t.br.x,t.br.y)}},{key:"Scale",value:function(t,e){this.tl.Multiply(t,e),this.br.Multiply(t,e),this.ComputeWH()}},{key:"ScaleV",value:function(t){this.tl.MultiplyV(t),this.br.MultiplyV(t),this.ComputeWH()}},{key:"ComputeWH",value:function(){this.w=this.br.x-this.tl.x,this.h=this.br.y-this.tl.y,this.hw=.5*this.w,this.hh=.5*this.h,this.area=this.w*this.h}},{key:"IntersectsPoint",value:function(t){return!(t.x<this.tl.x||t.x>this.br.x||t.y<this.tl.y||t.y>this.br.y)}},{key:"ContainsPoint",value:function(t){return t.x>this.tl.x&&t.x<this.br.x&&t.y>this.tl.y&&t.y<this.br.y}},{key:"IntersectsAABB2D",value:function(t){var e=this.tl,n=this.br,i=t.tl,r=t.br;return!(i.x>=n.x||i.y>=n.y||r.x<=e.x||r.y<=e.y)}},{key:"ContainsAABB2D",value:function(t){if(t.area>this.area)return!1;var e=this.tl,n=this.br,i=t.tl,r=t.br;return i.x>=e.x&&i.y>=e.y&&r.x<=n.x&&r.y<=n.y}},{key:"GetQuadrant",value:function(e){var n=this.tl,i=this.br;switch(e){case he:return new t(n.x,n.y,n.x+this.hw,n.y+this.hh);case fe:return new t(n.x+this.hw,n.y,i.x,n.y+this.hh);case de:return new t(n.x,n.y+this.hh,n.x+this.hw,i.y);case pe:return new t(n.x+this.hw,n.y+this.hh,i.x,i.y);default:return null}}}],[{key:"TYPE",get:function(){return ye}}]),t}(),he="TL",fe="TR",de="BL",pe="BR",ye=1;function ve(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var me=Math.PI,be=Math.sin,ge=Math.cos,we=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.center=new pt(e,n),this.diameter=0,this.w=0,this.h=0,this.radiusSquared=0,this.radiusUnsquared=0,this.area=0,this.radius=i,this.belongsTo=null,this.TYPE=Ae}return function(t,e,n){e&&ve(t.prototype,e),n&&ve(t,n)}(t,[{key:"Set",value:function(t,e,n){this.center.Set(t,e),this.radius=n}},{key:"SetC",value:function(t){this.center.SetV(t),this.radius=t.radius}},{key:"Scale",value:function(t){this.radius*=t}},{key:"IntersectsCircle",value:function(t){var e=this.radius+t.radius;return e*e>=this.center.GetDistanceSquaredV(t.center)}},{key:"IntersectsPoint",value:function(t){return this.radiusSquared>=this.center.GetDistanceSquaredV(t)}},{key:"GenerateRandomPoints",value:function(t,e,n){var i=R.RandomFloat,r=new pt(this.x-this.radius,this.y-this.radius),o=new pt(this.x+this.radius,this.y+this.radius),a=[];n=!!n,!0===e&&(i=R.RandomInteger);for(var s=0;s<t;++s){for(var u=Nenkraft.Vector2D(i(r.x,o.x),i(r.y,o.y));this.IntersectsPoint(u)===n;)u.Set(i(r.x,o.x),i(r.y,o.y));a.push(u)}return a}},{key:"GeneratePerimeterPoints",value:function(t,e){var n=[];t*=e;for(var i=0;i<t;i+=e)n.push(Nenkraft.Vector2D(this.x+ge(Object(D.DegreesToRadians)(i))*this.radius,this.y+be(Object(D.DegreesToRadians)(i))*this.radius));return n}},{key:"x",get:function(){return this.center.x},set:function(t){this.center.x=t}},{key:"y",get:function(){return this.center.y},set:function(t){this.center.y=t}},{key:"radius",get:function(){return this.radiusUnsquared},set:function(t){this.radiusUnsquared=t,this.radiusSquared=t*t,this.diameter=this.w=this.h=2*t,this.area=me*t*t}}],[{key:"TYPE",get:function(){return Ae}}]),t}(),Ae=2;function Se(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ce=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.s=new pt(e,n),this.e=new pt(i,r),this.epsilon=1e3,this.belongsTo=null,this.TYPE=Te}return function(t,e,n){e&&Se(t.prototype,e),n&&Se(t,n)}(t,[{key:"Set",value:function(t,e,n,i){this.s.Set(t,e),this.e.Set(n,i)}},{key:"SetC",value:function(t){this.s.SetV(t.s),this.e.SetV(t.e)}},{key:"Stretch",value:function(t){var e=.5*t;this.s.PushFromV(this.e,e),this.e.PushFromV(this.s,e)}},{key:"Rotate",value:function(t,e,n){e=void 0==e?.5:e;var i=this.s.Copy();i.AddV(this.e),i.Multiply(e,void 0==n?e:n),this.s.RotateAroundV(i,t),this.e.RotateAroundV(i,t)}},{key:"Cut",value:function(t,e){null==e&&(e=[]);for(var n=0;n<t.length;++n)e.push(this.s.GetWeightedAverageV(this.e,t[n]));return e}},{key:"GetLength",value:function(){return this.s.GetDistanceV(this.e)}},{key:"GetLengthSquared",value:function(){return this.s.GetDistanceSquaredV(this.e)}},{key:"IntersectsPoint",value:function(t){var e=this.s,n=this.e,i=(t.y-e.y)*(n.x-e.x)-(t.x-e.x)*(n.y-e.y);if(Math.abs(i)>this.epsilon)return!1;var r=(t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y);return!(r<0)&&!(r>this.GetLengthSquared())}},{key:"IntersectsLine",value:function(t){return Object(D.LineLineIntersection)(this.s,this.e,t.s,t.e)}},{key:"GetClosestPointTo",value:function(t){return Object(D.ClosestPointOnLine)(this.s,this.e,t)}},{key:"GetNormalA",value:function(){return this.s.GetNormalAV(this.e)}},{key:"GetNormalB",value:function(){return this.s.GetNormalBV(this.e)}}]),t}(),Te=0;function xe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Oe=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertices=[],this.normals=[],this.perimeterMidPoints=[],this.centroid=new pt(0,0),this.aabb=null,this.dirtyBounds=!0,this.belongsTo=null,this.TYPE=_e,null!=e&&this.AddVertices(e)}return function(t,e,n){e&&xe(t.prototype,e),n&&xe(t,n)}(t,[{key:"Copy",value:function(){for(var e=new t,n=this.vertices,i=0;i<n.length;++i)e.AddVertex(n[i].Copy());return e}},{key:"ExtractSegments",value:function(t){var e=this.vertices,n=e.length-1;null==t&&(t=[]);for(var i=0;i<n;++i)t.push(new Ce(e[i],e[i+1]));return t.push(new Ce(e[n],e[0])),t}},{key:"GenerateRandomPoints",value:function(t,e,n){this.ComputeBounds(),n=!!n;var i=R.RandomFloat,r=this.aabb.tl,o=this.aabb.br,a=[];!0===e&&(i=R.RandomInteger);for(var s=0;s<t;++s){for(var u=new pt(i(r.x,o.x),i(r.y,o.y));this.IntersectsPoint(u)===n;)u.Set(i(r.x,o.x),i(r.y,o.y));a.push(u)}return a}},{key:"AddVertex",value:function(t){this.vertices.push(t)}},{key:"AddVertices",value:function(t){if(t[0]instanceof pt)this.vertices.push.apply(this.vertices,t);else if("number"==typeof t[0])for(var e=0;e<t.length;e+=2)this.AddVertex(new pt(t[e],t[e+1]));else if(null!=t[0].x)for(e=0;e<t.length;++e)this.AddVertex(new pt(t[e].x,t[e].y))}},{key:"Recreate",value:function(t){this.vertices.length=0,void 0!=t&&this.vertices.push.apply(this.vertices,t)}},{key:"ComputeBounds",value:function(){var t,e=1/0,n=-e,i=e,r=-e,o=this.vertices;null===this.aabb&&(this.aabb=new ce(0,0,0,0));for(var a=0;a<o.length;++a)(t=o[a]).x<e&&(e=t.x),t.x>n&&(n=t.x),t.y<i&&(i=t.y),t.y>r&&(r=t.y);this.aabb.Set(e,i,n,r),this.dirtyBounds=!1}},{key:"Rotate",value:function(t,e,n,i){var r=0,o=this.aabb,a=o.tl.Copy(),s=this.vertices,u=s.length;for(!0===this.dirtyBounds&&!0===i?this.ComputeBounds():null===this.aabb&&this.ComputeBounds(),e=void 0===e?.5:e,a.AddV(o.br),a.Multiply(e,void 0===n?e:n);r<u;++r)s[r].RotateAroundV(a,t);this.dirtyBounds=!0}},{key:"GetControid",value:function(){var t=this.vertices,e=this.centroid;e.Set(0,0);for(var n=0;n<t.length;++n)e.AddV(t[n]);return e.Divide(t.length,t.length),e}},{key:"GetNormalsA",value:function(){var t=this.vertices,e=t.length-1,n=this.normals;n.length=0;for(var i=0;i<e;++i)n.push(t[i].GetNormalAV(t[i+1]));return n.push(t[e].GetNormalAV(t[0])),n}},{key:"GetNormalsA",value:function(){var t=this.vertices,e=t.length-1,n=this.normals;n.length=0;for(var i=0;i<e;++i)n.push(t[i].GetNormalBV(t[i+1]));return n.push(t[e].GetNormalBV(t[0])),n}},{key:"GetPerimeterMidPoints",value:function(){var t=this.vertices,e=t.length-1,n=this.perimeterMidPoints;n.length=0;for(var i=0;i<e;++i)n.push(t[i].GetMidPointV(t[i+1]));return n.push(t[e].GetMidPointV(t[0])),n}},{key:"IntersectsPoint",value:function(t){if(!0===this.dirtyBounds&&this.ComputeBounds(),!1===this.aabb.IntersectsPoint(t))return!1;for(var e,n,i=!1,r=this.vertices,o=t.x,a=t.y,s=0,u=r.length-1;s<r.length;u=s++)e=r[s],n=r[u],e.y>a!=n.y>a&&o<(n.x-e.x)*(a-e.y)/(n.y-e.y)+e.x&&(i=!i);return i}}]),t}(),_e=3,Pe="source-over",Ee="source-over",ke="source-in",Re="source-out",De="source-atop",Ie="destination-over",Le="destination-in",je="destination-out",Be="destination-atop",Ge="lighter",Ue="copy",Ne="xor",Fe="multiply",Me="overlay",Ve="darken",Xe="lighten",Ye="color-dodge",He="color-burn",We="hard-light",qe="soft-light",ze="difference",Ke="exclusion",Je="hue",Qe="saturation",$e="color",Ze="luminosity",tn="round",en="butt",nn="square",rn="bevel",on="round",an="miter",sn="start",un="end",ln="center",cn="left",hn="right",fn="alphabetic",dn="top",pn="hanging",yn="middle",vn="ideographic",mn="bottom";function bn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var gn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#36802d",this.applied=!0,Object(R.ApplyProperties)(this,e)}return function(t,e,n){e&&bn(t.prototype,e),n&&bn(t,n)}(t,[{key:"Apply",value:function(t){t.fillStyle=this.color}}]),t}();function wn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var An=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#c9df8a",this.lineCap=tn,this.lineJoin=on,this.lineWidth=2,this.miterLimit=10,this.applied=!0,Object(R.ApplyProperties)(this,e)}return function(t,e,n){e&&wn(t.prototype,e),n&&wn(t,n)}(t,[{key:"Apply",value:function(t){t.strokeStyle=this.color,t.lineCap=this.lineCap,t.lineJoin=this.lineJoin,t.lineWidth=this.lineWidth,t.miterLimit=this.miterLimit}}]),t}();function Sn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Cn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#234d20",this.blur=5,this.offsetX=0,this.offsetY=0,this.applied=!1,Object(R.ApplyProperties)(this,e)}return function(t,e,n){e&&Sn(t.prototype,e),n&&Sn(t,n)}(t,[{key:"Apply",value:function(t){t.shadowColor=this.color,t.shadowBlur=this.blur,t.shadowOffsetX=this.offsetX,t.shadowOffsetY=this.offsetY}}]),t}();function Tn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var xn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fillColor="#36802d",this.strokeColor="#36802d",this.fontSize=45,this.font=null,this.fontFamily="Arial",this.align=cn,this.baseline=dn,this.lineWidth=.5,this.applied=!0,Object(R.ApplyProperties)(this,e),this.ConcatFont()}return function(t,e,n){e&&Tn(t.prototype,e),n&&Tn(t,n)}(t,[{key:"Apply",value:function(t){t.fillStyle=this.fillColor,t.strokeStyle=this.strokeColor,t.font=this.font,t.textAlign=this.align,t.textBaseline=this.baseline,t.lineWidth=this.lineWidth}},{key:"ConcatFont",value:function(){this.font=this.fontSize+"px "+this.fontFamily}}]),t}();var On=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#c9df8a",this.size=1,Object(R.ApplyProperties)(this,e)},_n=function(t){return{fill:new gn(t?t.fill:null),stroke:new An(t?t.stroke:null),shadow:new Cn(t?t.shadow:null),text:new xn(t?t.text:null),pixel:new On(t?t.pixel:null)}},Pn=function(t){return{fill:new gn(t?t.fill:null),stroke:new An(t?t.stroke:null),shadow:new Cn(t?t.shadow:null)}},En=function(t){return{stroke:new An(t?t.stroke:null),shadow:new Cn(t?t.shadow:null)}},kn=function(t){return{fill:new gn(t?t.fill:null),shadow:new Cn(t?t.shadow:null)}},Rn=function(t){return{shadow:new Cn(t?t.shadow:null),text:new xn(t?t.text:null)}},Dn=function(t){return{pixel:new On(t?t.pixel:null)}};function In(t){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ln(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function jn(t,e){return!e||"object"!==In(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bn(t){return(Bn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gn(t,e){return(Gn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Un=function(t){function e(t,n,i,r,o){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=jn(this,Bn(e).call(this,t,n,i,r))).programController=null,a.style=Pn(o),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gn(t,e)}(e,ce),function(t,e,n){e&&Ln(t.prototype,e),n&&Ln(t,n)}(e,[{key:"Draw",value:function(t){var e=this.tl,n=this.br,i=this.style;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(n.x,e.y),t.lineTo(n.x,n.y),t.lineTo(e.x,n.y),t.closePath(),!0===i.shadow.applied&&i.shadow.Apply(t),!0===i.fill.applied&&(i.fill.Apply(t),t.fill()),!0===i.stroke.applied&&(i.stroke.Apply(t),t.stroke())}},{key:"GLDraw",value:function(t,e){null!==this.programController&&this.programController.Execute(e.globalTransform.AsArray(!0),this.tl.x,this.tl.y,this.w,this.h)}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.fillColor&&null!==t.outlineColor&&null!==t.outline&&(t.fillColor.SetHex(this.style.fill.color),t.fillColor.Normalize(),t.outlineColor.SetHex(this.style.stroke.color),t.outlineColor.Normalize(),t.outline=this.style.stroke.lineWidth+.2),this}}]),e}();function Nn(t){return(Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Mn(t,e){return!e||"object"!==Nn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vn(t){return(Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xn(t,e){return(Xn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yn=function(t){function e(t,n,i,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Mn(this,Vn(e).call(this,t,n,i))).programController=null,o.style=Pn(r),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xn(t,e)}(e,we),function(t,e,n){e&&Fn(t.prototype,e),n&&Fn(t,n)}(e,[{key:"Draw",value:function(t){var e=this.center,n=this.style;t.beginPath(),t.arc(e.x,e.y,this.radius,0,D.PII,!1),t.closePath(),!0===n.shadow.applied&&n.shadow.Apply(t),!0===n.fill.applied&&(n.fill.Apply(t),t.fill()),!0===n.stroke.applied&&(n.stroke.Apply(t),t.stroke())}},{key:"GLDraw",value:function(t,e){null!==this.programController&&this.programController.Execute(e.globalTransform.AsArray(!0),this.center.x,this.center.y,this.radius)}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.fillColor&&null!==t.outlineColor&&null!==t.outline&&(t.fillColor.SetHex(this.style.fill.color),t.fillColor.Normalize(),t.outlineColor.SetHex(this.style.stroke.color),t.outlineColor.Normalize(),t.outline=this.style.stroke.lineWidth+.2),this}}]),e}();function Hn(t){return(Hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function qn(t,e){return!e||"object"!==Hn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zn(t){return(zn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kn(t,e){return(Kn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jn=function(t){function e(t,n,i,r,o){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=qn(this,zn(e).call(this,t,n,i,r))).programController=null,a.style=En(o),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kn(t,e)}(e,Ce),function(t,e,n){e&&Wn(t.prototype,e),n&&Wn(t,n)}(e,[{key:"Draw",value:function(t){var e=this.s,n=this.e,i=this.style;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(n.x,n.y),t.closePath(),!0===i.shadow.applied&&i.shadow.Apply(t),!0===i.stroke.applied&&(i.stroke.Apply(t),t.stroke())}},{key:"GLDraw",value:function(t,e){null!==this.programController&&this.programController.Execute(e.globalTransform.AsArray(!0),this.s,this.e)}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.color&&(t.color.SetHex(this.style.stroke.color),t.color.Normalize()),this}}]),e}();function Qn(t){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Zn(t,e){return!e||"object"!==Qn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ti(t){return(ti=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ei(t,e){return(ei=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ni=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Zn(this,ti(e).call(this,t))).programController=null,i.style=Pn(n),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ei(t,e)}(e,Oe),function(t,e,n){e&&$n(t.prototype,e),n&&$n(t,n)}(e,[{key:"Draw",value:function(t){var e=this.vertices,n=this.style;t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var i=1;i<e.length;++i)t.lineTo(e[i].x,e[i].y);t.closePath(),!0===n.shadow.applied&&n.shadow.Apply(t),!0===n.fill.applied&&(n.fill.Apply(t),t.fill()),!0===n.stroke.applied&&(n.stroke.Apply(t),t.stroke())}}]),e}();function ii(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ri=Math.max,oi=Math.min,ai=Math.round,si=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.channel=new Float32Array([null==e?0:e,null==n?0:n,null==i?0:i,null==r?1:r]),this.value="",this.currentConversion="",this.ComputeValueRGBA()}return function(t,e,n){e&&ii(t.prototype,e),n&&ii(t,n)}(t,[{key:"Copy",value:function(){var e=new t(this.channel[0],this.channel[1],this.channel[2],this.channel[3]);return e.value=this.value,e.currentConversion=this.currentConversion,e}},{key:"ComputeValueRGBA",value:function(){return this.value="rgba(".concat(this.channel.join(",").concat(")")),this.value}},{key:"ComputeValueHSLA",value:function(){return this.value="hsla("+this.channel[0]+","+this.channel[1]+"%,"+this.channel[2]+"%,"+this.channel[3]+")",this.value}},{key:"ComputeValueHex",value:function(){return this.value="#"+this.channel[0].toString(16)+this.channel[1].toString(16)+this.channel[2].toString(16),this.value}},{key:"ConvertToHSLA",value:function(t){var e=0,n=0,i=this.channel[0]/ui,r=this.channel[1]/ui,o=this.channel[2]/ui,a=ri(i,r,o),s=oi(i,r,o),u=a-s,l=.5*(a+s);a!==s&&(n=l>.5?u/(2-a-s):u/(a+s),e=a===i?(r-o)/u+(r<o?6:0):a===r?(o-i)/u+2:(i-r)/u+4,e/=6),this.channel[0]=360*e,this.channel[1]=100*n,this.channel[2]=100*l,!0===t&&(this.channel[0]=ai(this.channel[0]),this.channel[1]=ai(this.channel[1]),this.channel[2]=ai(this.channel[2])),this.currentConversion="hsl",this.ComputeValueHSLA()}},{key:"ConvertToHEX",value:function(){}},{key:"SetRGB",value:function(t,e,n,i){this.channel[0]=Object(R.Clamp)(t,li,ui),this.channel[1]=Object(R.Clamp)(e,li,ui),this.channel[2]=Object(R.Clamp)(n,li,ui),this.currentConversion="rgb",i||this.ComputeValueRGBA()}},{key:"SetRGBA",value:function(t,e,n,i){this.SetRGB(t,e,n,!0),this.channel[3]=Object(R.Clamp)(i,0,1),this.ComputeValueRGBA()}},{key:"SetHex",value:function(t){var e=(t=t.replace(/#/g,"")).match(/.{2}/g);null==(e=e.map(R.Base16ToBase10))[3]&&(e[3]=1),this.SetRGBA(e[0],e[1],e[2],e[3])}},{key:"IncreaseChannel",value:function(t,e){this.channel[t]+=e,"rgb"===this.currentConversion?this.ComputeValueRGBA():"hsl"===this.currentConversion&&this.ComputeValueHSLA()}},{key:"SetChannel",value:function(t,e){this.channel[t]=e,"rgb"===this.currentConversion?this.ComputeValueRGBA():"hsl"===this.currentConversion&&this.ComputeValueHSLA()}},{key:"Normalize",value:function(){this.channel[0]=ci*this.channel[0],this.channel[1]=ci*this.channel[1],this.channel[2]=ci*this.channel[2]}},{key:"r",get:function(){return this.channel[0]},set:function(t){this.channel[0]=t}},{key:"g",get:function(){return this.channel[1]},set:function(t){this.channel[1]=t}},{key:"b",get:function(){return this.channel[2]},set:function(t){this.channel[2]=t}},{key:"a",get:function(){return this.channel[3]},set:function(t){this.channel[3]=t}}]),t}(),ui=255,li=0,ci=1/ui;function hi(t){return(hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function di(t,e){return!e||"object"!==hi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pi(t){return(pi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yi(t,e){return(yi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vi=function(t){function e(t,n,i){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=di(this,pi(e).call(this,t,n))).style=Dn(i),r.color=new si,r.programController=null,r.bufferData=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yi(t,e)}(e,pt),function(t,e,n){e&&fi(t.prototype,e),n&&fi(t,n)}(e,[{key:"GLDraw",value:function(t,e){null!==this.programController&&this.programController.Execute(e.worldTransform.AsArray(!0),this.x,this.y)}},{key:"LinkProgramController",value:function(t){this.programController=t,this.LinkStyle()}},{key:"UseProgramController",value:function(t){this.programController=t}},{key:"LinkStyle",value:function(){var t=this.programController;null!==t&&null!==t.color&&(t.color.SetHex(this.style.pixel.color),t.color.Normalize())}},{key:"GetBufferData",value:function(){null==this.bufferData&&(this.bufferData=[]);var t=this.bufferData,e=this.color;return t[0]=this.x,t[1]=this.y,t[2]=e.r,t[3]=e.g,t[4]=e.b,t[5]=e.a,t[6]=this.style.pixel.size,t}},{key:"UpdateInBuffer",value:function(t,e){var n=this.color;t[e]=this.x,t[e+1]=this.y,t[e+2]=n.r,t[e+3]=n.g,t[e+4]=n.b,t[e+5]=n.a,t[e+6]=this.style.pixel.size}}]),e}();function mi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var bi=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=n,this.holderContext=e,this.handle=i,this.removeOnNextCall=r}return function(t,e,n){e&&mi(t.prototype,e),n&&mi(t,n)}(t,[{key:"Execute",value:function(){this.handle.apply(this.context,arguments),!0===this.removeOnNextCall&&this.Remove()}},{key:"Remove",value:function(){this.holderContext.Remove(this.handle,this.context)}}]),t}();function gi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var wi=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.listeners=[],this.stopPropagation=!1,this.target=null,this.data=null}return function(t,e,n){e&&gi(t.prototype,e),n&&gi(t,n)}(t,[{key:"GetListenerIndex",value:function(t,e){var n,i=this.listeners;if(0===i.length)return-1;for(var r=0;r<i.length;++r)if((n=i[r]).context===e&&n.handle===t)return r;return-1}},{key:"Add",value:function(t,e,n){var i=new bi(this,e,t,n);this.listeners.push(i)}},{key:"Remove",value:function(t,e){var n=this.GetListenerIndex(t,e);-1!==n&&this.listeners.fickleSplice(n)}},{key:"Dump",value:function(t){var e=this.listeners;if(void 0!==t)for(var n=0;n<e.length;++n)e[n].context===t&&e.splice(n);else e.length=0}},{key:"Dispatch",value:function(t,e){var n=this.listeners.slice();if(0!==n.length){this.stopPropagation=!1,this.target=t,this.data=e;for(var i=0;i<n.length&&(n[i].Execute(this),!0!==this.stopPropagation);++i);this.target=null,this.data=null}}}]),t}();function Ai(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Si=Math.round,Ci=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.stopTime=Si(null==e?0:e),this.time=0,this.isRunning=!1,this.canResume=!1,this.count=0,this.onStop=new wi,this.onFinish=new wi,this.onStart=new wi,this.onReset=new wi,this.onPause=new wi,this.onResume=new wi}return function(t,e,n){e&&Ai(t.prototype,e),n&&Ai(t,n)}(t,[{key:"Reset",value:function(){this.onReset.Dispatch(this,null),this.count=0,this.time=0,this.isRunning=!1,this.canResume=!1}},{key:"Start",value:function(t){this.stopTime=Si(null==t?this.stopTime:t),this.stopTime>0&&(this.time=0,this.isRunning=!0,this.canResume=!1,this.onStart.Dispatch(this,{stopTime:this.stopTime}))}},{key:"Stop",value:function(){!0===this.isRunning&&(this.isRunning=!1,this.onStop.Dispatch(this,null))}},{key:"Pause",value:function(){!0===this.isRunning&&!1===this.canResume&&(this.isRunning=!1,this.canResume=!0,this.onPause.Dispatch(this,null))}},{key:"Resume",value:function(){!0===this.canResume&&(this.isRunning=!0,this.canResume=!1,this.onResume.Dispatch(this,null))}},{key:"Process",value:function(){this.time<this.stopTime&&!0===this.isRunning&&++this.time>=this.stopTime&&(this.isRunning=!1,this.count++,this.onFinish.Dispatch(this,null))}}]),t}();function Ti(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var xi=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.SetDesiredRate(n),this.onProcess=e,this.intervalId=null,this.afId=null,this.delta=0,this.then=0,this.now=0,this.desiredRate=0,this.supplyDelta=!0,i||this.StartAF()}return function(t,e,n){e&&Ti(t.prototype,e),n&&Ti(t,n)}(t,[{key:"Process",value:function(){this.onProcess(this.ComputeDelta())}},{key:"ProcessAF",value:function(){this.onProcess(this.ComputeDelta()),null!==this.afId&&(this.afId=requestAnimationFrame(this.ProcessAF))}},{key:"ComputeDelta",value:function(){return this.now=Date.now(),this.delta=this.now-this.then,this.then=this.now,this.delta}},{key:"GetTPS",value:function(){return Object(D.PrecisionRound)(1/this.delta*1e3,2)}},{key:"SetDesiredRate",value:function(t){this.desiredRate=void 0===t?16.66:1e3/t}},{key:"Start",value:function(t){if(null!==this.afId)return Pi("%cTicker: RAF is running!","color:red;".concat(_i)),null;null!==this.intervalId?!0===t?(this.Stop(),this.intervalId=setInterval(this.Process.bind(this),this.desiredRate),Pi("%cTicker: Starting interval!","color:#0F0;".concat(_i))):Pi("%cTicker: Interval already running!","color:#F00;".concat(_i)):(this.intervalId=setInterval(this.Process.bind(this),this.desiredRate),Pi("%cTicker: Starting interval!","color:#0F0;".concat(_i)))}},{key:"StartAF",value:function(t){if(null!==this.intervalId)return Pi("%cTicker: Interval is running!","color:#F00;".concat(_i)),null;null!==this.afId?!0===t?(this.Stop(),this.ProcessAF=this.ProcessAF.bind(this),this.afId=requestAnimationFrame(this.ProcessAF),Pi("%cTicker: Starting RAF!","color:#0F0;".concat(_i))):Pi("%cTicker: RAF already running!","color:#F00;".concat(_i)):(this.ProcessAF=this.ProcessAF.bind(this),this.afId=requestAnimationFrame(this.ProcessAF),Pi("%cTicker: Starting RAF!","color:#0F0;".concat(_i)))}},{key:"Stop",value:function(){null!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null,Pi("%cTicker: Stopping interval!","color:cyan;".concat(_i))),null!==this.afId&&(cancelAnimationFrame(this.afId),this.afId=null,Pi("%cTicker: Stopping RAF!","color:cyan;".concat(_i)))}}],[{key:"LOG",get:function(){return Oi},set:function(t){(function(t){throw new Error('"'+t+'" is read-only')})("PS_LOG"),Oi=!!t}}]),t}(),Oi=!0,_i="background-color:#36802d;font-family:Arial;font-size:18px;font-weight:900;padding:5px;",Pi=function(){!1!==Oi&&console.log.apply(null,arguments)},Ei=n(9),ki=n.n(Ei),Ri=n(10),Di=n.n(Ri),Ii=n(11),Li=n.n(Ii),ji=n(12),Bi=n.n(ji),Gi=n(13),Ui=n.n(Gi),Ni=n(14),Fi=n.n(Ni),Mi=n(15),Vi=n.n(Mi),Xi=function(t){var e,i,r="@vertex@",o="@fragment@";e=t.indexOf(r)+r.length,i=t.indexOf("@vertex-end@");var a=t.substring(e,i);e=t.indexOf(o)+o.length,i=t.indexOf("@fragment-end@");for(var s=t.substring(e,i),u=!0;!0===u;){u=!1;var l=a.match(/\((import .*?)\)/),c=s.match(/\((import .*?)\)/);null!=l&&(a=a.replace(l[0],n(6)(l[1].replace(/\'/g,"").replace("import ","")+".glslfunc")),u=!0),null!=c&&(s=s.replace(c[0],n(6)(c[1].replace(/\'/g,"").replace("import ","")+".glslfunc")),u=!0)}return{vertex:a.replace(/\n/g,""),fragment:s.replace(/\n/g,"")}},Yi=Xi(ki.a),Hi=Xi(Di.a),Wi=Xi(Li.a),qi=Xi(Bi.a),zi=Xi(Ui.a),Ki=Xi(Fi.a),Ji=Xi(Vi.a),Qi=function(t){var e,n=[];for(n.push("precision mediump float;"),e=0;e<t;++e)n.push("attribute vec2 aPosition"+e+";","attribute vec2 aTexCoord"+e+";");for(n.push("uniform mat3 uProjection;","uniform mat3 uTranslation;","uniform mat3 uTransformation;","uniform float uUnitId;","varying vec2 vTexCoord;","void main () {","if ( uUnitId == 0.0 ) {","gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition0, 1.0 ) ).xy, 0.0, 1.0 );","vTexCoord = ( uTransformation * vec3( aTexCoord0, 1.0 ) ).xy;","}"),e=1;e<t;++e)n.push("else if ( uUnitId == "+e+".0 ) {","gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition"+e+", 1.0 ) ).xy, 0.0, 1.0 );","vTexCoord = ( uTransformation * vec3( aTexCoord"+e+", 1.0 ) ).xy;","}");return n.push("}"),{vertex:n.join(""),fragment:Yi.fragment}},$i=n(4);function Zi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var tr=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,this.items=[]}return function(t,e,n){e&&Zi(t.prototype,e),n&&Zi(t,n)}(t,[{key:"Store",value:function(t){var e=!1;return null==t?(console.warn("Item is null."),null):(null!=t.id&&""!==t.id?e=!this.Contains(t,t.id):t.data&&null!=t.data.id&&""!==t.data.id&&(e=!this.Contains(t,t.data.id)),!1===e?(console.warn("Invalid item. Check the item id. The item has not been stored"),!1):(this.items.push(t),!0))}},{key:"StoreSafe",value:function(t){return null!=this.type&&Object($i.a)(t,$i.a.IS_INSTANCE_OF,this.type),Object($i.a)(t,$i.a.IS_SAME_TYPE,er),t.id?(Object($i.a)(t.id,$i.a.IS_SAME_TYPE,nr),Object($i.a)(t.id,$i.a.IS_NOT,"")):(Object($i.a)(t.data,$i.a.IS_SAME_TYPE,er),Object($i.a)(t.data.id,$i.a.IS_SAME_TYPE,nr),Object($i.a)(t.data.id,$i.a.IS_NOT,"")),this.Store(t)}},{key:"GetById",value:function(t){for(var e=this.items,n=e[0],i=0;i<e.length;n=e[++i])if(null!=n&&(n.id===t||null!=n.data&&n.data.id===t))return n;return null}},{key:"Contains",value:function(t,e){for(var n=this.items,i=n[r],r=0;r<n.length;i=n[++r])if(null!=i){if(i===t)return!0;if(i.id===e)return!0;if(null!=i.data&&i.data.id===e)return!0}return!1}}]),t}(),er=Object.create(null),nr="string";var ir=function t(e,n,i,r,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.image=e,this.id=null,this.w=0,this.h=0,this.fw=0,this.fh=0,this.uniformId=0,this.id=null!=n?n:e.id,this.w=null!=i?i:e.naturalWidth,this.h=null!=r?r:e.naturalHeight,this.fw=null!=o?o:e.naturalWidth,this.fh=null!=a?a:e.naturalHeight};function rr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var or=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.imageCache=new tr(Image),this.basicTextureCache=new tr(ir),this.onImageLoaded=new wi,this.onComplete=new wi,this.count=0,this.loading=!1,this.toLoad=null,this.createTexture=!1,null!=i&&this.onComplete.Add(i,this),null!=e&&this.Load(e,n)}return function(t,e,n){e&&rr(t.prototype,e),n&&rr(t,n)}(t,[{key:"Load",value:function(t,e){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),null!=e&&(this.createTextures=e),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))}},{key:"Haul",value:function(t){var e=this.toLoad[t];if(null!=e){var n=new Image;n.onload=this.OnLoad.bind(this),n.onerror=this.OnError.bind(this),n.src=e.src,n.id=e.id,n.data=Object.create(null),n.data.w=e.w,n.data.h=e.h,n.data.fw=e.fw,n.data.fh=e.fh}else this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{imageCache:this.imageCache,basicTextureCache:this.basicTextureCache})}},{key:"OnLoad",value:function(t){var e=t.currentTarget;e.onload=null,e.onerror=null,this.imageCache.StoreSafe(e),!0===this.createTextures&&this.basicTextureCache.StoreSafe(new ir(e,null,e.data.w,e.data.h,e.data.fw,e.data.fh)),this.onImageLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count)}},{key:"OnError",value:function(){throw new Error("Request failed")}},{key:"GetImageById",value:function(t){return this.imageCache.GetById(t)}},{key:"GetBasicTextureById",value:function(t){return this.basicTextureCache.GetById(t)}}]),t}();function ar(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var sr=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.XHRcache=new tr(XMLHttpRequest),this.dataCache=new tr,this.onXHRLoaded=new wi,this.onComplete=new wi,this.count=0,this.loading=!1,this.toLoad=null,null!=n&&this.onComplete.Add(n,this),null!=e&&this.Load(e)}return function(t,e,n){e&&ar(t.prototype,e),n&&ar(t,n)}(t,[{key:"Load",value:function(t){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))}},{key:"Haul",value:function(t){var e=this.toLoad[t];if(null!=e){var n=new XMLHttpRequest;switch(n.open("GET",e.src),e.type){case"json":n.onreadystatechange=this.OnLoadJSON.bind(this);break;default:n.onreadystatechange=this.OnLoadXML.bind(this)}n.onerror=this.OnError.bind(this),null!=n.data?n.data.id=e.id:n.data={id:e.id},n.send()}else this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{XHRcache:this.XHRcache,dataCache:this.dataCache})}},{key:"OnLoadXML",value:function(t){var e=t.currentTarget;200!==e.status&&null==e.responseText||4!==e.readyState||(e.onload=null,e.onerror=null,this.XHRcache.StoreSafe(e),this.dataCache.Store({id:e.data.id,data:V(e.responseText,!0)}),this.onXHRLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count),e.abort())}},{key:"OnLoadJSON",value:function(t){var e=t.currentTarget;200!==e.status&&null==e.responseText||4!==e.readyState||(e.onload=null,e.onerror=null,this.XHRcache.StoreSafe(e),this.dataCache.Store({id:e.data.id,data:JSON.parse(e.responseText)}),this.onXHRLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count),e.abort())}},{key:"OnError",value:function(t){throw console.error(t),new Error("Request failed")}},{key:"GetXHRById",value:function(t){return this.XHRcache.GetById(t)}},{key:"GetDataById",value:function(t){return this.dataCache.GetById(t).data}},{key:"GetClonedDataById",value:function(t){return Object(R.DeepClone)(this.GetDataById(t))}}]),t}();function ur(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var lr=function(){function t(e,n,i,r,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rate=o,this.timer=o,this.x=e,this.y=n,this.w=i,this.h=r,this.nextFrameIndex=null,this.id=null,null!=a&&(this.id=a)}return function(t,e,n){e&&ur(t.prototype,e),n&&ur(t,n)}(t,[{key:"Process",value:function(){return this.timer--<=0&&(this.Reset(),!0)}},{key:"Apply",value:function(t){t.ClipReconfigure(this.x,this.y,this.w,this.h)}},{key:"Reset",value:function(){this.timer=this.rate}}]),t}();function cr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var hr=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.id,this.basicTexture=e,this.data=n,this.frameCache=new tr(lr)}return function(t,e,n){e&&cr(t.prototype,e),n&&cr(t,n)}(t,[{key:"GenerateFrames",value:function(){for(var t,e,n,i=this.data,r=i.frames,o=i.meta.frameTags,a=0;a<r.length;++a)e=(t=r[a]).frame,n=o[a],this.frameCache.Store(new lr(e.x,e.y,e.w,e.h,t.duration,n?n.name:null))}},{key:"GetFrameById",value:function(t){return this.frameCache.GetById(t)}}]),t}();function fr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var dr=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.spritesheetCache=new tr(hr),this.xhrLoader=new sr,this.imageLoader=new or,this.onComplete=new wi,this.onSpritesheetLoaded=new wi,this.count=0,this.loading=!1,this.toLoad=null,this.pairCount=0,this.tempBasicTexture=null,this.tempData=null,this.xhrLoader.onXHRLoaded.Add(this.OnPartXHRLoaded,this),this.imageLoader.onImageLoaded.Add(this.OnPartImageLoaded,this),null!=n&&this.onComplete.Add(n,this),null!=e&&this.Load(e)}return function(t,e,n){e&&fr(t.prototype,e),n&&fr(t,n)}(t,[{key:"Load",value:function(t){null===this.toLoad&&(this.toLoad=[]),this.toLoad.push.apply(this.toLoad,t),!1===this.loading&&(this.count=0,this.loading=!0,this.Haul(this.count))}},{key:"Haul",value:function(t){var e=this.toLoad[t];null!=e?(e.data.id=e.image.id=e.id,this.xhrLoader.Load([e.data]),this.imageLoader.Load([e.image],!0)):(this.count=0,this.loading=!1,this.toLoad=null,this.onComplete.Dispatch(this,{spritesheetCache:this.spritesheetCache}))}},{key:"OnPartLoaded",value:function(){if(2==++this.pairCount){var t=this.tempData.meta.size;this.tempBasicTexture.fw=t.w,this.tempBasicTexture.fh=t.h;var e=new hr(this.tempBasicTexture,this.tempData);this.spritesheetCache.StoreSafe(e),this.pairCount=0,this.onSpritesheetLoaded.Dispatch(e,{count:this.count}),this.Haul(++this.count)}}},{key:"OnPartXHRLoaded",value:function(t){this.tempData=this.xhrLoader.GetDataById(t.target.data.id),this.OnPartLoaded()}},{key:"OnPartImageLoaded",value:function(t){this.tempBasicTexture=this.imageLoader.GetBasicTextureById(t.target.id),this.OnPartLoaded()}},{key:"GetSpritesheetById",value:function(t){return this.spritesheetCache.GetById(t)}}]),t}();function pr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var yr=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.data={},this.program=null,this.attributes=null,this.uniforms=null,null!=e&&null!=n&&this.Init(n.vertex,n.fragment)}return function(t,e,n){e&&pr(t.prototype,e),n&&pr(t,n)}(t,[{key:"Init",value:function(t,e){var n=this.gl,i=this.CreateShader(t,n.VERTEX_SHADER),r=this.CreateShader(e,n.FRAGMENT_SHADER),o=this.program=n.createProgram();if(n.attachShader(o,i),n.attachShader(o,r),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS)){var a=n.getProgramInfoLog(o);throw new Error("Program link failed:"+a)}n.detachShader(o,i),n.detachShader(o,r),n.deleteShader(i),n.deleteShader(r),this.attributes={},this.uniforms={}}},{key:"CreateShader",value:function(t,e){var n=this.gl,i=n.createShader(e);if(n.shaderSource(i,t),n.compileShader(i),!n.getShaderParameter(i,n.COMPILE_STATUS)){var r=n.getShaderInfoLog(i);throw new Error("Shader compilation failed:"+r)}return i}},{key:"AssignAttribute",value:function(t){this.attributes[t]=this.gl.getAttribLocation(this.program,t)}},{key:"AssignUniform",value:function(t){this.uniforms[t]=this.gl.getUniformLocation(this.program,t)}},{key:"Execute",value:function(){}}],[{key:"LAST_USED_CONTROLLER",get:function(){return vr},set:function(t){vr=t}}]),t}(),vr=null;function mr(t){return(mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function br(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function gr(t,e){return!e||"object"!==mr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wr(t){return(wr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ar(t,e){return(Ar=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Sr=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=gr(this,wr(e).call(this,t,zi))).essenceBuffer=null,n.vertices=null,n.fillColor=null,n.outlineColor=null,n.outline=5,n.Initialise(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ar(t,e)}(e,yr),function(t,e,n){e&&br(t.prototype,e),n&&br(t,n)}(e,[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array(Object(D.TriRectArray)(0,0,1,1)),this.fillColor=new si,this.outlineColor=new si,t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uFillColor"),this.AssignUniform("uOutlineColor"),this.AssignUniform("uRadius"),this.AssignUniform("uOutline")}},{key:"Execute",value:function(t,e,n,i){var r=this.gl,o=this.attributes,a=this.uniforms,s=this.vertices,u=this.fillColor.channel,l=this.outlineColor.channel;Object(D.TriRectArray)(e-i,n-i,2*i,2*i,s),this!==yr.LAST_USED_CONTROLLER&&(r.useProgram(this.program),yr.LAST_USED_CONTROLLER=this),r.bindBuffer(r.ARRAY_BUFFER,this.essenceBuffer),r.bufferSubData(r.ARRAY_BUFFER,0,s),r.enableVertexAttribArray(o.aPosition),r.vertexAttribPointer(o.aPosition,2,r.FLOAT,!1,0,0),r.uniformMatrix3fv(a.uProjection,!1,t),r.uniform4f(a.uFillColor,u[0],u[1],u[2],u[3]),r.uniform4f(a.uOutlineColor,l[0],l[1],l[2],l[3]),r.uniform1f(a.uOutline,this.outline),r.uniform1f(a.uRadius,i),r.drawArrays(r.TRIANGLE_STRIP,0,6)}}]),e}();function Cr(t){return(Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function xr(t,e){return!e||"object"!==Cr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Or(t){return(Or=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _r(t,e){return(_r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pr=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=xr(this,Or(e).call(this,t,Ki))).essenceBuffer=null,n.vertices=null,n.color=null,n.Initialise(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_r(t,e)}(e,yr),function(t,e,n){e&&Tr(t.prototype,e),n&&Tr(t,n)}(e,[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array([-1,0,1,0]),this.color=new si,t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uColor")}},{key:"Execute",value:function(t,e,n){var i=this.gl,r=this.attributes,o=this.uniforms,a=this.vertices,s=this.color.channel;a[0]=e.x,a[1]=e.y,a[2]=n.x,a[3]=n.y,this!==yr.LAST_USED_CONTROLLER&&(i.useProgram(this.program),yr.LAST_USED_CONTROLLER=this),i.bindBuffer(i.ARRAY_BUFFER,this.essenceBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,a),i.enableVertexAttribArray(r.aPosition),i.vertexAttribPointer(r.aPosition,2,i.FLOAT,!1,0,0),i.uniformMatrix3fv(o.uProjection,!1,t),i.uniform4f(o.uColor,s[0],s[1],s[2],s[3]),i.drawArrays(i.LINES,0,2)}}]),e}();function Er(t){return(Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Rr(t,e){return!e||"object"!==Er(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dr(t){return(Dr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ir(t,e){return(Ir=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Lr=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Rr(this,Dr(e).call(this,t,Wi))).dataBuffer=null,n.previousNumberOfElements=0,n.Initialise(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ir(t,e)}(e,yr),function(t,e,n){e&&kr(t.prototype,e),n&&kr(t,n)}(e,[{key:"Initialise",value:function(){var t=this.gl;this.dataBuffer=t.createBuffer(),this.AssignAttribute("aProjection1"),this.AssignAttribute("aProjection2"),this.AssignAttribute("aProjection3"),this.AssignAttribute("aPosition"),this.AssignAttribute("aColor"),this.AssignAttribute("aPointSize")}},{key:"Execute",value:function(t,e){var n=this.gl,i=this.attributes;yr.LAST_USED_CONTROLLER!==this&&(n.useProgram(this.program),yr.LAST_USED_CONTROLLER=this),n.bindBuffer(n.ARRAY_BUFFER,this.dataBuffer),e!==this.previousNumberOfElements?n.bufferData(n.ARRAY_BUFFER,t,n.DYNAMIC_DRAW):n.bufferSubData(n.ARRAY_BUFFER,0,t),n.enableVertexAttribArray(i.aProjection1),n.vertexAttribPointer(i.aProjection1,3,n.FLOAT,!1,64,0),n.enableVertexAttribArray(i.aProjection2),n.vertexAttribPointer(i.aProjection2,3,n.FLOAT,!1,64,12),n.enableVertexAttribArray(i.aProjection3),n.vertexAttribPointer(i.aProjection3,3,n.FLOAT,!1,64,24),n.enableVertexAttribArray(i.aPosition),n.vertexAttribPointer(i.aPosition,2,n.FLOAT,!1,64,36),n.enableVertexAttribArray(i.aColor),n.vertexAttribPointer(i.aColor,4,n.FLOAT,!1,64,44),n.enableVertexAttribArray(i.aPointSize),n.vertexAttribPointer(i.aPointSize,1,n.FLOAT,!1,64,60),n.drawArrays(n.POINTS,0,e),this.previousNumberOfElements=e}}]),e}();function jr(t){return(jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Br(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Gr(t,e){return!e||"object"!==jr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ur(t){return(Ur=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nr(t,e){return(Nr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fr=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Gr(this,Ur(e).call(this,t,qi))).essenceBuffer=null,n.vertices=null,n.fillColor=null,n.outlineColor=null,n.outline=5,n.Initialise(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nr(t,e)}(e,yr),function(t,e,n){e&&Br(t.prototype,e),n&&Br(t,n)}(e,[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array(Object(D.TriRectArray)(0,0,1,1)),this.fillColor=new si,this.outlineColor=new si,t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uFillColor"),this.AssignUniform("uOutlineColor"),this.AssignUniform("uSize"),this.AssignUniform("uOutline")}},{key:"Execute",value:function(t,e,n,i,r){var o=this.gl,a=this.attributes,s=this.uniforms,u=this.vertices,l=this.fillColor.channel,c=this.outlineColor.channel;Object(D.TriRectArray)(e,n,i,r,u),this!==yr.LAST_USED_CONTROLLER&&(o.useProgram(this.program),yr.LAST_USED_CONTROLLER=this),o.bindBuffer(o.ARRAY_BUFFER,this.essenceBuffer),o.bufferSubData(o.ARRAY_BUFFER,0,u),o.enableVertexAttribArray(a.aPosition),o.vertexAttribPointer(a.aPosition,2,o.FLOAT,!1,0,0),o.uniformMatrix3fv(s.uProjection,!1,t),o.uniform4f(s.uFillColor,l[0],l[1],l[2],l[3]),o.uniform4f(s.uOutlineColor,c[0],c[1],c[2],c[3]),o.uniform1f(s.uOutline,this.outline),o.uniform2f(s.uSize,i,r),o.drawArrays(o.TRIANGLE_STRIP,0,6)}}]),e}();function Mr(t){return(Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Xr(t,e){return!e||"object"!==Mr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yr(t){return(Yr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hr(t,e){return(Hr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wr=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Xr(this,Yr(e).call(this,t,Hi))).originalTexture=null,n.boundTexture=null,n.essenceBuffer=null,n.dataBuffer=null,n.indexBuffer=null,n.previousNumberOfElements=0,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hr(t,e)}(e,yr),function(t,e,n){e&&Vr(t.prototype,e),n&&Vr(t,n)}(e,[{key:"BindBasicTexture",value:function(t,e){var n=this.gl,i=Object(D.TriRectArray)(0,0,t.w,t.h);e=null!=e?e:n.LINEAR,this.aia=n.getExtension("ANGLE_instanced_arrays"),this.originalTexture=t,this.boundTexture=n.createTexture(),this.essenceBuffer=n.createBuffer(),this.dataBuffer=n.createBuffer(),i.push.apply(i,Object(D.TriRectArray)(0,0,1,1)),n.bindTexture(n.TEXTURE_2D,this.boundTexture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t.image),n.bindBuffer(n.ARRAY_BUFFER,this.essenceBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(i),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindTexture(n.TEXTURE_2D,null),this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignAttribute("aProjection1"),this.AssignAttribute("aProjection2"),this.AssignAttribute("aProjection3"),this.AssignAttribute("aTranslation1"),this.AssignAttribute("aTranslation2"),this.AssignAttribute("aTranslation3"),this.AssignAttribute("aTransformation1"),this.AssignAttribute("aTransformation2"),this.AssignAttribute("aTransformation3"),this.AssignUniform("uImage")}},{key:"Execute",value:function(t,e){var n=this.gl,i=this.aia,r=this.attributes,o=this.uniforms;this!==yr.LAST_USED_CONTROLLER&&(n.useProgram(this.program),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.boundTexture),n.uniform1i(o.uImage,0),n.bindBuffer(n.ARRAY_BUFFER,this.essenceBuffer),n.enableVertexAttribArray(r.aPosition),n.vertexAttribPointer(r.aPosition,2,n.FLOAT,!1,0,0),i.vertexAttribDivisorANGLE(r.aPosition,0),n.enableVertexAttribArray(r.aTexCoord),n.vertexAttribPointer(r.aTexCoord,2,n.FLOAT,!1,0,48),i.vertexAttribDivisorANGLE(r.aTexCoord,0),yr.LAST_USED_CONTROLLER=this),n.bindBuffer(n.ARRAY_BUFFER,this.dataBuffer),e!==this.previousNumberOfElements?n.bufferData(n.ARRAY_BUFFER,t,n.DYNAMIC_DRAW):n.bufferSubData(n.ARRAY_BUFFER,0,t),n.enableVertexAttribArray(r.aProjection1),n.vertexAttribPointer(r.aProjection1,3,n.FLOAT,!1,108,0),i.vertexAttribDivisorANGLE(r.aProjection1,1),n.enableVertexAttribArray(r.aProjection2),n.vertexAttribPointer(r.aProjection2,3,n.FLOAT,!1,108,12),i.vertexAttribDivisorANGLE(r.aProjection2,1),n.enableVertexAttribArray(r.aProjection3),n.vertexAttribPointer(r.aProjection3,3,n.FLOAT,!1,108,24),i.vertexAttribDivisorANGLE(r.aProjection3,1),n.enableVertexAttribArray(r.aTranslation1),n.vertexAttribPointer(r.aTranslation1,3,n.FLOAT,!1,108,36),i.vertexAttribDivisorANGLE(r.aTranslation1,1),n.enableVertexAttribArray(r.aTranslation2),n.vertexAttribPointer(r.aTranslation2,3,n.FLOAT,!1,108,48),i.vertexAttribDivisorANGLE(r.aTranslation2,1),n.enableVertexAttribArray(r.aTranslation3),n.vertexAttribPointer(r.aTranslation3,3,n.FLOAT,!1,108,60),i.vertexAttribDivisorANGLE(r.aTranslation3,1),n.enableVertexAttribArray(r.aTransformation1),n.vertexAttribPointer(r.aTransformation1,3,n.FLOAT,!1,108,72),i.vertexAttribDivisorANGLE(r.aTransformation1,1),n.enableVertexAttribArray(r.aTransformation2),n.vertexAttribPointer(r.aTransformation2,3,n.FLOAT,!1,108,84),i.vertexAttribDivisorANGLE(r.aTransformation2,1),n.enableVertexAttribArray(r.aTransformation3),n.vertexAttribPointer(r.aTransformation3,3,n.FLOAT,!1,108,96),i.vertexAttribDivisorANGLE(r.aTransformation3,1),i.drawArraysInstancedANGLE(n.TRIANGLE_STRIP,0,6,e)}}]),e}();function qr(t){return(qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Kr(t,e){return!e||"object"!==qr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jr(t){return(Jr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qr(t,e){return(Qr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $r=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Kr(this,Jr(e).call(this,t,Yi))).originalTexture=null,n.boundTexture=null,n.essenceBuffer=null,n.Initialise(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qr(t,e)}(e,yr),function(t,e,n){e&&zr(t.prototype,e),n&&zr(t,n)}(e,[{key:"Initialise",value:function(){this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignUniform("uImage"),this.AssignUniform("uUnitId"),this.AssignUniform("uProjection"),this.AssignUniform("uTranslation"),this.AssignUniform("uTransformation"),this.AssignUniform("uTint")}},{key:"BindBasicTexture",value:function(t,e){var n=this.gl,i=Object(D.TriRectArray)(0,0,t.w,t.h);e=null!=e?e:n.LINEAR,this.originalTexture=t,this.boundTexture=n.createTexture(),this.essenceBuffer=n.createBuffer(),i.push.apply(i,Object(D.TriRectArray)(0,0,1,1)),n.bindTexture(n.TEXTURE_2D,this.boundTexture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t.image),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e),n.bindBuffer(n.ARRAY_BUFFER,this.essenceBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(i),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindTexture(n.TEXTURE_2D,null)}},{key:"Execute",value:function(t,e,n,i,r){var o=this.gl,a=this.attributes,s=this.uniforms;this!==yr.LAST_USED_CONTROLLER?(o.useProgram(this.program),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,this.boundTexture),o.bindBuffer(o.ARRAY_BUFFER,this.essenceBuffer),o.enableVertexAttribArray(a.aPosition),o.vertexAttribPointer(a.aPosition,2,o.FLOAT,!1,0,0),o.enableVertexAttribArray(a.aTexCoord),o.vertexAttribPointer(a.aTexCoord,2,o.FLOAT,!1,0,48),o.uniform1f(s.uUnitId,r),o.uniform1i(s.uImage,r),yr.LAST_USED_CONTROLLER=this,this.lastUsedUnit=r):r!==this.lastUsedUnit&&(o.uniform1f(s.uUnitId,r),o.uniform1i(s.uImage,r),this.lastUsedUnit=r),o.uniform4fv(s.uTint,i),o.uniformMatrix3fv(s.uProjection,!1,t),o.uniformMatrix3fv(s.uTranslation,!1,e),o.uniformMatrix3fv(s.uTransformation,!1,n),o.drawArrays(o.TRIANGLE_STRIP,0,6)}}]),e}();function Zr(t){return(Zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function to(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function eo(t,e){return!e||"object"!==Zr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function no(t){return(no=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function io(t,e){return(io=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ro=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),.5*t.getParameter(t.MAX_VERTEX_ATTRIBS)<n&&console.error(.5*t.getParameter(t.MAX_VERTEX_ATTRIBS),"MAX"),(i=eo(this,no(e).call(this,t,Qi(n)))).units=n,i.originalTextures=[],i.boundTextures=[],i.essenceBuffers=[],i.lastUsedUnit=0,i.Initialise(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&io(t,e)}(e,yr),function(t,e,n){e&&to(t.prototype,e),n&&to(t,n)}(e,[{key:"Initialise",value:function(){for(var t=0;t<this.units;++t)this.AssignAttribute("aPosition"+t),this.AssignAttribute("aTexCoord"+t);this.AssignUniform("uImage"),this.AssignUniform("uUnitId"),this.AssignUniform("uProjection"),this.AssignUniform("uTranslation"),this.AssignUniform("uTransformation"),this.AssignUniform("uTint")}},{key:"BindBasicTexture",value:function(t,e,n){var i=this.gl,r=Object(D.TriRectArray)(0,0,t.w,t.h);(null==e||e<0||e>3)&&(e=0),n=null!=n?n:i.LINEAR,t.uniformId=e,this.originalTextures[e]=t,this.boundTextures[e]=i.createTexture(),this.essenceBuffers[e]=i.createBuffer(),r.push.apply(r,Object(D.TriRectArray)(0,0,1,1)),i.bindTexture(i.TEXTURE_2D,this.boundTextures[e]),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t.image),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,n),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,n),i.bindBuffer(i.ARRAY_BUFFER,this.essenceBuffers[e]),i.bufferData(i.ARRAY_BUFFER,new Float32Array(r),i.STATIC_DRAW),i.bindBuffer(i.ARRAY_BUFFER,null),i.bindTexture(i.TEXTURE_2D,null)}},{key:"BindUnit",value:function(t,e,n,i){null!=this.boundTextures[i]&&(t.activeTexture(t.TEXTURE0+i),t.bindTexture(t.TEXTURE_2D,this.boundTextures[i]),t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffers[i]),t.enableVertexAttribArray(n["aPosition"+i]),t.vertexAttribPointer(n["aPosition"+i],2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(n["aTexCoord"+i]),t.vertexAttribPointer(n["aTexCoord"+i],2,t.FLOAT,!1,0,48))}},{key:"Execute",value:function(t,e,n,i,r){var o=this.gl,a=this.attributes,s=this.uniforms;if(this!==yr.LAST_USED_CONTROLLER){o.useProgram(this.program);for(var u=0;u<this.units;++u)this.BindUnit(o,s,a,u);o.uniform1f(s.uUnitId,r),o.uniform1i(s.uImage,r),yr.LAST_USED_CONTROLLER=this,this.lastUsedUnit=r}else r!==this.lastUsedUnit&&(o.uniform1f(s.uUnitId,r),o.uniform1i(s.uImage,r),this.lastUsedUnit=r);o.uniform4fv(s.uTint,i),o.uniformMatrix3fv(s.uProjection,!1,t),o.uniformMatrix3fv(s.uTranslation,!1,e),o.uniformMatrix3fv(s.uTransformation,!1,n),o.drawArrays(o.TRIANGLE_STRIP,0,6)}}]),e}();function oo(t){return(oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ao(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function so(t,e){return!e||"object"!==oo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function uo(t){return(uo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lo(t,e){return(lo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var co=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=so(this,uo(e).call(this,t,n))).essenceBuffer=null,i.vertices=null,i.Initialise(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lo(t,e)}(e,yr),function(t,e,n){e&&ao(t.prototype,e),n&&ao(t,n)}(e,[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array(Object(D.TriRectArray)(0,0,1,1)),t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("a_v2Position"),this.AssignUniform("u_m3Projection"),this.AssignUniform("u_fTime"),this.AssignUniform("u_v2Resolution")}},{key:"Execute",value:function(t,e,n,i,r,o){var a=this.gl,s=this.attributes,u=this.uniforms,l=this.vertices;Object(D.TriRectArray)(e,n,i,r,l),this!==yr.LAST_USED_CONTROLLER&&(a.useProgram(this.program),yr.LAST_USED_CONTROLLER=this),a.bindBuffer(a.ARRAY_BUFFER,this.essenceBuffer),a.bufferSubData(a.ARRAY_BUFFER,0,l),a.enableVertexAttribArray(s.a_v2Position),a.vertexAttribPointer(s.a_v2Position,2,a.FLOAT,!1,0,0),a.uniformMatrix3fv(u.u_m3Projection,!1,t),a.uniform2f(u.u_v2Resolution,i,r),a.uniform1f(u.u_fTime,o),a.drawArrays(a.TRIANGLE_STRIP,0,6)}}]),e}();function ho(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var fo=function(){function t(e,n,i,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.split(" "),this.handle=n,this.info=i,this.priority=r,this.breakIfExecuted=!!o,this.data={},this.command=null}return function(t,e,n){e&&ho(t.prototype,e),n&&ho(t,n)}(t,[{key:"Execute",value:function(t,e,n){return this.handle(t,e,n),this.breakIfExecuted}}]),t}();function po(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var yo=function(){function t(e,n,i,r,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.split(" "),this.handle=n,this.info=i,this.data={},this.options=null,this.registry=null,this.optionPrefix=null==a?vo:a,this.dsCopy=[],this.dataSeparator="=",this.allOptionIds=null,this.fullInfo=null,this.continueToPrime=!!r,this.filterNull=!!o,this.jsonPrefix="(JSON)"}return function(t,e,n){e&&po(t.prototype,e),n&&po(t,n)}(t,[{key:"Execute",value:function(t,e,n){this.HandleData(t,e),!0===this.filterNull&&(t=t.filter(mo)),!0===this.HandleOptions(t,e,n)&&this.handle(t,e,n)}},{key:"AddOption",value:function(t,e,n,i,r,o){null!=(o=null==o?this.optionPrefix:o)&&(t=t.replace(/\S+/g,o+"$&")),null==this.options&&(this.options=[]),i=null==i?0:i;var a=this.options,s=a[0],u=new fo(t,e,n,i,r);u.command=this;for(var l=0;l<a.length;s=a[++l])if(s.priority<=i)return a.splice(l,0,u),this.allOptionIds=this.GetAllOptionIds(),this;return this.options.push(u),this.allOptionIds=this.GetAllOptionIds(),this}},{key:"HandleData",value:function(t,e){var n,i=this.dataSeparator,r=this.dsCopy,o=this.jsonPrefix,a=o.length;r.push.apply(r,t);for(var s=r[0],u=0;u<r.length;s=r[++u])2===(n=s.split(i)).length&&(t[u]=null,n[0].substring(0,a)===o?e[n[0].substring(a)]=JSON.parse(n[1]):e[n[0]]=n[1]);r.length=0}},{key:"HandleOptions",value:function(t,e,n){if(0===t.length)return this.continueToPrime;var i=this.GetAndRemoveMatchingOptionIds(t);if(null==i)return this.continueToPrime;for(var r=0;r<i.length;++r)if(!0===this.GetOptionById(i[r]).Execute(t,e,n))return!1;return this.continueToPrime}},{key:"GetOptionById",value:function(t){for(var e=this.options,n=e[0],i=0;i<e.length;n=e[++i])if(-1!==n.id.indexOf(t))return n;return null}},{key:"GetAllOptionIds",value:function(){for(var t=this.options,e=[],n=0;n<t.length;++n)e.push.apply(e,t[n].id);return e}},{key:"GetAndRemoveMatchingOptionIds",value:function(t){var e,n=this.allOptionIds;if(null==n)return null;for(var i=[],r=0;r<n.length;++r)-1!==(e=t.indexOf(n[r]))&&i.push(t.fickleSplice(e));return i}},{key:"GenerateInfoString",value:function(){for(var t="COMMAND: "+this.id.join(", ")+" -> "+this.info+"\n",e=this.options,n=e[0],i=0;i<e.length;n=e[++i])t+="OPTION: "+n.id.join(", ")+" -> "+n.info+"\n";return t}}],[{key:"OPTION_PREFIX",get:function(){return vo},set:function(t){vo=t}}]),t}(),vo="",mo=function(t){return null!=t};function bo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var go=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.commands=[],this.splitter=" "}return function(t,e,n){e&&bo(t.prototype,e),n&&bo(t,n)}(t,[{key:"AddCommand",value:function(t){if(null==t.registry)return this.commands.push(t),t.registry=this,t}},{key:"RemoveCommand",value:function(t){var e=this.commands,n=e.indexOf(t);if(-1!==n)return t.registry=null,e.fickleSplice(n)}},{key:"GetCommandById",value:function(t){for(var e=this.commands,n=e[0],i=0;i<e.length;n=e[++i])if(n)for(var r=0;r<n.id.length;++r)if(n.id[r]===t)return n;return null}},{key:"Parse",value:function(t,e){var n=String(t).split(this.splitter),i=n.shift(),r=this.GetCommandById(i);return r?(r.Execute(n,{},e),null):i}}]),t}();function wo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ao=function(){function t(e,n,i,r,a,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.target=n,this.propertyString=i,this.value=r,this.duration=a,this.easing=o[null==s?So:s],this.time=0,this.startValue=0,this.change=0,this.property=null,this.properyObject=null,this.running=!1,this.onStart=new wi,this.onEnd=new wi,this.onStop=new wi,this.onReconfigure=new wi,this.onReset=new wi}return function(t,e,n){e&&wo(t.prototype,e),n&&wo(t,n)}(t,[{key:"Start",value:function(){var t=this.propertyString.split(".");this.property=t[t.length-1],this.propertyObject=Object(R.Nested)(this.target,this.propertyString,!0),this.startValue=this.propertyObject[this.property],this.change=this.value-this.startValue,this.time=0,this.running=!0,this.onStart.Dispatch(this,null)}},{key:"Stop",value:function(){this.property=null,this.propertyObject=null,this.startValue=0,this.change=0,this.time=0,this.running=!1,this.onStop.Dispatch(this,null)}},{key:"Process",value:function(){!0===this.running&&(this.propertyObject[this.property]=this.easing(this.time,this.startValue,this.change,this.duration),++this.time>=this.duration&&(this.running=!1,this.propertyObject[this.property]=this.value,this.onEnd.Dispatch(this,null)))}},{key:"Reconfigure",value:function(t,e,n,i){null!=t&&(this.propertyString=t),this.value=e,this.duration=n,this.easing=o[null==i?So:i],this.onReconfigure.Dispatch(this,null)}},{key:"NewValue",value:function(t){this.value=t,this.Start()}},{key:"Reset",value:function(){if(null==this.propertyObject||null==this.property)return!1;this.propertyObject[this.property]=this.startValue,this.property=null,this.propertyObject=null,this.startValue=0,this.change=0,this.time=0,this.running=!1,this.onReset.Dispatch(this,null)}}]),t}(),So="Linear";function Co(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var To=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.motions=[],this.target=e}return function(t,e,n){e&&Co(t.prototype,e),n&&Co(t,n)}(t,[{key:"Create",value:function(t,e,n,i,r){if(null==this.GetMotionById(t)){var o=new Ao(t,this.target,e,n,i,r);return this.motions.push(o),o}return null}},{key:"Add",value:function(t){null==this.GetMotionById(t.id)&&this.motions.push(t)}},{key:"Start",value:function(t){var e=this.GetMotionById(t);return null!==e&&e.Start(),e}},{key:"StartMultiple",value:function(t){t=t.split(" ");for(var e=0;e<t.length;++e)this.Start(t[e])}},{key:"Stop",value:function(t){var e=this.GetMotionById(t);return null!==e&&e.Stop(),e}},{key:"StopMultiple",value:function(t){t=t.split(" ");for(var e=0;e<t.length;++e)this.Stop(t[e])}},{key:"Reset",value:function(t){var e=this.GetMotionByid(t);return null!==e&&e.Reset(),e}},{key:"ResetMultiple",value:function(t){t=t.split(" ");for(var e=0;e<t.length;++e)this.Reset(t[e])}},{key:"Process",value:function(){for(var t=this.motions,e=0;e<t.length;++e)t[e].Process()}},{key:"GetMotionById",value:function(t){for(var e=this.motions,n=0;n<e.length;++n)if(e[n].id===t)return e[n];return null}}]),t}();function xo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Oo=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.velocityX=null,this.velocityY=null,this.torque=null,this.accelerationX=null,this.accelerationY=null,this.spin=null,this.growthX=null,this.growthY=null,this.gravityX=null,this.gravityY=null,this.active=!0}return function(t,e,n){e&&xo(t.prototype,e),n&&xo(t,n)}(t,[{key:"CreateOscillatingObject",value:function(t,e,n,i){if(null!==this[t])throw new Error("Invalid key");this[t]={from:e,to:n,amplitude:i,active:!0}}},{key:"SetOscillatingObject",value:function(t,e,n,i){var r=this[t];if(null==r)return this.CreateOscillatingObject(t,e,n,i);r.from=e,r.to=n,r.amplitude=i,r.active=!0}},{key:"Nullify",value:function(t){null!=this[t]&&(this[t].active=!1)}}]),t}();function _o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Po=Math.cos,Eo=Math.sin,ko=Math.atan2,Ro=Math.sqrt,Do=Math.abs,Io=Math.PI,Lo=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.array=new Float32Array(9),this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}return function(t,e,n){e&&_o(t.prototype,e),n&&_o(t,n)}(t,[{key:"Identity",value:function(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}},{key:"Copy",value:function(){var e=new t;return e.Set(this.a,this.b,this.c,this.d,this.e,this.f),e}},{key:"Set",value:function(t,e,n,i,r,o){return this.a=t,this.b=e,this.c=n,this.d=i,this.e=r,this.f=o,this}},{key:"SetTransform",value:function(t,e,n,i,r,o,a,s,u){t=null==t?0:t,e=null==e?0:e,n=null==n?1:n,i=null==i?1:i,r=null==r?0:r,o=null==o?0:o,a=null==a?0:a,s=null==s?0:s,u=null==u?0:u;var l=Eo(r),c=Po(r),h=-Eo(o),f=Po(o),d=Eo(a),p=Po(a),y=c*n,v=l*n,m=-l*i,b=c*i;return this.a=p*y+d*m,this.b=p*v+d*b,this.c=h*y+f*m,this.d=h*v+f*b,this.e=t+s*y+u*m,this.f=e+s*v+u*b,this}},{key:"Translate",value:function(t,e){this.e+=t,this.f+=e}},{key:"TranslateTo",value:function(t,e){this.e=t,this.f=e}},{key:"ApplyTranslation",value:function(t,e){this.e=t*this.a+e*this.c+this.e,this.f=t*this.b+e*this.d+this.f}},{key:"ApplyScale",value:function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e}},{key:"Scale",value:function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e}},{key:"Rotate",value:function(t){var e=Math.sin(t),n=Math.cos(t),i=this.a,r=this.c,o=this.e;this.a=i*n-this.b*e,this.b=i*e+this.b*n,this.c=r*n-this.d*e,this.d=r*e+this.d*n,this.e=o*n-this.f*e,this.f=o*e+this.f*n}},{key:"Decompose",value:function(t){var e=this.a,n=this.b,i=this.c,r=this.d,o=-ko(-i,r),a=ko(n,e);Do(o+a)<jo?(t.rotation=a,e<0&&r>=0&&(t.rotation+=Io),t.skew.SetSame(0)):t.skew.Set(o,a),t.scale.Set(Ro(e*e+n*n),Ro(i*i+r*r)),t.position.Set(this.e,this.f)}},{key:"ApplyToContext",value:function(t){t.setTransform(this.a,this.b,this.c,this.d,this.e,this.f)}},{key:"AsArray",value:function(t){var e=this.array;return!0===t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.e,e[7]=this.f,e[8]=1):(e[0]=this.a,e[1]=this.c,e[2]=this.e,e[3]=this.b,e[4]=this.d,e[5]=this.f,e[6]=0,e[7]=0,e[8]=1),e}}]),t}(),jo=1e-5;function Bo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Go=Math.cos,Uo=Math.sin,No=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.position=new pt(e,n),this.scale=new pt(1,1),this.skew=new pt(0,0),this.pivot=new pt(0,0),this.localTransform=new Lo,this.globalTransform=new Lo,this.rotation=0,this.skewCX=1,this.skewSX=0,this.skewCY=0,this.skewSY=1}return function(t,e,n){e&&Bo(t.prototype,e),n&&Bo(t,n)}(t,[{key:"Set",value:function(t){t.Decompose(this),this.UpdateSkew()}},{key:"UpdateLocal",value:function(){var t=this.localTransform,e=this.position,n=this.scale,i=this.pivot;t.a=this.skewCX*n.x,t.b=this.skewSX*n.x,t.c=this.skewCY*n.y,t.d=this.skewSY*n.y,t.e=e.x-i.x*t.a+i.y*t.c,t.f=e.y-i.y*t.b+i.y*t.d}},{key:"UpdateGlobal",value:function(t){var e=this.localTransform,n=this.globalTransform,i=this.position,r=this.scale,o=this.pivot;e.a=this.skewCX*r.x,e.b=this.skewSX*r.x,e.c=this.skewCY*r.y,e.d=this.skewSY*r.y,e.e=i.x-o.x*e.a+o.y*e.c,e.f=i.y-o.y*e.b+o.y*e.d,n.a=e.a*t.a+e.b*t.c,n.b=e.a*t.b+e.b*t.d,n.c=e.c*t.a+e.d*t.c,n.d=e.c*t.b+e.d*t.d,n.e=e.e*t.a+e.f*t.c+t.e,n.f=e.e*t.b+e.f*t.d+t.f}},{key:"UpdateSkew",value:function(){var t=this.skew,e=this.rotation;this.skewCX=Go(e+t.y),this.skewSX=Uo(e+t.y),this.skewCY=-Uo(e-t.x),this.skewSY=Go(e-t.x)}},{key:"ApplyGlobal",value:function(t){this.globalTransform.ApplyToContext(t)}}]),t}();function Fo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Mo=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.transform=new No(e,n),this.data={},this.parent=null,this.w=0,this.h=0,this.bounds=null,this.boundsDirty=!0,this.globalPosition=null}return function(t,e,n){e&&Fo(t.prototype,e),n&&Fo(t,n)}(t,[{key:"UpdateTransform",value:function(){null!=this.parent?this.transform.UpdateGlobal(this.parent.transform.globalTransform):this.transform.UpdateGlobal(Vo.globalTransform)}},{key:"GetGlobalPosition",value:function(){var t=this.transform.globalTransform;return null===this.globalPosition?this.globalPosition=new pt(t.e,t.f):this.globalPosition.Set(t.e,t.f),this.globalPosition}},{key:"ComputeBounds",value:function(t){var e=0,n=0;return null!=t&&(e=this.width*t.x,n=this.height*t.y),null===this.bounds?(this.bounds=new ce(this.x-e,this.y-n,this.x+this.width-e,this.y+this.height-n),this.bounds.belongsTo=this):this.bounds.Set(this.x-e,this.y-n,this.x+this.width-e,this.y+this.height-n),this.boundsDirty=!1,this.bounds}},{key:"rotation",get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t,this.transform.UpdateSkew()}},{key:"scale",get:function(){return this.transform.scale}},{key:"position",get:function(){return this.transform.position}},{key:"pivot",get:function(){return this.transform.pivot}},{key:"x",get:function(){return this.transform.position.x},set:function(t){this.transform.position.x=t}},{key:"y",get:function(){return this.transform.position.y},set:function(t){this.transform.position.y=t}},{key:"width",get:function(){return this.w*this.scale.x},set:function(t){this.w=t}},{key:"height",get:function(){return this.h*this.scale.y},set:function(t){this.h=t}}]),t}(),Vo=new No;function Xo(t){return(Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ho(t,e){return!e||"object"!==Xo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wo(t){return(Wo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qo(t,e){return(qo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zo=Math.abs,Ko=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Ho(this,Wo(e).call(this,t,n))).children=[],i.render=!0,i.display=!0,i.transformShouldUpdate=!0,i.transformAutomaticUpdate=!0,i.motionManager=null,i.isBatchParent=!1,i.childDataBuffer=null,i.bufferData=null,i.programController=null,i.bufferStartIndex=0,i.bufferEndIndex=0,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qo(t,e)}(e,Mo),function(t,e,n){e&&Yo(t.prototype,e),n&&Yo(t,n)}(e,[{key:"PreDraw",value:function(){}},{key:"GLPreDraw",value:function(){}},{key:"Draw",value:function(t){this.PreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.children.length>0&&!0===this.display&&this.DrawChildren(t))}},{key:"GLDraw",value:function(t){this.GLPreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren():this.GLDrawChildren(t)))}},{key:"RequestTransformUpdate",value:function(){this.transformShouldUpdate=!0}},{key:"DrawChildren",value:function(t){for(var e=this.children,n=0;n<e.length;++n)e[n].Draw(t)}},{key:"GLDrawChildren",value:function(t){for(var e=this.children,n=0;n<e.length;++n)e[n].GLDraw(t)}},{key:"GLBatchDrawChildren",value:function(){null!=this.childDataBuffer&&null!=this.programController&&this.programController.Execute(this.childDataBuffer,this.children.length)}},{key:"ComputeBatchBuffer",value:function(t){for(var e,n,i=this.children,r=[],o=0;o<i.length;++o)e=i[o],n=null!=t?t(e):e.GetBufferData(),e.bufferStartIndex=r.length,e.bufferEndIndex=r.length+n.length,r.push.apply(r,n);this.childDataBuffer=new Float32Array(r)}},{key:"UpdateInBuffer",value:function(){throw new Error(Jo)}},{key:"GetBufferData",value:function(){throw new Error(Jo)}},{key:"AddChild",value:function(t){var e=t.parent;return null!==e&&e.RemoveChild(t),this.children.push(t),t.parent=this,t}},{key:"AddChildren",value:function(){var t=arguments;Object(R.IsArray)(t[0])&&(t=t[0]);for(var e=0;e<t.length;++e)this.AddChild(t[e])}},{key:"AddSibling",value:function(t){var e=this.parent;return null!==e&&e.AddChild(t),t}},{key:"RemoveChild",value:function(t){var e=this.children,n=e.indexOf(t);if(-1!==n)return t.parent=null,e.fickleSplice(n)}},{key:"RemoveChildren",value:function(){var t,e,n=arguments;Object(R.IsArray)(i[0])&&(function(t){throw new Error('"'+t+'" is read-only')}("children"),i=i[0]);for(var i=this.children,r=[],o=0;o<n.length;++o)t=n[o],-1!==(e=i.indexOf(t))&&(r.push(i.fickleSplice(e)),t.parent=null);return r}},{key:"Swap",value:function(t){if(null!==this.parent){var e=this.parent.children,n=e.indexOf(this);if(-1!==n){-1===t&&(t=e.length-1);var i=e[t];e[t]=this,e[n]=i}}}},{key:"SendToFront",value:function(){this.Swap(-1)}},{key:"SendToBack",value:function(){this.Swap(0)}},{key:"Dump",value:function(){for(var t=this.children,e=0;e<t.length;++e)t[e].parent=null;t.length=0}},{key:"Destroy",value:function(){this.Dump(),null!==this.parent&&this.parent.RemoveChild(this)}},{key:"AttachTo",value:function(t){t.AddChild(this)}},{key:"Detach",value:function(){return null!==this.parent?this.parent.RemoveChild(this):null}},{key:"GetChildClosestTo",value:function(t,e){var n,i,r,o=1/0,a=this.children;if(0!==a.length){for(var s=0;s<a.length;++s)n=a[s],void 0!==e&&!1===e(n)||(i=zo(n.position.GetDistanceSquared(t.x,t.y)))<o&&(o=i,r=n);return r}return null}},{key:"GetChildFurthestFrom",value:function(t,e){var n,i,r,o=0,a=this.children;if(0!==a.length){for(var s=0;s<a.length;++s)n=a[s],void 0!==e&&!1===e(n)||(i=zo(n.position.GetDistanceSquared(t.x,t.y)))>o&&(o=i,r=n);return r}return null}},{key:"UseAsBatchParent",value:function(t){this.isBatchParent=!0,this.programController=t}}]),e}();Ko.prototype.Mount=Ko.prototype.AddChildren;var Jo="Cannot access buffer data directly on Container2D!";function Qo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var $o=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.frames=[],this.controller=e,this.sprite=e.sprite,this.id=n,this.onEnd=new wi,this.onStop=new wi,this.onStart=new wi,this.currentFrame=0,this.currentFrameIndex=0,this.playing=!1,this.rate=60,this.timer=0,this.reverse=!1,this.overrideFrameRate=!1,this.loop=!1,this.autoFrame=!0,null!=i&&(this.rate=i)}return function(t,e,n){e&&Qo(t.prototype,e),n&&Qo(t,n)}(t,[{key:"CreateFrame",value:function(t,e,n,i,r){r=null==r?this.rate:r,this.frames.push(new lr(t,e,n,i,r))}},{key:"AddFrame",value:function(t){(null==t.rate||t.rate<=0)&&(t.rate=this.rate),this.frames.push(t)}},{key:"GenerateFrames",value:function(t,e,n,i,r,o){var a,s=n/i;o=null==o?{}:o;for(var u=0;u<r;++u)a=o[u],this.CreateFrame(u%s*t,(u/s|0)*e,t,e,a)}},{key:"SetFrame",value:function(t){t=null==t?0:t;var e=this.frames[t];void 0!==e&&(this.currentFrame=e,this.currentFrameIndex=t,this.currentFrame.Apply(this.sprite))}},{key:"GetFrameById",value:function(t,e){for(var n=this.frames,i=0;i<n.length;++i)if(n[i].id===t)return!0===e?i:n[i]}},{key:"SetFrameById",value:function(t){var e=this.GetFrameById(t,!0);this.SetFrame(e)}},{key:"Start",value:function(t){null==t&&this.autoFrame&&(t=this.reverse?this.frames.length-1:0),this.SetFrame(t),this.ResetAllFrames(),this.timer=this.rate,this.playing=!0,this.onStart.Dispatch()}},{key:"Stop",value:function(){this.playing=!1,this.onStop.Dispatch()}},{key:"Process",value:function(){!0===this.playing&&(!0===this.overrideFrameRate?--this.timer<=0&&(this.timer=this.rate,this.NextFrame()):!0===this.currentFrame.Process()&&this.NextFrame())}},{key:"NextFrame",value:function(){var t=!1,e=this.frames,n=e.length;!1===this.reverse?++this.currentFrameIndex:--this.currentFrameIndex,this.currentFrameIndex>=n?(!0===this.loop?this.currentFrameIndex=0:this.currentFrameIndex=n-1,t=!0):this.currentFrameIndex<0&&(!0===this.loop?this.currentFrameIndex=n-1:this.currentFrameIndex=0,t=!0),this.currentFrame=e[this.currentFrameIndex],this.currentFrame.Apply(this.sprite),!0===t&&(this.onEnd.Dispatch(),!1===this.loop&&this.Stop())}},{key:"Clear",value:function(){this.frames=[],this.currentFrame=null,this.playing=!1,this.currentFrameIndex=0,this.timer=this.rate}},{key:"Reset",value:function(){this.SetFrame(0),this.ResetAllFrames(),this.timer=this.rate,this.playing=!1}},{key:"ResetAllFrames",value:function(){for(var t=this.frames,e=0;e<t.length;++e)t[e].Reset()}}]),t}();function Zo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ta=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.animations=[],this.sprite=null,this.currentAnimation=null,null!=e&&(this.sprite=e)}return function(t,e,n){e&&Zo(t.prototype,e),n&&Zo(t,n)}(t,[{key:"CreateAnimation",value:function(t,e){var n=new $o(this,t,e);return this.animations.push(n),n}},{key:"AddAnimation",value:function(t){t.controller=this,this.animations.push(t)}},{key:"GetAnimationById",value:function(t){for(var e=this.animations,n=e[i],i=0;i<e.length;n=e[++i])if(n&&n.id===t)return n;return null}},{key:"PlayAnimation",value:function(t,e){var n=this.GetAnimationById(t);null!==n&&(this.currentAnimation=n,n.Start(e))}},{key:"StopCurrentAnimation",value:function(){null!==this.currentAnimation&&this.currentAnimation.Stop()}},{key:"Process",value:function(){null!==this.currentAnimation&&this.currentAnimation.Process()}}]),t}();function ea(t){return(ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function na(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ia(t,e){return!e||"object"!==ea(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ra(t){return(ra=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oa(t,e){return(oa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var aa=function(t){function e(t,n,i){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=ia(this,ra(e).call(this,t,n))).anchor=new pt(0,0),r.SetPath(i),r.alpha=1,r.gco=Pe,r.interactive=!0,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oa(t,e)}(e,Ko),function(t,e,n){e&&na(t.prototype,e),n&&na(t,n)}(e,[{key:"Draw",value:function(t){if(this.PreDraw(t),!0===this.render){!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyGlobal(t);var e=this.path;e&&e.Draw&&!0===this.display&&(t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,e.Draw(t)),this.children.length>0&&this.DrawChildren(t)}}},{key:"GLDraw",value:function(t){if(this.GLPreDraw(t),!0===this.render){!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1));var e=this.path;e&&e.GLDraw&&!0===this.display&&e.GLDraw(t,this.transform),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren(t):this.GLDrawChildren(t))}}},{key:"GetBufferData",value:function(){this.UpdateTransform();var t=this.transform.globalTransform.AsArray(!0);null==this.bufferData&&(this.bufferData=[]);var e=this.bufferData;return e.length=0,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this.path&&this.path.GetBufferData&&e.push.apply(e,this.path.GetBufferData()),e}},{key:"UpdateInBuffer",value:function(){this.UpdateTransform();var t=this.transform.globalTransform.AsArray(!0),e=this.parent.childDataBuffer,n=this.bufferStartIndex;e[n]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=t[3],e[n+4]=t[4],e[n+5]=t[5],e[n+6]=t[6],e[n+7]=t[7],e[n+8]=t[8],this.path&&this.path.UpdateInBuffer&&this.path.UpdateInBuffer(e,n+9)}},{key:"IntersectsPoint",value:function(t){return!1!==this.interactive&&(sa.SetV(t),sa.SubtractV(this.position),this.path.IntersectsPoint(sa))}},{key:"SetPath",value:function(t){void 0!==t&&(void 0!==t.w&&void 0!==t.h?(this.w=t.w,this.h=t.h):void 0!==t.GetLength?this.w=this.h=t.GetLength():void 0!==t.diameter?this.w=this.h=t.diameter:void 0!==t.aabb&&(this.w=t.aabb.w,this.h=t.aabb.h),this.path=t)}}]),e}(),sa=new pt(0,0);function ua(t){return(ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function la(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ca(t,e){return!e||"object"!==ua(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ha(t){return(ha=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fa(t,e){return(fa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var da=function(t){function e(t,n,i,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=ca(this,ha(e).call(this,t,n))).anchor=new pt(0,0),o.clip=new ce(0,0,0,0),o.shape=new ce(0,0,0,0),o.textureTransformation=new Lo,o.textureTranslation=new Lo,o.originalShape=new ce(0,0,0,0),o.tint=new si(1,1,1,1),o.texture=null,o.gco=Pe,o.interactive=!0,o.programController=null,o.animationController=null,i instanceof $r?(o.programController=i,o.SetTexture(i.originalTexture)):i instanceof ro?(o.programController=i,null!=r?o.SetTexture(i.originalTextures[r]):o.SetTexture(i.originalTextures[0])):null==i?o.SetTexture(ya):o.SetTexture(i),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fa(t,e)}(e,Ko),function(t,e,n){e&&la(t.prototype,e),n&&la(t,n)}(e,[{key:"Draw",value:function(t){if(this.PreDraw(t),!0===this.render){if(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyGlobal(t),!0===this.display){var e=this.clip,n=e.tl,i=e.br,r=this.anchor;t.globalAlpha=this.tint.channel[3],t.globalCompositeOperation=this.gco,t.drawImage(this.texture.image,n.x,n.y,i.x,i.y,-this.w*r.x,-this.h*r.y,this.w,this.h)}this.children.length>0&&this.DrawChildren(t)}}},{key:"GLDraw",value:function(t){this.GLPreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),!0===this.display&&null!==this.programController&&this.programController.Execute(this.transform.globalTransform.AsArray(!0),this.textureTranslation.AsArray(!0),this.textureTransformation.AsArray(!0),this.tint.channel,this.texture.uniformId),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren(t):this.GLDrawChildren(t)))}},{key:"GetBufferData",value:function(){this.UpdateTransform(),this.UpdateTextureTransform();var t=this.transform.globalTransform.AsArray(!0),e=this.textureTranslation.AsArray(!0),n=this.textureTransformation.AsArray(!0);null==this.bufferData&&(this.bufferData=[]);var i=this.bufferData;return i.length=0,i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=e[0],i[10]=e[1],i[11]=e[2],i[12]=e[3],i[13]=e[4],i[14]=e[5],i[15]=e[6],i[16]=e[7],i[17]=e[8],i[18]=n[0],i[19]=n[1],i[20]=n[2],i[21]=n[3],i[22]=n[4],i[23]=n[5],i[24]=n[6],i[25]=n[7],i[26]=n[8],i}},{key:"UpdateInBuffer",value:function(){this.UpdateTransform(),this.UpdateTextureTransform();var t=this.transform.globalTransform.AsArray(!0),e=this.textureTranslation.AsArray(!0),n=this.textureTransformation.AsArray(!0),i=this.parent.childDataBuffer,r=this.bufferStartIndex;i[r]=t[0],i[r+1]=t[1],i[r+2]=t[2],i[r+3]=t[3],i[r+4]=t[4],i[r+5]=t[5],i[r+6]=t[6],i[r+7]=t[7],i[r+8]=t[8],i[r+9]=e[0],i[r+10]=e[1],i[r+11]=e[2],i[r+12]=e[3],i[r+13]=e[4],i[r+14]=e[5],i[r+15]=e[6],i[r+16]=e[7],i[r+17]=e[8],i[r+18]=n[0],i[r+19]=n[1],i[r+20]=n[2],i[r+21]=n[3],i[r+22]=n[4],i[r+23]=n[5],i[r+24]=n[6],i[r+25]=n[7],i[r+26]=n[8]}},{key:"UpdateTextureTransform",value:function(){this.textureTranslation.TranslateTo(-this.w*this.anchor.x,-this.h*this.anchor.y),this.textureTransformation.TranslateTo(this.w/this.texture.fw*this.clip.tl.x/this.w,this.h/this.texture.fh*this.clip.tl.y/this.h)}},{key:"UpdateShape",value:function(t){null!=t&&(this.originalShape=t),this.shape.SetC(this.originalShape),this.shape.Scale(this.scale.x,this.scale.y)}},{key:"SetTexture",value:function(t){this.texture=t,this.ClipReconfigure(0,0,t.w,t.h),this.shape.SetC(this.clip),this.originalShape.SetC(this.shape)}},{key:"ClipReconfigure",value:function(t,e,n,i){var r=n/this.texture.fw,o=i/this.texture.fh,a=this.width,s=this.height;this.clip.Set(t,e,n,i),this.w=n,this.h=i,0!==a&&0!==s&&(this.width=a,this.height=s),this.textureTranslation.SetTransform(-n*this.anchor.x,-i*this.anchor.y,r,o),this.textureTransformation.SetTransform(r*this.clip.tl.x/n,o*this.clip.tl.y/i,r,o)}},{key:"CreateAnimation",value:function(t){null===this.animationController&&(this.animationController=new ta(this));var e=this.animationController.CreateAnimation(t.id,t.rate);if(null!=t.spritesheet)for(var n=0;n<t.frames.length;++n)e.AddFrame(t.spritesheet.GetFrameById(t.frames[n]));return e}},{key:"IntersectsPoint",value:function(t){return!1!==this.interactive&&(pa.SetV(t),pa.SubtractV(this.position),pa.Add(this.width*this.anchor.x,this.height*this.anchor.y),this.shape.IntersectsPoint(pa))}},{key:"width",get:function(){return this.w*this.scale.x},set:function(t){this.scale.x=t/this.w}},{key:"height",get:function(){return this.h*this.scale.y},set:function(t){this.scale.y=t/this.h}},{key:"alpha",get:function(){return this.tint.channel[3]},set:function(t){this.tint.channel[3]=t}}],[{key:"BUILD_DEFAULT_TEXTURE",value:function(t){if(!0===va)throw new Error("Function can only be called once!");ya=new ir(F(N(function(){var t=new ni([0,0,64,0,64,64,0,64,0,0,32,32,64,0,32,32,64,64,32,32,0,64]);return t.ComputeBounds(),t.style.stroke.lineWidth=3,new aa(0,0,t)}),64,64,t),"__DEFAULT_SPRITE_TEXTURE__",64,64,64,64),va=!0}},{key:"DEFAULT_TEXTURE",get:function(){return ya}}]),e}(),pa=new pt(0,0),ya=null,va=!1;function ma(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ba=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.velocity=new pt(0,0),this.torque=0,this.spin=0,this.growth=new pt(1,1),this.acceleration=new pt(1,1),this.initialScale=new pt(1,1),this.fade=!1,this.deflate=!1,this.gravity=new pt,this.lifespan=0,this.lifespanTotal=0,this.dead=!1,this.entity=null,this.system=null,this.oscillation=null,this.oscillationOffset=0,this.Renew(e,n)}return function(t,e,n){e&&ma(t.prototype,e),n&&ma(t,n)}(t,[{key:"Process",value:function(){if(!0!==this.dead)if(this.lifespan++<this.lifespanTotal){var t=this.entity,e=this.velocity,n=1-this.lifespan/this.lifespanTotal,i=this.oscillation;if(e.AddV(this.gravity).MultiplyV(this.acceleration),0!==this.torque&&e.Rotate(this.torque),t.position.AddV(e),!0===this.fade&&(t.alpha=n),!0===this.deflate?t.scale.Set(n*this.initialScale.x,n*this.initialScale.y):t.scale.MultiplyV(this.growth),t.rotation+=this.spin,null!==i&&!0===i.active){var r=this.lifespan+this.oscillationOffset;null!=i.torque&&!0===i.torque.active&&(this.torque=Object(D.Oscillate)(r,i.torque.from,i.torque.to,i.torque.amplitude)),null!=i.spin&&!0===i.spin.active&&(this.spin=Object(D.Oscillate)(r,i.spin.from,i.spin.to,i.spin.amplitude)),null!=i.velocityX&&!0===i.velocityX.active&&(this.velocity.x=Object(D.Oscillate)(r,i.velocityX.from,i.velocityX.to,i.velocityX.amplitude)),null!=i.velocityY&&!0===i.velocityY.active&&(this.velocity.y=Object(D.Oscillate)(r,i.velocityY.from,i.velocityY.to,i.velocityY.amplitude)),null!=i.gravityX&&!0===i.gravityX.active&&(this.gravity.x=Object(D.Oscillate)(r,i.gravityX.from,i.gravityX.to,i.gravityX.amplitude)),null!=i.gravityY&&!0===i.gravityY.active&&(this.gravity.y=Object(D.Oscillate)(r,i.gravityY.from,i.gravityY.to,i.gravityY.amplitude)),null!=i.accelerationX&&!0===i.accelerationX.active&&(this.acceleration.x=Object(D.Oscillate)(r,i.accelerationX.from,i.accelerationX.to,i.accelerationX.amplitude)),null!=i.accelerationY&&!0===i.accelerationY.active&&(this.acceleration.y=Object(D.Oscillate)(r,i.accelerationY.from,i.accelerationY.to,i.accelerationY.amplitude)),null!=i.growthX&&!0===i.growthX.active&&(this.growth.x=Object(D.Oscillate)(r,i.growthX.from,i.growthX.to,i.growthX.amplitude)),null!=i.growthY&&!0===i.growthY.active&&(this.growth.y=Object(D.Oscillate)(r,i.growthY.from,i.growthY.to,i.growthY.amplitude))}}else this.dead=!0,this.entity.display=!1}},{key:"Renew",value:function(t,e){if(null!=t){this.dead=!1;var n=this.entity;if(null==t.texture)throw new Error("No texture or controller provided!");if(null===n?(n=this.entity=new da(0,0,t.texture,t.unitId),null!=t.anchor&&(n.anchor.SetV(t.anchor),n.UpdateTextureTransform())):this.ResetEntity(t.unitId),null!=t.frames&&(t.frames[Object(R.RandomInteger)(0,t.frames.length-1)].Apply(n),n.scale.SetSame(1),n.UpdateTextureTransform()),this.RenewVector(t.position,n.position,e,0,0),this.RenewVector(t.velocity,this.velocity,e,0,0),this.RenewVector(t.gravity,this.gravity,e,0,0),this.RenewVector(t.acceleration,this.acceleration,e,1,1),this.RenewVector(t.growth,this.growth,e,1,1),this.RenewVector(t.scale,n.scale,e,1,1),this.RenewVector(t.scale,this.initialScale,e,1,1),null!=t.rotation?n.rotation=Object(R.MinMaxOrValue)(t.rotation):n.rotation=0,null!=t.lifespan?this.SetLifespan(t.lifespan):this.SetLifespan(0),null!=t.torque?this.torque=Object(R.MinMaxOrValue)(t.torque):this.torque=0,null!=t.spin?this.spin=Object(R.MinMaxOrValue)(t.spin):this.spin=0,null!=t.fade?this.fade=t.fade:this.fade=!1,null!=t.deflate?this.deflate=t.deflate:this.deflate=!1,null!=t.oscillation){var i=t.oscillation,r=this.oscillation;null===r&&(r=this.oscillation=new Oo),r.active=!0,null!=i.offset?this.oscillationOffset=Object(R.MinMaxOrValue)(i.offset):this.oscillationOffset=0,null!=i.torque?r.SetOscillatingObject("torque",i.torque.from,i.torque.to,i.torque.amplitude):r.Nullify("torque"),null!=i.spin?r.SetOscillatingObject("spin",i.spin.from,i.spin.to,i.spin.amplitude):r.Nullify("spin"),null!=i.velocity&&(null!=i.velocity.x?r.SetOscillatingObject("velocityX",i.velocity.x.from,i.velocity.x.to,i.velocity.x.amplitude):r.Nullify("velocityX"),null!=i.velocity.y?r.SetOscillatingObject("velocityY",i.velocity.y.from,i.velocity.y.to,i.velocity.y.amplitude):r.Nullify("velocityY")),null!=i.gravity&&(null!=i.gravity.x?r.SetOscillatingObject("gravityX",i.gravity.x.from,i.gravity.x.to,i.gravity.x.amplitude):r.Nullify("gravityX"),null!=i.gravity.y?r.SetOscillatingObject("gravityY",i.gravity.y.from,i.gravity.y.to,i.gravity.y.amplitude):r.Nullify("gravityY")),null!=i.acceleration&&(null!=i.acceleration.x?r.SetOscillatingObject("accelerationX",i.acceleration.x.from,i.acceleration.x.to,i.acceleration.x.amplitude):r.Nullify("accelerationX"),null!=i.acceleration.y?r.SetOscillatingObject("accelerationY",i.acceleration.y.from,i.acceleration.y.to,i.acceleration.y.amplitude):r.Nullify("accelerationY")),null!=i.growth&&(null!=i.growth.x?r.SetOscillatingObject("growthX",i.growth.x.from,i.growth.x.to,i.growth.x.amplitude):r.Nullify("growthX"),null!=i.growth.y?r.SetOscillatingObject("growthY",i.growth.y.from,i.growth.y.to,i.growth.y.amplitude):r.Nullify("growthY"))}else null!==this.oscillation&&(this.oscillation.active=!1)}}},{key:"RenewVector",value:function(t,e,n,i,r){null!=t?null!=t.points?null!=t.moduloWrapper?(null!=t.indexGap&&(n+=t.indexGap),e.SetV(t.points[n%t.moduloWrapper])):e.SetV(Object(R.RandomInArray)(t.points)):null!=t.xy?e.SetSame(Object(R.MinMaxOrValue)(t.xy)):(null!=t.x?e.x=Object(R.MinMaxOrValue)(t.x):e.x=i,null!=t.y?e.y=Object(R.MinMaxOrValue)(t.y):e.y=r):e.Set(i,r)}},{key:"SetLifespan",value:function(t){this.lifespan=0,this.lifespanTotal=Object(R.MinMaxOrValue)(t)}},{key:"ResetEntity",value:function(t){var e=this.entity;null!=t&&e.SetTexture(e.programController["originalTexture"+t]),e.scale.SetSame(1),e.alpha=1,e.display=!0,e.rotation=0}},{key:"Destroy",value:function(t){return(!0!==t||!1!==this.dead)&&(null!==this.system&&this.system.RemoveParticle(this),wa&&ga.Store(this),!0)}}],[{key:"USE_POOL",get:function(){return wa},set:function(t){wa=!!t}},{key:"Pool",get:function(){return ga}}]),t}(),ga=new ot,wa=!0;function Aa(t){return(Aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sa(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ca(t){return(Ca=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ta(t,e){return(Ta=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function xa(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}ga.Retrieve=function(t,e){this.PreRetrieve();var n=this.objects.pop();return n.Renew(t,e),n},ga.Flood(function(){return new ba},1e3);var Oa=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e){return!e||"object"!==Aa(e)&&"function"!=typeof e?xa(t):e}(this,Ca(e).call(this,t,n))).particles=[],i.deletionTimer=new Ci(60),i.deletionTimer.onFinish.Add(i.HandleParticleDeletion,xa(xa(i))),i.deletionTimer.Start(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ta(t,e)}(e,Ko),function(t,e,n){e&&Sa(t.prototype,e),n&&Sa(t,n)}(e,[{key:"Process",value:function(){this.HandleParticles(),this.deletionTimer.Process()}},{key:"HandleParticles",value:function(){for(var t=this.particles,e=0;e<t.length;++e)t[e].Process()}},{key:"HandleParticleDeletion",value:function(){for(var t=this.particles,e=t[n],n=0;n<t.length;e=t[++n])e&&e.Destroy(!0)&&n--;this.deletionTimer.Start()}},{key:"AddParticle",value:function(t){return t.system=this,this.AddChild(t.entity),this.particles.push(t),t}},{key:"RemoveParticle",value:function(t){var e=this.particles,n=e.indexOf(t);if(-1!==n)return t.system=null,this.RemoveChild(t.entity),e.fickleSplice(n)}},{key:"Emit",value:function(t){for(var e=0;e<t.amount;++e)!0===ba.USE_POOL?this.AddParticle(ba.Pool.Retrieve(t,e)):this.AddParticle(new ba(t,e))}}]),e}(),_a=function(t,e,n){t.setTransform(1,0,0,1,0,0),t.globalAlpha=.25,t.strokeStyle="rgba(255, 0, 255, 1)",t.fillStyle="rgba(0, 255, 0, 1)",null!=n&&(null!=n.alpha&&(t.globalAlpha=n.alpha),null!=n.strokeStyle&&(t.strokeStyle=n.strokeStyle),null!=n.fillStyle&&(t.fillStyle=n.fillStyle)),t.lineWidth=2,t.beginPath(),t.moveTo(e.tl.x,e.tl.y),t.lineTo(e.br.x,e.tl.y),t.lineTo(e.br.x,e.br.y),t.lineTo(e.tl.x,e.br.y),t.closePath(),null!=n?(null==n.noStroke&&t.stroke(),null==n.noFill&&t.fill()):(t.stroke(),t.fill())};function Pa(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ea=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=0}return function(t,e,n){e&&Pa(t.prototype,e),n&&Pa(t,n)}(t,[{key:"Add",value:function(t){this.value|=t}},{key:"Remove",value:function(t){this.value=this.value&~t}},{key:"Compare",value:function(t){return 0!=(this.value&t)}},{key:"Holds",value:function(t){return(this.value&t)===t}},{key:"Toggle",value:function(t){this.value^=t}}]),t}();function ka(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ra=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.NONE=0,this.next=1}return function(t,e,n){e&&ka(t.prototype,e),n&&ka(t,n)}(t,[{key:"Add",value:function(t){void 0===this[t=t.toUpperCase()]&&(this[t]=this.next,this.next=this.next<<1)}}]),t}(),Da=n(8);function Ia(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var La=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.orders=[],this.classUsed=null,this.amount=1,this.locked=!1}return function(t,e,n){e&&Ia(t.prototype,e),n&&Ia(t,n)}(t,[{key:"Many",value:function(t){return this.amount=t,this}},{key:"Bind",value:function(t,e){return e&&(this.orders.length=0),this.orders.push(t),this}},{key:"Make",value:function(t){var e=this.amount,n=Object(R.CreateIteratorArgs)(arguments,"@","i");if(!0===this.locked)throw new Error('"Make" called twice before end!');this.locked=!0,this.orders.length=0,this.classUsed=t;for(var i=0;i<e;++i)ja(arguments,n,i),this.orders.push(new(Function.prototype.bind.apply(t,arguments)));return this}},{key:"Call",value:function(t,e,n){var i,r,o,a=this.orders,s=Object(R.IsArray)(e),u="string"==typeof t,l=a[0];!0===s&&(o=Object(R.CreateIteratorArgs)(e,"@","i"));for(var c=0;c<a.length;l=a[++c])!0===s&&(r=e.slice(),Object(R.ReplaceArgumentWithObjectValue)(l,r,"$"),ja(r,o,c)),!1===u&&null!=n?("$"===n[0]&&(n=n.slice(1),console.warn("No need for '$' on property arguments")),Object(R.Nested)(l,n,!1,!0,t.apply(null,r))):!1===u?t.apply(null,r):(i=Object(R.Nested)(l,t,!0),Object(R.Nested)(l,t).apply(i,r));return this}},{key:"Cast",value:function(t,e){for(var n=this.orders,i="string"==typeof e,r=0;r<n.length;++r)!0===i&&"$"===e[0]&&(e=Object(R.Nested)(n[r],e)),Object(R.Nested)(n[r],t,!1,!0,e);return this}},{key:"Done",value:function(){return this.amount=1,this.locked=!1,this.orders[0]}},{key:"Mass",value:function(){return this.amount=1,this.locked=!1,this.orders}},{key:"Ship",value:function(t){this.amount=1,this.locked=!1;var e=!0===t?this.orders.slice():this.orders[0];return this.orders.length=0,e}}]),t}(),ja=function(t,e,n){if(null!=e)for(var i=0,r=e[i];i<e.length;r=e[++i])if(-1!==r.iteratorIndex)if(r.mod&&r.val)switch(r.mod){case"+":t[r.iteratorIndex]=n+parseInt(r.val);break;case"*":t[r.iteratorIndex]=n*parseInt(r.val);break;case"-":t[r.iteratorIndex]=n-parseInt(r.val);break;case"/":t[r.iteratorIndex]=n/parseInt(r.val);break;case"%":t[r.iteratorIndex]=n%parseInt(r.val);break;default:throw new Error("Bad mod!")}else t[r.iteratorIndex]=n},Ba=n(5);function Ga(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ua=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=e,this.w=n,this.h=i,this.aspectRatio=Object(D.SimplifyAspectRatio)(n,i),this.onChange=new wi,this.mode=r,this.stage=null,this.rootContainer=null,this.currentWidth=0,this.currentHeight=0,e.setAttribute("width",n),e.setAttribute("height",i),this.___bound___OnWindowRsize=this.OnWindowResize.bind(this),window.addEventListener("resize",this.___bound___OnWindowRsize)}return function(t,e,n){e&&Ga(t.prototype,e),n&&Ga(t,n)}(t,[{key:"OnWindowResize",value:function(){this[this.mode]()}},{key:"Trigger",value:function(){return this.OnWindowResize(),this}},{key:"Reconfigure",value:function(t,e,n){return this.w=t,this.h=e,this.mode=n,this}},{key:"BindStage",value:function(t){return this.stage=t,this}},{key:"BindRootContainer",value:function(t){return this.rootContainer=t,this}},{key:"SetCurrent",value:function(t,e){this.canvas.setAttribute("width",t),this.canvas.setAttribute("height",e),this.currentWidth=t,this.currentHeight=e,null!==this.stage&&(this.stage.w=t,this.stage.h=e,this.stage.mouse&&this.stage.mouse.scale.Set(t/this.w,e/this.h),this.stage.touch&&this.stage.touch.scale.Set(t/this.w,e/this.h),!0===this.stage.usingWebGL&&this.stage.GLConfig()),null!==this.rootContainer&&this.rootContainer.scale.Set(t/this.w,e/this.h)}},{key:"FillScreen",value:function(){this.SetCurrent(window.innerWidth,window.innerHeight)}},{key:"KeepAspectRatio",value:function(){var t=window.innerWidth,e=t/this.aspectRatio[0]*this.aspectRatio[1];this.SetCurrent(t,e)}},{key:"KeepAspectRatioMIN",value:function(){var t,e=window.innerWidth;e<=this.w&&(e=this.w),t=e/this.aspectRatio[0]*this.aspectRatio[1],this.SetCurrent(e,t)}},{key:"KeepAspectRatioMAX",value:function(){var t,e=window.innerWidth;e>=this.w&&(e=this.w),t=e/this.aspectRatio[0]*this.aspectRatio[1],this.SetCurrent(e,t)}},{key:"KeepAspectRatioFIT",value:function(){var t=window.innerWidth,e=t/this.aspectRatio[0]*this.aspectRatio[1];e>=window.innerHeight&&(t=(e=window.innerHeight)/this.aspectRatio[1]*this.aspectRatio[0]),this.SetCurrent(t,e)}},{key:"Destroy",value:function(){window.removeEventListener("resize",this.___bound___OnWindowRsize)}}],[{key:"FILL_SCREEN",get:function(){return Na}},{key:"KEEP_ASPECT_RATIO",get:function(){return Fa}},{key:"KEEP_ASPECT_RATIO_MIN",get:function(){return Ma}},{key:"KEEP_ASPECT_RATIO_MAX",get:function(){return Va}},{key:"KEEP_ASPECT_RATIO_FIT",get:function(){return Xa}}]),t}(),Na="FillScreen",Fa="KeepAspectRatio",Ma="KeepAspectRatioMIN",Va="KeepAspectRatioMAX",Xa="KeepAspectRatioFIT";function Ya(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ha=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nodes={},this.objects=[],this.convergence=[],this.objectCap=0,this.levelCap=0,this.level=0,this.aabb=null,this.hasSplit=!1,this.Set(e,n,i,r)}return function(t,e,n){e&&Ya(t.prototype,e),n&&Ya(t,n)}(t,[{key:"Set",value:function(t,e,n,i){return this.aabb=t,this.level=e,this.objectCap=n,this.levelCap=i,this}},{key:"FromPool",value:function(e,n,i,r){return!0===Qa?Ja.Retrieve(e,n,i,r):new t(e,n,i,r)}},{key:"Store",value:function(){Ja.Store(this)}},{key:"Add",value:function(t){var e=0,n="",i=this.objects,r=this.nodes;if(!0!==this.hasSplit||null===(n=this.Marking(t))){if(i.push(t),this.level<this.levelCap&&i.length>this.objectCap)for(!1===this.hasSplit&&this.Split();e<i.length;)null!==(n=this.Marking(i[e]))?r[n].Add(i.fickleSplice(e)):++e}else r[n].Add(t)}},{key:"Converge",value:function(t){var e="",n=this.nodes,i=this.convergence;return i.length=0,i.push.apply(i,this.objects),!0===this.hasSplit&&(null!==(e=this.Marking(t))?i.push.apply(i,n[e].Converge(t)):(i.push.apply(i,n[Wa].Converge(t)),i.push.apply(i,n[qa].Converge(t)),i.push.apply(i,n[za].Converge(t)),i.push.apply(i,n[Ka].Converge(t)))),i}},{key:"Split",value:function(){var t=this.level+1,e=this.objectCap,n=this.levelCap,i=this.nodes,r=this.aabb;i[Wa]=this.FromPool(r.GetQuadrant(Wa),t,e,n),i[qa]=this.FromPool(r.GetQuadrant(qa),t,e,n),i[za]=this.FromPool(r.GetQuadrant(za),t,e,n),i[Ka]=this.FromPool(r.GetQuadrant(Ka),t,e,n),this.hasSplit=!0}},{key:"Dump",value:function(){var t=this.nodes;this.objects.length=0,!0===this.hasSplit&&(t[Wa].Dump(),t[qa].Dump(),t[za].Dump(),t[Ka].Dump(),!0===Qa&&(t[Wa].Store(),t[qa].Store(),t[za].Store(),t[Ka].Store())),this.nodes={},this.hasSplit=!1}},{key:"Marking",value:function(t){var e=this.nodes;return!0===e[Wa].aabb.ContainsAABB2D(t)?Wa:!0===e[qa].aabb.ContainsAABB2D(t)?qa:!0===e[za].aabb.ContainsAABB2D(t)?za:!0===e[Ka].aabb.ContainsAABB2D(t)?Ka:null}},{key:"ConcatNodes",value:function(t){var e=this.nodes;return void 0===t&&(t=[]),t.push(this),!1===this.hasSplit?t:(e[Wa].ConcatNodes(t),e[qa].ConcatNodes(t),e[za].ConcatNodes(t),e[Ka].ConcatNodes(t),t)}}],[{key:"pool",get:function(){return Ja}},{key:"USE_POOL",get:function(){return Qa},set:function(t){Qa=!!t}}]),t}(),Wa="TL",qa="TR",za="BL",Ka="BR",Ja=new ot,Qa=!0;function $a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Ja.Retrieve=function(t,e,n,i){return this.PreRetrieve(),this.objects.pop().Set(t,e,n,i)},Ja.Flood(function(){return new Ha(null,0,0,0)},500);var Za=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.element.setAttribute("tabindex","1"),this.element.focus(),this.___bound___OnKeyDown=this.OnKeyDown.bind(this),this.___bound___OnKeyUp=this.OnKeyUp.bind(this),this.element.addEventListener("keydown",this.___bound___OnKeyDown),this.element.addEventListener("keyup",this.___bound___OnKeyUp),this.onDown=new wi,this.onUp=new wi}return function(t,e,n){e&&$a(t.prototype,e),n&&$a(t,n)}(t,[{key:"OnKeyDown",value:function(t){t.preventDefault(),t.stopPropagation(),this.onDown.Dispatch(this.element,t)}},{key:"OnKeyUp",value:function(t){t.preventDefault(),t.stopPropagation(),this.onUp.Dispatch(this.element,t)}},{key:"Destroy",value:function(){this.element.removeEventListener("keydown",this.___bound___OnKeyDown),this.element.removeEventListener("keyup",this.___bound___OnKeyUp)}}]),t}();function ts(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var es=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.position=new pt,this.scale=new pt(1,1),this.offset=new pt(n,i),this.eventData={position:this.position,native:null},this.offsets=[],this.___bound___OnMove=this.OnMove.bind(this),this.___bound___OnDown=this.OnDown.bind(this),this.___bound___OnUp=this.OnUp.bind(this),this.___bound___OnLeave=this.OnLeave.bind(this),this.___bound___OnWheel=this.OnWheel.bind(this),this.element.addEventListener("mousemove",this.___bound___OnMove),this.element.addEventListener("mousedown",this.___bound___OnDown),this.element.addEventListener("mouseup",this.___bound___OnUp),this.element.addEventListener("mouseleave",this.___bound___OnLeave),this.element.addEventListener("wheel",this.___bound___OnWheel,{passive:!0}),this.onMove=new wi,this.onDown=new wi,this.onUp=new wi,this.onLeave=new wi,this.onWheel=new wi}return function(t,e,n){e&&ts(t.prototype,e),n&&ts(t,n)}(t,[{key:"OnMove",value:function(t){return this.CalculatePosition(t.pageX,t.pageY),this.eventData.native=t,this.onMove.Dispatch(this.element,this.eventData),!1}},{key:"OnDown",value:function(t){t.stopPropagation(),t.preventDefault(),this.CalculatePosition(t.pageX,t.pageY),this.eventData.native=t,this.onDown.Dispatch(this.element,this.eventData)}},{key:"OnUp",value:function(t){t.stopPropagation(),t.preventDefault(),this.CalculatePosition(t.pageX,t.pageY),this.eventData.native=t,this.onUp.Dispatch(this.element,this.eventData)}},{key:"OnLeave",value:function(t){t.stopPropagation(),this.CalculatePosition(t.pageX,t.pageY),this.eventData.native=t,this.onLeave.Dispatch(this.element,this.eventData)}},{key:"OnWheel",value:function(t){t.stopPropagation(),this.CalculatePosition(t.pageX,t.pageY),this.eventData.native=t,this.onWheel.Dispatch(this.element,this.eventData)}},{key:"CalculatePosition",value:function(t,e){var n=this.offsets,i=this.position;i.Set(t,e).Subtract(this.element.offsetLeft,this.element.offsetTop).SubtractV(this.offset).DivideV(this.scale);for(var r=0;r<n.length;++r)i.SubtractV(n[r])}},{key:"AddOffset",value:function(t){return this.offsets.push(t),this}},{key:"Destroy",value:function(){this.element.removeEventListener("mousemove",this.___bound___OnMove),this.element.removeEventListener("mousedown",this.___bound___OnDown),this.element.removeEventListener("mouseup",this.___bound___OnUp),this.element.removeEventListener("mouseleave",this.___bound___OnLeave),this.element.removeEventListener("wheel",this.___bound___OnWheel)}}],[{key:"x",get:function(){return this.position.x}},{key:"y",get:function(){return this.position.y}}]),t}();function ns(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var is=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.position=new pt,this.scale=new pt(1,1),this.offset=new pt(n,i),this.eventData={position:this.position,native:null},this.___bound___OnMove=this.OnMove.bind(this),this.___bound___OnStart=this.OnStart.bind(this),this.___bound___OnEnd=this.OnEnd.bind(this),this.___bound___OnCancel=this.OnCancel.bind(this),this.element.addEventListener("touchmove",this.___bound___OnMove),this.element.addEventListener("touchstart",this.___bound___OnStart),this.element.addEventListener("touchend",this.___bound___OnEnd),this.element.addEventListener("touchcancel",this.___bound___OnCancel),this.onMove=new wi,this.onStart=new wi,this.onEnd=new wi,this.onCancel=new wi}return function(t,e,n){e&&ns(t.prototype,e),n&&ns(t,n)}(t,[{key:"OnMove",value:function(t){return t.preventDefault(),t.stopPropagation(),this.CalculatePosition(t.touches.item(0).pageX,t.touches.item(0).pageY),this.eventData.native=t,this.onMove.Dispatch(this.element,this.eventData),!1}},{key:"OnStart",value:function(t){t.preventDefault(),t.stopPropagation(),this.CalculatePosition(t.touches.item(0).pageX,t.touches.item(0).pageY),this.eventData.native=t,this.onStart.Dispatch(this.element,this.eventData)}},{key:"OnEnd",value:function(t){t.stopPropagation(),this.eventData.native=t,this.onEnd.Dispatch(this.element,this.eventData)}},{key:"OnCancel",value:function(t){t.stopPropagation(),this.eventData.native=t,this.onCancel.Dispatch(this.element,this.eventData)}},{key:"CalculatePosition",value:function(t,e){var n=this.position;n.Set(t,e),n.Subtract(this.element.offsetLeft,this.element.offsetTop),n.SubtractV(this.offset),n.DivideV(this.scale)}},{key:"Destroy",value:function(){this.element.removeEventListener("touchmove",this.___bound___OnMove),this.element.removeEventListener("touchstart",this.___bound___OnStart),this.element.removeEventListener("touchend",this.___bound___OnEnd),this.element.removeEventListener("touchcancel",this.___bound___OnCancel)}}],[{key:"x",get:function(){return this.position.x}},{key:"y",get:function(){return this.position.y}}]),t}();function rs(t){return(rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function os(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function as(t){return(as=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ss(t,e){return(ss=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function us(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var ls=function(t){function e(t){var n;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=function(t,e){return!e||"object"!==rs(e)&&"function"!=typeof e?us(t):e}(this,as(e).call(this,t.x,t.y)),"string"==typeof t.canvas&&(t.canvas=document.getElementById(t.canvas)),n.canvas=t.canvas,n.w=t.canvas.width,n.h=t.canvas.height,n.id=null,n.backgroundColor="rgba(10,20,30,1)",n.clear=!0,n.fill=!0,n.usingWebGL=!1,n.positionReconfiguration=new pt(t.x,t.y),n.canvasManager=null,n.mouse=null,n.touch=null,n.ticker=null,null!=t.mode&&"webgl"===t.mode.toLowerCase()){if(n.gl=t.canvas.getContext("webgl",{antialias:t.antialias,powerPreference:t.powerPreference,preserveDrawingBuffer:!0}),null!=n.gl?console.log("%cWebGL!","color:#f0f7da;background-color:#234d20;font-family:Arial;font-size:18px;font-weight:900;padding:5px;"):(n.gl=t.canvas.getContext("experimental-webgl"),null!=n.gl&&console.warn("Experimental WebGL!")),null==n.gl)throw new Error("WebGL is not supported!");n.gl.clearColor(.0392156862745098,.0784313725490196,.11764705882352941,1),n.usingWebGL=!0,!0!==t.noTicker&&(n.ticker=new xi(n.GLProcess.bind(us(us(n))),60,t.halt)),n.GLConfig(n.gl)}else n.rc=t.canvas.getContext("2d"),console.log("%cCanvas 2D!","color:#f0f7da;background-color:#234d20;font-family:Arial;font-size:18px;font-weight:900;padding:5px;"),!0!==t.noTicker&&(n.ticker=new xi(n.Process.bind(us(us(n))),60,t.halt));return null!=t.backgroundColor&&(n.backgroundColor=t.backgroundColor),!1===t.clear&&(n.clear=!1),!1===t.fill&&(n.fill=!1),null!=t.id&&(n.id=t.id),n.onProcess=new wi,!0!==t.noMouse&&(n.mouse=new es(t.canvas,t.x,t.y)),!0!==t.noKeyboard&&(n.keyboard=new Za(t.canvas)),!0!==t.noTouch&&(n.touch=new is(t.canvas,t.x,t.y)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ss(t,e)}(e,Ko),function(t,e,n){e&&os(t.prototype,e),n&&os(t,n)}(e,[{key:"PreDraw",value:function(t){t.setTransform(1,0,0,1,0,0),t.globalAlpha=1,t.globalCompositeOperation=Pe,!0===this.fill?(t.fillStyle=this.backgroundColor,t.fillRect(0,0,this.w,this.h)):!0===this.clear&&t.clearRect(0,0,this.w,this.h)}},{key:"GLConfig",value:function(t){null==t&&(t=this.gl),this.position.SetSame(0),this.scale.Set(2/this.w,-2/this.h),this.position.Add(-1,1),this.position.Add(this.positionReconfiguration.x*this.scale.x,this.positionReconfiguration.y*this.scale.y),this.UpdateTransform(),t.viewport(0,0,this.w,this.h),t.enable(t.BLEND),t.disable(t.DEPTH_TEST),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)}},{key:"GLPreDraw",value:function(t){!0===this.clear&&t.clear(t.COLOR_BUFFER_BIT)}},{key:"GLPostDraw",value:function(t){t.flush()}},{key:"Process",value:function(t){this.Draw(this.rc),this.onProcess.Dispatch(this,t)}},{key:"GLProcess",value:function(t){this.GLDraw(this.gl),this.GLPostDraw(this.gl),this.onProcess.Dispatch(this,t)}},{key:"MixedProcess",value:function(t){!0===this.usingWebGL?(this.GLDraw(this.gl),this.GLPostDraw(this.gl)):this.Draw(this.rc),this.onProcess.Dispatch(this,t)}},{key:"Destroy",value:function(){this.Dump(),this.keyboard.Destroy(),this.mouse.Destroy(),this.touch.Destroy(),null!=this.ticker&&this.ticker.Stop()}}]),e}();function cs(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var hs=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.stages=[],this.currentStage=null,this.onlyCurrent=!1,this.options=null,this.ticker=new xi(this.Process.bind(this),60,e.halt),this.SetOptions(e)}return function(t,e,n){e&&cs(t.prototype,e),n&&cs(t,n)}(t,[{key:"SetOptions",value:function(t){null!=t&&(this.options=t)}},{key:"CreateStage2D",value:function(t){var e,n=document.createElement("canvas");"string"==typeof t&&(e=t,t=null),null==t&&(t=this.options),null==t&&(t={}),null!==e&&(t.id=e),null!=t.width&&(n.width=t.width),null!=t.height&&(n.height=t.height),null!=t.className&&(n.className=t.className),null==t.rootNode&&(t.rootNode=document.body),t.rootNode.appendChild(n),t.canvas=n,t.noTicker=!0,t.halt=!0;var i=new ls(t);return t.id=null,t.canvas=null,this.stages.push(i),i}},{key:"GetStages",value:function(){for(var t=this.stages,e=[],n=0;n<t.length;++n)for(var i=0;i<arguments.length;++i)t[n].id===arguments[i]&&e.push(t[n]);return e}},{key:"Process",value:function(t){for(var e=this.stages,n=0;n<e.length;++n)e[n].MixedProcess(t)}},{key:"Destroy",value:function(){for(var t=this.stages,e=0;e<t.length;++e)t[e].Destroy();this.ticker.Stop()}}]),t}();function fs(t){return(fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ds(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ps(t,e){return!e||"object"!==fs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ys(t){return(ys=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vs(t,e){return(vs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ms=function(t){function e(t,n,i,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=ps(this,ys(e).call(this,t,n,null==i?bs:i,r))).pattern=null,o.patternOffset=new pt(0,0),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vs(t,e)}(e,da),function(t,e,n){e&&ds(t.prototype,e),n&&ds(t,n)}(e,[{key:"Draw",value:function(t){this.PreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyGlobal(t),!0===this.display&&null!==this.pattern&&(t.globalAlpha=this.tint.channel[3],t.globalCompositeOperation=this.gco,t.fillStyle=this.pattern,t.beginPath(),t.rect(0,0,this.w,this.h),t.closePath(),t.translate(this.patternOffset.x,this.patternOffset.y),t.fill()),this.children.length>0&&this.DrawChildren(t))}},{key:"GeneratePattern",value:function(t,e,n){null==this.programController?(this.pattern=t.createPattern(this.texture.image,null),this.w=e,this.h=n,this.scale.SetSame(1)):(this.width=e,this.height=n,this.textureTransformation.SetTransform(0,0,this.scale.x,this.scale.y))}},{key:"OffsetPattern",value:function(t,e){this.patternOffset.Add(t,e),this.textureTransformation.Translate(-t/this.w,-e/this.h)}},{key:"SetPatternOffset",value:function(t,e){this.patternOffset.Set(t,e),this.textureTransformation.TranslateTo(-t/this.w,-e/this.h)}},{key:"GetPatternOffset",value:function(){return this.patternOffset}}],[{key:"BUILD_DEFAULT_TEXTURE",value:function(t){if(!0===gs)throw new Error("Function can only be called once!");bs=new ir(F(N(function(){var t=new ni([0,0,64,0,64,64,0,64,0,0,32,32,64,0,32,32,64,64,32,32,0,64]);return t.ComputeBounds(),t.style.stroke.lineWidth=3,new aa(0,0,t)}),64,64,t),"__DEFAULT_TILESPRITE_TEXTURE__",64,64,64,64),gs=!0}},{key:"DEFAULT_TEXTURE",get:function(){return bs}}]),e}(),bs=null,gs=!1;function ws(t){return(ws="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function As(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ss(t,e){return!e||"object"!==ws(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Cs(t){return(Cs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ts(t,e){return(Ts=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xs=function(t){function e(t,n,i){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Ss(this,Cs(e).call(this,t,n))).id=parseInt(i.id),r.cx=parseInt(i.x),r.cy=parseInt(i.y),r.w=parseInt(i.width),r.h=parseInt(i.height),r.xoffset=parseInt(i.xoffset),r.yoffset=parseInt(i.yoffset),r.xadvance=parseInt(i.xadvance),r.yadvance=0,r.kernings=[],r.translation=new Lo,r.transformation=new Lo,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ts(t,e)}(e,Mo),function(t,e,n){e&&As(t.prototype,e),n&&As(t,n)}(e,[{key:"Draw",value:function(t,e){t.drawImage(e,this.cx,this.cy,this.width,this.height,this.position.x,this.position.y,this.width,this.height)}},{key:"GLDrawAuto",value:function(t,e,n){this.UpdateMatrices(),t.Execute(this.transform.globalTransform.AsArray(!0),this.translation.AsArray(!0),this.transformation.AsArray(!0),e,n)}},{key:"GLDraw",value:function(t,e,n){t.Execute(this.transform.globalTransform.AsArray(!0),this.translation.AsArray(!0),this.transformation.AsArray(!0),e,n)}},{key:"ApplyKernings",value:function(t){for(var e,n=0;n<t.length;++n)e=t[n].attributes,parseInt(e.first)===this.id&&this.kernings.push(parseInt(e.first),parseInt(e.second),parseInt(e.amount))}},{key:"Crunch",value:function(t){if(this.position.SetSame(0),null!=t&&(this.x=t.x+t.xadvance,this.y=this.yadvance=t.yadvance,t.kernings&&t.kernings.length>0&&this.kernings.length>0))for(var e=this.kernings,n=0;n<e.length;n+=3)if(e[n+1]===t.id){this.x+=e[n+2];break}this.position.Add(this.xoffset,this.yoffset)}},{key:"UpdateMatrices",value:function(){if(null!=this.parent){var t=this.parent.texture,e=this.width/t.fw,n=this.height/t.fh;this.UpdateTransform(),this.translation.SetTransform(0,0,e,n),this.transformation.SetTransform(e*this.cx/this.width,n*this.cy/this.height,e,n)}}}]),e}();function Os(t){return(Os="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ps(t,e){return!e||"object"!==Os(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Es(t){return(Es=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ks(t,e){return(ks=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rs=function(t){function e(t,n,i,r,o,a){var s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(s=Ps(this,Es(e).call(this,t,n,i,a))).fontData=r,s.lineHeight=r.font.common.attributes.lineHeight,s.chars=[],s.maxWidth=1024,s.text="",s.autoUpdateChars=!0,null!=o&&(s.text=o),s.ComputeText(),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ks(t,e)}(e,da),function(t,e,n){e&&_s(t.prototype,e),n&&_s(t,n)}(e,[{key:"Draw",value:function(t){this.PreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyGlobal(t),!0===this.display&&(t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,this.DrawText(t)),this.children.length>0&&this.DrawChildren(t))}},{key:"GLDraw",value:function(t){this.GLPreDraw(t),!0===this.render&&(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),!0===this.display&&null!==this.programController&&this.GLDrawText(t),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchDrawChildren(t):this.GLDrawChildren(t)))}},{key:"DrawText",value:function(t){for(var e=this.chars,n=this.texture.image,i=0;i<e.length;++i)e[i].Draw(t,n)}},{key:"GLDrawText",value:function(){var t=this.chars;if(!0===this.autoUpdateChars)for(var e=0;e<t.length;++e)t[e].GLDrawAuto(this.programController,this.tint.channel,this.texture.uniformId);else for(e=0;e<t.length;++e)t[e].GLDraw(this.programController,this.tint.channel,this.texture.uniformId)}},{key:"ComputeText",value:function(){var t,e,n,i=0,r=0,o=!1,a=0,s=0,u=0,l=0,c=this.chars,h=this.text;this.UpdateTransform(),c.length=0,this.fontData.font.kernings&&(t=this.fontData.font.kernings.kerning);for(var f=0;f<h.length;++f){var d=h.charCodeAt(f);n=c[f-1-r],10!==d?(e=new xs(0,0,this.GetCharDataById(d)),null!=t&&e.ApplyKernings(t),e.Crunch(n),u=e.position.x+e.width,l=e.position.y+e.height,(u>this.maxWidth||!0===o)&&(e.position.SetSame(0),e.yadvance=this.lineHeight*++i,e.position.Add(e.xoffset,e.yoffset+e.yadvance),o=!1),u>a&&(a=u),l>s&&(s=l),e.parent=this,e.UpdateMatrices(),c.push(e)):(r++,o=!0)}this.w=a,this.h=s}},{key:"UpdateChars",value:function(){for(var t=this.chars,e=0;e<t.length;++e)t[e].UpdateMatrices()}},{key:"GetCharDataById",value:function(t){for(var e=this.fontData.font.chars.char,n=0;n<e.length;++n)if(parseInt(e[n].attributes.id)===t)return e[n].attributes}},{key:"UpdateInBuffer",value:function(){throw new Error(Ds)}},{key:"GetBufferData",value:function(){throw new Error(Ds)}}]),e}(),Ds="Cannot access buffer data directly on BitmapText!";function Is(t){return(Is="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ls(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function js(t,e){return!e||"object"!==Is(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bs(t){return(Bs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gs(t,e){return(Gs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Us=function(t){function e(t,n,i,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=js(this,Bs(e).call(this,t,n))).text=i,o.style=Rn(r),o.maxWidth=void 0,o.alpha=1,o.gco=Pe,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gs(t,e)}(e,Ko),function(t,e,n){e&&Ls(t.prototype,e),n&&Ls(t,n)}(e,[{key:"Draw",value:function(t){if(this.PreDraw(t),!0===this.render){if(!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1)),this.transform.ApplyGlobal(t),!0===this.display){var e=this.style;!0===e.shadow.applied&&e.shadow.Apply(t),!0===e.text.applied&&(e.text.Apply(t),t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,t.fillText(this.text,0,0,this.maxWidth),t.strokeText(this.text,0,0,this.maxWidth))}this.children.length>0&&this.DrawChildren(t)}}},{key:"IntersectsPoint",value:function(){return!1}}]),e}();function Ns(t){return(Ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fs(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ms(t,e){return!e||"object"!==Ns(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vs(t){return(Vs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xs(t,e){return(Xs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ys=Math.cos,Hs=Math.sin,Ws=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Ms(this,Vs(e).call(this,0,0))).focus=t,i.target=n,i.velocity=new pt(0,0),i.force=new pt(1,1),i.stopRadiusSq=1e3,i.EPSILON=2e-4,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xs(t,e)}(e,Ko),function(t,e,n){e&&Fs(t.prototype,e),n&&Fs(t,n)}(e,[{key:"Process",value:function(){var t=this.target;if(null!=t){zs.SetV(t.position),zs.Invert(),zs.AddV(this.focus),qs.SetV(this.position).SubtractV(zs);var e=qs.GetMagnitudeSquared();if(e<this.stopRadiusSq)return;e*=this.EPSILON;var n=qs.GetAngle();this.velocity.Set(e*Ys(n),e*Hs(n)).MultiplyV(this.force),this.position.SubtractV(this.velocity)}}},{key:"SetTarget",value:function(t){return this.target=t,this}}]),e}(),qs=new pt(0,0),zs=new pt(0,0);function Ks(t){return(Ks="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Js(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Qs(t,e){return!e||"object"!==Ks(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $s(t){return($s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zs(t,e){return(Zs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var tu=function(t){function e(t,n,i){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Qs(this,$s(e).call(this,t,n))).programController=i,r.transformShouldUpdate=!1,r.transformAutomaticUpdate=!1,r.w=128,r.h=128,r.time=0,r.timeInc=.1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zs(t,e)}(e,Mo),function(t,e,n){e&&Js(t.prototype,e),n&&Js(t,n)}(e,[{key:"GLPreDraw",value:function(){}},{key:"GLDraw",value:function(t){this.GLPreDraw(t),!0===this.transformShouldUpdate&&(this.UpdateTransform(),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1));var e=this.bounds;this.programController.Execute(this.transform.globalTransform.AsArray(!0),e.tl.x,e.tl.y,e.w,e.h,this.time),this.time+=this.timeInc}}]),e}();n.d(e,"Math",function(){return D}),n.d(e,"Assert",function(){return $i.a}),n.d(e,"Pool",function(){return ot}),n.d(e,"FlagList",function(){return Ea}),n.d(e,"FlagEnum",function(){return Ra}),n.d(e,"Cache",function(){return tr}),n.d(e,"Glob",function(){return Da.a}),n.d(e,"Maker",function(){return La}),n.d(e,"Color",function(){return si}),n.d(e,"Utility",function(){return R}),n.d(e,"Cipher",function(){return i}),n.d(e,"BrowserUtility",function(){return r}),n.d(e,"Style",function(){return v}),n.d(e,"Time",function(){return b}),n.d(e,"CharacterSets",function(){return Ba.a}),n.d(e,"CanvasManager",function(){return Ua}),n.d(e,"Vector2D",function(){return pt}),n.d(e,"Matrix2D",function(){return Lo}),n.d(e,"Transform2D",function(){return No}),n.d(e,"QuadtreeNode",function(){return Ha}),n.d(e,"Ease",function(){return o}),n.d(e,"Collision",function(){return c}),n.d(e,"Geom",function(){return f}),n.d(e,"Path",function(){return m}),n.d(e,"CoreEntity2D",function(){return Mo}),n.d(e,"Container2D",function(){return Ko}),n.d(e,"Stage2D",function(){return ls}),n.d(e,"Stadium",function(){return hs}),n.d(e,"Graphic2D",function(){return aa}),n.d(e,"Sprite",function(){return da}),n.d(e,"Tilesprite",function(){return ms}),n.d(e,"Char",function(){return xs}),n.d(e,"BitmapText",function(){return Rs}),n.d(e,"Text",function(){return Us}),n.d(e,"Camera2D",function(){return Ws}),n.d(e,"GLEntity2D",function(){return tu}),n.d(e,"Shader",function(){return g}),n.d(e,"Load",function(){return w}),n.d(e,"Controller",function(){return S}),n.d(e,"CP",function(){return C}),n.d(e,"Motion",function(){return T}),n.d(e,"Particle",function(){return O}),n.d(e,"Texture",function(){return _}),n.d(e,"Animator",function(){return P}),n.d(e,"Debug",function(){return k}),n(20)},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(t,e){var n=document.getElementById("buttons"),i=document.createElement("input"),r=document.getElementById("back-button");i.setAttribute("value",t),i.setAttribute("type","button"),i.addEventListener("click",function(){n.style.display="none",r.onclick=a,e(o)}),n.appendChild(i);var o={canvas:null,stage:null,stadium:null,ticker:null};function a(){o.canvas&&o.canvas.parentNode.removeChild(o.canvas),o.stage&&o.stage.Destroy(),o.stadium&&(o.stadium.stages.forEach(function(t){t.canvas.parentNode.removeChild(t.canvas)}),o.stadium.Destroy()),o.canvasManager&&o.canvasManager.Destroy(),o.ticker&&o.ticker.Stop(),r.onclick=null,n.style.display=null}}},function(t,e,n){"use strict";n.r(e),n.d(e,"RandomInteger",function(){return u}),n.d(e,"RandomFloat",function(){return l}),n.d(e,"IsInteger",function(){return c}),n.d(e,"IsFloat",function(){return h}),n.d(e,"IsArray",function(){return f}),n.d(e,"ThisOrThat",function(){return d}),n.d(e,"Sign",function(){return p}),n.d(e,"Clamp",function(){return y}),n.d(e,"InverseClamp",function(){return v}),n.d(e,"FlipACoin",function(){return m}),n.d(e,"GenerateSequence",function(){return b}),n.d(e,"RandomInArray",function(){return g}),n.d(e,"MinMaxOrValue",function(){return w}),n.d(e,"UUID",function(){return A}),n.d(e,"ApplyProperties",function(){return S}),n.d(e,"Nested",function(){return C}),n.d(e,"ArrayGetRandom",function(){return T}),n.d(e,"ArrayShuffle",function(){return x}),n.d(e,"Base16ToBase10",function(){return O}),n.d(e,"Base2ToBase10",function(){return _}),n.d(e,"IsObjectEmpty",function(){return P}),n.d(e,"DeepClone",function(){return E}),n.d(e,"CreateIteratorArgs",function(){return k}),n.d(e,"ReplaceArgumentWithObjectValue",function(){return R}),n.d(e,"PRINT_VERSION",function(){return D});var i=n(3),r=n(5);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a=n(21).version,s=Math.random;function u(t,e){return s()*(e-t+1)+t|0}function l(t,e){return s()*(e-t)+t}function c(t){return Number(t)===t&&t%1==0}function h(t){return Number(t)===t&&t%1!=0}function f(t){return"[object Array]"===Object.prototype.toString.call(t)}function d(t,e){return s()>.5?t:e}function p(t,e){return 0===t?!0===e?1:0:t>0?1:-1}function y(t,e,n){return t<e?e:t>n?n:t}function v(t,e,n){return t<e?n:t>n?e:t}function m(t,e){return 1===u(1,2)?t:e}function b(t,e,n,r){for(var o=[],a=0;a<e;a+=n)o.push(Object(i.PrecisionRound)(a,r));return o}function g(t){return t[u(0,t.length-1)]}function w(t,e){return null!=t.min&&null!=t.max?l(t.min,t.max):null!=t.values&&t.values.length>0?g(t.values):null!=e&&t[e].length>0?g(t[e]):t}function A(t,e,n,i){var o,a,s="",l=t/e,h=r.a[n];t=null==t?32:t,e=null==e?4:e,n=null==n?0:n,i=null==i?"-":i;for(var f=0;f<t;++f)0!==(a=f/l)&&c(a)?s+=i:(o=u(1,h.length-1),s+=h.charAt(o));return s}function S(t,e){var n;if(void 0!==e)for(n in e)void 0!==t[n]&&(t[n]=e[n])}function C(t,e,n,i,r,o){var a;if("string"==typeof e&&(o=null==o?".":o,e=e.split(o)),e.length>1){if(void 0!==t[a=e.shift()])return C(t[a],e,n,i,r,o)}else{if(void 0!==t[a=e.shift()])return!0===i?void(t[a]=r):!0===n?t:t[a];if(!0===i)return void(t[a]=r)}}function T(t,e){for(var n=[],i={},r=t.length,o=0;o<e;++o){var a=s()*r|0;void 0===i[a]?(i[a]=null,n.push(t[a])):o--}return n}function x(t){for(var e,n,i=t.length-1;i-- >=0;)n=s()*i|0,e=t[i],t[i]=t[n],t[n]=e}function O(t){return parseInt(t,16)}function _(t){return parseInt(t,2)}function P(t){var e;for(e in t)if(t.hasOwnProperty(e))return!1;return JSON.stringify(t)===JSON.stringify({})}function E(t){var e,n=null,i=!1;if("function"==typeof t)throw new TypeError("Object was of type: function. Not acceptable.");if(f(t))n=[],i=!0;else{if("object"!==o(t))return t;n={}}if(i)for(var r=0;r<t.length;++r)n[r]=E(t[r]);else for(e in t)t.hasOwnProperty(e)&&(n[e]=E(t[e]));return n}function k(t,e,n){for(var i,r,o,a,s=[],u=0;u<t.length;++u)"string"==typeof(i=t[u])&&0===i.indexOf(e)&&i.indexOf(n)===e.length&&(-1!==(a=i.indexOf("|"))?(r=i.slice(i.indexOf("(")+1,a),o=i.slice(a+1,i.indexOf(")")),s.push({mod:r,val:o,iteratorIndex:u})):s.push({iteratorIndex:u}));return s}function R(t,e,n){for(var i,r=0;r<e.length;++r)"string"==typeof(i=e[r])&&0===i.indexOf(n)&&(e[r]=C(t,i.slice(n.length)))}function D(t){t?console.log("nenkraft2 server version "+a):console.log("%cnenkraft2 %cversion %c"+a,"color:#f0f7da;background-color:#234d20;font-family:Arial;font-size:18px;font-weight:900;padding:5px;","color:#f0f7da;background-color:#36802d;font-family:Arial;font-size:18px;font-weight:900;padding:5px;","color:#f0f7da;background-color:#77ab59;font-family:Arial;font-size:18px;font-weight:900;padding:5px;")}},function(t,e,n){"use strict";n.r(e),n.d(e,"PII",function(){return l}),n.d(e,"PI5",function(){return c}),n.d(e,"DEGREES_TO_RADIANS",function(){return h}),n.d(e,"RADIANS_TO_DEGRESS",function(){return f}),n.d(e,"RADIAN",function(){return d}),n.d(e,"DegreesToRadians",function(){return p}),n.d(e,"RadiansToDegress",function(){return y}),n.d(e,"PrecisionRound",function(){return v}),n.d(e,"Spread",function(){return m}),n.d(e,"AttractRepel",function(){return b}),n.d(e,"Oscillate",function(){return g}),n.d(e,"LineLineIntersection",function(){return w}),n.d(e,"ClosestPointOnLine",function(){return A}),n.d(e,"LikeASquareGrid",function(){return S}),n.d(e,"TriRectArray",function(){return C}),n.d(e,"GreatestCommonDivisor",function(){return T}),n.d(e,"SimplifyAspectRatio",function(){return x}),n.d(e,"IntegerNotation",function(){return O});var i=Math.PI,r=Math.sin,o=Math.cos,a=Math.pow,s=Math.round,u=Math.ceil,l=2*i,c=.5*i,h=i/180,f=180/i,d=h;function p(t){return t*h}function y(t){return t*f}function v(t,e){if(null==e)return t;var n=a(10,e);return s(n*t)/n}function m(t,e,n,i){return t-n*(e-1)*.5+i*n}function b(t,e,n,i,a){var s=e.SubtractVC(t);if(s.GetMagnitudeSquared()<i*i){var u=s.GetAngle();n.Add(o(u)*a,r(u)*a)}}function g(t,e,n,i){var o=.5*(n-e);return e+o+r(p(t*i))*o}function w(t,e,n,i){var r=e.SubtractVC(t),o=i.SubtractVC(n),a=-o.x*r.y+r.x*o.y,s=t.x-n.x,u=t.y-n.y,l=(-r.y*s+r.x*u)/a,c=(o.x*u-o.y*s)/a;return o.Store(),l>=0&&l<=1&&c>=0&&c<=1&&(r.Set(t.x+c*r.x,t.y+c*r.y),r)}function A(t,e,n){var i=e.SubtractVC(t),r=((n.x-t.x)*i.x+(n.y-t.y)*i.y)/i.GetMagnitudeSquared();return r<0?t:r>1?e:(i.Set(t.x+r*i.x,t.y+r*i.y),i)}function S(t,e,n,i){for(var r=e/n|0,o=0;o<t.length;++o)t[o].Set(o%r*n,(o/r|0)*i)}function C(t,e,n,i,r){return null!=r?(r[0]=t,r[1]=e,r[2]=t+n,r[3]=e,r[4]=t,r[5]=e+i,r[6]=t,r[7]=e+i,r[8]=t+n,r[9]=e,r[10]=t+n,r[11]=e+i,r):[t,e,t+n,e,t,e+i,t,e+i,t+n,e,t+n,e+i]}function T(t,e){return 0===e?t:T(e,t%e)}function x(t,e,n){var i=T(t,e),r=null==n?[]:n;return r[0]=t/i,r[1]=e/i,r}function O(t,e,n){var i=t%e,r=t/e;return u(0===i?r+1:r)+n+(1+i)}},function(t,e,n){"use strict";(function(t){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e,n,a){if(void 0==a||"function"!=typeof t.Assert)switch(e){case r.IS:return void function(t,e,n){var i=!1;t!==e&&(i=!0);o(i,t,e,n)}(t,n,e);case r.IS_NOT:return void function(t,e,n){var i=!1;t===e&&(i=!0);o(i,t,e,n)}(t,n,e);case r.IS_SAME_TYPE:return void function(t,e,n){var r=!1;Array.isArray(t)||Array.isArray(e)?!Array.isArray(t)!=!Array.isArray(e)&&(r=!0):null===t||null===e?t!==e&&(r=!0):i(t)!==i(e)?r=!0:"number"!=typeof t&&"number"!=typeof e||(isNaN(t)||isNaN(e))&&t!==e&&(r=!0);o(r,t,e,n)}(t,n,e);case r.IS_NOT_SAME_TYPE:return void function(t,e,n){var r=!1;Array.isArray(t)||Array.isArray(e)?Array.isArray(t)&&Array.isArray(e)&&(r=!0):null===t||null===e?e===t&&(r=!0):i(t)===i(e)?r=!0:"number"!=typeof t&&"number"!=typeof e||(isNaN(t)||isNaN(e))&&isNaN(t)&&isNaN(e)&&(r=!0);o(r,t,e,n)}(t,n,e);case r.IS_INSTANCE_OF:return void function(t,e,n){var i=!1;t instanceof e||(i=!0);o(i,t,e.name,n)}(t,n,e);case r.IS_NOT_INSTANCE_OF:return void function(t,e,n){var i=!1;t instanceof e&&(i=!0);o(i,t,e.name,n)}(t,n,e);case r.IS_LESS_THAN:return void function(t,e,n){var i=!1;t>=e&&(i=!0);o(i,t,e,n)}(t,n,e);case r.IS_GREATER_THAN:return void function(t,e,n){var i=!1;t<=e&&(i=!0);o(i,t,e,n)}(t,n,e);case r.IS_LESS_THAN_OR_EQUAL:return void function(t,e,n){var i=!1;t>e&&(i=!0);o(i,t,e,n)}(t,n,e);case r.IS_GREATER_THAN_OR_EQUAL:return void function(t,e,n){var i=!1;t<e&&(i=!0);o(i,t,e,n)}(t,n,e);default:throw new Error("No comparison: "+e)}else t.Assert(e,n)}function o(t,e,n,i){if(t)throw function(t,e,n){switch(n){case r.IS:n=r.IS_NOT;break;case r.IS_NOT:n=r.IS;break;case r.IS_SAME_TYPE:n=r.IS_NOT_SAME_TYPE;break;case r.IS_NOT_SAME_TYPE:n=r.IS_SAME_TYPE;break;case r.IS_INSTANCE_OF:n=r.IS_NOT_INSTANCE_OF;break;case r.IS_NOT_INSTANCE_OF:n=r.IS_INSTANCE_OF;break;case r.IS_LESS_THAN:n=r.IS_GREATER_THAN_OR_EQUAL;break;case r.IS_GREATER_THAN:n=r.IS_LESS_THAN_OR_EQUAL;break;case r.IS_LESS_THAN_OR_EQUAL:n=r.IS_GREATER_THAN;break;case r.IS_GREATER_THAN_OR_EQUAL:n=r.IS_LESS_THAN;break;default:throw new Error("Unexpected error")}console.error(t,n,e)}(e,n,i),new Error("Assertion failed: "+i);r.LOG&&window&&function(t,e,n){console.log("%c<<||-?START?-||>>","background-color: black; color: #0FF; padding: 0px 25px;"),console.log("%cAssertion success: ","background-color: #333; color: #0F0; padding: 0px 25px;"),console.log(t),console.log(n),console.log(e),console.log("%c>>||-?END?-||<<","background-color: black; color: #FF0; padding: 0px 25px;")}(e,n,i)}n.d(e,"a",function(){return r}),r.IS="I",r.IS_NOT="IN",r.IS_SAME_TYPE="IST",r.IS_NOT_SAME_TYPE="INST",r.IS_INSTANCE_OF="IIO",r.IS_NOT_INSTANCE_OF="INIO",r.IS_LESS_THAN="ILT",r.IS_GREATER_THAN="IGT",r.IS_LESS_THAN_OR_EQUAL="ILTOE",r.IS_GREATER_THAN_OR_EQUAL="IGTOE",r.Assign=function(e){if(window&&!e?e=window:t&&!e&&(e=t),!e)throw new Error("No global namespace");e.IS=r.IS,e.IS_NOT=r.IS_NOT,e.IS_SAME_TYPE=r.IS_SAME_TYPE,e.IS_NOT_SAME_TYPE=r.IS_NOT_SAME_TYPE,e.IS_INSTANCE_OF=r.IS_INSTANCE_OF,e.IS_NOT_INSTANCE_OF=r.IS_NOT_INSTANCE_OF,e.IS_LESS_THAN=r.IS_LESS_THAN,e.IS_GREATER_THAN=r.IS_GREATER_THAN,e.IS_LESS_THAN_OR_EQUAL=r.IS_LESS_THAN_OR_EQUAL,e.IS_GREATER_THAN_OR_EQUAL=r.IS_GREATER_THAN_OR_EQUAL},r.LOG=!1}).call(this,n(7))},function(t,e,n){"use strict";e.a=["0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz!?#$%@&","0123456789","ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","ABCDEFGHJIKLMNOPQRSTUWVXYZ","abcdefghijklmnopqrstuwvxyz","0123456789abcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZ"]},function(t,e,n){var i={"./functions/circle.glslfunc":22,"./functions/line.glslfunc":23,"./functions/plot.glslfunc":24};function r(t){var e=o(t);return n(e)}function o(t){var e=i[t];if(!(e+1)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return e}r.keys=function(){return Object.keys(i)},r.resolve=o,t.exports=r,r.id=6},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return a});var i=n(2);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var a=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.functions={},this.values={},this.constants={},this.components={},this.objects={},this.lists={}}return function(t,e,n){e&&o(t.prototype,e),n&&o(t,n)}(e,[{key:"Define",value:function(t,e,n){this.Mark(t,e),this.Set(t,e,n)}},{key:"Mark",value:function(t,e){if("string"!=typeof t)throw new Error("Type needs to be a string!");if("string"!=typeof e)throw new Error("Id needs to be a string!");if(null==this[t])throw new Error("Type does not exist");if((t===l||t===c)&&void 0!==this[t][e])throw new Error("Constants cannot be reassigned!");this[t][e]=null}},{key:"Get",value:function(t,n){if("string"!=typeof t)throw new Error("Type needs to be a string!");if("string"!=typeof n)throw new Error("Id needs to be a string!");if(null==this[t])throw new Error("Type does not exist");if(!1===e.AllowGetNullUndefined&&null==this[t][n])throw new Error("Null or undefined!");return this[t][n]}},{key:"Set",value:function(t,e,n){if("string"!=typeof t)throw new Error("Type needs to be a string!");if("string"!=typeof e)throw new Error("Id needs to be a string!");switch(t){case s:if("function"!=typeof n)throw new Error("Needs to be a function!");if(null!==this.functions[e])throw new Error("No mark!");this.functions[e]=n;break;case u:if(n instanceof Object)throw new Error("Objects are not allowed!");if(null!==this.values[e])throw new Error("No mark!");this.values[e]=n;break;case l:if(n instanceof Object)throw new Error("Objects are not allowed!");if(null!==this.constants[e])throw new Error("No mark!");Object.defineProperty(this.constants,e,{writable:!1,configurable:!1,value:n});break;case c:if("function"!=typeof n)throw new Error("Needs to be a function!");if(null!==this.components[e])throw new Error("No mark!");Object.defineProperty(this.components,e,{writable:!1,configurable:!1,value:n});break;case h:if("object"!==r(n))throw new Error("Needs to be an object");if(!0===Object(i.IsArray)(n))throw new Error("Arrays are not allowed!");if(null!==this.objects[e])throw new Error("No mark!");this.objects[e]=n;break;case f:if(!1===Object(i.IsArray)(n))throw new Error("Needs to be an array!");if(null!==this.lists[e])throw new Error("No mark!");this.lists[e]=n;break;default:throw new Error("Unrecognized type!")}}}],[{key:"Assign",value:function(e){if(window&&!e?e=window:t&&!e&&(e=t),!e)throw new Error("No global namespace");e.FUNC=s,e.VAL=u,e.CONST=l,e.COMP=c,e.OBJ=h,e.LIST=f}},{key:"Create",value:function(n){var i=i||null;if(null==i){if(null==t)throw new Error("Neither window nor global exists!");if(void 0!==t[n])throw new Error("global."+n+" already exists!");t[n]=new e}else{if(void 0!==i[n])throw new Error("window."+n+" already exists!");i[n]=new e}}},{key:"FUNCTION",get:function(){return s}},{key:"VALUE",get:function(){return u}},{key:"CONSTANT",get:function(){return l}},{key:"COMPONENT",get:function(){return c}},{key:"OBJECT",get:function(){return h}},{key:"LIST",get:function(){return f}},{key:"AllowGetNullUndefined",get:function(){return d},set:function(t){(function(t){throw new Error('"'+t+'" is read-only')})("PS_AllowGetNullUndefined"),d=!!t}}]),e}(),s="functions",u="values",l="constants",c="components",h="objects",f="lists",d=!1}).call(this,n(7))},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nuniform mat3 uProjection;\r\nuniform mat3 uTranslation;\r\nuniform mat3 uTransformation;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vTexCoord = ( uTransformation * vec3( aTexCoord, 1.0 ) ).xy;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\nuniform vec4 uTint;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  gl_FragColor = TEX( uImage, vTexCoord ) * uTint;\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nattribute vec3 aProjection1;\r\nattribute vec3 aProjection2;\r\nattribute vec3 aProjection3;\r\n\r\nattribute vec3 aTranslation1;\r\nattribute vec3 aTranslation2;\r\nattribute vec3 aTranslation3;\r\n\r\nattribute vec3 aTransformation1;\r\nattribute vec3 aTransformation2;\r\nattribute vec3 aTransformation3;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  mat3 projection = mat3( aProjection1, aProjection2, aProjection3 );\r\n  mat3 translation = mat3( aTranslation1, aTranslation2, aTranslation3 );\r\n  mat3 transformation = mat3( aTransformation1, aTransformation2, aTransformation3 );\r\n  gl_Position = vec4( ( projection * translation * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vTexCoord = ( transformation * vec3( aTexCoord, 1.0 ) ).xy;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision mediump float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n  gl_FragColor = TEX( uImage, vTexCoord );\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec3 aProjection1;\r\nattribute vec3 aProjection2;\r\nattribute vec3 aProjection3;\r\nattribute vec2 aPosition;\r\nattribute vec4 aColor;\r\nattribute float aPointSize;\r\n\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  mat3 projection = mat3( aProjection1, aProjection2, aProjection3 );\r\n  gl_Position = vec4( ( projection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  gl_PointSize = aPointSize;\r\n  vColor = aColor;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n  gl_FragColor = vColor;\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform vec2 uSize;\r\nuniform float uOutline;\r\n\r\nvarying vec2 vPosition;\r\nvarying float vBorderX;\r\nvarying float vNegBorderX;\r\nvarying float vBorderY;\r\nvarying float vNegBorderY;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vPosition = aPosition;\r\n  vBorderX = -uSize.x * 0.5 + uOutline;\r\n  vNegBorderX = uSize.x * 0.5 - uOutline;\r\n  vBorderY = -uSize.y * 0.5 + uOutline;\r\n  vNegBorderY = uSize.y * 0.5 - uOutline;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform lowp vec4 uFillColor;\r\nuniform lowp vec4 uOutlineColor;\r\n\r\nvarying vec2 vPosition;\r\nvarying float vBorderX;\r\nvarying float vNegBorderX;\r\nvarying float vBorderY;\r\nvarying float vNegBorderY;\r\n\r\nvoid main() {\r\n  if (\r\n    vPosition.x > vBorderX &&\r\n    vPosition.x < vNegBorderX && \r\n    vPosition.y > vBorderY && \r\n    vPosition.y < vNegBorderY\r\n  ) {\r\n    gl_FragColor = uFillColor;\r\n  } else {\r\n    gl_FragColor = uOutlineColor;\r\n  }\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\n\r\nvarying vec2 vPosition;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n  vPosition = aPosition;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform lowp vec4 uFillColor;\r\nuniform lowp vec4 uOutlineColor;\r\nuniform float uRadius;\r\nuniform float uOutline;\r\n\r\nvarying vec2 vPosition;\r\n\r\nvoid main() {\r\n  float d = dot( vPosition, vPosition );\r\n  float rs = uRadius * uRadius;\r\n  float ors = uRadius - uOutline;\r\n  ors = ors * ors;\r\n  if ( d < rs && d > ors ) {\r\n    gl_FragColor = uOutlineColor;\r\n  } else if ( d < rs ) {\r\n    gl_FragColor = uFillColor;\r\n  }\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision mediump float;\r\n\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform lowp vec4 uColor;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision mediump float;\r\n\r\nuniform lowp vec4 uColor;\r\n\r\nvoid main() {\r\n  gl_FragColor = uColor;\r\n}\r\n@fragment-end@"},function(t,e){t.exports="/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision lowp float;\r\n\r\nattribute vec2 a_v2Position;\r\n\r\nuniform mat3 u_m3Projection;\r\n\r\nvarying vec2 v_v2Position;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( u_m3Projection * vec3( a_v2Position, 1.0 ) ).xy, 0.0, 1.0 );\r\n  v_v2Position = a_v2Position;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision lowp float;\r\n\r\nuniform float u_fTime;\r\nuniform vec2 u_v2Resolution;\r\n\r\nvarying vec2 v_v2Position;\r\n\r\nvoid main() {\r\n\r\n  vec2 pos = v_v2Position / u_v2Resolution;\r\n\r\n  //pos.x -= v_v2Position.x;\r\n\r\n  float r = sqrt( dot( pos, pos ) ) * 1.9 - sin ( u_fTime ) * 0.2;\r\n  float a = atan( pos.x, pos.y ) + sin ( 0.9 * u_fTime );\r\n  float s = 0.5 + 0.4999 * sin( 12.0 * a );\r\n  float t = 0.15 + 0.35 * pow( s, 0.1 * sin( u_fTime ) * 0.5 );\r\n  t += 0.1 * pow( 0.5 + 0.5 * cos( 24.0 * a ), 0.5 );\r\n  float h = r / t;\r\n  float f = 0.0;\r\n  f = smoothstep( h-0.05, h+0.05, 1.0 );\r\n\r\n  vec4 color = vec4( mix( vec3( f ), vec3( 0.5 + 0.5 * h, h, 0.5 * h ), f ), f );\r\n\r\n  gl_FragColor = color;\r\n\r\n\r\n}\r\n@fragment-end@"},function(t,e,n){t.exports=n(17)},function(t,e,n){n(18);var i=n(0);console.log(i),i.Utility.PRINT_VERSION(),i.Sprite.BUILD_DEFAULT_TEXTURE(function(){i.Tilesprite.BUILD_DEFAULT_TEXTURE(function(){var t=new i.Load.XHRLoader,e=new i.Load.ImageLoader,r=new i.Load.SpritesheetLoader,o=0;function a(){if(!(o<3)){var i=[];window.testData={xhrloader:t,imgloader:e,ssloader:r};var a=n(25);a.keys().forEach(function(t){i.push(a(t))});for(var s=0,u=i.length;s<u;++s)i[s].default()}}t.Load([{id:"fontdataxml",src:"./assets/xhr/font.fnt",type:"xml"},{id:"fontdatajson",src:"./assets/xhr/font.json",type:"json"},{id:"fontNoK",src:"./assets/xhr/fontNoK.xml",type:"xml"},{id:"particleExplosion",src:"./assets/xhr/particle-explosion.json",type:"json"}]),e.Load([{id:"fontimg",src:"./assets/images/font.png"},{id:"fontNoK",src:"./assets/images/fontNoK.png"},{id:"1to8",src:"./assets/images/1to8.png"},{id:"4dots",src:"./assets/images/4dots.png"},{id:"colors",src:"./assets/images/colors.png"},{id:"glass-of-blueberryjuice",src:"./assets/images/glass-of-blueberryjuice.png"},{id:"raindrop",src:"./assets/images/raindrop.png"},{id:"smudge",src:"./assets/images/smudge.png"}],!0),r.Load([{id:"sheet-default",image:{src:"./../assets/images/invaders/invaders-sheet.png"},data:{src:"./../assets/xhr/invaders.json",type:"json"}}]),t.onComplete.Add(function(t){console.log(t.data),console.log(JSON.stringify(t.data.dataCache.items[0].data)===JSON.stringify(t.data.dataCache.items[1].data)),o++,a()}),e.onComplete.Add(function(t){console.log(t.data),o++,a()}),r.onComplete.Add(function(t){console.log(t.data),o++,a()})})})},function(t,e,n){},,function(t,e){Array.prototype.indexPop=function(t){var e=this.length-1;if(e>1&&t<=e&&t>=0){var n=this[e];return this[e]=this[t],this[t]=n,this.pop()}return this.pop()},Array.prototype.indexShift=function(t){if(this.length>1&&t<=this.length-1&&t>=0){var e=this[0];return this[0]=this[t],this[t]=e,this.shift()}return this.shift()},Array.prototype.popSplice=function(t){var e=this.length-1;if(!(e<1)){for(var n=this[t];t<e;)this[t]=this[t+1],t++;return this.pop(),n}},Array.prototype.shiftSplice=function(t){if(!(this.length<1)){for(var e=this[t];t>0;)this[t]=this[t-1],t--;return this.shift(),e}},Array.prototype.fickleSplice=function(t){return t>.5*this.length|0?this.popSplice(t):this.shiftSplice(t)}},function(t){t.exports={name:"nenkraft2",version:"1.0.2",description:"A small rendering tool",main:"./bundle-fe/nk2.js",devDependencies:{"@babel/core":"^7.0.0","@babel/preset-env":"^7.0.0","babel-loader":"^8.0.2","copy-webpack-plugin":"^4.5.2","css-loader":"^1.0.0",eslint:"^5.5.0","file-loader":"^2.0.0","html-loader":"^0.5.5","html-webpack-plugin":"^3.2.0","mini-css-extract-plugin":"^0.4.2","raw-loader":"^0.5.1",rimraf:"^2.6.2",webpack:"^4.17.2","webpack-cli":"^3.1.0","webpack-dev-server":"^3.1.8"},dependencies:{},scripts:{"build-prod":"webpack --env production --mode production","build-bundle-fe":"webpack --env bundle-fe --mode production","build-bundle-be":"webpack --env bundle-be --mode production",start:"webpack-dev-server --env development --mode development","clear-bundle-fe":"rimraf bundle-fe/dist","clear-bundle-be":"rimraf bundle-be/dist","clear-dist":"rimraf dist",ce:"rimraf dist bundle-fe/dist bundle-be/dist",be:"npm run ce && npm run build-prod && npm run build-bundle-be && npm run build-bundle-fe","lint-f":"eslint src demos --fix",lint:"eslint src demos"},keywords:["2d","rendering","command","vector","game","graphic","tween","animation","collision","canvas","web","webgl","utilities"],author:"nuuf",license:"MIT"}},function(t,e){t.exports="float circle( vec2 pos, float radius ) {\r\n\r\n  float dist = dot( pos, pos );\r\n  \r\n  return step( dist, radius * radius );\r\n\r\n}"},function(t,e){t.exports="float line ( float axis, float percent, float prec ) {\r\n\r\n  return plot( axis, percent, prec );\r\n\r\n}"},function(t,e){t.exports="float plot( float axis, float percent, float prec ){\r\n\r\n  return (\r\n    smoothstep( percent - prec, percent, axis ) -\r\n    smoothstep( percent, percent + prec, axis )\r\n  );\r\n\r\n}"},function(t,e,n){var i={"./playground/pg.un.demo":26,"./solid/01.sprite.demo":27,"./solid/02.graphic2d.demo":28,"./solid/03.container2d.demo":29,"./solid/04.bitmap-text.demo":30,"./solid/05.stage2d.demo":31,"./solid/06.stadium.demo":32,"./solid/07.canvas-manager.demo":33,"./solid/08.camera2d.demo":34,"./solid/09.basic-setup.demo":35,"./solid/10.tilesprite.demo":36,"./solid/11.text.demo":37,"./solid/12.geom.demo":38,"./solid/13.collision-aabb2d.demo":39,"./solid/14.collision-circle.demo":40,"./solid/15.collision-polygon2d.demo":41,"./solid/16.collision-line2d-circle.demo":42,"./solid/17.create-texture.demo":43,"./solid/18.animation.demo":44,"./solid/19.quadtree.demo":45,"./solid/20.ray-casting.demo":46,"./solid/21.particle-system.demo":47,"./solid/22.webgl-animation.demo":48,"./solid/23.webgl-circle.demo":49,"./solid/24.webgl-rectangle.demo":50,"./solid/25.webgl-line2d.demo":51,"./solid/26.webgl-pixelbatch.demo":52,"./solid/27.webgl-texture2dbatch.demo":53,"./solid/28.webgl-bitmap-text.demo":54,"./solid/29.webgl-tilesprite.demo":55,"./solid/30.stresstest.demo":56,"./solid/31.webgl-stresstest.demo":57,"./solid/32.utilities.demo":58,"./solid/33.motion.demo":59,"./solid/34.interaction.demo":60};function r(t){var e=o(t);return n(e)}function o(t){var e=i[t];if(!(e+1)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return e}r.keys=function(){return Object.keys(i)},r.resolve=o,t.exports=r,r.id=25},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("PGUNDEMO",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1,mode:"WebGL"},i=t.stage=new r.Stage2D(n),o=new r.Container2D(0,0),a=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),s=new r.Container2D(300,200);i.gl.clearColor(.9,.9,.9,1),a.force.SetSame(5),i.AddChild(o).AddChild(a).AddChild(s),new r.CanvasManager(e,600,400,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(i).BindRootContainer(o).Trigger();for(var u=new r.Controller.ProgramController.GLUnProgramController(i.gl,r.Shader.UN),l=50;l--;){var c=new r.GLEntity2D(0,0,u);c.transformAutomaticUpdate=!0,c.transformShouldUpdate=!0;var h=r.Utility.RandomFloat(1,10);c.w=c.h=32*h,c.timeInc=.05/h,c.ComputeBounds({x:.5,y:.5}),c.position.Set(r.Utility.RandomInteger(-300,300),r.Utility.RandomInteger(-200,200)),s.AddChild(c)}i.mouse.AddOffset(s).AddOffset(a),i.onProcess.Add(function(){a.Process()}),i.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("Sprite",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new r.Sprite(i,o);s.anchor.SetSame(.5),s.Draw(a.getContext("2d"))})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("Graphic2D",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new r.Path.Circle(0,0,50);new r.Graphic2D(i,o,s).Draw(a.getContext("2d"))})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("Container2D",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new r.Sprite(i,o);s.anchor.SetSame(.5);var u=new r.Container2D(0,0);u.AddChild(s),u.Draw(a.getContext("2d"))})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("BitmapText",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute",a.style.backgroundColor="white";var s=a.getContext("2d"),u=new r.BitmapText(0,0,window.testData.imgloader.GetBasicTextureById("fontNoK"),window.testData.xhrloader.GetDataById("fontNoK"),"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.");u.scale.SetSame(.6),u.x=i-.5*u.width,u.y=o-.5*u.height,u.Draw(s)})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("Stage2D",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s={canvas:a,x:i,y:o,halt:!0},u=t.stage=new r.Stage2D(s);u.ticker.StartAF(),u.onProcess.Add(function(){console.log("tick"),u.onProcess.Dump()})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("Stadium",function(t){var e={className:"mcnvs",width:600,height:400,mode:"2d",x:0,y:0,fill:!1},n=t.stadium=new r.Stadium(e);function i(){this.children.forEach(o)}function o(t){t.position.AddV(t.data.velocity),t.data.velocity.Rotate(t.data.torque)}n.CreateStage2D("stage1"),n.CreateStage2D("stage2"),n.CreateStage2D("stage3"),n.CreateStage2D("stage4"),n.GetStages("stage1","stage2","stage3").forEach(function(t){for(var e=10;e--;){var n=t.AddChild(new r.Graphic2D(r.Utility.RandomFloat(100,500),r.Utility.RandomFloat(50,350),new r.Path.Circle(0,0,r.Utility.RandomInteger(10,50))));n.data.velocity=new r.Vector2D(r.Utility.RandomFloat(-1,1),r.Utility.RandomFloat(-1,1)),n.data.torque=r.Utility.RandomFloat(-r.Math.RADIAN,r.Math.RADIAN)}t.onProcess.Add(i,t)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("CanvasManager",function(t){var e=1920,n=1080,i=t.canvas=document.createElement("canvas");document.body.appendChild(i),i.setAttribute("width",e),i.setAttribute("height",n),i.style.display="initial",i.style.position="absolute";var o={canvas:i,x:960,y:540,halt:!1},a=t.stage=new r.Stage2D(o),s=new r.Container2D(0,0);(t.canvasManager=new r.CanvasManager(i,e,n,r.CanvasManager.KEEP_ASPECT_RATIO_FIT)).BindStage(a).BindRootContainer(s).Trigger()})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("Camera2D",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s={canvas:a,x:i,y:o,halt:!0},u=t.stage=new r.Stage2D(s),l=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),c=new r.Container2D(0,0),h=new r.Sprite(0,0);u.AddChild(l).AddChild(c).AddChild(h),u.mouse.AddOffset(l),u.ticker.StartAF(),u.onProcess.Add(function(){l.Process()}),u.mouse.onDown.Add(function(t){l.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("BasicSetup",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1},i=t.stage=new r.Stage2D(n),o=new r.Container2D(0,0),a=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),s=new r.Container2D(300,200),u=new r.Sprite(0,0);a.force.SetSame(5),u.anchor.SetSame(.5),i.AddChild(o).AddChild(a).AddChild(s).AddChild(u),new r.CanvasManager(e,600,400,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(i).BindRootContainer(o).Trigger(),i.mouse.AddOffset(s).AddOffset(a),i.onProcess.Add(function(){a.Process()}),i.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("Tilesprite",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=a.getContext("2d"),u=new r.Tilesprite(i,o,r.Tilesprite.DEFAULT_TEXTURE);u.GeneratePattern(s,640,640),u.x=i-.5*u.width,u.y=o-.5*u.height,u.Draw(s)})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("Text",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute",a.style.backgroundColor="white";var s=a.getContext("2d"),u=new r.Text(i,o,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.");u.style.text.align=r.Style.TextConf.ALIGN_CENTER,u.style.text.baseline=r.Style.TextConf.BASELINE_MIDDLE,u.style.text.lineWidth=.3,u.style.text.font="40px Arial",u.Draw(s)})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("Geom",function(t){var e=window.innerWidth,n=window.innerHeight,i=t.canvas=document.createElement("canvas");document.body.appendChild(i),i.setAttribute("width",e),i.setAttribute("height",n),i.style.display="initial",i.style.position="absolute";var o=i.getContext("2d"),a=new r.Path.Circle(0,0,50),s=new r.Path.AABB2D(0,0,100,100),u=new r.Path.Polygon2D,l=new r.Path.Line2D(0,0,100,100),c=new r.Path.Polygon2D,h=new r.Path.Polygon2D;r.Geom.PolygonConstruction.Butterfly(u,0,0,1e3,50),r.Geom.PolygonConstruction.Star(c,0,0,100,50,5),r.Geom.PolygonConstruction.Rose(h,0,0,100,7/9,1e3,9);var f=new r.Graphic2D(100,100,a),d=new r.Graphic2D(200,100,s),p=new r.Graphic2D(350,100,l),y=new r.Graphic2D(600,200,u),v=new r.Graphic2D(100,300,c),m=new r.Graphic2D(400,400,h);f.Draw(o),d.Draw(o),p.Draw(o),y.Draw(o),v.Draw(o),m.Draw(o)})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("CollisionAABB2D",function(t){var e=1920,n=1080,i=t.canvas=document.createElement("canvas");document.body.appendChild(i),i.setAttribute("width",e),i.setAttribute("height",n),i.style.display="initial",i.style.position="absolute";var o={canvas:i,x:0,y:0,halt:!1},a=t.stage=new r.Stage2D(o),s=new r.Container2D(0,0),u=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),l=new r.Container2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new r.CanvasManager(i,e,n,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u);var c=r.Collision.AABB2DvsAABB2D.CollideRel,h=new r.Collision.AABB2DvsAABB2D.Result,f=l.AddChild(new r.Graphic2D(0,100,new r.Path.AABB2D(0,0,50,50))),d=l.AddChild(new r.Graphic2D(0,0,new r.Path.AABB2D(0,0,400,100))),p={shape:f.path,relative:f.position},y={shape:d.path,relative:d.position},v=new r.Vector2D(0,0),m=new r.Vector2D(0,0),b=null;a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){for(var e=l.children.length,n=t.data.position;e--;)if(l.children[e].IntersectsPoint(n)){v.SetV(n),b=l.children[e],m.SetV(b.position),t.stopPropagation=!0,b.SendToFront();break}b||u.target.position.SetV(n)}),a.mouse.onMove.Add(function(t){if(b){var e=t.data.position;b.position.SetV(e).AddV(m).SubtractV(v),h.Reset(),c(p,y,h),h.occured&&p.relative.AddV(h.mtv)}},a),a.mouse.onUp.Add(function(){b&&(b=null)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("CollisionCircle",function(t){var e=5760,n=3240,i=2880,o=1620,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s={canvas:a,x:0,y:0,halt:!1},u=t.stage=new r.Stage2D(s),l=new r.Container2D(0,0),c=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),h=new r.Container2D(i,o);c.force.SetSame(5),u.AddChild(l).AddChild(c).AddChild(h);for(var f=new r.CanvasManager(a,e,n,r.CanvasManager.KEEP_ASPECT_RATIO_FIT),d=[],p=r.Collision.CirclevsCircle.CollideRel,y=r.Collision.CirclevsCircle.ElasticResponse,v=new r.Collision.CirclevsCircle.Result,m=50;m--;){var b=r.Utility.RandomInteger(50,125),g=new r.Path.Circle(0,0,b),w=new r.Graphic2D(r.Utility.RandomFloat(-i,i),r.Utility.RandomFloat(-o,o),g);w.data.body={shape:g,relative:w.position,mass:b,velocity:new r.Vector2D(r.Utility.RandomInteger(-30,30),r.Utility.RandomInteger(-30,30))},d.push(w.data.body),h.AddChild(w)}f.BindStage(u).BindRootContainer(l).Trigger(),u.mouse.AddOffset(h).AddOffset(c),u.onProcess.Add(function(){c.Process();for(var t,e,n=0,r=0,a=d.length;n<a;++n)for((t=d[n]).relative.AddV(t.velocity),t.relative.x>i?(t.relative.x=i,t.velocity.x=-t.velocity.x):t.relative.x<-i&&(t.relative.x=-i,t.velocity.x=-t.velocity.x),t.relative.y>o?(t.relative.y=o,t.velocity.y=-t.velocity.y):t.relative.y<-o&&(t.relative.y=-o,t.velocity.y=-t.velocity.y),r=0;r<a;++r)t!==(e=d[r])&&(v.Reset(),p(t,e,v),v.occured&&y(t,e,v))}),u.mouse.onDown.Add(function(t){c.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("CollisionPolygon2D",function(t){var e=1920,n=1080,i=t.canvas=document.createElement("canvas");document.body.appendChild(i),i.setAttribute("width",e),i.setAttribute("height",n),i.style.display="initial",i.style.position="absolute";var o={canvas:i,x:0,y:0,halt:!1},a=t.stage=new r.Stage2D(o),s=new r.Container2D(0,0),u=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),l=new r.Container2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l);for(var c=new r.CanvasManager(i,e,n,r.CanvasManager.KEEP_ASPECT_RATIO_FIT),h=[],f=r.Collision.PolygonvsPolygon.CollideRel,d=new r.Collision.PolygonvsPolygon.Result,p=new r.Vector2D(0,0),y=new r.Vector2D(0,0),v=null,m=100;m--;){var b=new r.Path.Polygon2D;r.Geom.PolygonConstruction.Cyclic(b,0,0,r.Utility.RandomInteger(30,60),r.Utility.RandomInteger(3,6));var g=new r.Graphic2D(0,0,b);g.data.body={shape:b,relative:g.position},h.push(g.data.body),l.AddChild(g)}c.BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process();for(var t,e,n=0,i=0,r=h.length;n<r;++n)for(t=h[n],i=0;i<r;++i)t!==(e=h[i])&&(d.Reset(),f(t,e,d),d.occured&&(v?(t.relative!==v.position&&t.relative.SubtractV(d.mtv),e.relative!==v.position&&e.relative.AddV(d.mtv)):(d.mtv.Multiply(.5,.5),t.relative.SubtractV(d.mtv),e.relative.AddV(d.mtv))))}),a.mouse.onDown.Add(function(t){for(var e=l.children.length,n=t.data.position;e--;)if(l.children[e].IntersectsPoint(n)){p.SetV(n),v=l.children[e],y.SetV(v.position),t.stopPropagation=!0,v.SendToFront();break}v||u.target.position.SetV(n)}),a.mouse.onMove.Add(function(t){if(v){var e=t.data.position;v.position.SetV(e).AddV(y).SubtractV(p)}},a),a.mouse.onUp.Add(function(){v&&(v=null)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("CollisionLine2DCircle",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1},i=t.stage=new r.Stage2D(n),o=new r.Container2D(0,0),a=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),s=new r.Container2D(300,200);a.force.SetSame(5),i.AddChild(o).AddChild(a).AddChild(s),new r.CanvasManager(e,600,400,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(i).BindRootContainer(o).Trigger();for(var u=[],l=[],c=50;c--;){var h=new r.Path.Circle(0,0,r.Utility.RandomInteger(5,8)),f=new r.Graphic2D(0,0,h);f.data.body={shape:h,relative:f.position,velocity:new r.Vector2D(r.Utility.RandomFloat(-4,4),r.Utility.RandomFloat(-4,4))},s.AddChild(f),u.push(f.data.body)}for(var d=50;d--;){var p=new r.Path.Line2D(0,0,r.Utility.RandomInteger(10,25),r.Utility.RandomInteger(10,25)),y=new r.Graphic2D(r.Utility.RandomInteger(-300,300),r.Utility.RandomInteger(-200,200),p);p.Rotate(r.Math.RADIAN*r.Utility.RandomInteger(0,360)),y.data.body={shape:p,relative:y.position},s.AddChild(y),l.push(y.data.body)}var v=r.Collision.CirclevsLine.CollideRel,m=r.Collision.CirclevsLine.ReflectingResponse,b=new r.Collision.CirclevsLine.Result;i.mouse.AddOffset(s).AddOffset(a),i.onProcess.Add(function(){var t,e;a.Process();for(var n=0;n<u.length;++n){(t=u[n]).relative.AddV(t.velocity),t.relative.y<-200&&(t.relative.y=-200,t.velocity.y*=-1),t.relative.y>200&&(t.relative.y=200,t.velocity.y*=-1),t.relative.x<-300&&(t.relative.x=-300,t.velocity.x*=-1),t.relative.x>300&&(t.relative.x=300,t.velocity.x*=-1);for(var i=0;i<l.length;++i)e=l[i],b.Reset(),v(t,e,b),b.occured&&m(t,e,b)}}),i.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("CreateTexture",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new Image;s.onload=function(){var t=new r.Sprite(i,o,new r.Texture.BasicTexture2D(s));t.anchor.Set(.5,.5),t.Draw(a.getContext("2d"))},s.src=r.BrowserUtility.GenerateSimpleBase64PNG(function(){var t=new r.Path.Polygon2D;return r.Geom.PolygonConstruction.Supershape(t,0,0,100,100,6,.3,.3,.3),new r.Graphic2D(Math.abs(t.aabb.tl.x),Math.abs(t.aabb.tl.y),t)},null,null,"white")})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("Animation",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1},i=t.stage=new r.Stage2D(n),o=new r.Container2D(0,0),a=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),s=new r.Container2D(300,200);a.force.SetSame(5),i.AddChild(o).AddChild(a).AddChild(s),new r.CanvasManager(e,600,400,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(i).BindRootContainer(o).Trigger();var u=new r.Sprite(0,0,window.testData.imgloader.GetBasicTextureById("1to8"));u.anchor.SetSame(.5),s.AddChild(u);var l=(u.animationController=new r.Animator.Controller(u)).CreateAnimation("play",25);u.width=64,u.height=64,l.GenerateFrames(64,64,512,64,8,{5:10,3:8,1:6}),l.reverse=!0,l.loop=!0,l.Start(),l.onEnd.Add(function(){console.log("end")}),i.mouse.AddOffset(s).AddOffset(a),i.onProcess.Add(function(){a.Process(),l.Process()}),i.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("Quadtree",function(t){var e=window.innerWidth,n=window.innerHeight,i=t.canvas=document.createElement("canvas");document.body.appendChild(i),i.setAttribute("width",e),i.setAttribute("height",n),i.style.display="initial",i.style.position="absolute";var o={canvas:i,x:0,y:0,halt:!1},a=t.stage=new r.Stage2D(o),s=new r.Geom.AABB2D(0,0,e,n),u=new r.QuadtreeNode(s,0,4,5),l=[],c=[];a.onProcess.Add(function(){l.forEach(function(t){r.Debug.Draw.AABB2D(a.rc,t.aabb)})}),a.mouse.onDown.Add(function(t){var e=new r.Graphic2D(t.data.position.x,t.data.position.y,new r.Path.AABB2D(0,0,10,10));e.ComputeBounds(e.anchor),a.AddChild(e),c.push(e),u.Dump(),c.forEach(function(t){u.Add(t.bounds)}),l.length=0,u.ConcatNodes(l)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("RayCasting",function(t){var e=1920,n=1080,i=t.canvas=document.createElement("canvas");document.body.appendChild(i),i.setAttribute("width",e),i.setAttribute("height",n),i.style.display="initial",i.style.position="absolute";var o={canvas:i,x:0,y:0,halt:!1},a=t.stage=new r.Stage2D(o),s=new r.Container2D(0,0),u=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),l=new r.Container2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new r.CanvasManager(i,e,n,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();for(var c=[],h=[],f=100;f--;){var d=new r.Path.Polygon2D;r.Geom.PolygonConstruction.Cyclic(d,r.Utility.RandomInteger(-e,e),r.Utility.RandomInteger(-n,n),r.Utility.RandomInteger(30,60),r.Utility.RandomInteger(3,8)),d.Rotate(r.Utility.RandomFloat(0,r.Math.PII));var p=new r.Graphic2D(0,0,d);c.push(p)}for(var y=180,v=2*Math.PI/y;y--;){var m=v*y,b=new r.Path.Ray2D(0,0,0,0);b.style.stroke.lineWidth=1;var g=new r.Graphic2D(0,0,b);g.interactive=!1,g.data.angle=m,g.data.r=360,h.push(g)}l.Mount(c.concat(h)),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process(),h.forEach(function(t){t.path.s.SetV(a.mouse.position),t.path.e.SetV(t.path.s),t.path.e.Add(t.data.r,t.data.r),t.path.e.RotateAroundV(t.path.s,t.data.angle)});for(var t,e,n,i,o=0,s=0,l=0,f=0,d=h[o],p=h.length,y=c.length,v=0;o<p;d=h[++o])for(t=c[s=0];s<y;t=c[++s])for(l=0,f=(v=t.path.vertices.length)-1;l<v;f=l++)e=t.path.vertices[l],n=t.path.vertices[f],(i=r.Math.LineLineIntersection(d.path.s,d.path.e,e,n))&&(h[o].path.e.SetV(i),i.Store(),i=null)}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("ParticleSystem",function(t){var e=1920,n=1080,i=t.canvas=document.createElement("canvas");document.body.appendChild(i),i.setAttribute("width",e),i.setAttribute("height",n),i.style.display="initial",i.style.position="absolute";var o={canvas:i,x:0,y:0,halt:!1},a=t.stage=new r.Stage2D(o),s=new r.Container2D(0,0),u=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),l=new r.Container2D(960,540),c=new r.Particle.Particle2D.System(0,0),h=window.testData.xhrloader.GetClonedDataById("particleExplosion"),f=new r.Time.Timer(10),d=new r.Geom.Polygon2D;r.Geom.PolygonConstruction.Cyclic(d,0,0,400,72);var p=d.Copy();p.vertices.forEach(function(t){t.Invert(),t.Multiply(.1,.1)}),f.onFinish.Add(function(){c.Emit(h),f.Start()}),f.Start(),h.texture=r.Sprite.DEFAULT_TEXTURE,h.position={points:d.vertices,moduloWrapper:d.vertices.length},h.velocity={points:p.vertices,moduloWrapper:p.vertices.length},u.force.SetSame(.1),a.AddChild(s).AddChild(u).AddChild(l).AddChild(c),new r.CanvasManager(i,e,n,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger(),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process(),c.Process(),f.Process()}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("WebGLAnimation",function(t){var e=400/3,n=t.canvas=document.createElement("canvas");document.body.appendChild(n),n.setAttribute("width",200),n.setAttribute("height",e),n.style.display="initial",n.style.position="absolute";var i={canvas:n,x:0,y:0,halt:!1,mode:"WebGL",antialias:!0},o=t.stage=new r.Stage2D(i),a=new r.Container2D(0,0),s=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),u=new r.Container2D(100,66.66666666666667);s.force.SetSame(5),o.AddChild(a).AddChild(s).AddChild(u),new r.CanvasManager(n,200,e,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(o).BindRootContainer(a).Trigger(),o.mouse.AddOffset(u).AddOffset(s);var l=new r.Controller.ProgramController.GLDynamicTexture2DProgramController(o.gl,2);l.BindBasicTexture(r.Sprite.DEFAULT_TEXTURE,0),l.BindBasicTexture(window.testData.imgloader.GetBasicTextureById("1to8"),1);var c=new r.Sprite(0,0,l,1),h=new r.Sprite(0,0,l,0);c.anchor.SetSame(.5),h.anchor.SetSame(.5),h.UpdateTextureTransform(),h.alpha=.5,u.AddChildren(c,h);var f=(c.animationController=new r.Animator.Controller(c)).CreateAnimation("play",25);c.width=64,c.height=64,f.GenerateFrames(64,64,512,64,8,{5:10,3:8,1:6}),f.loop=!0,f.Start(),o.onProcess.Add(function(){s.Process(),f.Process()}),o.mouse.onDown.Add(function(t){s.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("WebGLCircle",function(t){var e=1920,n=1080,i=t.canvas=document.createElement("canvas");document.body.appendChild(i),i.setAttribute("width",e),i.setAttribute("height",n),i.style.display="initial",i.style.position="absolute";var o={canvas:i,x:0,y:0,halt:!1,mode:"WebGL"},a=t.stage=new r.Stage2D(o),s=new r.Container2D(0,0),u=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),l=new r.Container2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new r.CanvasManager(i,e,n,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();for(var c=new r.Controller.ProgramController.GLCircleProgramController(a.gl),h=1e3;h--;){var f=new r.Path.Circle(0,0,50);f.style.stroke.lineWidth=1,f.LinkProgramController(c);var d=new r.Graphic2D(r.Utility.RandomInteger(-960,960),r.Utility.RandomInteger(-540,540),f);l.Mount(d)}a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("WebGLRectangle",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1,mode:"WebGL"},i=t.stage=new r.Stage2D(n),o=new r.Container2D(0,0),a=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),s=new r.Container2D(300,200);a.force.SetSame(5),i.AddChild(o).AddChild(a).AddChild(s),new r.CanvasManager(e,600,400,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(i).BindRootContainer(o).Trigger();var u=new r.Controller.ProgramController.GLRectangleProgramController(i.gl),l=new r.Path.AABB2D(-100,-100,100,100);l.style.stroke.lineWidth=1,l.LinkProgramController(u);var c=new r.Graphic2D(0,0,l);s.Mount(c),i.mouse.AddOffset(s).AddOffset(a),i.onProcess.Add(function(){a.Process(),c.rotation+=r.Math.RADIAN}),i.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("WebGLLine2D",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1,mode:"WebGL"},i=t.stage=new r.Stage2D(n),o=new r.Container2D(0,0),a=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),s=new r.Container2D(300,200);a.force.SetSame(5),i.AddChild(o).AddChild(a).AddChild(s),new r.CanvasManager(e,600,400,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(i).BindRootContainer(o).Trigger();var u=new r.Controller.ProgramController.GLLine2DProgramController(i.gl),l=new r.Path.Line2D(-100,-100,100,100);l.style.stroke.lineWidth=1,l.LinkProgramController(u);var c=new r.Graphic2D(0,0,l);s.Mount(c),i.mouse.AddOffset(s).AddOffset(a),i.onProcess.Add(function(){a.Process(),c.rotation+=r.Math.RADIAN}),i.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("WebGLPixelBatch",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1,mode:"WebGL"},i=t.stage=new r.Stage2D(n),o=new r.Container2D(0,0),a=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),s=new r.Container2D(300,200);a.force.SetSame(5),i.AddChild(o).AddChild(a).AddChild(s),new r.CanvasManager(e,600,400,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(i).BindRootContainer(o).Trigger();var u=new r.Container2D(0,0),l=new r.Controller.ProgramController.GLPixelBatchProgramController(i.gl);s.AddChild(u),u.UseAsBatchParent(l);for(var c=2e4;c--;){var h=new r.Path.Pixel(0,0);h.color.r=0,h.color.g=Math.random(),h.color.b=.8,h.color.a=r.Utility.RandomFloat(.1,.6),h.style.pixel.size=r.Utility.RandomFloat(1,2);var f=new r.Graphic2D(0,0,h);f.data.velocity=new r.Vector2D(r.Utility.RandomFloat(-2,2),r.Utility.RandomFloat(-2,2)),f.data.torque=r.Utility.RandomFloat(20*-r.Math.RADIAN,20*r.Math.RADIAN),u.Mount(f),f.UpdateTransform()}u.ComputeBatchBuffer(),i.mouse.AddOffset(s).AddOffset(a),i.onProcess.Add(function(){var t;a.Process();for(var e=0;e<u.children.length;++e)(t=u.children[e]).data.velocity.Rotate(t.data.torque),t.position.AddV(t.data.velocity),t.UpdateInBuffer()}),i.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("WebGLTexture2DBatch",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1,mode:"WebGL"},i=t.stage=new r.Stage2D(n),o=new r.Container2D(0,0),a=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),s=new r.Container2D(300,200),u=new r.Sprite(0,0);a.force.SetSame(5),u.anchor.SetSame(.5),i.AddChild(o).AddChild(a).AddChild(s).AddChild(u),new r.CanvasManager(e,600,400,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(i).BindRootContainer(o).Trigger();var l=new r.Container2D(0,0),c=new r.Controller.ProgramController.GLTexture2DBatchProgramController(i.gl);c.BindBasicTexture(window.testData.imgloader.GetBasicTextureById("colors")),s.AddChild(l),l.UseAsBatchParent(c);for(var h=5e3;h--;){var f=new r.Sprite(0,0,c.originalTexture);f.w=64,f.h=64,f.scale.SetSame(.05),f.anchor.SetSame(.5),f.animationController=new r.Animator.Controller(f);var d=f.animationController.CreateAnimation("animation",60);d.GenerateFrames(64,64,1024,64,16),d.SetFrame(r.Utility.RandomInteger(0,15)),f.data.velocity=new r.Vector2D(r.Utility.RandomFloat(-2,2),r.Utility.RandomFloat(-2,2)),f.data.torque=r.Utility.RandomFloat(20*-r.Math.RADIAN,20*r.Math.RADIAN),l.Mount(f),f.UpdateTransform()}l.ComputeBatchBuffer(),i.mouse.AddOffset(s).AddOffset(a),i.onProcess.Add(function(){var t;a.Process();for(var e=0;e<l.children.length;++e)(t=l.children[e]).data.velocity.Rotate(t.data.torque),t.position.AddV(t.data.velocity),t.UpdateInBuffer()}),i.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("WebGLBitmapText",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1,mode:"WebGL"},i=t.stage=new r.Stage2D(n),o=new r.Container2D(0,0),a=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),s=new r.Container2D(300,200);i.gl.clearColor(1,1,1,1),a.force.SetSame(5),i.AddChild(o).AddChild(a).AddChild(s),new r.CanvasManager(e,600,400,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(i).BindRootContainer(o).Trigger();var u=new r.Controller.ProgramController.GLTexture2DProgramController(i.gl);u.BindBasicTexture(window.testData.imgloader.GetBasicTextureById("fontimg"));var l=new r.BitmapText(0,0,u,window.testData.xhrloader.GetDataById("fontdataxml"),"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.");l.scale.SetSame(.3),l.x=.5*-l.width,l.y=.5*-l.height,s.AddChild(l),i.mouse.AddOffset(s).AddOffset(a),i.onProcess.Add(function(){a.Process()}),i.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("WebGLTilesprite",function(t){var e=960,n=540,i=t.canvas=document.createElement("canvas");document.body.appendChild(i),i.setAttribute("width",e),i.setAttribute("height",n),i.style.display="initial",i.style.position="absolute";var o={canvas:i,x:0,y:0,halt:!1,mode:"WebGL"},a=t.stage=new r.Stage2D(o),s=new r.Container2D(0,0),u=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),l=new r.Container2D(480,270);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new r.CanvasManager(i,e,n,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();var c=new r.Controller.ProgramController.GLTexture2DProgramController(a.gl);c.BindBasicTexture(r.Tilesprite.DEFAULT_TEXTURE);var h=new r.Tilesprite(-240,-135,c);h.GeneratePattern(null,480,270),l.AddChild(h),a.mouse.AddOffset(l).AddOffset(u),a.onProcess.Add(function(){u.Process(),h.OffsetPattern(1,1)}),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("Stresstest",function(t){var e=window.innerWidth,n=window.innerHeight,i=t.canvas=document.createElement("canvas");document.body.appendChild(i),i.setAttribute("width",e),i.setAttribute("height",n),i.style.display="initial",i.style.position="absolute";var o=i.getContext("2d"),a=new r.Container2D(0,0),s=t.ticker=new r.Time.Ticker(function(){o.setTransform(1,0,0,1,0,0),o.fillStyle="rgba(0,0,0,1)",o.fillRect(0,0,e,n),a.Draw(o),d.Process()},1e3,!0),u=20,l=0,c=35,h=[],f=new r.Pool,d=new r.Time.Timer;f.Flood(function(){var t=new r.Sprite(Math.random()*e,Math.random()*n);return t.transformAutomaticUpdate=!1,t},2e4),d.onFinish.Add(function(){var t=c;for(c=c<3?3:c--;t--;)a.AddChild(f.Retrieve());if(s.GetTPS()>40||l++<20)this.Start(1);else{var e=a.children.length;console.log(e,s.GetTPS()),a.children.forEach(function(t){f.Store(t)}),a.Dump(),l=0,h.push(e),--u>0?this.Start(120):(h.sort(function(t,e){return t-e}),console.log(h,"\nMIN: "+h[0],"MED: "+h[Math.round(h.length/2)],"MAX: "+h[h.length-1]))}},d),s.Start(),d.Start(120)})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("WebGLStresstest",function(t){var e=window.innerWidth,n=window.innerHeight,i=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=a.getContext("webgl"),u=new r.Container2D(0,0),l=t.ticker=new r.Time.Ticker(function(){s.viewport(0,0,e,n),s.clear(s.COLOR_BUFFER_BIT),s.enable(s.BLEND),s.disable(s.DEPTH_TEST),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),u.GLDraw(s),y.Process(),s.flush()},1e3,!0),c=20,h=0,f=35,d=[],p=new r.Pool(r.Sprite),y=new r.Time.Timer,v=new r.Controller.ProgramController.GLTexture2DProgramController(s);v.BindBasicTexture(r.Sprite.DEFAULT_TEXTURE,s.NEAREST),u.scale.Set(2/e,-2/n),u.position.Add(0,0),u.UpdateTransform(),p.Flood(function(){var t=new r.Sprite(Math.random()*e-i,Math.random()*n-o,v);return t.transformAutomaticUpdate=!1,t},2e4),y.onFinish.Add(function(){var t=f;for(f=f<3?3:f--;t--;)u.AddChild(p.Retrieve());if(l.GetTPS()>40||h++<20)this.Start(1);else{var e=u.children.length;console.log(e,l.GetTPS()),u.children.forEach(function(t){p.Store(t)}),u.Dump(),h=0,d.push(e),--c>0?this.Start(120):(d.sort(function(t,e){return t-e}),console.log(d,"\nMIN: "+d[0],"MED: "+d[Math.round(d.length/2)],"MAX: "+d[d.length-1]))}},y),l.Start(),y.Start(120)})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}e.default=function(){Object(i.a)("Utilities",function(t){var e=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mem1=e,this.mem2=n,this.mem3=null,this.mem4=null,this.deep={deeper:{deepest:0}}}return function(t,e,n){e&&o(t.prototype,e),n&&o(t,n)}(t,[{key:"Some",value:function(t){this.mem3=t,this.mem4=this.mem1+this.mem2}}]),t}(),n=new r.Maker;console.log(n.Many(15).Make(e,"@i(*|2)","@i(%|3)").Call(Math.random,null,"deep.deeper.deepest").Call("Some",["@i"]).Call(console.log,["$deep.deeper.deepest"]).Ship(!0)),console.log(n),r.Glob.Create("myGlob");var i=window.myGlob;i.Define(r.Glob.CONSTANT,"myConstant","someValue"),i.Define(r.Glob.FUNCTION,"myFunction",function(){}),i.Define(r.Glob.VALUE,"myValue","someValue");try{i.Mark(r.Glob.CONSTANT,"myConstant")}catch(t){console.error(t)}i.Mark(r.Glob.OBJECT,"myObject");try{i.Set(r.Glob.OBJECT,"myObject",0)}catch(t){console.error(t)}i.Set(r.Glob.OBJECT,"myObject",{}),console.log(i),window.myGlob=void 0,r.Assert.LOG=!0,r.Assert(0,r.Assert.IS_SAME_TYPE,1),r.Assert("myString",r.Assert.IS,"myString"),r.Assert(10,r.Assert.IS_GREATER_THAN,9);try{r.Assert(10,r.Assert.IS_LESS_THAN,9)}catch(t){console.error(t)}try{r.Assert([],r.Assert.IS_SAME_TYPE,Object)}catch(t){console.error(t)}r.Assert([],r.Assert.IS_INSTANCE_OF,Object);var a=new r.CP.Registry;r.CP.Command.OPTION_PREFIX="--",a.AddCommand(new r.CP.Command("myCommand mycmd",function(t,e,n){console.log(t,e,n,"prime")},"some info about this command",!0,!0).AddOption("anOption anopt",function(t,e,n){console.log(t,e,n,"priorty 1")},"some info about this option",0,!1).AddOption("op2",function(){console.log("op2 called.","priorty 0")},"brrrr",1,!1)),console.log(a),a.Parse('myCommand --anopt someData=myData someString --op2 (JSON)myJsonData={"someJsonData":"value"}',{someStatic:"data"}),null!=a.Parse("what?")&&console.error("Unknown command");var s=a.Parse("hmmm...");s&&console.error(s,"- is not a recognized command")})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}e.default=function(){Object(i.a)("Motion",function(t){var e=function(t){function e(t,n,a){var u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(u=function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?l(t):e}(this,s(e).call(this,0,0,new r.Path.Line2D(t.x,t.y,n.x,n.y)))).path.style.stroke.color=new r.Color(r.Utility.RandomInteger(u.w,200),r.Utility.RandomInteger(u.w,150),r.Utility.RandomInteger(0,20),1).value,u.path.style.stroke.lineWidth=u.w/12,a.AddChild(l(l(u))),u.x=r.Utility.RandomFloat(-c,c),u.y=r.Utility.RandomFloat(0,i),u.rotation=r.Utility.RandomInteger(0,r.Math.PII),u.rotation=r.Utility.ThisOrThat(u.rotation,-u.rotation);var h=u.motionManager=new r.Motion.Manager(l(l(u)));return h.Create("moveX","x",0,120,"SineInOut"),h.Create("moveY","y",0,120,"SineInOut"),h.Create("rotate","rotation",0,120,"SineInOut"),h.StartMultiple("moveX moveY rotate"),u.w>12&&u.Grow(),u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(e,r["Graphic2D"]),function(t,e,n){e&&a(t.prototype,e),n&&a(t,n)}(e,[{key:"Grow",value:function(){var t=this.path.e.SubtractVC(this.path.s),n=t.Copy();t.Rotate(50*r.Math.RADIAN+r.Utility.RandomFloat(20*-r.Math.RADIAN,20*r.Math.RADIAN)),n.Rotate(50*-r.Math.RADIAN+r.Utility.RandomFloat(20*-r.Math.RADIAN,20*r.Math.RADIAN)),t.Multiply(.67,.67),n.Multiply(.67,.67),t.AddV(this.path.e),n.AddV(this.path.e),new e(this.path.e,t,this.parent),new e(this.path.e,n,this.parent)}}]),e}(),n=1920,i=1080,c=960,h=t.canvas=document.createElement("canvas");document.body.appendChild(h),h.setAttribute("width",n),h.setAttribute("height",i),h.style.display="initial",h.style.position="absolute";var f={canvas:h,x:0,y:0,halt:!1},d=t.stage=new r.Stage2D(f),p=new r.Container2D(0,0),y=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),v=new r.Container2D(c,i);v.scale.Set(1,-1),y.force.SetSame(5),d.AddChild(p).AddChild(y).AddChild(v),new r.CanvasManager(h,n,i,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(d).BindRootContainer(p).Trigger(),d.mouse.AddOffset(v).AddOffset(y),new e(new r.Vector2D(0,0),new r.Vector2D(0,300),v);var m=new r.Time.Timer(130);m.onFinish.Add(function(){d.ticker.Stop()}),m.Start(),d.onProcess.Add(function(){y.Process(),v.children.forEach(function(t){t.motionManager.Process()}),m.Process()}),d.mouse.onDown.Add(function(t){y.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var i=n(1),r=n(0);e.default=function(){Object(i.a)("Interaction",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,x:0,y:0,halt:!1},i=t.stage=new r.Stage2D(n),o=new r.Container2D(0,0),a=new r.Camera2D(new r.Vector2D(0,0),{position:new r.Vector2D(0,0)}),s=new r.Container2D(300,200),u=new r.Sprite(0,0),l=new r.Graphic2D(-100,-100,new r.Path.Circle(0,0,50)),c=new r.Graphic2D(100,100,new r.Path.Line2D(-100,0,100,0)),h=new r.Vector2D(0,0),f=new r.Vector2D(0,0),d=null;a.force.SetSame(5),i.AddChild(o).AddChild(a).AddChild(s).AddChildren(u,l,c),new r.CanvasManager(e,600,400,r.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(i).BindRootContainer(o).Trigger(),i.mouse.AddOffset(s).AddOffset(a),i.onProcess.Add(function(){a.Process()}),i.mouse.onDown.Add(function(t){for(var e=s.children.length,n=t.data.position;e--;)if(s.children[e].IntersectsPoint(n)){h.SetV(n),d=s.children[e],f.SetV(d.position),t.stopPropagation=!0,d.SendToFront();break}d||a.target.position.SetV(n)}),i.mouse.onMove.Add(function(t){if(d){var e=t.data.position;d.position.SetV(e).AddV(f).SubtractV(h)}},i),i.mouse.onUp.Add(function(){d&&(d=null)})})}}]);