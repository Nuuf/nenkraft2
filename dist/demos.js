/**
* @package     Nenkraft2
* @author      Gustav 'Nuuf' Åberg <gustavrein@gmail.com>
* @version     2.4.0
* @copyright   (C) 2018-2019 Gustav 'Nuuf' Åberg
* @license     {@link https://github.com/Nuuf/nenkraft2/blob/master/LICENSE}
*/!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=13)}([function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"CCH1",function(){return j}),n.d(r,"CCH1Decipher",function(){return V});var i={};n.r(i),n.d(i,"GenerateSimpleBase64PNG",function(){return U}),n.d(i,"ImageFromDataURL",function(){return X}),n.d(i,"ParsedXMLToJSON",function(){return Y}),n.d(i,"XMLToJSON",function(){return H}),n.d(i,"DownloadAsJSON",function(){return W});var o={};n.r(o),n.d(o,"Linear",function(){return Q}),n.d(o,"QuadIn",function(){return $}),n.d(o,"QuadOut",function(){return Z}),n.d(o,"QuadInOut",function(){return tt}),n.d(o,"SineIn",function(){return et}),n.d(o,"SineOut",function(){return nt}),n.d(o,"SineInOut",function(){return rt}),n.d(o,"CircIn",function(){return it}),n.d(o,"CircOut",function(){return ot}),n.d(o,"CircInOut",function(){return at});var a={};n.r(a),n.d(a,"Result",function(){return lt}),n.d(a,"Collide",function(){return ct}),n.d(a,"SeparatingResponse",function(){return ht});var s={};n.r(s),n.d(s,"Line2DLine2DCollision",function(){return dt});var u={};n.r(u),n.d(u,"Result",function(){return vt}),n.d(u,"Collide",function(){return mt});var l={};n.r(l),n.d(l,"Result",function(){return St}),n.d(l,"Collide",function(){return Ct}),n.d(l,"ElasticResponse",function(){return Tt});var c={};n.r(c),n.d(c,"Result",function(){return Lt}),n.d(c,"Collide",function(){return Bt}),n.d(c,"ReflectingResponse",function(){return jt});var h={};n.r(h),n.d(h,"Result",function(){return Nt}),n.d(h,"Collide",function(){return Ft}),n.d(h,"AxisSeparates",function(){return Ut}),n.d(h,"SeparatingResponse",function(){return Xt});var f={};n.r(f),n.d(f,"Body2D",function(){return Ht}),n.d(f,"AABB2DvsAABB2D",function(){return a}),n.d(f,"Line2DvsLine2D",function(){return s}),n.d(f,"AABB2DvsLine2D",function(){return u}),n.d(f,"CirclevsCircle",function(){return l}),n.d(f,"CirclevsLine2D",function(){return c}),n.d(f,"Polygon2DvsPolygon2D",function(){return h});var d={};n.r(d),n.d(d,"Rectangular2D",function(){return $t}),n.d(d,"Isosceles2D",function(){return Zt}),n.d(d,"Cyclic2D",function(){return te}),n.d(d,"Equilateral2D",function(){return ee}),n.d(d,"Star2D",function(){return ne}),n.d(d,"Butterfly2D",function(){return re}),n.d(d,"Rose2D",function(){return ie}),n.d(d,"Supershape2D",function(){return oe});var p={};n.r(p),n.d(p,"AABB2D",function(){return se}),n.d(p,"Circle",function(){return me}),n.d(p,"Line2D",function(){return Ae}),n.d(p,"Ray2D",function(){return Ae}),n.d(p,"Polygon2D",function(){return xe}),n.d(p,"PolygonConstruction",function(){return d});var y={};n.r(y),n.d(y,"DEFAULT",function(){return Pe}),n.d(y,"SOURCE_OVER",function(){return Oe}),n.d(y,"SOURCE_IN",function(){return ke}),n.d(y,"SOURCE_OUT",function(){return Re}),n.d(y,"SOURCE_ATOP",function(){return _e}),n.d(y,"DESTINATION_OVER",function(){return De}),n.d(y,"DESTINATION_IN",function(){return Ie}),n.d(y,"DESTINATION_OUT",function(){return Le}),n.d(y,"DESTINATION_ATOP",function(){return Be}),n.d(y,"LIGHTER",function(){return je}),n.d(y,"COPY",function(){return Ve}),n.d(y,"XOR",function(){return Me}),n.d(y,"MULTIPLY",function(){return Ge}),n.d(y,"OVERLAY",function(){return Ne}),n.d(y,"DARKEN",function(){return Fe}),n.d(y,"LIGHTEN",function(){return Ue}),n.d(y,"COLOR_DODGE",function(){return Xe}),n.d(y,"COLOR_BURN",function(){return Ye}),n.d(y,"HARD_LIGHT",function(){return He}),n.d(y,"SOFT_LIGHT",function(){return We}),n.d(y,"DIFFERENCE",function(){return qe}),n.d(y,"EXCLUSION",function(){return ze}),n.d(y,"HUE",function(){return Ke}),n.d(y,"SATURATION",function(){return Je}),n.d(y,"COLOR",function(){return Qe}),n.d(y,"LUMINOSITY",function(){return $e});var v={};n.r(v),n.d(v,"CAP_ROUND",function(){return Ze}),n.d(v,"CAP_BUTT",function(){return tn}),n.d(v,"CAP_SQUARE",function(){return en}),n.d(v,"JOIN_BEVEL",function(){return nn}),n.d(v,"JOIN_ROUND",function(){return rn}),n.d(v,"JOIN_MITER",function(){return on});var m={};n.r(m),n.d(m,"ALIGN_START",function(){return an}),n.d(m,"ALIGN_END",function(){return sn}),n.d(m,"ALIGN_CENTER",function(){return un}),n.d(m,"ALIGN_LEFT",function(){return ln}),n.d(m,"ALIGN_RIGHT",function(){return cn}),n.d(m,"BASELINE_ALPHABETIC",function(){return hn}),n.d(m,"BASELINE_TOP",function(){return fn}),n.d(m,"BASELINE_HANGING",function(){return dn}),n.d(m,"BASELINE_MIDDLE",function(){return pn}),n.d(m,"BASELINE_IDEOGRAPHIC",function(){return yn}),n.d(m,"BASELINE_BOTTOM",function(){return vn});var b={};n.r(b),n.d(b,"Fill",function(){return bn}),n.d(b,"Stroke",function(){return wn}),n.d(b,"Shadow",function(){return Sn}),n.d(b,"Text",function(){return Tn}),n.d(b,"Pixel",function(){return xn}),n.d(b,"GCO",function(){return y}),n.d(b,"LineConf",function(){return v}),n.d(b,"TextConf",function(){return m}),n.d(b,"All",function(){return En}),n.d(b,"FFSa",function(){return Pn}),n.d(b,"SSa",function(){return On}),n.d(b,"FSa",function(){return kn}),n.d(b,"SaT",function(){return Rn}),n.d(b,"P",function(){return _n});var g={};n.r(g),n.d(g,"AABB2D",function(){return In}),n.d(g,"Circle",function(){return Bn}),n.d(g,"Line2D",function(){return Vn}),n.d(g,"Ray2D",function(){return Vn}),n.d(g,"Polygon2D",function(){return Gn}),n.d(g,"Pixel",function(){return Qn});var w={};n.r(w),n.d(w,"Timer",function(){return ir}),n.d(w,"Ticker",function(){return or.a});var A={};n.r(A),n.d(A,"Uglify",function(){return ar}),n.d(A,"ParseImports",function(){return sr}),n.d(A,"SNIPPETS",function(){return ur}),n.d(A,"Parse",function(){return lr}),n.d(A,"TEXTURE_2D",function(){return cr}),n.d(A,"TEXTURE_2D_BATCH",function(){return hr}),n.d(A,"PIXEL_BATCH",function(){return fr}),n.d(A,"RECTANGLE",function(){return dr}),n.d(A,"CIRCLE",function(){return pr}),n.d(A,"LINE2D",function(){return yr}),n.d(A,"UN",function(){return vr}),n.d(A,"RENDERTEXTURE_BLACK_WHITE",function(){return mr}),n.d(A,"RENDERTEXTURE_GRAYSCALE",function(){return br}),n.d(A,"RENDERTEXTURE_SEPIA",function(){return gr}),n.d(A,"RENDERTEXTURE_INVERT",function(){return wr}),n.d(A,"RENDERTEXTURE_DEFAULT",function(){return Ar}),n.d(A,"WT",function(){return Sr}),n.d(A,"DynamicTEXTURE_2D",function(){return Cr});var S={};n.r(S),n.d(S,"ImageLoader",function(){return Ir}),n.d(S,"SpritesheetLoader",function(){return Xr}),n.d(S,"TilesetLoader",function(){return qr}),n.d(S,"XHRLoader",function(){return jr}),n.d(S,"LoaderCombiner",function(){return Jr});var C={};n.r(C),n.d(C,"GLProgramController",function(){return $r}),n.d(C,"GLCircleProgramController",function(){return oi}),n.d(C,"GLLine2DProgramController",function(){return hi}),n.d(C,"GLPixelBatchProgramController",function(){return mi}),n.d(C,"GLRectangleProgramController",function(){return Ci}),n.d(C,"GLTexture2DBatchProgramController",function(){return ki}),n.d(C,"GLTexture2DProgramController",function(){return Bi}),n.d(C,"GLDynamicTexture2DProgramController",function(){return Fi}),n.d(C,"GLUnProgramController",function(){return qi}),n.d(C,"GLRendertextureProgramController",function(){return Zi});var T={};n.r(T),n.d(T,"ProgramController",function(){return C});var x={};n.r(x),n.d(x,"Option",function(){return eo}),n.d(x,"Command",function(){return io}),n.d(x,"Registry",function(){return co});var E={};n.r(E),n.d(E,"Motion",function(){return fo}),n.d(E,"Manager",function(){return vo});var P={};n.r(P),n.d(P,"BasicTexture2D",function(){return Rr}),n.d(P,"Spritesheet",function(){return Nr}),n.d(P,"Tileset",function(){return Yr});var O={};n.r(O),n.d(O,"Particle",function(){return Pa}),n.d(O,"Oscillation",function(){return So}),n.d(O,"OscillatingObject",function(){return Ao}),n.d(O,"System",function(){return ja}),n.d(O,"ValidateData",function(){return Ja});var k={};n.r(k),n.d(k,"P2D",function(){return O});var R={};n.r(R),n.d(R,"Animation",function(){return $a}),n.d(R,"Controller",function(){return es}),n.d(R,"Frame",function(){return Mr});var _={};n.r(_),n.d(_,"RectanglePacker",function(){return is});var D={};n.r(D),n.d(D,"Keyboard",function(){return cs}),n.d(D,"Key",function(){return ss}),n.d(D,"Mouse",function(){return fs}),n.d(D,"Touch",function(){return ps});var I={};n.r(I),n.d(I,"Dispatcher",function(){return er}),n.d(I,"Listener",function(){return Zn});var L=n(1),B=n(4);function j(t,e){var n,r,i=t.split(""),o=[];e=e||1;for(var a=0;a<i.length;++a)n=((n=i[a]).charCodeAt(0)+e).toString(2),r=Object(L.RandomInteger)(1,9),o.push(r+"x"+n.replace(/1/g,r));return o.join(" ")}function V(t,e){var n,r=t.split(" "),i=[];e=e||1;for(var o=0;o<r.length;++o)n=(n=r[o]).slice(2-n.length),i.push(String.fromCharCode(parseInt(n.replace(/[2-9]/g,"1"),2)-e));return i.join("")}var M,G,N,F=Math.ceil;function U(t,e,n,r){var i=t();return null==M&&(M=document.createElement("canvas"),G=M.getContext("2d")),M.width=F(i.width),M.height=F(i.height),null!=n&&(M.width=n),null!=r&&(M.height=r),null!=e?(G.fillStyle=e,G.fillRect(0,0,M.width,M.height)):G.clearRect(0,0,M.width,M.height),G.setTransform(1,0,0,1,0,0),i.Render(G),M.toDataURL("image/png")}function X(t,e,n,r){var i=new Image;return n&&(i.width=n),r&&(i.height=r),i.onload=e,i.src=t,i}function Y(t,e){var n,r,i,o,a,s,u={},l=t.childNodes,c=l.length;if(1===t.nodeType){if((c=(r=t.attributes).length)>0)for(u.attributes={},n=0,i=r.item(n);n<c;i=r.item(++n))u.attributes[i.nodeName]=i.nodeValue}else 3===t.nodeType&&(/^\s*$/g.exec(t.nodeValue)||(u=t.nodeValue,!0===e&&(u=u.replace(/^\s+|\s+&|\n/gim,""))));if(null!=l)for(c=l.length,n=0,o=l.item(n);n<c;o=l.item(++n))void 0===u[o.nodeName]?u[o.nodeName]=Y(o,e):(void 0===u[o.nodeName].push&&(s=u[o.nodeName],u[o.nodeName]=[],Object(L.IsObjectEmpty)(s)||u[o.nodeName].push(s)),a=Y(o,e),Object(L.IsObjectEmpty)(a)||u[o.nodeName].push(a));return u["#text"]&&0===u["#text"].length&&delete u["#text"],u}function H(t,e){return null==N&&(N=new DOMParser),Y(N.parseFromString(t,"text/xml"),e)}function W(t,e){var n="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t)),r=document.createElement("a");r.setAttribute("href",n),r.setAttribute("download",e+".json"),r.click()}var q=Math.sin,z=Math.cos,K=Math.sqrt,J=Math.PI,Q=function(t,e,n,r){return n*t/r+e},$=function(t,e,n,r){return n*(t/=r)*t+e},Z=function(t,e,n,r){return-n*(t/=r)*(t-2)+e},tt=function(t,e,n,r){return(t/=.5*r)<1?.5*n*t*t+e:.5*-n*(--t*(t-2)-1)+e},et=function(t,e,n,r){return-n*z(t/r*(.5*J))+n+e},nt=function(t,e,n,r){return n*q(t/r*(.5*J))+e},rt=function(t,e,n,r){return.5*-n*(z(J*t/r)-1)+e},it=function(t,e,n,r){return-n*(K(1-(t/=r)*t)-1)+e},ot=function(t,e,n,r){return t/=r,n*K(1- --t*t)+e},at=function(t,e,n,r){return(t/=.5*r)<1?.5*-n*(K(1-t*t)-1)+e:.5*n*(K(1-(t-=2)*t)+1)+e},st=n(2);function ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var lt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new st.a(0,0),this.occured=!1}var e,n,r;return e=t,(n=[{key:"Reset",value:function(){this.mtv.SetSame(0),this.occured=!1}}])&&ut(e.prototype,n),r&&ut(e,r),t}(),ct=function(t,e,n){var r=t.shape,i=e.shape;return r.tl.x<i.br.x&&i.tl.x<r.br.x&&r.tl.y<i.br.y&&i.tl.y<r.br.y&&(ft[0].Set(r.tl.x-i.br.x,0),ft[1].Set(r.br.x-i.tl.x,0),ft[2].Set(0,r.tl.y-i.br.y),ft[3].Set(0,r.br.y-i.tl.y),ft.sort(st.a.SortMinMag),n.mtv.SetV(ft[0]),n.occured=!0,!0)},ht=function(t,e,n){n.mtv.Multiply(.5,.5),t.relative.SubtractV(n.mtv),e.relative.AddV(n.mtv)},ft=[new st.a(0,0),new st.a(0,0),new st.a(0,0),new st.a(0,0)];function dt(t,e,n,r,i){i.SetV(e).SubtractV(t),pt.SetV(r).SubtractV(n);var o=-pt.x*i.y+i.x*pt.y,a=t.x-n.x,s=t.y-n.y,u=(-i.y*a+i.x*s)/o,l=(pt.x*s-pt.y*a)/o;return u>=0&&u<=1&&l>=0&&l<=1?(i.Set(t.x+l*i.x,t.y+l*i.y),!0):(i.SetSame(0),!1)}var pt=new st.a(0,0);function yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var vt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.poc={a:new st.a(0,0),b:new st.a(0,0),c:new st.a(0,0),d:new st.a(0,0)},this.top=!1,this.right=!1,this.bottom=!1,this.left=!1}var e,n,r;return e=t,(n=[{key:"Reset",value:function(){this.poc.a.SetSame(0),this.poc.b.SetSame(0),this.poc.c.SetSame(0),this.poc.d.SetSame(0),this.top=!1,this.right=!1,this.bottom=!1,this.left=!1}}])&&yt(e.prototype,n),r&&yt(e,r),t}(),mt=function(t,e,n){var r=t.shape,i=e.shape;bt.Set(r.tl.x+(r.br.x-r.tl.x),r.tl.y),gt.Set(r.tl.x,r.tl.y+(r.br.y-r.tl.y)),n.top=dt(i.s,i.e,r.tl,bt,n.poc.a),n.right=dt(i.s,i.e,r.br,bt,n.poc.b),n.bottom=dt(i.s,i.e,r.br,gt,n.poc.c),n.left=dt(i.s,i.e,r.tl,gt,n.poc.d)},bt=new st.a(0,0),gt=new st.a(0,0);function wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var At=Math.sqrt,St=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new st.a(0,0),this.poc={a:new st.a(0,0),b:new st.a(0,0),c:new st.a(0,0)},this.mtd=0,this.delta=new st.a(0,0),this.occured=!1}var e,n,r;return e=t,(n=[{key:"Reset",value:function(){this.poc.a.SetSame(0),this.poc.b.SetSame(0),this.poc.c.SetSame(0),this.mtv.SetSame(0),this.mtd=0,this.delta.SetSame(0),this.occured=!1}}])&&wt(e.prototype,n),r&&wt(e,r),t}(),Ct=function(t,e,n){var r=t.shape,i=e.shape,o=r.radius+i.radius;Rt.SetV(r.center).SubtractV(i.center);var a=Rt.GetMagnitudeSquared();if(o*o>a){var s=At(a),u=(r.radiusSquared-i.radiusSquared+a)/(s+s),l=At(r.radiusSquared-u*u)/s,c=-Rt.y*l,h=Rt.x*l,f=s-r.radius-i.radius;return Pt.Set(r.center.x+Rt.x*u/s,r.center.y+Rt.y*u/s),Ot.Set(Pt.x+c,Pt.y+h),kt.Set(Pt.x-c,Pt.y-h),n.mtv.SetV(Rt).Divide(o,o),n.poc.a.SetV(Pt),n.poc.b.SetV(Ot),n.poc.c.SetV(kt),n.mtd=f,n.delta.SetV(Rt),n.occured=!0,!0}return!1},Tt=function(t,e,n){xt.SetV(n.delta).Normalize(),Et.SetV(n.mtv);var r=t.mass,i=e.mass,o=t.velocity,a=e.velocity,s=2*(o.GetDotV(xt)-a.GetDotV(xt))/(r+i);o.Set(o.x-s*i*xt.x,o.y-s*i*xt.y),a.Set(a.x+s*r*xt.x,a.y+s*r*xt.y),Et.Multiply(n.mtd,n.mtd).Multiply(.5,.5),t.relative.SubtractV(Et),e.relative.AddV(Et)},xt=new st.a(0,0),Et=new st.a(0,0),Pt=new st.a(0,0),Ot=new st.a(0,0),kt=new st.a(0,0),Rt=new st.a(0,0),_t=n(7);function Dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var It=Math.sqrt,Lt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new st.a(0,0),this.cp=new st.a(0,0),this.sOrE=0,this.occured=!1}var e,n,r;return e=t,(n=[{key:"Reset",value:function(){this.mtv.SetSame(0),this.cp.SetSame(0),this.sOrE=0,this.occured=!1}}])&&Dt(e.prototype,n),r&&Dt(e,r),t}(),Bt=function(t,e,n){var r=t.shape,i=e.shape,o=r.center,a=Object(_t.ClosestPoint2DOnLine2D)(i.s,i.e,o);Vt.Set(o.x-a.x,o.y-a.y);var s=Vt.GetMagnitudeSquared();if(s<r.radiusSquared){var u=r.radius-It(s);return n.mtv.SetV(Vt).Normalize().Multiply(u,u),n.cp.SetV(a),n.occured=!0,a===i.s?n.sOrE=1:a===i.e&&(n.sOrE=-1),!0}return!1},jt=function(t,e,n){var r,i,o=e.shape,a=t.velocity,s=t.relative,u=n.cp;0!==n.sOrE?(r=u.SubtractVC(s)).Normalize():r=o.GetNormalA(),i=a.GetReflectionV(r),a.SetV(i),s.AddV(n.mtv)},Vt=new st.a(0,0);function Mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Gt=Math.abs,Nt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mtv=new st.a(0,0),this.olAxis=new st.a(0,0),this.mtd=1/0,this.occured=!1}var e,n,r;return e=t,(n=[{key:"Reset",value:function(){this.occured=!1,this.mtv.Set(0,0),this.mtd=1/0,this.olAxis.Set(0,0)}}])&&Mt(e.prototype,n),r&&Mt(e,r),t}(),Ft=function(t,e,n){for(var r=0,i=t.shape.normals,o=e.shape.normals;r<o.length;++r)if(!0===Ut(t,e,i[r],n))return!1;for(r=0;r<o.length;++r)if(!0===Ut(t,e,o[r],n))return!1;return n.mtv.SetV(n.olAxis),n.mtv.Multiply(n.mtd,n.mtd),n.occured=!0,!0},Ut=function(t,e,n,r){var i=n.GetMinMaxDot(t.shape.vertices),o=n.GetMinMaxDot(e.shape.vertices),a=e.relative.SubtractVC(t.relative).GetDotV(n);if(o.Add(a,a),i.x>o.y||o.x>i.y)return!0;var s=0,u=0,l=0,c=i.x,h=i.y,f=o.x,d=o.y;s=c<f?h<d?h-f:(u=h-f)<(l=d-c)?u:-l:h>d?c-d:(u=h-f)<(l=d-c)?u:-l;var p=Gt(s);return p<r.mtd&&(r.mtd=p,r.olAxis.SetV(n),s<0&&r.olAxis.Invert()),!1},Xt=function(t,e,n){n.mtv.Multiply(.5,.5),t.relative.SubtractV(n.mtv),e.relative.AddV(n.mtv)};function Yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ht=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.shape=e,this.mass=0,this.relative=null,this.velocity=new st.a(0,0),this.offset=new st.a(0,0)}var e,n,r;return e=t,(n=[{key:"SetMass",value:function(t){return this.mass=t,this}},{key:"SetOffset",value:function(t,e){return this.offset.Set(t,e),this}},{key:"SetVelocity",value:function(t,e){return this.velocity.Set(t,e),this}},{key:"SetVelocityV",value:function(t){return this.velocity.SetV(t),this}},{key:"GetPosition",value:function(){return this.shape.GetPosition()}},{key:"SetPosition",value:function(t,e){this.shape.SetPosition(t+this.offset.x,e+this.offset.y)}},{key:"SetPositionV",value:function(t){return this.SetPosition(t.x,t.y),this}},{key:"SetRelative",value:function(t){return this.relative=t,this}}])&&Yt(e.prototype,n),r&&Yt(e,r),t}(),Wt=Math.PI,qt=Math.cos,zt=Math.sin,Kt=Math.abs,Jt=Math.pow,Qt=Math.exp,$t=function(t,e,n,r,i){var o=new st.a(e,n),a=new st.a(e+r,n),s=new st.a(e+r,n+i),u=new st.a(e,n+i);return t.Recreate([o,a,s,u]),t.ComputeBounds(),t.ComputeNormalsA(),t},Zt=function(t,e,n,r,i){var o=new st.a(e,n),a=new st.a(e+.5*r,n+i),s=new st.a(e-.5*r,n+i);return t.Recreate([o,a,s]),t.ComputeBounds(),t.ComputeNormalsA(),t},te=function(t,e,n,r,i){var o,a,s,u=0,l=i,c=2*Wt/l;for(t.Recreate([]);u<l;++u)o=qt(s=c*u)*r,a=zt(s)*r,t.AddVertex(new st.a(e+o,n+a));return t.ComputeBounds(),t.ComputeNormalsA(),t},ee=function(t,e,n,r){var i,o,a=2.0943951023931953;return t.Recreate([]),i=r,o=0,t.AddVertex(new st.a(e+i,n+o)),i=qt(a)*r,o=zt(a)*r,t.AddVertex(new st.a(e+i,n+o)),i=qt(2*a)*r,o=zt(2*a)*r,t.AddVertex(new st.a(e+i,n+o)),t.Rotate(-90*new Math.RADIAN),t.ComputeBounds(),t.ComputeNormalsA(),t},ne=function(t,e,n,r,i,o){var a,s,u,l,c=0,h=2*o,f=2*Math.PI/h;for(t.Recreate([]);c<h;++c)l=0==(1&c)?r:i,u=f*c,a=Math.cos(u)*l,s=Math.sin(u)*l,t.AddVertex(new st.a(e+a,n+s));return t.ComputeBounds(),t.ComputeNormalsA(),t},re=function t(e,n,r,i,o){var a,s,u,l=0,c=t.C;for(e.Recreate([]);l<i;++l)u=l*c._1*Wt/i,a=qt(u)*(Qt(qt(u))-c._2*qt(c._3*u)-Jt(zt(u/c._4),c._5))*o,s=zt(u)*(Qt(qt(u))-c._2*qt(c._3*u)-Jt(zt(u/c._4),c._5))*o,e.AddVertex(new st.a(n+a,r+s));return e.ComputeBounds(),e.ComputeNormalsA(),e};re.C={_1:24,_2:2,_3:4,_4:12,_5:5};var ie=function(t,e,n,r,i,o,a){var s,u,l,c,h=0,f=o,d=2*Wt/f*a;for(t.Recreate([]);h<f;++h)c=qt(i*(l=d*h))*r,s=qt(l)*c,u=zt(l)*c,t.AddVertex(new st.a(e+s,n+u));return t.ComputeBounds(),t.ComputeNormalsA(),t},oe=function t(e,n,r,i,o,a,s,u,l){var c,h,f,d,p,y,v=0,m=o,b=t.C;for(s=null==s?1:s,u=null==u?1:u,l=null==l?1:l,e.Recreate([]);v<m;++v)p=qt(a*(f=v*Wt*2/o)/4)/b._A,p=Kt(p),p=Jt(p,u),y=zt(a*f/4)/b._B,y=Kt(y),y=Jt(y,l),d=Jt(p+y,1/s),0===Kt(d)?(c=0,h=0):(d=1/d,c=qt(f)*d*i,h=zt(f)*d*i),e.AddVertex(new st.a(n+c,r+h));return e.ComputeBounds(),e.ComputeNormalsA(),e};function ae(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}oe.C={_A:1,_B:1};var se=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tl=new st.a(e,n),this.br=new st.a(r,i),this.w=0,this.h=0,this.hw=0,this.hh=0,this.area=0,this.belongsTo=null,this.TYPE=fe,this.ComputeWH()}var e,n,r;return e=t,r=[{key:"TYPE",get:function(){return fe}}],(n=[{key:"Copy",value:function(){return(new t).SetC(this)}},{key:"Set",value:function(t,e,n,r){return this.tl.Set(t,e),this.br.Set(n,r),this.ComputeWH()}},{key:"SetC",value:function(t){return this.Set(t.tl.x,t.tl.y,t.br.x,t.br.y)}},{key:"SetXYWH",value:function(t,e,n,r){return this.Set(t,e,t+n,e+r)}},{key:"SetPosition",value:function(t,e){return this.tl.Set(t,e),this.br.Set(t+this.w,e+this.h),this}},{key:"GetPosition",value:function(){return this.tl}},{key:"Scale",value:function(t,e,n){return!1!==n&&this.tl.Multiply(t,e),this.br.Multiply(t,e),this.ComputeWH()}},{key:"ScaleV",value:function(t,e){return!1!==e&&this.tl.MultiplyV(t),this.br.MultiplyV(t),this.ComputeWH()}},{key:"ComputeWH",value:function(){return this.w=this.br.x-this.tl.x,this.h=this.br.y-this.tl.y,this.hw=.5*this.w,this.hh=.5*this.h,this.area=this.w*this.h,this}},{key:"IntersectsPoint2D",value:function(t){return!(t.x<this.tl.x||t.x>this.br.x||t.y<this.tl.y||t.y>this.br.y)}},{key:"ContainsPoint2D",value:function(t){return!(t.x<=this.tl.x||t.x>=this.br.x||t.y<=this.tl.y||t.y>=this.br.y)}},{key:"IntersectsAABB2D",value:function(t){return!(t.tl.x>=this.br.x||t.tl.y>=this.br.y||t.br.x<=this.tl.x||t.br.y<=this.tl.y)}},{key:"ContainsAABB2D",value:function(t){return!(t.area>this.area)&&(t.tl.x>this.tl.x&&t.tl.y>this.tl.y&&t.br.x<this.br.x&&t.br.y<this.br.y)}},{key:"GetQuadrant",value:function(e){var n=this.tl,r=this.br;switch(e){case ue:return new t(n.x,n.y,n.x+this.hw,n.y+this.hh);case le:return new t(n.x+this.hw,n.y,r.x,n.y+this.hh);case ce:return new t(n.x,n.y+this.hh,n.x+this.hw,r.y);case he:return new t(n.x+this.hw,n.y+this.hh,r.x,r.y);default:return null}}}])&&ae(e.prototype,n),r&&ae(e,r),t}(),ue="TL",le="TR",ce="BL",he="BR",fe=1;function de(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var pe=Math.PI,ye=Math.sin,ve=Math.cos,me=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.center=new st.a(e,n),this.diameter=0,this.w=0,this.h=0,this.radiusSquared=0,this.radiusUnsquared=0,this.area=0,this.radius=r,this.belongsTo=null,this.TYPE=be}var e,n,r;return e=t,r=[{key:"TYPE",get:function(){return be}}],(n=[{key:"Copy",value:function(){return(new t).SetC(this)}},{key:"Set",value:function(t,e,n){return this.center.Set(t,e),this.radius=n,this}},{key:"SetC",value:function(t){return this.center.SetV(t),this.radius=t.radius,this}},{key:"SetPosition",value:function(t,e){return this.center.Set(t,e),this}},{key:"GetPosition",value:function(){return this.center}},{key:"Scale",value:function(t){return this.radius*=t,this}},{key:"IntersectsCircle",value:function(t){var e=this.radius+t.radius;return e*e>=this.center.GetDistanceSquaredV(t.center)}},{key:"ContainsCircle",value:function(t){return this.radius-t.radius>this.center.GetDistanceV(t.center)}},{key:"IntersectsPoint2D",value:function(t){return this.radiusSquared>=this.center.GetDistanceSquaredV(t)}},{key:"GenerateRandomPoints",value:function(t,e,n){var r=L.RandomFloat,i=new st.a(this.x-this.radius,this.y-this.radius),o=new st.a(this.x+this.radius,this.y+this.radius),a=[];n=!!n,!0===e&&(r=L.RandomInteger);for(var s=0;s<t;++s){for(var u=new st.a(r(i.x,o.x),r(i.y,o.y));this.IntersectsPoint2D(u)===n;)u.Set(r(i.x,o.x),r(i.y,o.y));a.push(u)}return a}},{key:"GeneratePerimeterPoints",value:function(t,e){var n=[];t*=e;for(var r=0;r<t;r+=e)n.push(new st.a(this.x+ve(Object(B.DegreesToRadians)(r))*this.radius,this.y+ye(Object(B.DegreesToRadians)(r))*this.radius));return n}},{key:"x",get:function(){return this.center.x},set:function(t){this.center.x=t}},{key:"y",get:function(){return this.center.y},set:function(t){this.center.y=t}},{key:"radius",get:function(){return this.radiusUnsquared},set:function(t){this.radiusUnsquared=t,this.radiusSquared=t*t,this.diameter=this.w=this.h=2*t,this.area=pe*t*t}}])&&de(e.prototype,n),r&&de(e,r),t}(),be=2;function ge(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var we=Math.abs,Ae=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.s=new st.a(e,n),this.e=new st.a(r,i),this.epsilon=1e3,this.belongsTo=null,this.TYPE=Se}var e,n,r;return e=t,r=[{key:"TYPE",get:function(){return Se}}],(n=[{key:"Copy",value:function(){return(new t).SetC(this)}},{key:"Set",value:function(t,e,n,r){return this.s.Set(t,e),this.e.Set(n,r),this}},{key:"SetC",value:function(t){return this.s.SetV(t.s),this.e.SetV(t.e),this}},{key:"SetPosition",value:function(t,e){var n=t+we(this.e.x-this.s.x),r=e+we(this.e.y-this.s.y);return this.s.Set(t,e),this.e.Set(n,r),this}},{key:"GetPosition",value:function(){return this.s}},{key:"Stretch",value:function(t){var e=.5*t;return this.s.PushFromV(this.e,e),this.e.PushFromV(this.s,e),this}},{key:"Rotate",value:function(t,e,n){return e=null==e?.5:e,Ce.SetV(this.s).AddV(this.e).Multiply(e,null==n?e:n),this.s.RotateAroundV(Ce,t),this.e.RotateAroundV(Ce,t),this}},{key:"Cut",value:function(t,e){null==e&&(e=[]);for(var n=0;n<t.length;++n)e.push(this.s.GetWeightedAverageV(this.e,t[n]));return e}},{key:"GetLength",value:function(){return this.s.GetDistanceV(this.e)}},{key:"GetLengthSquared",value:function(){return this.s.GetDistanceSquaredV(this.e)}},{key:"IntersectsPoint2D",value:function(t){var e=this.s,n=this.e,r=(t.y-e.y)*(n.x-e.x)-(t.x-e.x)*(n.y-e.y);if(Math.abs(r)>this.epsilon)return!1;var i=(t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y);return!(i<0)&&!(i>this.GetLengthSquared())}},{key:"IntersectsLine2D",value:function(t){return Object(_t.Line2DLine2DIntersection)(this.s,this.e,t.s,t.e)}},{key:"GetClosestPoint2DTo",value:function(t){return Object(_t.ClosestPoint2DOnLine2D)(this.s,this.e,t)}},{key:"GetNormalA",value:function(){return this.s.GetNormalAV(this.e)}},{key:"GetNormalB",value:function(){return this.s.GetNormalBV(this.e)}}])&&ge(e.prototype,n),r&&ge(e,r),t}(),Se=0,Ce=new st.a(0,0);function Te(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xe=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertices=[],this.normals=[],this.perimeterMidPoints=[],this.centroid=new st.a(0,0),this.aabb=new se(0,0,0,0),this.dirtyBounds=!0,this.dirtyCentroid=!0,this.belongsTo=null,this.TYPE=Ee,null!=e&&this.AddVertices(e)}var e,n,r;return e=t,r=[{key:"TYPE",get:function(){return Ee}}],(n=[{key:"Copy",value:function(){return(new t).SetC(this)}},{key:"SetC",value:function(t){for(var e=t.vertices,n=0;n<e.length;++n)this.AddVertex(e[n].Copy());return this.ComputeBounds(),this.ComputeCentroid(),this}},{key:"ExtractSegments",value:function(t){var e=this.vertices,n=e.length-1;null==t&&(t=[]);for(var r=0;r<n;++r)t.push(new Ae(e[r],e[r+1]));return t.push(new Ae(e[n],e[0])),t}},{key:"GenerateRandomPoints",value:function(t,e,n){this.ComputeBounds(),n=!!n;var r=L.RandomFloat,i=this.aabb.tl,o=this.aabb.br,a=[];!0===e&&(r=L.RandomInteger);for(var s=0;s<t;++s){for(var u=new st.a(r(i.x,o.x),r(i.y,o.y));this.IntersectsPoint2D(u)===n;)u.Set(r(i.x,o.x),r(i.y,o.y));a.push(u)}return a}},{key:"AddVertex",value:function(t){return this.vertices.push(t),this.dirtyBounds=!0,this.dirtyCentroid=!0,this}},{key:"AddVertices",value:function(t){if(t[0]instanceof st.a)this.vertices.push.apply(this.vertices,t);else if("number"==typeof t[0])for(var e=0;e<t.length;e+=2)this.AddVertex(new st.a(t[e],t[e+1]));else if(null!=t[0].x)for(e=0;e<t.length;++e)this.AddVertex(new st.a(t[e].x,t[e].y));return this}},{key:"Recreate",value:function(t){return this.vertices.length=0,null!=t&&this.vertices.push.apply(this.vertices,t),this.dirtyBounds=!0,this.dirtyCentroid=!0,this}},{key:"ComputeBounds",value:function(){for(var t,e=1/0,n=-e,r=e,i=-e,o=this.vertices,a=0;a<o.length;++a)(t=o[a]).x<e&&(e=t.x),t.x>n&&(n=t.x),t.y<r&&(r=t.y),t.y>i&&(i=t.y);return this.aabb.Set(e,r,n,i),this.dirtyBounds=!1,this}},{key:"Rotate",value:function(t,e,n){!0===this.dirtyBounds&&this.ComputeBounds();var r=0,i=this.aabb,o=i.tl.Copy(),a=this.vertices,s=a.length;for(e=null==e?.5:e,o.AddV(i.br),o.Multiply(e,null==n?e:n);r<s;++r)a[r].RotateAroundV(o,t);return this.dirtyCentroid=!0,this.dirtyBounds=!0,this}},{key:"SetPosition",value:function(t,e){!0===this.dirtyCentroid&&this.ComputeCentroid();for(var n=this.vertices,r=this.centroid,i=0;i<n.length;++i)n[i].SubtractV(r).Add(t,e);return this.dirtyCentroid=!0,this.dirtyBounds=!0,this}},{key:"ComputeCentroid",value:function(){var t=this.vertices,e=this.centroid;e.Set(0,0);for(var n=0;n<t.length;++n)e.AddV(t[n]);return e.Divide(t.length,t.length),this.dirtyCentroid=!1,this}},{key:"ComputeNormalsA",value:function(){var t=this.vertices,e=t.length-1,n=this.normals;n.length=0;for(var r=0;r<e;++r)n.push(t[r].GetNormalAV(t[r+1]));return n.push(t[e].GetNormalAV(t[0])),this}},{key:"ComputeNormalsB",value:function(){var t=this.vertices,e=t.length-1,n=this.normals;n.length=0;for(var r=0;r<e;++r)n.push(t[r].GetNormalBV(t[r+1]));return n.push(t[e].GetNormalBV(t[0])),this}},{key:"ComputePerimeterMidPoints",value:function(){var t=this.vertices,e=t.length-1,n=this.perimeterMidPoints;n.length=0;for(var r=0;r<e;++r)n.push(t[r].GetMidPointV(t[r+1]));return n.push(t[e].GetMidPointV(t[0])),this}},{key:"IntersectsPoint2D",value:function(t){if(!0===this.dirtyBounds&&this.ComputeBounds(),!1===this.aabb.IntersectsPoint2D(t))return!1;for(var e,n,r=!1,i=this.vertices,o=t.x,a=t.y,s=0,u=i.length-1;s<i.length;u=s++)e=i[s],n=i[u],e.y>a!=n.y>a&&o<(n.x-e.x)*(a-e.y)/(n.y-e.y)+e.x&&(r=!r);return r}}])&&Te(e.prototype,n),r&&Te(e,r),t}(),Ee=3,Pe="source-over",Oe="source-over",ke="source-in",Re="source-out",_e="source-atop",De="destination-over",Ie="destination-in",Le="destination-out",Be="destination-atop",je="lighter",Ve="copy",Me="xor",Ge="multiply",Ne="overlay",Fe="darken",Ue="lighten",Xe="color-dodge",Ye="color-burn",He="hard-light",We="soft-light",qe="difference",ze="exclusion",Ke="hue",Je="saturation",Qe="color",$e="luminosity",Ze="round",tn="butt",en="square",nn="bevel",rn="round",on="miter",an="start",sn="end",un="center",ln="left",cn="right",hn="alphabetic",fn="top",dn="hanging",pn="middle",yn="ideographic",vn="bottom";function mn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var bn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#6496c8",this.applied=!0,Object(L.ApplyProperties)(this,e)}var e,n,r;return e=t,(n=[{key:"Apply",value:function(t){t.fillStyle=this.color}}])&&mn(e.prototype,n),r&&mn(e,r),t}();function gn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var wn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#c89664",this.lineCap=Ze,this.lineJoin=rn,this.lineWidth=2,this.lineDashOffset=0,this.lineDash=[0,0],this.miterLimit=10,this.applied=!0,Object(L.ApplyProperties)(this,e)}var e,n,r;return e=t,(n=[{key:"Apply",value:function(t){t.strokeStyle=this.color,t.lineCap=this.lineCap,t.lineJoin=this.lineJoin,t.lineWidth=this.lineWidth,t.miterLimit=this.miterLimit,t.lineDashOffset=this.lineDashOffset,t.setLineDash(this.lineDash)}}])&&gn(e.prototype,n),r&&gn(e,r),t}();function An(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Sn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#c89664",this.blur=5,this.offsetX=0,this.offsetY=0,this.applied=!1,Object(L.ApplyProperties)(this,e)}var e,n,r;return e=t,(n=[{key:"Apply",value:function(t){t.shadowColor=this.color,t.shadowBlur=this.blur,t.shadowOffsetX=this.offsetX,t.shadowOffsetY=this.offsetY}}])&&An(e.prototype,n),r&&An(e,r),t}();function Cn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Tn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fillColor="#6496c8",this.strokeColor="#c89664",this.fontSize=45,this.font=null,this.fontFamily="Arial",this.align=ln,this.baseline=fn,this.lineWidth=.5,this.applied=!0,Object(L.ApplyProperties)(this,e),this.ConcatFont()}var e,n,r;return e=t,(n=[{key:"Apply",value:function(t){t.fillStyle=this.fillColor,t.strokeStyle=this.strokeColor,t.font=this.font,t.textAlign=this.align,t.textBaseline=this.baseline,t.lineWidth=this.lineWidth}},{key:"ConcatFont",value:function(){this.font=this.fontSize+"px "+this.fontFamily}}])&&Cn(e.prototype,n),r&&Cn(e,r),t}();var xn=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#6496c8",this.size=1,Object(L.ApplyProperties)(this,e)},En=function(t){return{fill:new bn(t?t.fill:null),stroke:new wn(t?t.stroke:null),shadow:new Sn(t?t.shadow:null),text:new Tn(t?t.text:null),pixel:new xn(t?t.pixel:null)}},Pn=function(t){return{fill:new bn(t?t.fill:null),stroke:new wn(t?t.stroke:null),shadow:new Sn(t?t.shadow:null)}},On=function(t){return{stroke:new wn(t?t.stroke:null),shadow:new Sn(t?t.shadow:null)}},kn=function(t){return{fill:new bn(t?t.fill:null),shadow:new Sn(t?t.shadow:null)}},Rn=function(t){return{shadow:new Sn(t?t.shadow:null),text:new Tn(t?t.text:null)}},_n=function(t){return{pixel:new xn(t?t.pixel:null)}};function Dn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var In=function(){function t(e,n,r,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.shape=new se(e,n,r,i),this.programController=null,this.style=Pn(o)}var e,n,r;return e=t,(n=[{key:"Render",value:function(t){var e=this.shape.tl,n=this.shape.br,r=this.style;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(n.x,e.y),t.lineTo(n.x,n.y),t.lineTo(e.x,n.y),t.closePath(),!0===r.shadow.applied&&r.shadow.Apply(t),!0===r.fill.applied&&(r.fill.Apply(t),t.fill()),!0===r.stroke.applied&&(r.stroke.Apply(t),t.stroke())}},{key:"GLRender",value:function(t,e){if(null!==this.programController){var n=this.shape;this.programController.Execute(e.globalTransform.AsArray(!0),n.tl.x,n.tl.y,n.w,n.h)}}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.fillColor&&null!==t.outlineColor&&null!==t.outline&&(t.fillColor.SetHex(this.style.fill.color),t.fillColor.Normalize(),t.outlineColor.SetHex(this.style.stroke.color),t.outlineColor.Normalize(),t.outline=this.style.stroke.lineWidth+.2),this}},{key:"SetShape",value:function(t){return this.shape=t,this}}])&&Dn(e.prototype,n),r&&Dn(e,r),t}();function Ln(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Bn=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.shape=new me(e,n,r),this.programController=null,this.style=Pn(i)}var e,n,r;return e=t,(n=[{key:"Render",value:function(t){var e=this.style,n=this.shape;t.beginPath(),t.arc(n.x,n.y,n.radius,0,B.PII,!1),!0===e.shadow.applied&&e.shadow.Apply(t),!0===e.fill.applied&&(e.fill.Apply(t),t.fill()),!0===e.stroke.applied&&(e.stroke.Apply(t),t.stroke())}},{key:"GLRender",value:function(t,e){if(null!==this.programController){var n=this.shape;this.programController.Execute(e.globalTransform.AsArray(!0),n.x,n.y,n.radius)}}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.fillColor&&null!==t.outlineColor&&null!==t.outline&&(t.fillColor.SetHex(this.style.fill.color),t.fillColor.Normalize(),t.outlineColor.SetHex(this.style.stroke.color),t.outlineColor.Normalize(),t.outline=this.style.stroke.lineWidth+.2),this}},{key:"SetShape",value:function(t){return this.shape=t,this}}])&&Ln(e.prototype,n),r&&Ln(e,r),t}();function jn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Vn=function(){function t(e,n,r,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.shape=new Ae(e,n,r,i),this.programController=null,this.style=On(o)}var e,n,r;return e=t,(n=[{key:"Render",value:function(t){var e=this.shape.s,n=this.shape.e,r=this.style;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(n.x,n.y),!0===r.shadow.applied&&r.shadow.Apply(t),!0===r.stroke.applied&&(r.stroke.Apply(t),t.stroke())}},{key:"GLRender",value:function(t,e){null!==this.programController&&this.programController.Execute(e.globalTransform.AsArray(!0),this.shape.s,this.shape.e)}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.color&&(t.color.SetHex(this.style.stroke.color),t.color.Normalize()),this}},{key:"SetShape",value:function(t){return this.shape=t,this}}])&&jn(e.prototype,n),r&&jn(e,r),t}();function Mn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Gn=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.shape=new xe(e),this.programController=null,this.style=Pn(n)}var e,n,r;return e=t,(n=[{key:"Render",value:function(t){var e=this.shape.vertices,n=this.style;t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var r=1;r<e.length;++r)t.lineTo(e[r].x,e[r].y);t.closePath(),!0===n.shadow.applied&&n.shadow.Apply(t),!0===n.fill.applied&&(n.fill.Apply(t),t.fill()),!0===n.stroke.applied&&(n.stroke.Apply(t),t.stroke())}},{key:"SetShape",value:function(t){return this.shape=t,this}}])&&Mn(e.prototype,n),r&&Mn(e,r),t}();function Nn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Fn=Math.max,Un=Math.min,Xn=Math.round,Yn=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.channel=new Float32Array([null==e?0:e,null==n?0:n,null==r?0:r,null==i?1:i]),this.value="",this.currentConversion=Hn,this.ComputeValueRGBA()}var e,n,r;return e=t,(n=[{key:"Copy",value:function(){var e=new t(this.channel[0],this.channel[1],this.channel[2],this.channel[3]);return e.value=this.value,e.currentConversion=this.currentConversion,e}},{key:"ComputeValueRGBA",value:function(){return this.value="rgba(".concat(this.channel.join(",").concat(")")),this}},{key:"ComputeValueHSLA",value:function(){return this.value="hsla("+this.channel[0]+","+this.channel[1]+"%,"+this.channel[2]+"%,"+this.channel[3]+")",this}},{key:"ComputeValueHex",value:function(){return this.value="#"+this.channel[0].toString(16)+this.channel[1].toString(16)+this.channel[2].toString(16),this}},{key:"Mix",value:function(e,n){var r=1-n;return new t(this.channel[0]*n+e.channel[0]*r,this.channel[1]*n+e.channel[1]*r,this.channel[2]*n+e.channel[2]*r,this.channel[3]*n+e.channel[3]*r)}},{key:"ConvertToHSLA",value:function(t){var e=0,n=0,r=this.channel[0]/qn,i=this.channel[1]/qn,o=this.channel[2]/qn,a=Fn(r,i,o),s=Un(r,i,o),u=a-s,l=.5*(a+s);a!==s&&(n=l>.5?u/(2-a-s):u/(a+s),e=a===r?(i-o)/u+(i<o?6:0):a===i?(o-r)/u+2:(r-i)/u+4,e/=6),this.channel[0]=360*e,this.channel[1]=100*n,this.channel[2]=100*l,!0===t&&(this.channel[0]=Xn(this.channel[0]),this.channel[1]=Xn(this.channel[1]),this.channel[2]=Xn(this.channel[2])),this.currentConversion=Wn,this.ComputeValueHSLA()}},{key:"SetRGB",value:function(t,e,n,r){return this.channel[0]=Object(L.Clamp)(t,zn,qn),this.channel[1]=Object(L.Clamp)(e,zn,qn),this.channel[2]=Object(L.Clamp)(n,zn,qn),this.currentConversion=Hn,r||this.ComputeValueRGBA(),this}},{key:"SetRGBA",value:function(t,e,n,r){return this.SetRGB(t,e,n,!0),this.channel[3]=Object(L.Clamp)(r,0,1),this.ComputeValueRGBA(),this}},{key:"SetHex",value:function(t){var e=(t=t.replace(/#/g,"")).match(/.{2}/g);return null==(e=e.map(L.Base16ToBase10))[3]&&(e[3]=1),this.SetRGBA(e[0],e[1],e[2],e[3]),this}},{key:"IncreaseChannel",value:function(t,e){return this.channel[t]+=e,this.currentConversion===Hn?this.ComputeValueRGBA():this.currentConversion===Wn&&this.ComputeValueHSLA(),this}},{key:"SetChannel",value:function(t,e){return this.channel[t]=e,this.currentConversion===Hn?this.ComputeValueRGBA():this.currentConversion===Wn&&this.ComputeValueHSLA(),this}},{key:"SetSame",value:function(t){return this.channel[0]=this.channel[1]=this.channel[2]=t,this.currentConversion===Hn?this.ComputeValueRGBA():this.currentConversion===Wn&&this.ComputeValueHSLA(),this}},{key:"Normalize",value:function(){return this.channel[0]=Kn*this.channel[0],this.channel[1]=Kn*this.channel[1],this.channel[2]=Kn*this.channel[2],this}},{key:"r",get:function(){return this.channel[0]},set:function(t){this.channel[0]=t}},{key:"g",get:function(){return this.channel[1]},set:function(t){this.channel[1]=t}},{key:"b",get:function(){return this.channel[2]},set:function(t){this.channel[2]=t}},{key:"a",get:function(){return this.channel[3]},set:function(t){this.channel[3]=t}}])&&Nn(e.prototype,n),r&&Nn(e,r),t}(),Hn="RGB",Wn="HSL",qn=255,zn=0,Kn=1/qn;function Jn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Qn=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.shape=new st.a(e,n),this.style=_n(r),this.color=new Yn,this.programController=null,this.bufferData=null}var e,n,r;return e=t,(n=[{key:"GLRender",value:function(t,e){null!==this.programController&&this.programController.Execute(e.worldTransform.AsArray(!0),this.shape.x,this.shape.y)}},{key:"LinkProgramController",value:function(t){return this.programController=t,this.LinkStyle(),this}},{key:"UseProgramController",value:function(t){return this.programController=t,this}},{key:"LinkStyle",value:function(){var t=this.programController;return null!==t&&null!==t.color&&(t.color.SetHex(this.style.pixel.color),t.color.Normalize()),this}},{key:"GetBufferData",value:function(){null==this.bufferData&&(this.bufferData=[]);var t=this.bufferData,e=this.color;return t[0]=this.shape.x,t[1]=this.shape.y,t[2]=e.r,t[3]=e.g,t[4]=e.b,t[5]=e.a,t[6]=this.style.pixel.size,t}},{key:"UpdateInBuffer",value:function(t,e){var n=this.color;t[e]=this.shape.x,t[e+1]=this.shape.y,t[e+2]=n.r,t[e+3]=n.g,t[e+4]=n.b,t[e+5]=n.a,t[e+6]=this.style.pixel.size}},{key:"SetShape",value:function(t){return this.shape=t,this}}])&&Jn(e.prototype,n),r&&Jn(e,r),t}();function $n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Zn=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=n,this.holderContext=null==e?n:e,this.handle=r,this.removeOnNextCall=i}var e,n,r;return e=t,(n=[{key:"Execute",value:function(){this.handle.apply(this.context,arguments),!0===this.removeOnNextCall&&this.Remove()}},{key:"Remove",value:function(){this.holderContext.Remove(this.handle,this.context)}}])&&$n(e.prototype,n),r&&$n(e,r),t}();function tr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var er=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.listeners=[],this.stopPropagation=!1,this.target=null,this.data=null}var e,n,r;return e=t,(n=[{key:"GetListenerIndex",value:function(t,e){var n,r=this.listeners;if(0===r.length)return-1;for(var i=0;i<r.length;++i)if((n=r[i]).context===e&&n.handle===t)return i;return-1}},{key:"Add",value:function(t,e,n){this.listeners.push(new Zn(this,e,t,n))}},{key:"Once",value:function(t,e){this.Add(t,e,!0)}},{key:"Remove",value:function(t,e){var n=this.GetListenerIndex(t,e);-1!==n&&this.listeners.fickleSplice(n)}},{key:"Dump",value:function(t){var e=this.listeners;if(void 0!==t)for(var n=0;n<e.length;++n)e[n].context===t&&e.splice(n);else e.length=0}},{key:"Dispatch",value:function(t,e){var n=this.listeners.slice();if(0!==n.length){this.stopPropagation=!1,this.target=t,this.data=e;for(var r=0;r<n.length&&(n[r].Execute(this),!0!==this.stopPropagation);++r);this.target=null,this.data=null}}}])&&tr(e.prototype,n),r&&tr(e,r),t}();function nr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var rr=Math.round,ir=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.stopTime=rr(null==e?0:e),this.time=0,this.isRunning=!1,this.canResume=!1,this.count=0,this.onStop=new er,this.onFinish=new er,this.onStart=new er,this.onReset=new er,this.onPause=new er,this.onResume=new er}var e,n,r;return e=t,(n=[{key:"Reset",value:function(){return this.onReset.Dispatch(this,null),this.count=0,this.time=0,this.isRunning=!1,this.canResume=!1,this}},{key:"Start",value:function(t){return this.stopTime=rr(null==t?this.stopTime:t),this.stopTime>0&&(this.time=0,this.isRunning=!0,this.canResume=!1,this.onStart.Dispatch(this,{stopTime:this.stopTime})),this}},{key:"Stop",value:function(){return!0===this.isRunning&&(this.isRunning=!1,this.onStop.Dispatch(this,null)),this}},{key:"Pause",value:function(){return!0===this.isRunning&&!1===this.canResume&&(this.isRunning=!1,this.canResume=!0,this.onPause.Dispatch(this,null)),this}},{key:"Resume",value:function(){return!0===this.canResume&&(this.isRunning=!0,this.canResume=!1,this.onResume.Dispatch(this,null)),this}},{key:"Process",value:function(){this.time<this.stopTime&&!0===this.isRunning&&++this.time>=this.stopTime&&(this.isRunning=!1,this.count++,this.onFinish.Dispatch(this,null))}}])&&nr(e.prototype,n),r&&nr(e,r),t}(),or=n(8),ar=function(t){return t.replace(/\/\*[\s\S]*?\*\//g,"").replace(/[\r\t]/g," ").replace(/[ ]{2,}/g," ").replace(/[\n ]{2,}/g,"\n").replace(/\/\/.*/g,"").replace(/\s*(\=|\+|\-|\*|\/|\<|\>|\(|\)|\{|\}|\,|\:|\;|\?)\s*/g,"$1").trim()},sr=function(t){var e,n,r,i,o=t.match(/\((import .[\s\S]*?)\/\)/);if(null==o)return null;if((e=o[1].match(/\[([\s\S]*?)\]/))&&(o[1]=o[1].replace(e[0],""),e=JSON.parse(e[1])),r=o[1].match(/\'(.[\s\S]*?)\'/)[1],i=ur[r],null!=e){if(null!=e.replace)for(n in e.replace)i=i.replace(new RegExp(n,"g"),e.replace[n]);if(null!=e.set)for(n in e.set){var a=i.match(new RegExp("("+n+"\\s*=\\s*.*?;)",""));if(a){var s=a[1].match(/=([\s\S]*?);/);s[1]=a[1].replace(s[1],e.set[n]),i=i.replace(a[1],s[1])}}}return{imp:o,snippet:i}},ur={VERTEX_TEXTURE_DEFAULT:ar(n(20).default),VERTEX_TEXTURE_TRANSFORM:ar(n(21).default),PI:ar(n(22).default),RADIAN:ar(n(23).default),RSEEDS:ar(n(24).default),VRSEEDS:ar(n(25).default),mod289:ar(n(26).default),permute:ar(n(27).default),rotate2d:ar(n(28).default),scale2d:ar(n(29).default),plot:ar(n(30).default),ridge:ar(n(31).default),pixelate:ar(n(32).default),random:ar(n(33).default),vrandom:ar(n(34).default),noise:ar(n(35).default),gnoise:ar(n(36).default),snoise:ar(n(37).default),fbm:ar(n(38).default),abs_fbm:ar(n(39).default),rot_fbm:ar(n(40).default),rmf:ar(n(41).default),aabb:ar(n(42).default),cruciform:ar(n(43).default),circle:ar(n(44).default)},lr=function(t){var e,n,r="@vertex@",i="@fragment@";e=t.indexOf(r)+r.length,n=t.indexOf("@vertex-end@");var o=t.substring(e,n).replace(/\/\*[\s\S]*?\*\//g,"");e=t.indexOf(i)+i.length,n=t.indexOf("@fragment-end@");for(var a=t.substring(e,n).replace(/\/\*[\s\S]*?\*\//g,""),s=!0;!0===s;){s=!1;var u=sr(o);null!=u&&(o=o.replace(u.imp[0],u.snippet),s=!0);var l=sr(a);null!=l&&(a=a.replace(l.imp[0],l.snippet),s=!0)}return{vertex:ar(o),fragment:ar(a)}},cr=lr("/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\n(import 'VERTEX_TEXTURE_TRANSFORM' /)\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision highp float;\r\n\r\nuniform sampler2D uImage;\r\nuniform vec4 uTint;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_FragColor = TEX( uImage, vTexCoord ) * uTint;\r\n}\r\n@fragment-end@"),hr=lr("/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision highp float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\n\r\nattribute vec3 aProjection1;\r\nattribute vec3 aProjection2;\r\nattribute vec3 aProjection3;\r\n\r\nattribute vec3 aTranslation1;\r\nattribute vec3 aTranslation2;\r\nattribute vec3 aTranslation3;\r\n\r\nattribute vec3 aTransformation1;\r\nattribute vec3 aTransformation2;\r\nattribute vec3 aTransformation3;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    mat3 projection = mat3( aProjection1, aProjection2, aProjection3 );\r\n    mat3 translation = mat3( aTranslation1, aTranslation2, aTranslation3 );\r\n    mat3 transformation = mat3( aTransformation1, aTransformation2, aTransformation3 );\r\n    gl_Position = vec4( ( projection * translation * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vTexCoord = ( transformation * vec3( aTexCoord, 1.0 ) ).xy;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision highp float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_FragColor = TEX( uImage, vTexCoord );\r\n}\r\n@fragment-end@"),fr=lr("/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision highp float;\r\n\r\nattribute vec3 aProjection1;\r\nattribute vec3 aProjection2;\r\nattribute vec3 aProjection3;\r\nattribute vec2 aPosition;\r\nattribute vec4 aColor;\r\nattribute float aPointSize;\r\n\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n    mat3 projection = mat3( aProjection1, aProjection2, aProjection3 );\r\n    gl_Position = vec4( ( projection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n    gl_PointSize = aPointSize;\r\n    vColor = aColor;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision highp float;\r\n\r\nvarying vec4 vColor;\r\n\r\nvoid main() {\r\n    gl_FragColor = vColor;\r\n}\r\n@fragment-end@"),dr=lr("/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision highp float;\r\n\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\nuniform vec2 uSize;\r\nuniform float uOutline;\r\n\r\nvarying vec2 vPosition;\r\nvarying float vBorderX;\r\nvarying float vNegBorderX;\r\nvarying float vBorderY;\r\nvarying float vNegBorderY;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vPosition = aPosition;\r\n    vBorderX = -uSize.x * 0.5 + uOutline;\r\n    vNegBorderX = uSize.x * 0.5 - uOutline;\r\n    vBorderY = -uSize.y * 0.5 + uOutline;\r\n    vNegBorderY = uSize.y * 0.5 - uOutline;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision highp float;\r\n\r\nuniform lowp vec4 uFillColor;\r\nuniform lowp vec4 uOutlineColor;\r\n\r\nvarying vec2 vPosition;\r\nvarying float vBorderX;\r\nvarying float vNegBorderX;\r\nvarying float vBorderY;\r\nvarying float vNegBorderY;\r\n\r\nvoid main() {\r\n    if (\r\n      vPosition.x > vBorderX &&\r\n      vPosition.x < vNegBorderX && \r\n      vPosition.y > vBorderY && \r\n      vPosition.y < vNegBorderY\r\n    ) {\r\n      gl_FragColor = uFillColor;\r\n    } else {\r\n      gl_FragColor = uOutlineColor;\r\n    }\r\n}\r\n@fragment-end@"),pr=lr("/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision highp float;\r\n\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\n\r\nvarying vec2 vPosition;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vPosition = aPosition;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision highp float;\r\n\r\nuniform lowp vec4 uFillColor;\r\nuniform lowp vec4 uOutlineColor;\r\nuniform float uRadius;\r\nuniform float uOutline;\r\n\r\nvarying vec2 vPosition;\r\n\r\nvoid main() {\r\n    float d = dot( vPosition, vPosition );\r\n    float rs = uRadius * uRadius;\r\n    float ors = uRadius - uOutline;\r\n    ors = ors * ors;\r\n    if ( d < rs && d > ors ) {\r\n      gl_FragColor = uOutlineColor;\r\n    } else if ( d < rs ) {\r\n      gl_FragColor = uFillColor;\r\n    }\r\n}\r\n@fragment-end@"),yr=lr("/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision highp float;\r\n\r\nattribute vec2 aPosition;\r\n\r\nuniform mat3 uProjection;\r\n\r\nuniform lowp vec4 uColor;\r\n\r\nvoid main() {\r\n    gl_Position = vec4( ( uProjection * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\nprecision highp float;\r\n\r\nuniform lowp vec4 uColor;\r\n\r\nvoid main() {\r\n    gl_FragColor = uColor;\r\n}\r\n@fragment-end@"),vr=lr('/**\r\n* @author Gustav \'Nuuf\' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\nprecision highp float;\r\n\r\nattribute vec2 a_v2Position;\r\n\r\nuniform mat3 u_m3Projection;\r\n\r\nvarying vec2 v_v2Position;\r\n\r\nvoid main() {\r\n  gl_Position = vec4( ( u_m3Projection * vec3( a_v2Position, 1.0 ) ).xy, 0.0, 1.0 );\r\n  v_v2Position = a_v2Position;\r\n}\r\n@vertex-end@\r\n\r\n@fragment@\r\n\r\n(import \'RADIAN\' /)\r\n\r\nprecision highp float;\r\n\r\nuniform float u_fTime;\r\nuniform vec2 u_v2Resolution;\r\n\r\nvarying vec2 v_v2Position;\r\n\r\n(import \'rotate2d\' /)\r\n(import \'mod289\' /)\r\n(import \'permute\' /)\r\n(import \'snoise\' /)\r\n(import \'ridge\' /)\r\n(import \'pixelate\' /)\r\n(import \'rmf\' [\r\n  {\r\n    "set": {\r\n      "OFFSET": "1.0 + 0.1 * abs( sin( u_fTime ) )",\r\n      "OCTAVES": "19"\r\n    }\r\n  }\r\n] /)\r\n(import \'rmf\' [\r\n  {\r\n    "replace": {\r\n      "rmf": "rmf2"\r\n    },\r\n    "set": {\r\n      "OFFSET": "0.5 + 0.1 * abs( sin( u_fTime ) )",\r\n      "OCTAVES": "3"\r\n    }\r\n  }\r\n] /)\r\n\r\nvoid main() {\r\n\r\n  vec2 pos = v_v2Position / u_v2Resolution;\r\n\r\n  float sp = 4.0 * u_fTime;\r\n\r\n  pos *= -1.0; \r\n\r\n  pos = pixelate( pos, 1028 );\r\n\r\n  // pos *= rotate2d( RADIAN * sp );\r\n  \r\n  pos += sp / 100.0;\r\n\r\n  vec3 color = vec3( 0.0, rmf2( pos * 10.0 ) * rmf( pos * 0.4 ), 0.0 );\r\n\r\n  color = mix( color * rmf( pos ), vec3( 0.9, 0.0, 0.9 ), 0.2 );\r\n\r\n  gl_FragColor = vec4( color, 1.0 );\r\n  \r\n}\r\n\r\n@fragment-end@'),mr=lr("/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\n(import 'VERTEX_TEXTURE_DEFAULT' /)\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision highp float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    vec4 color = TEX( uImage, vTexCoord );\r\n    gl_FragColor = vec4( vec3( step( 1.0, color.r + color.g + color.b / 3.0 ) ), color.a );\r\n}\r\n@fragment-end@"),br=lr("/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\n(import 'VERTEX_TEXTURE_DEFAULT' /)\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision highp float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    vec4 color = TEX( uImage, vTexCoord );\r\n    gl_FragColor = vec4( vec3( color.r + color.g + color.b / 3.0 ), color.a );\r\n}\r\n@fragment-end@"),gr=lr("/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\n(import 'VERTEX_TEXTURE_DEFAULT' /)\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision highp float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    vec4 color = TEX( uImage, vTexCoord );\r\n    gl_FragColor = vec4( vec3(\r\n      ( color.r * 0.393 ) + ( color.g * 0.769 ) + ( color.b * 0.189 ),\r\n      ( color.r * 0.349 ) + ( color.g * 0.686 ) + ( color.b * 0.168 ),\r\n      ( color.r * 0.272 ) + ( color.g * 0.534 ) + ( color.b * 0.131 )\r\n    ), color.a );\r\n}\r\n@fragment-end@"),wr=lr("/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\n(import 'VERTEX_TEXTURE_DEFAULT' /)\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision highp float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    vec4 color = TEX( uImage, vTexCoord );\r\n    gl_FragColor = vec4( vec3(\r\n      1.0 - color.r,\r\n      1.0 - color.g,\r\n      1.0 - color.b\r\n    ), color.a );\r\n}\r\n@fragment-end@"),Ar=lr("/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\n(import 'VERTEX_TEXTURE_DEFAULT' /)\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision highp float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    gl_FragColor =  TEX( uImage, vTexCoord );\r\n}\r\n@fragment-end@"),Sr=lr("/**\r\n* @author Gustav 'Nuuf' Åberg <gustavrein@gmail.com>\r\n*/\r\n\r\n@vertex@\r\n(import 'VERTEX_TEXTURE_TRANSFORM' /)\r\n@vertex-end@\r\n\r\n@fragment@\r\n#if __VERSION__ < 130\r\n#define TEX texture2D\r\n#else\r\n#define TEX texture\r\n#endif\r\n\r\nprecision highp float;\r\n\r\nuniform sampler2D uImage;\r\n\r\nvarying vec2 vTexCoord;\r\n\r\nvoid main() {\r\n    vec4 color = TEX( uImage, vTexCoord );\r\n    gl_FragColor = color;\r\n}\r\n@fragment-end@"),Cr=function(t){var e,n=[];for(n.push("precision highp float;"),e=0;e<t;++e)n.push("attribute vec2 aPosition"+e+";","attribute vec2 aTexCoord"+e+";");for(n.push("uniform mat3 uProjection;","uniform mat3 uTranslation;","uniform mat3 uTransformation;","uniform int uUnitId;","varying vec2 vTexCoord;","void main () {","if ( uUnitId == 0 ) {","gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition0, 1.0 ) ).xy, 0.0, 1.0 );","vTexCoord = ( uTransformation * vec3( aTexCoord0, 1.0 ) ).xy;","}"),e=1;e<t;++e)n.push("else if ( uUnitId == "+e+" ) {","gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition"+e+", 1.0 ) ).xy, 0.0, 1.0 );","vTexCoord = ( uTransformation * vec3( aTexCoord"+e+", 1.0 ) ).xy;","}");return n.push("}"),{vertex:n.join(""),fragment:cr.fragment}},Tr=n(5);function xr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Er(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Pr=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,this.items=[]}var e,n,r;return e=t,(n=[{key:"Store",value:function(t){var e=!1;return null==t?(console.warn("Item is null."),!1):(null!=t.id&&""!==t.id?e=!this.Contains(t,t.id):t.data&&null!=t.data.id&&""!==t.data.id&&(e=!this.Contains(t,t.data.id)),!1===e?(console.warn("Invalid item. Check the item id. The item has not been stored"),!1):(this.items.push(t),!0))}},{key:"StoreSafe",value:function(t){return null!=this.type&&Object(Tr.a)(t,Tr.a.IS_INSTANCE_OF,this.type),Object(Tr.a)(t,Tr.a.IS_SAME_TYPE,Or),t.id?(Object(Tr.a)(t.id,Tr.a.IS_SAME_TYPE,kr),Object(Tr.a)(t.id,Tr.a.IS_NOT,"")):(Object(Tr.a)(t.data,Tr.a.IS_SAME_TYPE,Or),Object(Tr.a)(t.data.id,Tr.a.IS_SAME_TYPE,kr),Object(Tr.a)(t.data.id,Tr.a.IS_NOT,"")),this.Store(t)}},{key:"GetById",value:function(t){if(!t)throw new Error("ID Null or Undefined");for(var e=this.items,n=xr(e,1)[0],r=0;r<e.length;n=e[++r])if(null!=n&&(n.id===t||null!=n.data&&n.data.id===t))return n;return null}},{key:"Contains",value:function(t,e){if(!e)throw new Error("ID Null or Undefined");for(var n=this.items,r=xr(n,1)[0],i=0;i<n.length;r=n[++i])if(null!=r){if(r===t)return!0;if(r.id===e)return!0;if(null!=r.data&&r.data.id===e)return!0}return!1}}])&&Er(e.prototype,n),r&&Er(e,r),t}(),Or=Object.create(null),kr="string";var Rr=function t(e,n,r,i,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.image=e,this.id=null,this.w=0,this.h=0,this.fw=0,this.fh=0,this.uniformId=0,this.id=null!=n?n:e.id,this.w=null!=r?r:e.naturalWidth,this.h=null!=i?i:e.naturalHeight,this.fw=null!=o?o:e.naturalWidth,this.fh=null!=a?a:e.naturalHeight};function _r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Dr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ir=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.imageCache=new Pr(Image),this.basicTextureCache=new Pr(Rr),this.onImageLoaded=new er,this.onComplete=new er,this.onError=new er,this.toLoadCount=0,this.loadedCount=0,this.loading=!1,this.createTextures=!1,null!=r&&this.onComplete.Once(r),null!=e&&this.Load(e,n)}var e,n,r;return e=t,(n=[{key:"Load",value:function(t,e){!1===this.loading&&(this.loading=!0,this.loadedCount=0,this.toLoadCount=0),this.createTextures=!!e;var n=t.length,r=_r(t,1)[0];this.toLoadCount+=n;for(var i=0;i<t.length;r=t[++i]){var o=new Image;o.onload=this.OnLoad.bind(this),o.onerror=this.OnError.bind(this),o.id=r.id,o.data=Object.create(null),o.data.w=r.w,o.data.h=r.h,o.data.fw=r.fw,o.data.fh=r.fh,o.src=r.src}}},{key:"OnLoad",value:function(t){var e=t.currentTarget;delete e.onload,delete e.onerror,this.imageCache.StoreSafe(e),!0===this.createTextures&&this.basicTextureCache.StoreSafe(new Rr(e,null,e.data.w,e.data.h,e.data.fw,e.data.fh)),this.onImageLoaded.Dispatch(e,{loadedCount:++this.loadedCount}),this.loadedCount===this.toLoadCount&&(this.loading=!1,this.onComplete.Dispatch(this,{imageCache:this.imageCache,basicTextureCache:this.basicTextureCache}))}},{key:"OnError",value:function(t){this.onError.Dispatch(null,t)}},{key:"GetImageById",value:function(t){return this.imageCache.GetById(t)}},{key:"GetBasicTextureById",value:function(t){return this.basicTextureCache.GetById(t)}}])&&Dr(e.prototype,n),r&&Dr(e,r),t}();function Lr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Br(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var jr=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.XHRcache=new Pr(XMLHttpRequest),this.dataCache=new Pr,this.onXHRLoaded=new er,this.onComplete=new er,this.onNetworkError=new er,this.onLoadError=new er,this.toLoadCount=0,this.loadedCount=0,this.loading=!1,null!=n&&this.onComplete.Once(n),null!=e&&this.Load(e)}var e,n,r;return e=t,(n=[{key:"Load",value:function(t){!1===this.loading&&(this.loading=!0,this.loadedCount=0,this.toLoadCount=0);var e=t.length,n=Lr(t,1)[0];this.toLoadCount+=e;for(var r=0;r<t.length;n=t[++r]){var i=new XMLHttpRequest;switch(i.open("GET",n.src),n.type){case"json":i.onreadystatechange=this.OnLoadJSON.bind(this);break;default:i.onreadystatechange=this.OnLoadXML.bind(this)}i.onerror=this.OnNetworkError.bind(this),null!=i.data?i.data.id=n.id:(i.data=Object.create(null),i.data.id=n.id),i.send()}}},{key:"OnDataLoaded",value:function(t){var e=t.currentTarget;this.onXHRLoaded.Dispatch(e,{loadedCount:++this.loadedCount}),this.loadedCount===this.toLoadCount&&(this.loading=!1,this.onComplete.Dispatch(this,{XHRcache:this.XHRcache,dataCache:this.dataCache}))}},{key:"OnLoadXML",value:function(t){var e=t.currentTarget;200!==e.status&&null==e.responseText||4!==e.readyState?404!==e.status&&500!==e.status&&0!==e.status||this.onLoadError.Dispatch(e):(e.onload=null,e.onerror=null,this.XHRcache.StoreSafe(e),this.dataCache.Store({id:e.data.id,data:H(e.responseText,!0)}),this.OnDataLoaded(t),e.abort())}},{key:"OnLoadJSON",value:function(t){var e=t.currentTarget;200!==e.status&&null==e.responseText||4!==e.readyState?404!==e.status&&500!==e.status&&0!==e.status||this.onLoadError.Dispatch(e):(e.onload=null,e.onerror=null,this.XHRcache.StoreSafe(e),this.dataCache.Store({id:e.data.id,data:JSON.parse(e.responseText)}),this.OnDataLoaded(t),e.abort())}},{key:"OnNetworkError",value:function(t){this.onNetworkError.Dispatch(null,t)}},{key:"GetXHRById",value:function(t){return this.XHRcache.GetById(t)}},{key:"GetDataById",value:function(t){return this.dataCache.GetById(t).data}},{key:"CloneDataById",value:function(t){return Object(L.DeepClone)(this.GetDataById(t))}}])&&Br(e.prototype,n),r&&Br(e,r),t}();function Vr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Mr=function(){function t(e,n,r,i,o,a,s,u,l,c){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.duration=this.timer=o,this.x=e,this.y=n,this.w=r,this.h=i,this.offsetX=null==s?0:s,this.offsetY=null==u?0:u,this.originW=null==l?r:l,this.originH=null==c?i:c,this.id=null!=a?a:null}var e,n,r;return e=t,(n=[{key:"Copy",value:function(){return new t(this.x,this.y,this.w,this.h,this.duration,this.id,this.offsetX,this.offsetY,this.originW,this.originH)}},{key:"Process",value:function(){return this.timer--<=0&&(this.Reset(),!0)}},{key:"Apply",value:function(t,e){return!0===e&&(t.w=this.w,t.h=this.h),t.ClipReconfigure(this.x,this.y,this.w,this.h,this.offsetX,this.offsetY,this.originW,this.originH),this}},{key:"FullApply",value:function(t){return this.Apply(t),t.w=this.w,t.h=this.h,t.scale.SetSame(1),this}},{key:"Reset",value:function(){return this.timer=this.duration,this}}])&&Vr(e.prototype,n),r&&Vr(e,r),t}();function Gr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Nr=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.id,this.basicTexture=e,this.data=n,this.frameCache=new Pr(Mr)}var e,n,r;return e=t,(n=[{key:"GenerateFrames",value:function(){for(var t,e,n,r,i,o=this.data,a=o.frames,s=o.meta.frameTags,u=0;u<a.length;++u)e=(t=a[u]).frame,r=t.spriteSourceSize,i=t.sourceSize,n=s[u],this.frameCache.Store(new Mr(e.x,e.y,e.w,e.h,t.duration,n?n.name:a[u].filename,r.x,r.y,i.w,i.h))}},{key:"GetFrameById",value:function(t){return this.frameCache.GetById(t)}}])&&Gr(e.prototype,n),r&&Gr(e,r),t}();function Fr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ur(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Xr=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.spritesheetCache=new Pr(Nr),this.xhrLoader=new jr,this.imageLoader=new Ir,this.onComplete=new er,this.onSpritesheetLoaded=new er,this.toLoadCount=0,this.loadedCount=0,this.loading=!1,this.xhrLoader.onXHRLoaded.Add(this.OnPartXHRLoaded,this),this.imageLoader.onImageLoaded.Add(this.OnPartImageLoaded,this),null!=n&&this.onComplete.Once(n),null!=e&&this.Load(e)}var e,n,r;return e=t,(n=[{key:"Load",value:function(t){!1===this.loading&&(this.loading=!0,this.loadedCount=0,this.toLoadCount=0);var e=t.length,n=Fr(t,1)[0];this.toLoadCount+=e;for(var r=[],i=[],o=0;o<t.length;n=t[++o])n.data.id=n.image.id=n.id,r.push(n.data),i.push(n.image);this.xhrLoader.Load(r),this.imageLoader.Load(i,!0)}},{key:"OnSpritesheetLoaded",value:function(t){var e=this.imageLoader.GetBasicTextureById(t),n=this.xhrLoader.GetDataById(t),r=new Nr(e,n);this.spritesheetCache.StoreSafe(r),this.onSpritesheetLoaded.Dispatch(r,{loadedCount:++this.loadedCount}),this.loadedCount===this.toLoadCount&&(this.loading=!1,this.onComplete.Dispatch(this,{spritesheetCache:this.spritesheetCache}))}},{key:"OnPartXHRLoaded",value:function(t){var e=t.target.data.id;this.imageLoader.imageCache.Contains(null,e)&&this.OnSpritesheetLoaded(e)}},{key:"OnPartImageLoaded",value:function(t){var e=t.target.id;this.xhrLoader.dataCache.Contains(null,e)&&this.OnSpritesheetLoaded(e)}},{key:"GetSpritesheetById",value:function(t){return this.spritesheetCache.GetById(t)}}])&&Ur(e.prototype,n),r&&Ur(e,r),t}();var Yr=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.id,this.basicTexture=e,this.mapData=n,this.setData=r,this.pc=null};function Hr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Wr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var qr=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tilesetCache=new Pr(Yr),this.mapDataLoader=new jr,this.setDataLoader=new jr,this.imageLoader=new Ir,this.onComplete=new er,this.onTilesetLoaded=new er,this.toLoadCount=0,this.loadedCount=0,this.loading=!1,this.mapDataLoader.onXHRLoaded.Add(this.OnPartMapDataLoaded,this),this.setDataLoader.onXHRLoaded.Add(this.OnPartSetDataLoaded,this),this.imageLoader.onImageLoaded.Add(this.OnPartImageLoaded,this),null!=n&&this.onComplete.Once(n),null!=e&&this.Load(e)}var e,n,r;return e=t,(n=[{key:"Load",value:function(t){!1===this.loading&&(this.loading=!0,this.loadedCount=0,this.toLoadCount=0);var e=t.length,n=Hr(t,1)[0];this.toLoadCount+=e;for(var r=[],i=[],o=[],a=0;a<t.length;n=t[++a])n.mapData.id=n.setData.id=n.image.id=n.id,r.push(n.mapData),i.push(n.setData),o.push(n.image);this.mapDataLoader.Load(r),this.setDataLoader.Load(i),this.imageLoader.Load(o,!0)}},{key:"OnTilesetLoaded",value:function(t){var e=this.imageLoader.GetBasicTextureById(t),n=this.mapDataLoader.GetDataById(t),r=this.setDataLoader.GetDataById(t),i=new Yr(e,n,r);this.tilesetCache.StoreSafe(i),this.onTilesetLoaded.Dispatch(i,{loadedCount:++this.loadedCount}),this.loadedCount===this.toLoadCount&&(this.loading=!1,this.onComplete.Dispatch(this,{spritesheetCache:this.spritesheetCache}))}},{key:"OnPartMapDataLoaded",value:function(t){var e=t.target.data.id;this.imageLoader.imageCache.Contains(null,e)&&this.setDataLoader.dataCache.Contains(null,e)&&this.OnTilesetLoaded(e)}},{key:"OnPartSetDataLoaded",value:function(t){var e=t.target.data.id;this.imageLoader.imageCache.Contains(null,e)&&this.mapDataLoader.dataCache.Contains(null,e)&&this.OnTilesetLoaded(e)}},{key:"OnPartImageLoaded",value:function(t){var e=t.target.id;this.mapDataLoader.dataCache.Contains(null,e)&&this.setDataLoader.dataCache.Contains(null,e)&&this.OnTilesetLoaded(e)}},{key:"GetTilesetById",value:function(t){return this.tilesetCache.GetById(t)}}])&&Wr(e.prototype,n),r&&Wr(e,r),t}();function zr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Kr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Jr=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.loaders=e,this.loaderCount=0,this.onComplete=new er,null!=n&&this.onComplete.Once(n)}var e,n,r;return e=t,(n=[{key:"Load",value:function(){for(var t=this.loaders,e=zr(t,1)[0],n=0;n<t.length;e=t[++n])e.loader.onComplete.Once(this.OnLoaderComplete,this),e.loader.Load.apply(e.loader,e.args)}},{key:"OnLoaderComplete",value:function(){if(++this.loaderCount===this.loaders.length){for(var t=this.loaders,e=zr(t,1)[0],n=0;n<t.length;e=t[++n])t[n]=e.loader;this.onComplete.Dispatch()}}}])&&Kr(e.prototype,n),r&&Kr(e,r),t}();function Qr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $r=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.data={},this.program=null,this.attributes=null,this.uniforms=null,null!=e&&null!=n&&this.Init(n.vertex,n.fragment)}var e,n,r;return e=t,r=[{key:"LAST_USED_CONTROLLER",get:function(){return Zr},set:function(t){Zr=t}}],(n=[{key:"Init",value:function(t,e){var n=this.gl,r=this.CreateShader(t,n.VERTEX_SHADER),i=this.CreateShader(e,n.FRAGMENT_SHADER),o=this.program=n.createProgram();if(n.attachShader(o,r),n.attachShader(o,i),n.linkProgram(o),!n.getProgramParameter(o,n.LINK_STATUS)){var a=n.getProgramInfoLog(o);throw new Error("Program link failed:"+a)}n.detachShader(o,r),n.detachShader(o,i),n.deleteShader(r),n.deleteShader(i),this.attributes={},this.uniforms={}}},{key:"CreateShader",value:function(t,e){var n=this.gl,r=n.createShader(e);if(n.shaderSource(r,t),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS)){var i=n.getShaderInfoLog(r);throw new Error("Shader compilation failed:"+i)}return r}},{key:"AssignAttribute",value:function(t){this.attributes[t]=this.gl.getAttribLocation(this.program,t)}},{key:"AssignUniform",value:function(t){this.uniforms[t]=this.gl.getUniformLocation(this.program,t)}},{key:"Execute",value:function(){}}])&&Qr(e.prototype,n),r&&Qr(e,r),t}(),Zr=null;function ti(t){return(ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ei(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ni(t,e){return!e||"object"!==ti(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ri(t){return(ri=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ii(t,e){return(ii=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var oi=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ni(this,ri(e).call(this,t,pr))).essenceBuffer=null,n.vertices=null,n.fillColor=null,n.outlineColor=null,n.outline=5,n.Initialise(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ii(t,e)}(e,$r),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array(Object(B.TriRectArray)(0,0,1,1)),this.fillColor=new Yn,this.outlineColor=new Yn,t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uFillColor"),this.AssignUniform("uOutlineColor"),this.AssignUniform("uRadius"),this.AssignUniform("uOutline")}},{key:"Execute",value:function(t,e,n,r){var i=this.gl,o=this.attributes,a=this.uniforms,s=this.vertices,u=this.fillColor.channel,l=this.outlineColor.channel;Object(B.TriRectArray)(e-r,n-r,2*r,2*r,s),this!==$r.LAST_USED_CONTROLLER&&(i.useProgram(this.program),$r.LAST_USED_CONTROLLER=this),i.bindBuffer(i.ARRAY_BUFFER,this.essenceBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,s),i.enableVertexAttribArray(o.aPosition),i.vertexAttribPointer(o.aPosition,2,i.FLOAT,!1,0,0),i.uniformMatrix3fv(a.uProjection,!1,t),i.uniform4f(a.uFillColor,u[0],u[1],u[2],u[3]),i.uniform4f(a.uOutlineColor,l[0],l[1],l[2],l[3]),i.uniform1f(a.uOutline,this.outline),i.uniform1f(a.uRadius,r),i.drawArrays(i.TRIANGLE_STRIP,0,6)}}])&&ei(n.prototype,r),i&&ei(n,i),e}();function ai(t){return(ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function si(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ui(t,e){return!e||"object"!==ai(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function li(t){return(li=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ci(t,e){return(ci=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hi=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ui(this,li(e).call(this,t,yr))).essenceBuffer=null,n.vertices=null,n.color=null,n.Initialise(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ci(t,e)}(e,$r),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array([-1,0,1,0]),this.color=new Yn,t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uColor")}},{key:"Execute",value:function(t,e,n){var r=this.gl,i=this.attributes,o=this.uniforms,a=this.vertices,s=this.color.channel;a[0]=e.x,a[1]=e.y,a[2]=n.x,a[3]=n.y,this!==$r.LAST_USED_CONTROLLER&&(r.useProgram(this.program),$r.LAST_USED_CONTROLLER=this),r.bindBuffer(r.ARRAY_BUFFER,this.essenceBuffer),r.bufferSubData(r.ARRAY_BUFFER,0,a),r.enableVertexAttribArray(i.aPosition),r.vertexAttribPointer(i.aPosition,2,r.FLOAT,!1,0,0),r.uniformMatrix3fv(o.uProjection,!1,t),r.uniform4f(o.uColor,s[0],s[1],s[2],s[3]),r.drawArrays(r.LINES,0,2)}}])&&si(n.prototype,r),i&&si(n,i),e}();function fi(t){return(fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function di(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pi(t,e){return!e||"object"!==fi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function yi(t){return(yi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vi(t,e){return(vi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mi=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=pi(this,yi(e).call(this,t,fr))).dataBuffer=null,n.previousNumberOfElements=0,n.Initialise(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vi(t,e)}(e,$r),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.dataBuffer=t.createBuffer(),this.AssignAttribute("aProjection1"),this.AssignAttribute("aProjection2"),this.AssignAttribute("aProjection3"),this.AssignAttribute("aPosition"),this.AssignAttribute("aColor"),this.AssignAttribute("aPointSize")}},{key:"Execute",value:function(t,e){var n=this.gl,r=this.attributes;$r.LAST_USED_CONTROLLER!==this&&(n.useProgram(this.program),$r.LAST_USED_CONTROLLER=this),n.bindBuffer(n.ARRAY_BUFFER,this.dataBuffer),e!==this.previousNumberOfElements?n.bufferData(n.ARRAY_BUFFER,t,n.DYNAMIC_DRAW):n.bufferSubData(n.ARRAY_BUFFER,0,t);n.enableVertexAttribArray(r.aProjection1),n.vertexAttribPointer(r.aProjection1,3,n.FLOAT,!1,64,0),n.enableVertexAttribArray(r.aProjection2),n.vertexAttribPointer(r.aProjection2,3,n.FLOAT,!1,64,12),n.enableVertexAttribArray(r.aProjection3),n.vertexAttribPointer(r.aProjection3,3,n.FLOAT,!1,64,24),n.enableVertexAttribArray(r.aPosition),n.vertexAttribPointer(r.aPosition,2,n.FLOAT,!1,64,36),n.enableVertexAttribArray(r.aColor),n.vertexAttribPointer(r.aColor,4,n.FLOAT,!1,64,44),n.enableVertexAttribArray(r.aPointSize),n.vertexAttribPointer(r.aPointSize,1,n.FLOAT,!1,64,60),n.drawArrays(n.POINTS,0,e),this.previousNumberOfElements=e}}])&&di(n.prototype,r),i&&di(n,i),e}();function bi(t){return(bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wi(t,e){return!e||"object"!==bi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ai(t){return(Ai=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Si(t,e){return(Si=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ci=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=wi(this,Ai(e).call(this,t,dr))).essenceBuffer=null,n.vertices=null,n.fillColor=null,n.outlineColor=null,n.outline=5,n.Initialise(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Si(t,e)}(e,$r),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array(Object(B.TriRectArray)(0,0,1,1)),this.fillColor=new Yn,this.outlineColor=new Yn,t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("aPosition"),this.AssignUniform("uProjection"),this.AssignUniform("uFillColor"),this.AssignUniform("uOutlineColor"),this.AssignUniform("uSize"),this.AssignUniform("uOutline")}},{key:"Execute",value:function(t,e,n,r,i){var o=this.gl,a=this.attributes,s=this.uniforms,u=this.vertices,l=this.fillColor.channel,c=this.outlineColor.channel;Object(B.TriRectArray)(e,n,r,i,u),this!==$r.LAST_USED_CONTROLLER&&(o.useProgram(this.program),$r.LAST_USED_CONTROLLER=this),o.bindBuffer(o.ARRAY_BUFFER,this.essenceBuffer),o.bufferSubData(o.ARRAY_BUFFER,0,u),o.enableVertexAttribArray(a.aPosition),o.vertexAttribPointer(a.aPosition,2,o.FLOAT,!1,0,0),o.uniformMatrix3fv(s.uProjection,!1,t),o.uniform4f(s.uFillColor,l[0],l[1],l[2],l[3]),o.uniform4f(s.uOutlineColor,c[0],c[1],c[2],c[3]),o.uniform1f(s.uOutline,this.outline),o.uniform2f(s.uSize,r,i),o.drawArrays(o.TRIANGLE_STRIP,0,6)}}])&&gi(n.prototype,r),i&&gi(n,i),e}();function Ti(t){return(Ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ei(t,e){return!e||"object"!==Ti(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pi(t){return(Pi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oi(t,e){return(Oi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ki=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ei(this,Pi(e).call(this,t,hr))).originalTexture=null,n.texture=null,n.essenceBuffer=null,n.dataBuffer=null,n.previousNumberOfElements=0,n.Initialise(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oi(t,e)}(e,$r),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.texture=t.createTexture(),this.essenceBuffer=t.createBuffer(),this.dataBuffer=t.createBuffer(),this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignAttribute("aProjection1"),this.AssignAttribute("aProjection2"),this.AssignAttribute("aProjection3"),this.AssignAttribute("aTranslation1"),this.AssignAttribute("aTranslation2"),this.AssignAttribute("aTranslation3"),this.AssignAttribute("aTransformation1"),this.AssignAttribute("aTransformation2"),this.AssignAttribute("aTransformation3"),this.AssignUniform("uImage")}},{key:"BindBasicTexture",value:function(t,e){var n=this.gl,r=Object(B.TriRectArray)(0,0,t.w,t.h);e=null!=e?e:n.LINEAR,this.aia=n.getExtension("ANGLE_instanced_arrays"),this.originalTexture=t,r.push.apply(r,Object(B.TriRectArray)(0,0,1,1)),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t.image),n.bindBuffer(n.ARRAY_BUFFER,this.essenceBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(r),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindTexture(n.TEXTURE_2D,null)}},{key:"Execute",value:function(t,e){var n=this.gl,r=this.aia,i=this.attributes,o=this.uniforms;this!==$r.LAST_USED_CONTROLLER&&(n.useProgram(this.program),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.texture),n.uniform1i(o.uImage,0),n.bindBuffer(n.ARRAY_BUFFER,this.essenceBuffer),n.enableVertexAttribArray(i.aPosition),n.vertexAttribPointer(i.aPosition,2,n.FLOAT,!1,0,0),r.vertexAttribDivisorANGLE(i.aPosition,0),n.enableVertexAttribArray(i.aTexCoord),n.vertexAttribPointer(i.aTexCoord,2,n.FLOAT,!1,0,48),r.vertexAttribDivisorANGLE(i.aTexCoord,0),$r.LAST_USED_CONTROLLER=this),n.bindBuffer(n.ARRAY_BUFFER,this.dataBuffer),e!==this.previousNumberOfElements?(n.bufferData(n.ARRAY_BUFFER,t,n.DYNAMIC_DRAW),this.previousNumberOfElements=e):n.bufferSubData(n.ARRAY_BUFFER,0,t),n.enableVertexAttribArray(i.aProjection1),n.vertexAttribPointer(i.aProjection1,3,n.FLOAT,!1,108,0),r.vertexAttribDivisorANGLE(i.aProjection1,1),n.enableVertexAttribArray(i.aProjection2),n.vertexAttribPointer(i.aProjection2,3,n.FLOAT,!1,108,12),r.vertexAttribDivisorANGLE(i.aProjection2,1),n.enableVertexAttribArray(i.aProjection3),n.vertexAttribPointer(i.aProjection3,3,n.FLOAT,!1,108,24),r.vertexAttribDivisorANGLE(i.aProjection3,1),n.enableVertexAttribArray(i.aTranslation1),n.vertexAttribPointer(i.aTranslation1,3,n.FLOAT,!1,108,36),r.vertexAttribDivisorANGLE(i.aTranslation1,1),n.enableVertexAttribArray(i.aTranslation2),n.vertexAttribPointer(i.aTranslation2,3,n.FLOAT,!1,108,48),r.vertexAttribDivisorANGLE(i.aTranslation2,1),n.enableVertexAttribArray(i.aTranslation3),n.vertexAttribPointer(i.aTranslation3,3,n.FLOAT,!1,108,60),r.vertexAttribDivisorANGLE(i.aTranslation3,1),n.enableVertexAttribArray(i.aTransformation1),n.vertexAttribPointer(i.aTransformation1,3,n.FLOAT,!1,108,72),r.vertexAttribDivisorANGLE(i.aTransformation1,1),n.enableVertexAttribArray(i.aTransformation2),n.vertexAttribPointer(i.aTransformation2,3,n.FLOAT,!1,108,84),r.vertexAttribDivisorANGLE(i.aTransformation2,1),n.enableVertexAttribArray(i.aTransformation3),n.vertexAttribPointer(i.aTransformation3,3,n.FLOAT,!1,108,96),r.vertexAttribDivisorANGLE(i.aTransformation3,1),r.drawArraysInstancedANGLE(n.TRIANGLE_STRIP,0,6,e)}}])&&xi(n.prototype,r),i&&xi(n,i),e}();function Ri(t){return(Ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Di(t,e){return!e||"object"!==Ri(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ii(t){return(Ii=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Li(t,e){return(Li=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bi=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Di(this,Ii(e).call(this,t,cr))).originalTexture=null,n.texture=null,n.essenceBuffer=null,n.Initialise(),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Li(t,e)}(e,$r),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.texture=t.createTexture(),this.essenceBuffer=t.createBuffer(),this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignUniform("uImage"),this.AssignUniform("uProjection"),this.AssignUniform("uTranslation"),this.AssignUniform("uTransformation"),this.AssignUniform("uTint")}},{key:"BindBasicTexture",value:function(t,e){var n=this.gl,r=Object(B.TriRectArray)(0,0,t.w,t.h);e=null!=e?e:n.LINEAR,this.originalTexture=t,r.push.apply(r,Object(B.TriRectArray)(0,0,1,1)),n.bindTexture(n.TEXTURE_2D,this.texture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t.image),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e),n.bindBuffer(n.ARRAY_BUFFER,this.essenceBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array(r),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindTexture(n.TEXTURE_2D,null)}},{key:"Execute",value:function(t,e,n,r){var i=this.gl,o=this.attributes,a=this.uniforms;this!==$r.LAST_USED_CONTROLLER&&(i.useProgram(this.program),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.texture),i.bindBuffer(i.ARRAY_BUFFER,this.essenceBuffer),i.enableVertexAttribArray(o.aPosition),i.vertexAttribPointer(o.aPosition,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(o.aTexCoord),i.vertexAttribPointer(o.aTexCoord,2,i.FLOAT,!1,0,48),i.uniform1i(a.uImage,0),$r.LAST_USED_CONTROLLER=this),i.uniform4fv(a.uTint,r),i.uniformMatrix3fv(a.uProjection,!1,t),i.uniformMatrix3fv(a.uTranslation,!1,e),i.uniformMatrix3fv(a.uTransformation,!1,n),i.drawArrays(i.TRIANGLE_STRIP,0,6)}}])&&_i(n.prototype,r),i&&_i(n,i),e}();function ji(t){return(ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mi(t,e){return!e||"object"!==ji(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gi(t){return(Gi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ni(t,e){return(Ni=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fi=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),.5*t.getParameter(t.MAX_VERTEX_ATTRIBS)<n&&console.error(.5*t.getParameter(t.MAX_VERTEX_ATTRIBS),"MAX"),(r=Mi(this,Gi(e).call(this,t,Cr(n)))).units=n,r.originalTextures=[],r.textures=[],r.essenceBuffers=[],r.lastUsedUnit=0,r.Initialise(),r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ni(t,e)}(e,$r),n=e,(r=[{key:"Initialise",value:function(){for(var t=0;t<this.units;++t)this.AssignAttribute("aPosition"+t),this.AssignAttribute("aTexCoord"+t);this.AssignUniform("uImage"),this.AssignUniform("uUnitId"),this.AssignUniform("uProjection"),this.AssignUniform("uTranslation"),this.AssignUniform("uTransformation"),this.AssignUniform("uTint")}},{key:"BindBasicTexture",value:function(t,e,n){var r=this.gl,i=Object(B.TriRectArray)(0,0,t.w,t.h);null==e&&(e=0),n=null!=n?n:r.LINEAR,t.uniformId=e,this.originalTextures[e]=t,this.textures[e]=r.createTexture(),this.essenceBuffers[e]=r.createBuffer(),i.push.apply(i,Object(B.TriRectArray)(0,0,1,1)),r.bindTexture(r.TEXTURE_2D,this.textures[e]),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t.image),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n),r.bindBuffer(r.ARRAY_BUFFER,this.essenceBuffers[e]),r.bufferData(r.ARRAY_BUFFER,new Float32Array(i),r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,null),r.bindTexture(r.TEXTURE_2D,null)}},{key:"BindUnit",value:function(t,e,n,r){null!=this.textures[r]&&(t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,this.textures[r]),t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffers[r]),t.enableVertexAttribArray(n["aPosition"+r]),t.vertexAttribPointer(n["aPosition"+r],2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(n["aTexCoord"+r]),t.vertexAttribPointer(n["aTexCoord"+r],2,t.FLOAT,!1,0,48))}},{key:"Execute",value:function(t,e,n,r,i){var o=this.gl,a=this.attributes,s=this.uniforms;if(this!==$r.LAST_USED_CONTROLLER){o.useProgram(this.program);for(var u=0;u<this.units;++u)this.BindUnit(o,s,a,u);o.uniform1i(s.uUnitId,i),o.uniform1i(s.uImage,i),$r.LAST_USED_CONTROLLER=this,this.lastUsedUnit=i}else i!==this.lastUsedUnit&&(o.uniform1i(s.uUnitId,i),o.uniform1i(s.uImage,i),this.lastUsedUnit=i);o.uniform4fv(s.uTint,r),o.uniformMatrix3fv(s.uProjection,!1,t),o.uniformMatrix3fv(s.uTranslation,!1,e),o.uniformMatrix3fv(s.uTransformation,!1,n),o.drawArrays(o.TRIANGLE_STRIP,0,6)}}])&&Vi(n.prototype,r),i&&Vi(n,i),e}();function Ui(t){return(Ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yi(t,e){return!e||"object"!==Ui(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hi(t){return(Hi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wi(t,e){return(Wi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qi=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Yi(this,Hi(e).call(this,t,n))).essenceBuffer=null,r.vertices=null,r.Initialise(),r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wi(t,e)}(e,$r),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.vertices=new Float32Array(Object(B.TriRectArray)(0,0,1,1)),t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.AssignAttribute("a_v2Position"),this.AssignUniform("u_m3Projection"),this.AssignUniform("u_fTime"),this.AssignUniform("u_v2Resolution")}},{key:"Execute",value:function(t,e,n,r,i,o){var a=this.gl,s=this.attributes,u=this.uniforms,l=this.vertices;Object(B.TriRectArray)(e,n,r,i,l),this!==$r.LAST_USED_CONTROLLER&&(a.useProgram(this.program),$r.LAST_USED_CONTROLLER=this),a.bindBuffer(a.ARRAY_BUFFER,this.essenceBuffer),a.bufferSubData(a.ARRAY_BUFFER,0,l),a.enableVertexAttribArray(s.a_v2Position),a.vertexAttribPointer(s.a_v2Position,2,a.FLOAT,!1,0,0),a.uniformMatrix3fv(u.u_m3Projection,!1,t),a.uniform2f(u.u_v2Resolution,r,i),a.uniform1f(u.u_fTime,o),a.drawArrays(a.TRIANGLE_STRIP,0,6)}}])&&Xi(n.prototype,r),i&&Xi(n,i),e}();function zi(t){return(zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ki(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ji(t,e){return!e||"object"!==zi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qi(t){return(Qi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $i(t,e){return($i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zi=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Ji(this,Qi(e).call(this,t,n))).essenceBuffer=null,r.frameBuffer=null,r.renderBuffer=null,r.texture=null,r.w=0,r.h=0,r.Initialise(),r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$i(t,e)}(e,$r),n=e,(r=[{key:"Initialise",value:function(){var t=this.gl;this.essenceBuffer=t.createBuffer(),this.frameBuffer=t.createFramebuffer(),this.renderBuffer=t.createRenderbuffer(),this.texture=t.createTexture(),this.AssignAttribute("aPosition"),this.AssignAttribute("aTexCoord"),this.AssignUniform("uImage"),this.AssignUniform("uProjection"),this.AssignUniform("uTranslation"),this.AssignUniform("uTransformation")}},{key:"Config",value:function(t,e,n,r,i,o,a){this.w=t,this.h=e;var s,u=this.gl;s=null!=r&&null!=i&&null!=o&&null!=a?Object(B.TriRectArray)(r,i,o,a):Object(B.TriRectArray)(-1,-1,2,2),n=null!=n?n:u.LINEAR,s.push.apply(s,Object(B.TriRectArray)(0,0,1,1)),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,n),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,n),u.texImage2D(u.TEXTURE_2D,0,u.RGBA,this.w,this.h,0,u.RGBA,u.UNSIGNED_BYTE,null),u.bindRenderbuffer(u.RENDERBUFFER,this.renderBuffer),u.renderbufferStorage(u.RENDERBUFFER,u.DEPTH_COMPONENT16,this.w,this.h),u.bindFramebuffer(u.FRAMEBUFFER,this.frameBuffer),u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,this.texture,0),u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,this.renderBuffer),u.bindBuffer(u.ARRAY_BUFFER,this.essenceBuffer),u.bufferData(u.ARRAY_BUFFER,new Float32Array(s),u.STATIC_DRAW),u.bindTexture(u.TEXTURE_2D,null),u.bindFramebuffer(u.FRAMEBUFFER,null),u.bindRenderbuffer(u.RENDERBUFFER,null)}},{key:"ExecuteClean",value:function(){var t=this.gl,e=this.attributes;this!==$r.LAST_USED_CONTROLLER&&(t.useProgram(this.program),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.texture),t.bindBuffer(t.ARRAY_BUFFER,this.essenceBuffer),t.enableVertexAttribArray(e.aPosition),t.vertexAttribPointer(e.aPosition,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(e.aTexCoord),t.vertexAttribPointer(e.aTexCoord,2,t.FLOAT,!1,0,48),t.uniform1i(this.uniforms.uImage,0),$r.LAST_USED_CONTROLLER=this),t.drawArrays(t.TRIANGLE_STRIP,0,6)}},{key:"Execute",value:function(t,e,n){var r=this.gl,i=this.attributes,o=this.uniforms;this!==$r.LAST_USED_CONTROLLER&&(r.useProgram(this.program),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.texture),r.bindBuffer(r.ARRAY_BUFFER,this.essenceBuffer),r.enableVertexAttribArray(i.aPosition),r.vertexAttribPointer(i.aPosition,2,r.FLOAT,!1,0,0),r.enableVertexAttribArray(i.aTexCoord),r.vertexAttribPointer(i.aTexCoord,2,r.FLOAT,!1,0,48),r.uniform1i(o.uImage,0),$r.LAST_USED_CONTROLLER=this),r.uniformMatrix3fv(o.uProjection,!1,t),r.uniformMatrix3fv(o.uTranslation,!1,e),r.uniformMatrix3fv(o.uTransformation,!1,n),r.drawArrays(r.TRIANGLE_STRIP,0,6)}}])&&Ki(n.prototype,r),i&&Ki(n,i),e}();function to(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var eo=function(){function t(e,n,r,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.split(" "),this.handle=n,this.info=r,this.priority=i,this.breakIfExecuted=!!o,this.data={},this.command=null}var e,n,r;return e=t,(n=[{key:"Execute",value:function(t,e,n){return this.handle(t,e,n),this.breakIfExecuted}}])&&to(e.prototype,n),r&&to(e,r),t}();function no(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ro(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var io=function(){function t(e,n,r,i,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e.split(" "),this.handle=n,this.info=r,this.data={},this.options=null,this.registry=null,this.optionPrefix=null==a?oo:a,this.dataSeparator="=",this.allOptionIds=null,this.fullInfo=null,this.continueToPrime=!!i,this.filterNull=!!o,this.jsonPrefix="(JSON)"}var e,n,r;return e=t,r=[{key:"OPTION_PREFIX",get:function(){return oo},set:function(t){oo=t}}],(n=[{key:"Execute",value:function(t,e,n){this.HandleData(t,e),!0===this.filterNull&&(t=t.filter(so)),!0===this.HandleOptions(t,e,n)&&this.handle(t,e,n)}},{key:"AddOption",value:function(t,e,n,r,i,o){null!=(o=null==o?this.optionPrefix:o)&&(t=t.replace(/\S+/g,o+"$&")),null==this.options&&(this.options=[]),r=null==r?0:r;var a=this.options,s=no(a,1)[0],u=new eo(t,e,n,r,i);u.command=this;for(var l=0;l<a.length;s=a[++l])if(s.priority<=r)return a.splice(l,0,u),this.allOptionIds=this.GetAllOptionIds(),this;return this.options.push(u),this.allOptionIds=this.GetAllOptionIds(),this}},{key:"HandleData",value:function(t,e){var n,r=this.dataSeparator,i=ao,o=this.jsonPrefix,a=o.length;i.push.apply(i,t);for(var s=no(i,1)[0],u=0;u<i.length;s=i[++u])2===(n=s.split(r)).length&&(t[u]=null,n[0].substring(0,a)===o?e[n[0].substring(a)]=JSON.parse(n[1]):e[n[0]]=n[1]);i.length=0}},{key:"HandleOptions",value:function(t,e,n){if(0===t.length)return this.continueToPrime;var r=this.GetAndRemoveMatchingOptionIds(t);if(null==r)return this.continueToPrime;for(var i=0;i<r.length;++i)if(!0===this.GetOptionById(r[i]).Execute(t,e,n))return!1;return this.continueToPrime}},{key:"GetOptionById",value:function(t){for(var e=this.options,n=no(e,1)[0],r=0;r<e.length;n=e[++r])if(-1!==n.id.indexOf(t))return n;return null}},{key:"GetAllOptionIds",value:function(){for(var t=this.options,e=[],n=0;n<t.length;++n)e.push.apply(e,t[n].id);return e}},{key:"GetAndRemoveMatchingOptionIds",value:function(t){var e,n=this.allOptionIds;if(null==n)return null;for(var r=[],i=0;i<n.length;++i)-1!==(e=t.indexOf(n[i]))&&r.push(t.fickleSplice(e));return r}},{key:"GenerateInfoString",value:function(){for(var t="COMMAND: "+this.id.join(", ")+" -> "+this.info+"\n",e=this.options,n=no(e,1)[0],r=0;r<e.length;n=e[++r])t+="OPTION: "+n.id.join(", ")+" -> "+n.info+"\n";return t}}])&&ro(e.prototype,n),r&&ro(e,r),t}(),oo="",ao=[],so=function(t){return null!=t};function uo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function lo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var co=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.commands=[],this.splitter=" "}var e,n,r;return e=t,(n=[{key:"AddCommand",value:function(t){if(null==t.registry)return this.commands.push(t),t.registry=this,t}},{key:"RemoveCommand",value:function(t){var e=this.commands,n=e.indexOf(t);if(-1!==n)return t.registry=null,e.fickleSplice(n)}},{key:"GetCommandById",value:function(t){for(var e=this.commands,n=uo(e,1)[0],r=0;r<e.length;n=e[++r])if(n)for(var i=0;i<n.id.length;++i)if(n.id[i]===t)return n;return null}},{key:"Parse",value:function(t,e){var n=String(t).split(this.splitter),r=n.shift(),i=this.GetCommandById(r);return i?(i.Execute(n,{},e),null):r}}])&&lo(e.prototype,n),r&&lo(e,r),t}();function ho(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var fo=function(){function t(e,n,r,i,a,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.target=n,this.propertyString=r,this.value=i,this.duration=a,this.easing=o[null==s?po:s],this.time=0,this.startValue=0,this.change=0,this.property=null,this.properyObject=null,this.running=!1,this.onStart=new er,this.onEnd=new er,this.onStop=new er,this.onReconfigure=new er,this.onReset=new er}var e,n,r;return e=t,(n=[{key:"Start",value:function(){var t=this.propertyString.split(".");this.property=t[t.length-1],this.propertyObject=Object(L.Nested)(this.target,this.propertyString,!0),this.startValue=this.propertyObject[this.property],this.change=this.value-this.startValue,this.time=0,this.running=!0,this.onStart.Dispatch(this,null)}},{key:"Stop",value:function(){this.property=null,this.propertyObject=null,this.startValue=0,this.change=0,this.time=0,this.running=!1,this.onStop.Dispatch(this,null)}},{key:"Process",value:function(){!0===this.running&&(this.propertyObject[this.property]=this.easing(this.time,this.startValue,this.change,this.duration),++this.time>=this.duration&&(this.running=!1,this.propertyObject[this.property]=this.value,this.onEnd.Dispatch(this,null)))}},{key:"Reconfigure",value:function(t,e,n,r){null!=t&&(this.propertyString=t),this.value=e,this.duration=n,this.easing=o[null==r?po:r],this.onReconfigure.Dispatch(this,null)}},{key:"NewValue",value:function(t){this.value=t,this.Start()}},{key:"Reset",value:function(){if(null==this.propertyObject||null==this.property)return!1;this.propertyObject[this.property]=this.startValue,this.property=null,this.propertyObject=null,this.startValue=0,this.change=0,this.time=0,this.running=!1,this.onReset.Dispatch(this,null)}}])&&ho(e.prototype,n),r&&ho(e,r),t}(),po="Linear";function yo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var vo=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.motions=[],this.target=e}var e,n,r;return e=t,(n=[{key:"Create",value:function(t,e,n,r,i){if(null==this.GetMotionById(t)){var o=new fo(t,this.target,e,n,r,i);return this.motions.push(o),o}return null}},{key:"Add",value:function(t){null==this.GetMotionById(t.id)&&this.motions.push(t)}},{key:"Start",value:function(t){var e=this.GetMotionById(t);return null!==e&&e.Start(),e}},{key:"StartMultiple",value:function(t){t=t.split(" ");for(var e=0;e<t.length;++e)this.Start(t[e])}},{key:"Stop",value:function(t){var e=this.GetMotionById(t);return null!==e&&e.Stop(),e}},{key:"StopMultiple",value:function(t){t=t.split(" ");for(var e=0;e<t.length;++e)this.Stop(t[e])}},{key:"Reset",value:function(t){var e=this.GetMotionByid(t);return null!==e&&e.Reset(),e}},{key:"ResetMultiple",value:function(t){t=t.split(" ");for(var e=0;e<t.length;++e)this.Reset(t[e])}},{key:"Process",value:function(){for(var t=this.motions,e=0;e<t.length;++e)t[e].Process()}},{key:"GetMotionById",value:function(t){for(var e=this.motions,n=0;n<e.length;++n)if(e[n].id===t)return e[n];return null}}])&&yo(e.prototype,n),r&&yo(e,r),t}(),mo=n(6);function bo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function go(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wo(t,e,n){return e&&go(t.prototype,e),n&&go(t,n),t}var Ao=function(){function t(e,n,r){bo(this,t),this.Set(e,n,r)}return wo(t,[{key:"Set",value:function(t,e,n){this.from=t,this.to=e,this.amplitude=n,this.active=!0}},{key:"Inactivate",value:function(){this.active=!1}}]),t}(),So=function(){function t(){bo(this,t),this.velocityX=null,this.velocityY=null,this.torque=null,this.accelerationX=null,this.accelerationY=null,this.spin=null,this.growthX=null,this.growthY=null,this.gravityX=null,this.gravityY=null,this.active=!0}return wo(t,[{key:"CreateOscillatingObject",value:function(t,e,n,r){if(null!==this[t])throw new Error("Invalid key");this[t]=new Ao(e,n,r)}},{key:"SetOscillatingObject",value:function(t,e,n,r){var i=this[t];if(null==i)return this.CreateOscillatingObject(t,e,n,r);i.Set(e,n,r)}},{key:"Nullify",value:function(t){null!=this[t]&&this[t].Inactivate()}}]),t}();function Co(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var To=Math.cos,xo=Math.sin,Eo=Math.atan2,Po=Math.sqrt,Oo=Math.abs,ko=Math.PI,Ro=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.array=new Float32Array(9),this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}var e,n,r;return e=t,(n=[{key:"Identity",value:function(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}},{key:"Copy",value:function(){var e=new t;return e.Set(this.a,this.b,this.c,this.d,this.e,this.f),e}},{key:"Set",value:function(t,e,n,r,i,o){return this.a=t,this.b=e,this.c=n,this.d=r,this.e=i,this.f=o,this}},{key:"SetTransform",value:function(t,e,n,r,i,o,a,s,u){t=null==t?0:t,e=null==e?0:e,n=null==n?1:n,r=null==r?1:r,o=null==o?0:o,a=null==a?0:a,s=null==s?0:s,u=null==u?0:u;var l=xo(i=null==i?0:i),c=To(i),h=-xo(o),f=To(o),d=xo(a),p=To(a),y=c*n,v=l*n,m=-l*r,b=c*r;return this.a=p*y+d*m,this.b=p*v+d*b,this.c=h*y+f*m,this.d=h*v+f*b,this.e=t+s*y+u*m,this.f=e+s*v+u*b,this}},{key:"Multiply",value:function(t,e){return this.a=t.a*e.a+t.b*e.c,this.b=t.a*e.b+t.b*e.d,this.c=t.c*e.a+t.d*e.c,this.d=t.c*e.b+t.d*e.d,this.e=t.e*e.a+t.f*e.c+e.e,this.f=t.e*e.b+t.f*e.d+e.f,this}},{key:"Translate",value:function(t,e){return this.e+=t,this.f+=e,this}},{key:"TranslateTo",value:function(t,e){return this.e=t,this.f=e,this}},{key:"ApplyTranslation",value:function(t,e){return this.e=t*this.a+e*this.c+this.e,this.f=t*this.b+e*this.d+this.f,this}},{key:"ApplyScale",value:function(t,e){return this.a*=t,this.b*=e,this.c*=t,this.d*=e,this}},{key:"Scale",value:function(t,e){return this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e,this}},{key:"Rotate",value:function(t){var e=xo(t),n=To(t),r=this.a,i=this.c,o=this.e;return this.a=r*n-this.b*e,this.b=r*e+this.b*n,this.c=i*n-this.d*e,this.d=i*e+this.d*n,this.e=o*n-this.f*e,this.f=o*e+this.f*n,this}},{key:"Decompose",value:function(t){var e=this.a,n=this.b,r=this.c,i=this.d,o=-Eo(-r,i),a=Eo(n,e);return Oo(o+a)<_o?(t.rotation=a,e<0&&i>=0&&(t.rotation+=ko),t.skew.SetSame(0)):t.skew.Set(o,a),t.scale.Set(Po(e*e+n*n),Po(r*r+i*i)),t.position.Set(this.e,this.f),this}},{key:"ApplyToContext",value:function(t){return t.setTransform(this.a,this.b,this.c,this.d,this.e,this.f),this}},{key:"AsArray",value:function(t){var e=this.array;return!0===t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.e,e[7]=this.f,e[8]=1):(e[0]=this.a,e[1]=this.c,e[2]=this.e,e[3]=this.b,e[4]=this.d,e[5]=this.f,e[6]=0,e[7]=0,e[8]=1),e}}])&&Co(e.prototype,n),r&&Co(e,r),t}(),_o=.01;function Do(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Io=Math.cos,Lo=Math.sin,Bo=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.position=new st.a(e,n),this.scale=new st.a(1,1),this.skew=new st.a(0,0),this.pivot=new st.a(0,0),this.localTransform=new Ro,this.globalTransform=new Ro,this.rotation=0,this.skewCX=1,this.skewSX=0,this.skewCY=0,this.skewSY=1}var e,n,r;return e=t,(n=[{key:"SetMatrix",value:function(t){return t.Decompose(this),this.UpdateSkew(),this}},{key:"UpdateLocal",value:function(){var t=this.localTransform,e=this.position,n=this.scale,r=this.pivot;return t.a=this.skewCX*n.x,t.b=this.skewSX*n.x,t.c=this.skewCY*n.y,t.d=this.skewSY*n.y,t.e=e.x-r.x*t.a+r.y*t.c,t.f=e.y-r.y*t.b+r.y*t.d,this}},{key:"UpdateGlobal",value:function(t){var e=this.localTransform,n=this.globalTransform,r=this.position,i=this.scale,o=this.pivot;return e.a=this.skewCX*i.x,e.b=this.skewSX*i.x,e.c=this.skewCY*i.y,e.d=this.skewSY*i.y,e.e=r.x-o.x*e.a+o.y*e.c,e.f=r.y-o.y*e.b+o.y*e.d,n.a=e.a*t.a+e.b*t.c,n.b=e.a*t.b+e.b*t.d,n.c=e.c*t.a+e.d*t.c,n.d=e.c*t.b+e.d*t.d,n.e=e.e*t.a+e.f*t.c+t.e,n.f=e.e*t.b+e.f*t.d+t.f,this}},{key:"UpdateSkew",value:function(){var t=this.skew,e=this.rotation;return this.skewCX=Io(e+t.y),this.skewSX=Lo(e+t.y),this.skewCY=-Lo(e-t.x),this.skewSY=Io(e-t.x),this}},{key:"ApplyGlobal",value:function(t){return this.globalTransform.ApplyToContext(t),this}}])&&Do(e.prototype,n),r&&Do(e,r),t}();function jo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Vo=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.local=null,this.localDirty=!0,this.global=null,this.globalDirty=!0}var e,n,r;return e=t,(n=[{key:"ComputeLocal",value:function(t,e,n,r,i,o){return null!=i&&(t-=n*i.x,e-=r*i.y),null===this.local?(this.local=new se(t,e,t+n,e+r),this.local.belongsTo=o):this.local.Set(t,e,t+n,e+r),this.localDirty=!1,this.local}},{key:"ComputeGlobal",value:function(t,e,n,r,i,o){return null!=i&&(t-=n*i.x,e-=r*i.y),null===this.global?(this.global=new se(t,e,t+n,e+r),this.global.belongsTo=o):this.global.Set(t,e,t+n,e+r),this.globalDirty=!1,this.global}}])&&jo(e.prototype,n),r&&jo(e,r),t}();function Mo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Go=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.object=e}var e,n,r;return e=t,r=[{key:"Get",value:function(t){return No[t]}},{key:"GetAll",value:function(){return No}},{key:"Add",value:function(e,n){return No[e]=n,t}}],(n=[{key:"In",value:function(t){return-1===No[t].indexOf(this.object)&&No[t].push(this.object),this}},{key:"InAll",value:function(){var t=0;for(var e in No)-1===(t=No[e].indexOf(this.object))&&No[e].push(t);return this}},{key:"Out",value:function(t){var e=No[t].indexOf(this.object);return-1!==e&&No[t].fickleSplice(e),this}},{key:"OutAll",value:function(){var t=0;for(var e in No)-1!==(t=No[e].indexOf(this.object))&&No[e].fickleSplice(t);return this}}])&&Mo(e.prototype,n),r&&Mo(e,r),t}(),No={};function Fo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Uo=Math.abs,Xo=Math.cos,Yo=Math.sin,Ho=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.transform=new Bo(e,n),this.data={},this.w=0,this.h=0,this.bounds=new Vo,this.globalPosition=null,this.transformShouldUpdate=!0,this.transformAutomaticUpdate=!0,this.render=!0,this.motionManager=null,this.arrayHandler=null,this.__inside__=null}var e,n,r;return e=t,(n=[{key:"UpdateTransform",value:function(t){null!=t?this.transform.UpdateGlobal(t.transform.globalTransform):this.transform.UpdateGlobal(Wo.globalTransform)}},{key:"ProcessTransform",value:function(t){!0===this.transformShouldUpdate&&(this.UpdateTransform(t),!1===this.transformAutomaticUpdate&&(this.transformShouldUpdate=!1))}},{key:"RequestTransformUpdate",value:function(){return this.transformShouldUpdate=!0,this}},{key:"ComputeGlobalPosition",value:function(){var t=this.transform.globalTransform;return null===this.globalPosition?this.globalPosition=new st.a(t.e,t.f):this.globalPosition.Set(t.e,t.f),this.globalPosition}},{key:"GlobalToLocalPoint",value:function(t,e){return e?(zo.Multiply(this.transform.globalTransform,e),zo.Decompose(qo)):this.transform.globalTransform.Decompose(qo),t.SubtractV(qo.position).DivideV(qo.scale).Rotate(-qo.rotation),t}},{key:"ComputeLocalBounds",value:function(t){return this.bounds.ComputeLocal(this.x,this.y,Uo(this.width),Uo(this.height),t,this)}},{key:"ComputeGlobalBounds",value:function(t,e){e?(zo.Multiply(this.transform.globalTransform,e),zo.Decompose(qo)):this.transform.globalTransform.Decompose(qo);var n=qo.rotation,r=qo.position,i=qo.scale;return this.bounds.ComputeGlobal(r.x,r.y,Uo(this.w*i.x*Xo(n))+Uo(this.h*i.y*Yo(n)),Uo(this.w*i.x*Yo(n))+Uo(this.h*i.y*Xo(n)),t,this)}},{key:"AHCreate",value:function(){return this.arrayHandler=new Go(this),this}},{key:"AHIn",value:function(t){return this.arrayHandler.In(t),this}},{key:"AHOut",value:function(t){return this.arrayHandler.Out(t),this}},{key:"rotation",get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t,this.transform.UpdateSkew()}},{key:"scale",get:function(){return this.transform.scale}},{key:"position",get:function(){return this.transform.position}},{key:"pivot",get:function(){return this.transform.pivot}},{key:"x",get:function(){return this.transform.position.x},set:function(t){this.transform.position.x=t}},{key:"y",get:function(){return this.transform.position.y},set:function(t){this.transform.position.y=t}},{key:"width",get:function(){return this.w*this.scale.x},set:function(t){this.scale.x=t/this.w}},{key:"height",get:function(){return this.h*this.scale.y},set:function(t){this.scale.y=t/this.h}}])&&Fo(e.prototype,n),r&&Fo(e,r),t}(),Wo=new Bo,qo=new Bo,zo=new Ro;function Ko(t){return(Ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Qo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $o(t,e){return!e||"object"!==Ko(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zo(t){return(Zo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ta(t,e){return(ta=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ea=Math.abs,na=Math.min,ra=Math.max,ia=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=$o(this,Zo(e).call(this,t,n))).parent=null,r.children=[],r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ta(t,e)}(e,Ho),n=e,(r=[{key:"Render",value:function(){!0===this.render&&(this.ProcessTransform(this.parent),this.children.length>0&&this.RenderChildren())}},{key:"RenderChildren",value:function(){for(var t=this.children,e=0;e<t.length;++e)t[e].Render()}},{key:"AddChild",value:function(t){var e=t.parent;return null!=e&&e.RemoveChild(t),this.children.push(t),t.parent=this,t}},{key:"AddChildren",value:function(){var t=arguments;Object(L.IsArray)(t[0])&&(t=Jo(t,1)[0]);for(var e=0;e<t.length;++e)this.AddChild(t[e]);return this}},{key:"AddSibling",value:function(t){var e=this.parent;return null!=e&&e.AddChild(t),t}},{key:"RemoveChild",value:function(t){var e=this.children,n=e.indexOf(t);if(-1!==n)return t.parent=null,e.fickleSplice(n)}},{key:"RemoveChildren",value:function(){var t,e,n=arguments;Object(L.IsArray)(r[0])&&(r=Jo((function(t){throw new Error('"'+t+'" is read-only')}("children"),r),1)[0]);for(var r=this.children,i=[],o=0;o<n.length;++o)t=n[o],-1!==(e=r.indexOf(t))&&(i.push(r.fickleSplice(e)),t.parent=null);return i}},{key:"Swap",value:function(t){if(null!=this.parent){var e=this.parent.children,n=e.indexOf(this);if(-1!==n){-1===t&&(t=e.length-1);var r=e[t];e[t]=this,e[n]=r}}return this}},{key:"SendToFront",value:function(){return this.Swap(-1),this}},{key:"SendToBack",value:function(){return this.Swap(0),this}},{key:"Dump",value:function(){for(var t=this.children,e=0;e<t.length;++e)t[e].parent=null;return t.length=0,this}},{key:"Destroy",value:function(){return this.Dump(),null!=this.parent&&this.parent.RemoveChild(this),this}},{key:"AttachTo",value:function(t){return t.AddChild(this),this}},{key:"Detach",value:function(){return null!=this.parent?this.parent.RemoveChild(this):null}},{key:"GetChildClosestTo",value:function(t,e){var n,r,i,o=1/0,a=this.children;if(0!==a.length){for(var s=0;s<a.length;++s)n=a[s],void 0!==e&&!1===e(n)||(r=ea(n.position.GetDistanceSquared(t.x,t.y)))<o&&(o=r,i=n);return i}return null}},{key:"GetChildFurthestFrom",value:function(t,e){var n,r,i,o=0,a=this.children;if(0!==a.length){for(var s=0;s<a.length;++s)n=a[s],e&&e(n)||(r=ea(n.position.GetDistanceSquared(t.x,t.y)))>o&&(o=r,i=n);return i}return null}},{key:"ClusterBind",value:function(){var t,e=this.children,n=Jo(e,1)[0];oa.Set(0,0,0,0);for(var r=oa.tl,i=oa.br,o=0;o<e.length;n=e[++o])t=n.ComputeLocalBounds(n.anchor),r.x=na(r.x,t.tl.x),r.y=na(r.y,t.tl.y),i.x=ra(i.x,t.br.x),i.y=ra(i.y,t.br.y);return oa.ComputeWH(),this.w=oa.w,this.h=oa.h,this.bounds.ComputeLocal(r.x,r.y,this.width,this.height,null,this),this}}])&&Qo(n.prototype,r),i&&Qo(n,i),e}();ia.prototype.Mount=ia.prototype.AddChildren,ia.prototype.Unmount=ia.prototype.RemoveChildren;var oa=new se(0,0,0,0);function aa(t){return(aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ua(t,e){return!e||"object"!==aa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function la(t){return(la=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ca(t,e){return(ca=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ha=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=ua(this,la(e).call(this,t,n))).interactive=!0,r.display=!0,r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ca(t,e)}(e,ia),n=e,(r=[{key:"PreRender",value:function(){}},{key:"GLPreRender",value:function(){}},{key:"PostRender",value:function(){}},{key:"GLPostRender",value:function(){}},{key:"Render",value:function(t){this.PreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),this.children.length>0&&!0===this.display&&this.RenderChildren(t)),this.PostRender(t)}},{key:"GLRender",value:function(t){this.GLPreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),this.children.length>0&&!0===this.display&&this.GLRenderChildren(t)),this.GLPostRender(t)}},{key:"RenderChildren",value:function(t){for(var e=this.children,n=0;n<e.length;++n)e[n].Render(t)}},{key:"GLRenderChildren",value:function(t){for(var e=this.children,n=0;n<e.length;++n)e[n].GLRender(t)}}])&&sa(n.prototype,r),i&&sa(n,i),e}();function fa(t){return(fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function da(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pa(t,e){return!e||"object"!==fa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ya(t){return(ya=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function va(t,e){return(va=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ma=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=pa(this,ya(e).call(this,t,n))).isBatchParent=!1,r.childDataBuffer=null,r.bufferData=null,r.programController=null,r.bufferStartIndex=0,r.bufferEndIndex=0,r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&va(t,e)}(e,ha),n=e,(r=[{key:"GLRender",value:function(t){this.GLPreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchRenderChildren():this.GLRenderChildren(t))),this.GLPostRender(t)}},{key:"GLBatchRenderChildren",value:function(){null!=this.childDataBuffer&&null!=this.programController&&this.programController.Execute(this.childDataBuffer,this.children.length)}},{key:"ComputeBatchBuffer",value:function(t){for(var e,n,r=this.children,i=[],o=0;o<r.length;++o)e=r[o],n=null!=t?t(e):e.GetBufferData(),e.bufferStartIndex=i.length,e.bufferEndIndex=i.length+n.length,i.push.apply(i,n);this.childDataBuffer=new Float32Array(i)}},{key:"UpdateInBuffer",value:function(){throw new Error(ba)}},{key:"GetBufferData",value:function(){throw new Error(ba)}},{key:"UseAsBatchParent",value:function(t){this.isBatchParent=!0,this.programController=t}}])&&da(n.prototype,r),i&&da(n,i),e}(),ba="Cannot access buffer data directly!";function ga(t){return(ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Aa(t,e){return!e||"object"!==ga(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sa(t){return(Sa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ca(t,e){return(Ca=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ta=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Aa(this,Sa(e).call(this,t,n))).anchor=new st.a(0,0),o.shape=new se(0,0,0,0),o.clip=new se(0,0,0,0),o.textureTransformation=new Ro,o.textureTranslation=new Ro,o.originalShape=new se(0,0,0,0),o.tint=new Yn(1,1,1,1),o.texture=null,o.gco=Pe,r instanceof Bi?(o.programController=r,o.SetTexture(r.originalTexture)):r instanceof Fi?(o.programController=r,null!=i?o.SetTexture(r.originalTextures[i]):o.SetTexture(r.originalTextures[0])):null!=r&&o.SetTexture(r),o}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ca(t,e)}(e,ma),n=e,(r=[{key:"Render",value:function(t){if(this.PreRender(t),!0===this.render){if(this.ProcessTransform(this.parent),!0===this.display){var e=this.clip,n=e.tl,r=e.br,i=this.textureTranslation;this.transform.ApplyGlobal(t),t.globalAlpha=this.tint.channel[3],t.globalCompositeOperation=this.gco,t.drawImage(this.texture.image,n.x,n.y,r.x,r.y,i.e,i.f,this.w,this.h)}this.children.length>0&&this.RenderChildren(t)}this.PostRender(t)}},{key:"GLRender",value:function(t){this.GLPreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),!0===this.display&&(null!==this.programController&&this.programController.Execute(this.transform.globalTransform.AsArray(!0),this.textureTranslation.AsArray(!0),this.textureTransformation.AsArray(!0),this.tint.channel,this.texture.uniformId),this.children.length>0&&(!0===this.isBatchParent?this.GLBatchRenderChildren(t):this.GLRenderChildren(t)))),this.GLPostRender(t)}},{key:"UpdateTextureTransform",value:function(){this.textureTranslation.TranslateTo(-this.w*this.anchor.x,-this.h*this.anchor.y),this.textureTransformation.TranslateTo(this.w/this.texture.fw*this.clip.tl.x/this.w,this.h/this.texture.fh*this.clip.tl.y/this.h)}},{key:"UpdateShape",value:function(t){null!=t?(this.originalShape=t.Copy(),this.shape=t):this.shape.SetC(this.originalShape),this.shape.Scale(this.scale.x,this.scale.y)}},{key:"ClipReconfigure",value:function(t,e,n,r,i,o,a,s){var u=n/this.texture.fw,l=r/this.texture.fh,c=this.width,h=this.height;this.clip.Set(t,e,n,r),this.w=n,this.h=r,0!==c&&0!==h&&(this.width=c,this.height=h),this.textureTranslation.SetTransform(-a*this.anchor.x+i,-s*this.anchor.y+o,u,l),this.textureTransformation.SetTransform(u*this.clip.tl.x/n,l*this.clip.tl.y/r,u,l)}},{key:"SetTexture",value:function(t){this.texture=t,this.ClipReconfigure(0,0,t.w,t.h,0,0,t.w,t.h),this.shape=this.clip.Copy(),this.originalShape=this.shape.Copy()}},{key:"GetBufferData",value:function(){this.UpdateTransform(this.parent),this.UpdateTextureTransform();var t=this.transform.globalTransform.AsArray(!0),e=this.textureTranslation.AsArray(!0),n=this.textureTransformation.AsArray(!0);null==this.bufferData&&(this.bufferData=[]);var r=this.bufferData;return r.length=0,r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=e[0],r[10]=e[1],r[11]=e[2],r[12]=e[3],r[13]=e[4],r[14]=e[5],r[15]=e[6],r[16]=e[7],r[17]=e[8],r[18]=n[0],r[19]=n[1],r[20]=n[2],r[21]=n[3],r[22]=n[4],r[23]=n[5],r[24]=n[6],r[25]=n[7],r[26]=n[8],r}},{key:"UpdateInBuffer",value:function(){this.UpdateTransform(this.parent),this.UpdateTextureTransform();var t=this.transform.globalTransform.AsArray(!0),e=this.textureTranslation.AsArray(!0),n=this.textureTransformation.AsArray(!0),r=this.parent.childDataBuffer,i=this.bufferStartIndex;r[i]=t[0],r[i+1]=t[1],r[i+2]=t[2],r[i+3]=t[3],r[i+4]=t[4],r[i+5]=t[5],r[i+6]=t[6],r[i+7]=t[7],r[i+8]=t[8],r[i+9]=e[0],r[i+10]=e[1],r[i+11]=e[2],r[i+12]=e[3],r[i+13]=e[4],r[i+14]=e[5],r[i+15]=e[6],r[i+16]=e[7],r[i+17]=e[8],r[i+18]=n[0],r[i+19]=n[1],r[i+20]=n[2],r[i+21]=n[3],r[i+22]=n[4],r[i+23]=n[5],r[i+24]=n[6],r[i+25]=n[7],r[i+26]=n[8]}},{key:"IntersectsPoint2D",value:function(t){return!1!==this.interactive&&(xa.SetV(t),xa.SubtractV(this.position),xa.Add(this.width*this.anchor.x,this.height*this.anchor.y),this.shape.IntersectsPoint2D(xa))}},{key:"alpha",get:function(){return this.tint.channel[3]},set:function(t){this.tint.channel[3]=t}}])&&wa(n.prototype,r),i&&wa(n,i),e}(),xa=new st.a(0,0);function Ea(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Pa=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.velocity=new st.a(0,0),this.torque=0,this.spin=0,this.growth=new st.a(1,1),this.acceleration=new st.a(1,1),this.initialScale=new st.a(1,1),this.initialVelocity=new st.a(0,0),this.fade=!1,this.deflate=!1,this.decelerate=!1,this.gravity=new st.a(0,0),this.lifespan=0,this.lifespanTotal=0,this.dead=!1,this.entity=null,this.system=null,this.oscillation=null,this.oscillationOffset=0,this.Renew(e,n)}var e,n,r;return e=t,r=[{key:"USE_POOL",get:function(){return ka},set:function(t){ka=!!t}},{key:"pool",get:function(){return Oa}}],(n=[{key:"Process",value:function(){if(!0!==this.dead)if(this.lifespan++<this.lifespanTotal){var t=this.entity,e=this.velocity,n=1-this.lifespan/this.lifespanTotal,r=this.oscillation;if(e.AddV(this.gravity),0!==this.torque&&e.Rotate(this.torque),t.position.AddV(e),!0===this.fade&&(t.alpha=n),!0===this.deflate?t.scale.Set(n*this.initialScale.x,n*this.initialScale.y):t.scale.MultiplyV(this.growth),!0===this.decelerate?e.Set(n*this.initialVelocity.x,n*this.initialVelocity.y):e.MultiplyV(this.acceleration),t.rotation+=this.spin,null!==r&&!0===r.active){var i=this.lifespan+this.oscillationOffset;null!=r.torque&&!0===r.torque.active&&(this.torque=Object(B.Oscillate)(i,r.torque.from,r.torque.to,r.torque.amplitude)),null!=r.spin&&!0===r.spin.active&&(this.spin=Object(B.Oscillate)(i,r.spin.from,r.spin.to,r.spin.amplitude)),null!=r.velocityX&&!0===r.velocityX.active&&(this.velocity.x=Object(B.Oscillate)(i,r.velocityX.from,r.velocityX.to,r.velocityX.amplitude)),null!=r.velocityY&&!0===r.velocityY.active&&(this.velocity.y=Object(B.Oscillate)(i,r.velocityY.from,r.velocityY.to,r.velocityY.amplitude)),null!=r.gravityX&&!0===r.gravityX.active&&(this.gravity.x=Object(B.Oscillate)(i,r.gravityX.from,r.gravityX.to,r.gravityX.amplitude)),null!=r.gravityY&&!0===r.gravityY.active&&(this.gravity.y=Object(B.Oscillate)(i,r.gravityY.from,r.gravityY.to,r.gravityY.amplitude)),null!=r.accelerationX&&!0===r.accelerationX.active&&(this.acceleration.x=Object(B.Oscillate)(i,r.accelerationX.from,r.accelerationX.to,r.accelerationX.amplitude)),null!=r.accelerationY&&!0===r.accelerationY.active&&(this.acceleration.y=Object(B.Oscillate)(i,r.accelerationY.from,r.accelerationY.to,r.accelerationY.amplitude)),null!=r.growthX&&!0===r.growthX.active&&(this.growth.x=Object(B.Oscillate)(i,r.growthX.from,r.growthX.to,r.growthX.amplitude)),null!=r.growthY&&!0===r.growthY.active&&(this.growth.y=Object(B.Oscillate)(i,r.growthY.from,r.growthY.to,r.growthY.amplitude))}}else this.dead=!0,this.entity.display=!1}},{key:"Renew",value:function(t,e){if(null!=t){this.dead=!1;var n=this.entity;if(null==t.texture)throw new Error("No texture or controller provided!");if(null===n?n=this.entity=new Ta(0,0,t.texture,t.unitId):this.ResetEntity(t.unitId),null!=t.anchor&&(n.anchor.SetV(t.anchor),null==t.frames&&n.UpdateTextureTransform()),null!=t.frames&&(t.frames[Object(L.RandomInteger)(0,t.frames.length-1)].Apply(n),n.scale.SetSame(1),n.UpdateTextureTransform()),this.RenewVector(t.position,n.position,e,0,0),this.RenewVector(t.velocity,this.velocity,e,0,0),this.initialVelocity.SetV(this.velocity),this.RenewVector(t.gravity,this.gravity,e,0,0),this.RenewVector(t.acceleration,this.acceleration,e,1,1),this.RenewVector(t.growth,this.growth,e,1,1),this.RenewVector(t.scale,n.scale,e,1,1),this.initialScale.SetV(n.scale),null!=t.rotation?n.rotation=Object(L.MinMaxOrValue)(t.rotation):n.rotation=0,null!=t.lifespan?this.SetLifespan(t.lifespan):this.SetLifespan(0),null!=t.torque?this.torque=Object(L.MinMaxOrValue)(t.torque):this.torque=0,null!=t.spin?this.spin=Object(L.MinMaxOrValue)(t.spin):this.spin=0,this.fade=!!t.fade,this.deflate=!!t.deflate,this.decelerate=!!t.decelerate,null!=t.oscillation){var r=t.oscillation,i=this.oscillation;null===i&&(i=this.oscillation=new So),i.active=!0,null!=r.offset?this.oscillationOffset=Object(L.MinMaxOrValue)(r.offset):this.oscillationOffset=0,null!=r.torque?i.SetOscillatingObject("torque",Object(L.MinMaxOrValue)(r.torque.from),Object(L.MinMaxOrValue)(r.torque.to),Object(L.MinMaxOrValue)(r.torque.amplitude)):i.Nullify("torque"),null!=r.spin?i.SetOscillatingObject("spin",Object(L.MinMaxOrValue)(r.spin.from),Object(L.MinMaxOrValue)(r.spin.to),Object(L.MinMaxOrValue)(r.spin.amplitude)):i.Nullify("spin"),null!=r.velocity&&(null!=r.velocity.x?i.SetOscillatingObject("velocityX",Object(L.MinMaxOrValue)(r.velocity.x.from),Object(L.MinMaxOrValue)(r.velocity.x.to),Object(L.MinMaxOrValue)(r.velocity.x.amplitude)):i.Nullify("velocityX"),null!=r.velocity.y?i.SetOscillatingObject("velocityY",Object(L.MinMaxOrValue)(r.velocity.y.from),Object(L.MinMaxOrValue)(r.velocity.y.to),Object(L.MinMaxOrValue)(r.velocity.y.amplitude)):i.Nullify("velocityY")),null!=r.gravity&&(null!=r.gravity.x?i.SetOscillatingObject("gravityX",Object(L.MinMaxOrValue)(r.gravity.x.from),Object(L.MinMaxOrValue)(r.gravity.x.to),Object(L.MinMaxOrValue)(r.gravity.x.amplitude)):i.Nullify("gravityX"),null!=r.gravity.y?i.SetOscillatingObject("gravityY",Object(L.MinMaxOrValue)(r.gravity.y.from),Object(L.MinMaxOrValue)(r.gravity.y.to),Object(L.MinMaxOrValue)(r.gravity.y.amplitude)):i.Nullify("gravityY")),null!=r.acceleration&&(null!=r.acceleration.x?i.SetOscillatingObject("accelerationX",Object(L.MinMaxOrValue)(r.acceleration.x.from),Object(L.MinMaxOrValue)(r.acceleration.x.to),Object(L.MinMaxOrValue)(r.acceleration.x.amplitude)):i.Nullify("accelerationX"),null!=r.acceleration.y?i.SetOscillatingObject("accelerationY",Object(L.MinMaxOrValue)(r.acceleration.y.from),Object(L.MinMaxOrValue)(r.acceleration.y.to),Object(L.MinMaxOrValue)(r.acceleration.y.amplitude)):i.Nullify("accelerationY")),null!=r.growth&&(null!=r.growth.x?i.SetOscillatingObject("growthX",Object(L.MinMaxOrValue)(r.growth.x.from),Object(L.MinMaxOrValue)(r.growth.x.to),Object(L.MinMaxOrValue)(r.growth.x.amplitude)):i.Nullify("growthX"),null!=r.growth.y?i.SetOscillatingObject("growthY",Object(L.MinMaxOrValue)(r.growth.y.from),Object(L.MinMaxOrValue)(r.growth.y.to),Object(L.MinMaxOrValue)(r.growth.y.amplitude)):i.Nullify("growthY"))}else null!==this.oscillation&&(this.oscillation.active=!1)}}},{key:"RenewVector",value:function(t,e,n,r,i){if(null!=t){if(null!=t.points?null!=t.moduloWrapper?(null!=t.indexGap&&(n+=t.indexGap),e.SetV(t.points[n%t.moduloWrapper])):e.SetV(Object(L.RandomInArray)(t.points)):null!=t.xy?e.SetSame(Object(L.MinMaxOrValue)(t.xy)):(null!=t.x?e.x=Object(L.MinMaxOrValue)(t.x):e.x=r,null!=t.y?e.y=Object(L.MinMaxOrValue)(t.y):e.y=i),null!=t.scalar)if(null!=t.scalar.xy){var o=Object(L.MinMaxOrValue)(t.scalar.xy);e.Multiply(o,o)}else null!=t.scalar.x&&(e.x*=Object(L.MinMaxOrValue)(t.scalar.x)),null!=t.scalar.y&&(e.y*=Object(L.MinMaxOrValue)(t.scalar.y))}else e.Set(r,i)}},{key:"SetLifespan",value:function(t){this.lifespan=0,this.lifespanTotal=Object(L.MinMaxOrValue)(t)}},{key:"ResetEntity",value:function(t){var e=this.entity;null!=t&&e.SetTexture(e.programController.originalTextures[t]),e.scale.SetSame(1),e.alpha=1,e.display=!0,e.rotation=0}},{key:"Destroy",value:function(t){return(!0!==t||!1!==this.dead)&&(null!==this.system&&this.system.RemoveParticle(this),ka&&Oa.Store(this),!0)}}])&&Ea(e.prototype,n),r&&Ea(e,r),t}(),Oa=new mo.a,ka=!0;function Ra(t){return(Ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Da(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ia(t){return(Ia=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function La(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ba(t,e){return(Ba=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Oa.Retrieve=function(t,e){this.PreRetrieve();var n=this.objects.pop();return n.Renew(t,e),n},Oa.Flood(function(){return new Pa},1e3);var ja=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=function(t,e){return!e||"object"!==Ra(e)&&"function"!=typeof e?La(t):e}(this,Ia(e).call(this,t,n))).particles=[],r.deletionTimer=new ir(60),r.deletionTimer.onFinish.Add(r.HandleParticleDeletion,La(r)),r.deletionTimer.Start(),r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ba(t,e)}(e,ha),n=e,(r=[{key:"Process",value:function(){this.HandleParticles(),this.deletionTimer.Process()}},{key:"HandleParticles",value:function(){for(var t=this.particles,e=0;e<t.length;++e)t[e].Process()}},{key:"HandleParticleDeletion",value:function(){for(var t=this.particles,e=_a(t,1)[0],n=0;n<t.length;e=t[++n])e&&e.Destroy(!0)&&n--;this.deletionTimer.Start()}},{key:"AddParticle",value:function(t){return t.system=this,this.AddChild(t.entity),this.particles.push(t),t}},{key:"RemoveParticle",value:function(t){var e=this.particles,n=e.indexOf(t);if(-1!==n)return t.system=null,this.RemoveChild(t.entity),e.fickleSplice(n)}},{key:"Emit",value:function(t){for(var e=0;e<t.amount;++e)!0===Pa.USE_POOL?this.AddParticle(Pa.pool.Retrieve(t,e)):this.AddParticle(new Pa(t,e))}}])&&Da(n.prototype,r),i&&Da(n,i),e}();function Va(t){return"number"==typeof t}function Ma(t){return Object(L.IsObject)(t)&&Va(t.x)&&Va(t.y)}function Ga(t){return"boolean"==typeof t}var Na={min:{required:!0,typeCheck:Va},max:{required:!0,typeCheck:Va}};function Fa(t){return!0===Object(L.IsObject)(t)?Object(L.ValidateWithSchema)(t,Na):Va(t)}var Ua={x:{required:!1,typeCheck:Fa},y:{required:!1,typeCheck:Fa},xy:{required:!1,typeCheck:Fa},points:{required:!1,typeCheck:function(t){if(!1===Object(L.IsArray)(t))return!1;for(var e=0;e<t.length;++e)if(!1===Ma(t[e]))return!1;return!0}},moduloWrapper:{required:!1,typeCheck:L.IsInteger},indexGap:{required:!1,typeCheck:L.IsInteger},scalar:{required:!1,typeCheck:Xa}};function Xa(t){return!1!==Object(L.IsObject)(t)&&Object(L.ValidateWithSchema)(t,Ua)}var Ya={from:{required:!0,typeCheck:Fa},to:{required:!0,typeCheck:Fa},amplitude:{required:!0,typeCheck:Fa}};function Ha(t){return!1!==Object(L.IsObject)(t)&&Object(L.ValidateWithSchema)(t,Ya)}var Wa={x:{required:!1,typeCheck:function(t){return Ha(t)}},y:{required:!1,typeCheck:Ha}};function qa(t){return!1!==Object(L.IsObject)(t)&&Object(L.ValidateWithSchema)(t,Wa)}var za={offset:{required:!1,typeCheck:Fa},torque:{required:!1,typeCheck:Ha},spin:{required:!1,typeCheck:Ha},velocity:{required:!1,typeCheck:qa},gravity:{required:!1,typeCheck:qa},acceleration:{required:!1,typeCheck:qa},growth:{required:!1,typeCheck:qa}};var Ka={amount:{required:!0,typeCheck:L.IsInteger},texture:{required:!0,typeCheck:function(t){return t instanceof Rr||t instanceof Fi||t instanceof Bi}},unitId:{required:!1,typeCheck:L.IsInteger},anchor:{required:!1,typeCheck:Ma},frames:{required:!1,typeCheck:function(t){if(!1===Object(L.IsArray)(t))return!1;for(var e=0;e<t.length;++e)if(!(t[e]instanceof Mr))return!1;return!0}},position:{required:!1,typeCheck:Xa},velocity:{required:!1,typeCheck:Xa},gravity:{required:!1,typeCheck:Xa},acceleration:{required:!1,typeCheck:Xa},growth:{required:!1,typeCheck:Xa},scale:{required:!1,typeCheck:Xa},rotation:{required:!1,typeCheck:Fa},lifespan:{required:!1,typeCheck:Fa},torque:{required:!1,typeCheck:Fa},spin:{required:!1,typeCheck:Fa},fade:{required:!1,typeCheck:Ga},deflate:{required:!1,typeCheck:Ga},decelerate:{required:!1,typeCheck:Ga},oscillation:{required:!1,typeCheck:function(t){return!1!==Object(L.IsObject)(t)&&Object(L.ValidateWithSchema)(t,za)}}};function Ja(t){return Object(L.ValidateWithSchema)(t,Ka)}function Qa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $a=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.frames=[],this.controller=e,this.sprite=e.sprite,this.id=n,this.onEnd=new er,this.onStop=new er,this.onStart=new er,this.currentFrame=0,this.currentFrameIndex=0,this.playing=!1,this.frameDuration=null!=r?r:60,this.timer=0,this.reverse=!1,this.overrideFrameTimer=!1,this.loop=!1,this.dynamicSize=!!i}var e,n,r;return e=t,(n=[{key:"CreateFrame",value:function(t,e,n,r,i,o,a,s,u){i=null==i?this.frameDuration:i,this.frames.push(new Mr(t,e,n,r,i,null,o,a,s,u))}},{key:"AddFrame",value:function(t){(null==t.duration||t.duration<=0)&&(t.duration=this.frameDuration),this.frames.push(t)}},{key:"GenerateFrames",value:function(t,e,n,r,i,o){var a,s=n/r;o=null==o?{}:o;for(var u=0;u<i;++u)a=o[u],this.CreateFrame(u%s*t,(u/s|0)*e,t,e,a)}},{key:"SetFrame",value:function(t){t=null==t?0:t;var e=this.frames[t];void 0!==e&&(this.currentFrame=e,this.currentFrameIndex=t,this.currentFrame.Apply(this.sprite,this.dynamicSize))}},{key:"GetFrameById",value:function(t,e){for(var n=this.frames,r=0;r<n.length;++r)if(n[r].id===t)return!0===e?r:n[r]}},{key:"SetFrameById",value:function(t){var e=this.GetFrameById(t,!0);this.SetFrame(e)}},{key:"Start",value:function(t){null==t&&(t=this.reverse?this.frames.length-1:0),this.SetFrame(t),this.ResetAllFrames(),this.timer=this.frameDuration,this.playing=!0,this.onStart.Dispatch()}},{key:"Stop",value:function(){this.playing=!1,this.onStop.Dispatch()}},{key:"Process",value:function(){!0===this.playing&&(!0===this.overrideFrameTimer?--this.timer<=0&&(this.timer=this.frameDuration,this.NextFrame()):!0===this.currentFrame.Process()&&this.NextFrame())}},{key:"NextFrame",value:function(){var t=!1,e=this.frames,n=e.length;!1===this.reverse?++this.currentFrameIndex:--this.currentFrameIndex,this.currentFrameIndex>=n?(!0===this.loop?this.currentFrameIndex=0:this.currentFrameIndex=n-1,t=!0):this.currentFrameIndex<0&&(!0===this.loop?this.currentFrameIndex=n-1:this.currentFrameIndex=0,t=!0),this.currentFrame=e[this.currentFrameIndex],this.currentFrame.Apply(this.sprite,this.dynamicSize),!0===t&&(this.onEnd.Dispatch(),!1===this.loop&&this.Stop())}},{key:"Clear",value:function(){this.frames=[],this.currentFrame=null,this.playing=!1,this.currentFrameIndex=0,this.timer=this.frameDuration}},{key:"Reset",value:function(){this.SetFrame(0),this.ResetAllFrames(),this.timer=this.frameDuration,this.playing=!1}},{key:"ResetAllFrames",value:function(){for(var t=this.frames,e=0;e<t.length;++e)t[e].Reset()}}])&&Qa(e.prototype,n),r&&Qa(e,r),t}();function Za(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ts(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var es=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.animations=[],this.sprite=null,this.currentAnimation=null,null!=e&&(this.sprite=e)}var e,n,r;return e=t,(n=[{key:"CreateAnimation",value:function(t,e,n){var r=new $a(this,t,e,n);return this.animations.push(r),r}},{key:"AddAnimation",value:function(t){t.controller=this,this.animations.push(t)}},{key:"GetAnimationById",value:function(t){for(var e=this.animations,n=Za(e,1)[0],r=0;r<e.length;n=e[++r])if(n&&n.id===t)return n;return null}},{key:"PlayAnimation",value:function(t,e){var n=this.GetAnimationById(t);null!==n&&(this.currentAnimation=n,n.Start(e))}},{key:"StopCurrentAnimation",value:function(){null!==this.currentAnimation&&this.currentAnimation.Stop()}},{key:"Process",value:function(){null!==this.currentAnimation&&this.currentAnimation.Process()}}])&&ts(e.prototype,n),r&&ts(e,r),t}();function ns(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function rs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var is=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.root=null,this.propW="width",this.propH="height",this.w=e,this.h=n,this.__dynamic=!e,this.padding=new st.a(0,0)}var e,n,r;return e=t,(n=[{key:"Pack",value:function(t,e){var n=t.length,r=this.propW,i=this.propH,o=this.padding.x,a=this.padding.y,s=ns(t,1)[0],u=s[r]+o,l=s[i]+a,c=null,h=[];this.root=new se(0,0,0,0).SetXYWH(0,0,this.w,this.h);for(var f=0;f<n;s=t[++f])if(u=s[r]+o,l=s[i]+a,f===n-1&&(u-=o,l-=a),(c=this.Find(this.root,u,l))&&(h[f]=this.Partition(c,u,l)),null==h[f]&&!0!==e)throw new Error(os);return h}},{key:"PackDynamic",value:function(t,e){var n=t.length,r=this.propW,i=this.propH,o=this.padding.x,a=this.padding.y,s=ns(t,1)[0],u=s[r]+o,l=s[i]+a,c=null,h=[];this.root=new se(0,0,0,0).SetXYWH(0,0,u,l);for(var f=0;f<n;s=t[++f])if(u=s[r]+o,l=s[i]+a,f===n-1&&(u-=o,l-=a),c=this.Find(this.root,u,l),h[f]=c?this.Partition(c,u,l):this.Extend(u,l),null==h[f]&&!0!==e)throw new Error(os);return h}},{key:"Find",value:function(t,e,n){return t.vertical&&t.horizontal?this.Find(t.horizontal,e,n)||this.Find(t.vertical,e,n):e<=t.w&&n<=t.h?t:null}},{key:"Partition",value:function(t,e,n){return t.vertical=new se(0,0,0,0).SetXYWH(t.tl.x,t.tl.y+n,t.w,t.h-n),t.horizontal=new se(0,0,0,0).SetXYWH(t.tl.x+e,t.tl.y,t.w-e,n),t}},{key:"Extend",value:function(t,e){var n=t<=this.root.w,r=e<=this.root.h,i=n&&this.root.w>=this.root.h+e;return r&&this.root.h>=this.root.w+t?this.ExtendAxis(t,e):i?this.ExtendAxis(t,e,!0):r?this.ExtendAxis(t,e):n?this.ExtendAxis(t,e,!0):null}},{key:"ExtendAxis",value:function(t,e,n){var r=null;n?((r=new se(0,0,0,0).SetXYWH(0,0,this.root.w,this.root.h+e)).horizontal=this.root,r.vertical=new se(0,0,0,0).SetXYWH(0,this.root.h,this.root.w,e)):((r=new se(0,0,0,0).SetXYWH(0,0,this.root.w+t,this.root.h)).vertical=this.root,r.horizontal=new se(0,0,0,0).SetXYWH(this.root.w,0,t,this.root.h)),this.root=r;var i=this.Find(this.root,t,e);return i?this.Partition(i,t,e):null}},{key:"UseProp",value:function(t,e){return this.propW=t,this.propH=e,this}},{key:"SetSize",value:function(t,e){return this.w=t,this.h=e,this.dynamic=!0,this}},{key:"SetPadding",value:function(t,e){return this.padding.Set(t,e),this}}])&&rs(e.prototype,n),r&&rs(e,r),t}(),os="Size error!";function as(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ss=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.code=e,this.duration=0,this.isDown=!1,this.repetitions=0,this.repetitionsTimer=0,this.repetitionsSpeed=20}var e,n,r;return e=t,r=[{key:"ARROW_LEFT",get:function(){return 37}},{key:"ARROW_UP",get:function(){return 38}},{key:"ARROW_RIGHT",get:function(){return 39}},{key:"ARROW_DOWN",get:function(){return 40}},{key:"SHIFT",get:function(){return 16}},{key:"SPACEBAR",get:function(){return 32}},{key:"BACKSPACE",get:function(){return 8}},{key:"ESCAPE",get:function(){return 27}},{key:"ENTER",get:function(){return 13}},{key:"TAB",get:function(){return 9}},{key:"ALT",get:function(){return 18}},{key:"CONTROL",get:function(){return 17}},{key:"FUNCTION1",get:function(){return 112}},{key:"FUNCTION2",get:function(){return 113}},{key:"FUNCTION3",get:function(){return 114}},{key:"FUNCTION4",get:function(){return 115}},{key:"FUNCTION5",get:function(){return 116}},{key:"FUNCTION6",get:function(){return 117}},{key:"FUNCTION7",get:function(){return 118}},{key:"FUNCTION8",get:function(){return 119}},{key:"FUNCTION9",get:function(){return 120}},{key:"FUNCTION10",get:function(){return 121}},{key:"FUNCTION11",get:function(){return 122}},{key:"FUNCTION12",get:function(){return 123}},{key:"A",get:function(){return 65}},{key:"B",get:function(){return 66}},{key:"C",get:function(){return 67}},{key:"D",get:function(){return 68}},{key:"E",get:function(){return 69}},{key:"F",get:function(){return 70}},{key:"G",get:function(){return 71}},{key:"H",get:function(){return 72}},{key:"I",get:function(){return 73}},{key:"J",get:function(){return 74}},{key:"K",get:function(){return 75}},{key:"L",get:function(){return 76}},{key:"M",get:function(){return 77}},{key:"N",get:function(){return 78}},{key:"O",get:function(){return 79}},{key:"P",get:function(){return 80}},{key:"Q",get:function(){return 81}},{key:"R",get:function(){return 82}},{key:"S",get:function(){return 83}},{key:"T",get:function(){return 84}},{key:"U",get:function(){return 85}},{key:"V",get:function(){return 86}},{key:"W",get:function(){return 87}},{key:"X",get:function(){return 88}},{key:"Y",get:function(){return 89}},{key:"Z",get:function(){return 90}},{key:"NUM0",get:function(){return 48}},{key:"NUM1",get:function(){return 49}},{key:"NUM2",get:function(){return 50}},{key:"NUM3",get:function(){return 51}},{key:"NUM4",get:function(){return 52}},{key:"NUM5",get:function(){return 53}},{key:"NUM6",get:function(){return 54}},{key:"NUM7",get:function(){return 55}},{key:"NUM8",get:function(){return 56}},{key:"NUM9",get:function(){return 57}}],(n=[{key:"Reset",value:function(){this.duration=0,this.repetitions=0,this.repetitionsTimer=0}}])&&as(e.prototype,n),r&&as(e,r),t}();function us(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ls(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var cs=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.element.setAttribute&&this.element.setAttribute("tabindex","1"),this.element.focus&&this.element.focus(),this.___bound___OnKeyDown=this.OnKeyDown.bind(this),this.___bound___OnKeyUp=this.OnKeyUp.bind(this),this.element.addEventListener("keydown",this.___bound___OnKeyDown),this.element.addEventListener("keyup",this.___bound___OnKeyUp),this.onDown=new er,this.onUp=new er,this.keys=[],this.keysToProcess=[]}var e,n,r;return e=t,(n=[{key:"OnKeyDown",value:function(t){t.stopPropagation();for(var e=t.keyCode,n=this.keys,r=us(n,1)[0],i=0;i<n.length;r=n[++i])r.code===e&&!1===r.isDown&&(r.isDown=!0,r.duration=0,r.repetitions++,r.repetitionsTimer=0);this.onDown.Dispatch(this.element,t)}},{key:"OnKeyUp",value:function(t){t.stopPropagation();for(var e=t.keyCode,n=this.keys,r=us(n,1)[0],i=0;i<n.length;r=n[++i])r.code===e&&!0===r.isDown&&(r.isDown=!1);this.onUp.Dispatch(this.element,t)}},{key:"Destroy",value:function(){return this.element.removeEventListener("keydown",this.___bound___OnKeyDown),this.element.removeEventListener("keyup",this.___bound___OnKeyUp),this.ReleaseAll(),this}},{key:"Process",value:function(){for(var t=this.keysToProcess,e=us(t,1)[0],n=0;n<t.length;e=t[++n])!0===e.isDown&&e.duration++,++e.repetitionsTimer>=e.repetitionsSpeed&&(e.repetitions=0,e.repetitionsTimer=0)}},{key:"KeyCodeBeingCaptured",value:function(t){for(var e=this.keys,n=0;n<e.length;++n)if(e[n].code===t)return!0;return!1}},{key:"KeyCodeBeingProcessed",value:function(t){for(var e=this.keysToProcess,n=0;n<e.length;++n)if(e[n].code===t)return!0;return!1}},{key:"GetKey",value:function(t){for(var e=this.keys,n=0;n<e.length;++n)if(e[n].code===t)return e[n];throw new Error("KeyCode not being captured!")}},{key:"Capture",value:function(){for(var t=0;t<arguments.length;++t){if(this.KeyCodeBeingCaptured(t))throw new Error("KeyCode already being captured!");var e=new ss(arguments[t]);this.keys.push(e),this.keysToProcess.push(e)}}},{key:"NoProcessCapture",value:function(){for(var t=0;t<arguments.length;++t){if(this.KeyCodeBeingCaptured(t))throw new Error("KeyCode already being captured!");var e=new ss(arguments[t]);this.keys.push(e)}}},{key:"Release",value:function(){for(var t=0;t<arguments.length;++t){var e=this.GetKey(arguments[t]);this.keys.fickleSplice(this.keys.indexOf(e)),this.keysToProcess.fickleSplice(this.keysToProcess.indexOf(e))}}},{key:"ReleaseAll",value:function(){this.keys.length=0,this.keysToProcess.length=0}}])&&ls(e.prototype,n),r&&ls(e,r),t}();function hs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var fs=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.position=new st.a,this.eventData={position:this.position,native:null},this.coordinateTranslationEntity=null,this.coordinateConversionMatrix=null,this.___bound___OnMove=this.OnMove.bind(this),this.___bound___OnDown=this.OnDown.bind(this),this.___bound___OnUp=this.OnUp.bind(this),this.___bound___OnLeave=this.OnLeave.bind(this),this.___bound___OnEnter=this.OnEnter.bind(this),this.___bound___OnWheel=this.OnWheel.bind(this),this.element.addEventListener("mousemove",this.___bound___OnMove),this.element.addEventListener("mousedown",this.___bound___OnDown),this.element.addEventListener("mouseup",this.___bound___OnUp),this.element.addEventListener("mouseleave",this.___bound___OnLeave),this.element.addEventListener("mouseenter",this.___bound___OnEnter),this.element.addEventListener("wheel",this.___bound___OnWheel,{passive:!0}),this.onMove=new er,this.onDown=new er,this.onUp=new er,this.onLeave=new er,this.onEnter=new er,this.onWheel=new er}var e,n,r;return e=t,(n=[{key:"OnMove",value:function(t){return this.CalculatePosition(t.clientX,t.clientY),this.eventData.native=t,this.onMove.Dispatch(this.element,this.eventData),!1}},{key:"OnDown",value:function(t){t.stopPropagation(),this.CalculatePosition(t.clientX,t.clientY),this.eventData.native=t,this.onDown.Dispatch(this.element,this.eventData)}},{key:"OnUp",value:function(t){t.stopPropagation(),this.CalculatePosition(t.clientX,t.clientY),this.eventData.native=t,this.onUp.Dispatch(this.element,this.eventData)}},{key:"OnLeave",value:function(t){t.stopPropagation(),this.CalculatePosition(t.clientX,t.clientY),this.eventData.native=t,this.onLeave.Dispatch(this.element,this.eventData)}},{key:"OnEnter",value:function(t){t.stopPropagation(),this.CalculatePosition(t.clientX,t.clientY),this.eventData.native=t,this.onEnter.Dispatch(this.element,this.eventData)}},{key:"OnWheel",value:function(t){t.stopPropagation(),this.CalculatePosition(t.clientX,t.clientY),this.eventData.native=t,this.onWheel.Dispatch(this.element,this.eventData)}},{key:"CalculatePosition",value:function(t,e){var n=this.position,r=this.element.getBoundingClientRect();n.Set(t,e).Subtract(r.left,r.top),this.coordinateTranslationEntity&&this.coordinateTranslationEntity.GlobalToLocalPoint(n,this.coordinateConversionMatrix)}},{key:"SetCoordinateTranslationEntity",value:function(t,e){return this.coordinateTranslationEntity=t,this.coordinateConversionMatrix=e,this}},{key:"Destroy",value:function(){return this.element.removeEventListener("mousemove",this.___bound___OnMove),this.element.removeEventListener("mousedown",this.___bound___OnDown),this.element.removeEventListener("mouseup",this.___bound___OnUp),this.element.removeEventListener("mouseleave",this.___bound___OnLeave),this.element.removeEventListener("wheel",this.___bound___OnWheel),this}},{key:"x",get:function(){return this.position.x}},{key:"y",get:function(){return this.position.y}}])&&hs(e.prototype,n),r&&hs(e,r),t}();function ds(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ps=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.position=new st.a,this.eventData={position:this.position,native:null},this.coordinateTranslationEntity=null,this.coordinateConversionMatrix=null,this.___bound___OnMove=this.OnMove.bind(this),this.___bound___OnStart=this.OnStart.bind(this),this.___bound___OnEnd=this.OnEnd.bind(this),this.___bound___OnCancel=this.OnCancel.bind(this),this.element.addEventListener("touchmove",this.___bound___OnMove),this.element.addEventListener("touchstart",this.___bound___OnStart),this.element.addEventListener("touchend",this.___bound___OnEnd),this.element.addEventListener("touchcancel",this.___bound___OnCancel),this.onMove=new er,this.onStart=new er,this.onEnd=new er,this.onCancel=new er}var e,n,r;return e=t,(n=[{key:"OnMove",value:function(t){return t.stopPropagation(),this.CalculatePosition(t.touches.item(0).clientX,t.touches.item(0).clientY),this.eventData.native=t,this.onMove.Dispatch(this.element,this.eventData),!1}},{key:"OnStart",value:function(t){t.stopPropagation(),this.CalculatePosition(t.touches.item(0).clientX,t.touches.item(0).clientY),this.eventData.native=t,this.onStart.Dispatch(this.element,this.eventData)}},{key:"OnEnd",value:function(t){t.stopPropagation(),this.eventData.native=t,this.onEnd.Dispatch(this.element,this.eventData)}},{key:"OnCancel",value:function(t){t.stopPropagation(),this.eventData.native=t,this.onCancel.Dispatch(this.element,this.eventData)}},{key:"CalculatePosition",value:function(t,e){var n=this.position,r=this.element.getBoundingClientRect();n.Set(t,e).Subtract(r.left,r.top),this.coordinateTranslationEntity&&this.coordinateTranslationEntity.GlobalToLocalPoint(n,this.coordinateConversionMatrix)}},{key:"SetCoordinateTranslationEntity",value:function(t,e){return this.coordinateTranslationEntity=t,this.coordinateConversionMatrix=e,this}},{key:"Destroy",value:function(){return this.element.removeEventListener("touchmove",this.___bound___OnMove),this.element.removeEventListener("touchstart",this.___bound___OnStart),this.element.removeEventListener("touchend",this.___bound___OnEnd),this.element.removeEventListener("touchcancel",this.___bound___OnCancel),this}},{key:"x",get:function(){return this.position.x}},{key:"y",get:function(){return this.position.y}}])&&ds(e.prototype,n),r&&ds(e,r),t}();function ys(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var vs=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=0}var e,n,r;return e=t,(n=[{key:"Add",value:function(t){return this.value|=t,this}},{key:"Remove",value:function(t){return this.value=this.value&~t,this}},{key:"Holds",value:function(t){return(this.value&t)===t}},{key:"Toggle",value:function(t){return this.value^=t,this}}])&&ys(e.prototype,n),r&&ys(e,r),t}();function ms(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var bs=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.NONE=0,this.next=1}var e,n,r;return e=t,(n=[{key:"Add",value:function(t){return void 0===this[t=t.toUpperCase()]&&(this[t]=this.next,this.next=this.next<<1),this}}])&&ms(e.prototype,n),r&&ms(e,r),t}(),gs=n(12);function ws(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function As(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ss=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.orders=[],this.classUsed=null,this.amount=1,this.locked=!1}var e,n,r;return e=t,(n=[{key:"Many",value:function(t){return this.amount=t,this}},{key:"Bind",value:function(t,e){return e&&(this.orders.length=0),this.orders.push(t),this}},{key:"Make",value:function(t){var e=this.amount,n=Object(L.CreateIteratorArgs)(arguments,"@","i");if(!0===this.locked)throw new Error('"Make" called twice before end!');this.locked=!0,this.orders.length=0,this.classUsed=t;for(var r=0;r<e;++r)Cs(arguments,n,r),this.orders.push(new(Function.prototype.bind.apply(t,arguments)));return this}},{key:"Call",value:function(t,e,n){var r,i,o,a=this.orders,s=Object(L.IsArray)(e),u="string"==typeof t,l=ws(a,1)[0];!0===s&&(o=Object(L.CreateIteratorArgs)(e,"@","i"));for(var c=0;c<a.length;l=a[++c])!0===s&&(i=e.slice(),Object(L.ReplaceArgumentWithObjectValue)(l,i,"$"),Cs(i,o,c)),!1===u&&null!=n?("$"===n[0]&&(n=n.slice(1),console.warn("No need for '$' on property arguments")),Object(L.Nested)(l,n,!1,!0,t.apply(null,i))):!1===u?t.apply(null,i):(r=Object(L.Nested)(l,t,!0),Object(L.Nested)(l,t).apply(r,i));return this}},{key:"Cast",value:function(t,e){for(var n=this.orders,r="string"==typeof e,i=0;i<n.length;++i)!0===r&&"$"===e[0]&&(e=Object(L.Nested)(n[i],e)),Object(L.Nested)(n[i],t,!1,!0,e);return this}},{key:"Done",value:function(){return this.amount=1,this.locked=!1,this.orders[0]}},{key:"Mass",value:function(){return this.amount=1,this.locked=!1,this.orders}},{key:"Ship",value:function(t){this.amount=1,this.locked=!1;var e=!0===t?this.orders.slice():this.orders[0];return this.orders.length=0,e}}])&&As(e.prototype,n),r&&As(e,r),t}(),Cs=function(t,e,n){if(null!=e)for(var r=0,i=e[r];r<e.length;i=e[++r])if(-1!==i.iteratorIndex)if(i.mod&&i.val)switch(i.mod){case"+":t[i.iteratorIndex]=n+Number(i.val);break;case"*":t[i.iteratorIndex]=n*Number(i.val);break;case"-":t[i.iteratorIndex]=n-Number(i.val);break;case"/":t[i.iteratorIndex]=n/Number(i.val);break;case"%":t[i.iteratorIndex]=n%Number(i.val);break;default:throw new Error("Bad mod!")}else t[i.iteratorIndex]=n},Ts=n(10);function xs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Es=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=e,this.w=n,this.h=r,this.aspectRatio=Object(B.SimplifyAspectRatio)(n,r),this.onChange=new er,this.mode=i,this.stage=null,this.culler=null,this.cullerAabbOrig=null,this.rootContainer=null,this.currentWidth=0,this.currentHeight=0,e.setAttribute("width",n),e.setAttribute("height",r),this.___bound___OnWindowRsize=this.OnWindowResize.bind(this),window.addEventListener("resize",this.___bound___OnWindowRsize)}var e,n,r;return e=t,r=[{key:"FILL_SCREEN",get:function(){return Ps}},{key:"KEEP_ASPECT_RATIO",get:function(){return Os}},{key:"KEEP_ASPECT_RATIO_MIN",get:function(){return ks}},{key:"KEEP_ASPECT_RATIO_MAX",get:function(){return Rs}},{key:"KEEP_ASPECT_RATIO_FIT",get:function(){return _s}}],(n=[{key:"OnWindowResize",value:function(){this[this.mode]()}},{key:"Trigger",value:function(){return this.OnWindowResize(),this}},{key:"Reconfigure",value:function(t,e,n){return this.w=t,this.h=e,this.mode=n,this}},{key:"BindStage",value:function(t){return this.stage=t,this}},{key:"BindRootContainer",value:function(t){return this.rootContainer=t,this}},{key:"BindCuller",value:function(t){return this.culler=t,this.cullerAabbOrig=new se(0,0,0,0).SetC(t.bounds),this}},{key:"SetCurrent",value:function(t,e){t|=0,e|=0,this.canvas.setAttribute("width",t),this.canvas.setAttribute("height",e),this.currentWidth=t,this.currentHeight=e;var n=t/this.w,r=e/this.h;null!==this.stage&&(this.stage.w=t,this.stage.h=e,!0===this.stage.usingWebGL&&this.stage.GLConfig()),null!==this.rootContainer&&this.rootContainer.scale.Set(n,r),null!==this.culler&&(this.culler.bounds.SetC(this.cullerAabbOrig),this.culler.bounds.Scale(n,r))}},{key:"FillScreen",value:function(){this.SetCurrent(window.innerWidth,window.innerHeight)}},{key:"KeepAspectRatio",value:function(){var t=window.innerWidth,e=t/this.aspectRatio[0]*this.aspectRatio[1];this.SetCurrent(t,e)}},{key:"KeepAspectRatioMIN",value:function(){var t,e=window.innerWidth;e<=this.w&&(e=this.w),t=e/this.aspectRatio[0]*this.aspectRatio[1],this.SetCurrent(e,t)}},{key:"KeepAspectRatioMAX",value:function(){var t,e=window.innerWidth;e>=this.w&&(e=this.w),t=e/this.aspectRatio[0]*this.aspectRatio[1],this.SetCurrent(e,t)}},{key:"KeepAspectRatioFIT",value:function(){var t=window.innerWidth,e=t/this.aspectRatio[0]*this.aspectRatio[1];e>=window.innerHeight&&(t=(e=window.innerHeight)/this.aspectRatio[1]*this.aspectRatio[0]),this.SetCurrent(t,e)}},{key:"Destroy",value:function(){window.removeEventListener("resize",this.___bound___OnWindowRsize)}}])&&xs(e.prototype,n),r&&xs(e,r),t}(),Ps="FillScreen",Os="KeepAspectRatio",ks="KeepAspectRatioMIN",Rs="KeepAspectRatioMAX",_s="KeepAspectRatioFIT";function Ds(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Is=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nodes={},this.objects=[],this.convergence=[],this.objectCap=0,this.levelCap=0,this.level=0,this.aabb=null,this.hasSplit=!1,this.Set(e,n,r,i)}var e,n,r;return e=t,r=[{key:"pool",get:function(){return Ms}},{key:"USE_POOL",get:function(){return Gs},set:function(t){Gs=!!t}}],(n=[{key:"Set",value:function(t,e,n,r){return this.aabb=t,this.level=e,this.objectCap=n,this.levelCap=r,this}},{key:"FromPool",value:function(e,n,r,i){return!0===Gs?Ms.Retrieve(e,n,r,i):new t(e,n,r,i)}},{key:"Store",value:function(){Ms.Store(this)}},{key:"Add",value:function(t){var e=0,n="",r=this.objects,i=this.nodes;if(!0!==this.hasSplit||null===(n=this.Marking(t))){if(r.push(t),this.level<this.levelCap&&r.length>this.objectCap)for(!1===this.hasSplit&&this.Split();e<r.length;)null!==(n=this.Marking(r[e]))?i[n].Add(r.fickleSplice(e)):++e}else i[n].Add(t)}},{key:"Converge",value:function(t){var e="",n=this.nodes,r=this.convergence;return r.length=0,r.push.apply(r,this.objects),!0===this.hasSplit&&(null!==(e=this.Marking(t))?r.push.apply(r,n[e].Converge(t)):(r.push.apply(r,n[Ls].Converge(t)),r.push.apply(r,n[Bs].Converge(t)),r.push.apply(r,n[js].Converge(t)),r.push.apply(r,n[Vs].Converge(t)))),r}},{key:"Split",value:function(){var t=this.level+1,e=this.objectCap,n=this.levelCap,r=this.nodes,i=this.aabb;r[Ls]=this.FromPool(i.GetQuadrant(Ls),t,e,n),r[Bs]=this.FromPool(i.GetQuadrant(Bs),t,e,n),r[js]=this.FromPool(i.GetQuadrant(js),t,e,n),r[Vs]=this.FromPool(i.GetQuadrant(Vs),t,e,n),this.hasSplit=!0}},{key:"Dump",value:function(){var t=this.nodes;this.objects.length=0,!0===this.hasSplit&&(t[Ls].Dump(),t[Bs].Dump(),t[js].Dump(),t[Vs].Dump(),!0===Gs&&(t[Ls].Store(),t[Bs].Store(),t[js].Store(),t[Vs].Store())),this.nodes={},this.hasSplit=!1}},{key:"Marking",value:function(t){var e=this.nodes;return!0===e[Ls].aabb.ContainsAABB2D(t)?Ls:!0===e[Bs].aabb.ContainsAABB2D(t)?Bs:!0===e[js].aabb.ContainsAABB2D(t)?js:!0===e[Vs].aabb.ContainsAABB2D(t)?Vs:null}},{key:"ConcatNodes",value:function(t){var e=this.nodes;return null==t&&(t=[]),t.push(this),!1===this.hasSplit?t:(e[Ls].ConcatNodes(t),e[Bs].ConcatNodes(t),e[js].ConcatNodes(t),e[Vs].ConcatNodes(t),t)}}])&&Ds(e.prototype,n),r&&Ds(e,r),t}(),Ls="TL",Bs="TR",js="BL",Vs="BR",Ms=new mo.a,Gs=!0;function Ns(t){return(Ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Us(t){return(Us=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xs(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ys(t,e){return(Ys=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Ms.Retrieve=function(t,e,n,r){return this.PreRetrieve(),this.objects.pop().Set(t,e,n,r)},Ms.Flood(function(){return new Is(null,0,0,0)},500);var Hs=function(t){function e(t){var n;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=function(t,e){return!e||"object"!==Ns(e)&&"function"!=typeof e?Xs(t):e}(this,Us(e).call(this,0,0)),"string"==typeof t.canvas&&(t.canvas=document.getElementById(t.canvas)),n.canvas=t.canvas,n.w=t.canvas.width,n.h=t.canvas.height,n.id=null,n.backgroundColor="rgba(10,20,30,1)",n.clear=!0,n.fill=!0,n.usingWebGL=!1,n.glConvMatrix=new Ro,n.canvasManager=null,n.mouse=null,n.touch=null,n.ticker=null,n.onProcess=new er,null==t.mode||"webgl2"!==t.mode.toLowerCase()&&"webgl"!==t.mode.toLowerCase())n.rc=t.canvas.getContext("2d"),console.log("%cCanvas 2D!","color:#f0f7da;background-color:#304860;font-family:Arial;font-size:18px;font-weight:900;padding:5px;"),!0!==t.noTicker&&(n.ticker=new or.a(n.Process.bind(Xs(n)),60,t.halt));else{if(n.gl=t.canvas.getContext(t.mode.toLowerCase(),{antialias:t.antialias,powerPreference:t.powerPreference,preserveDrawingBuffer:!0}),null!=n.gl?console.log("%cWebGL!","color:#f0f7da;background-color:#304860;font-family:Arial;font-size:18px;font-weight:900;padding:5px;"):(n.gl=t.canvas.getContext("experimental-webgl"),null!=n.gl&&console.warn("Experimental WebGL!")),null==n.gl)throw new Error("WebGL is not supported!");n.gl.clearColor(.0392156862745098,.0784313725490196,.11764705882352941,1),n.usingWebGL=!0,!0!==t.noTicker&&(n.ticker=new or.a(n.GLProcess.bind(Xs(n)),60,t.halt)),n.GLConfig(n.gl)}return null!=t.backgroundColor&&(n.backgroundColor=t.backgroundColor),!1===t.clear&&(n.clear=!1),!1===t.fill&&(n.fill=!1),null!=t.id&&(n.id=t.id),!0!==t.noMouse&&(n.mouse=new fs(t.canvas)),!0!==t.noKeyboard&&(n.keyboard=new cs(t.canvas)),!0!==t.noTouch&&(n.touch=new ps(t.canvas)),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ys(t,e)}(e,ha),n=e,(r=[{key:"PreRender",value:function(t){t.setTransform(1,0,0,1,0,0),t.globalAlpha=1,t.globalCompositeOperation=Pe,!0===this.fill?(t.fillStyle=this.backgroundColor,t.fillRect(0,0,this.w,this.h)):!0===this.clear&&t.clearRect(0,0,this.w,this.h)}},{key:"GLConfig",value:function(t){null==t&&(t=this.gl),this.position.Set(-1,1),this.scale.Set(2/this.w,-2/this.h),this.UpdateTransform(),this.glConvMatrix.SetTransform(this.w/2,this.h/2,1/this.scale.x,1/this.scale.y),t.viewport(0,0,this.w,this.h),t.enable(t.BLEND),t.disable(t.DEPTH_TEST),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)}},{key:"GLPreRender",value:function(t){!0===this.clear&&t.clear(t.COLOR_BUFFER_BIT)}},{key:"Process",value:function(t){this.Render(this.rc),this.onProcess.Dispatch(this,t)}},{key:"GLProcess",value:function(t){this.GLRender(this.gl),this.onProcess.Dispatch(this,t)}},{key:"MixedProcess",value:function(t){!0===this.usingWebGL?this.GLRender(this.gl):this.Render(this.rc),this.onProcess.Dispatch(this,t)}},{key:"SetFramebuffer",value:function(t,e){null==t&&(t=this.gl),null==e?(t.viewport(0,0,this.w,this.h),t.bindFramebuffer(t.FRAMEBUFFER,null)):(t.viewport(0,0,e.w,e.h),t.bindFramebuffer(t.FRAMEBUFFER,e.frameBuffer),t.clear(t.COLOR_BUFFER_BIT))}},{key:"Destroy",value:function(){return this.Dump(),null!=this.keyboard&&this.keyboard.Destroy(),null!=this.mouse&&this.mouse.Destroy(),null!=this.touch&&this.touch.Destroy(),null!=this.ticker&&this.ticker.Stop(),this}}])&&Fs(n.prototype,r),i&&Fs(n,i),e}();function Ws(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var qs=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.stages=[],this.options=null,this.ticker=new or.a(this.Process.bind(this),60,e.halt),this.SetOptions(e)}var e,n,r;return e=t,(n=[{key:"SetOptions",value:function(t){return null!=t&&(this.options=t),this}},{key:"CreateStage2D",value:function(t){var e,n=document.createElement("canvas");"string"==typeof t&&(e=t,t=null),null==t&&(t=this.options),null==t&&(t={}),null!==e&&(t.id=e),null!=t.width&&(n.width=t.width),null!=t.height&&(n.height=t.height),null!=t.className&&(n.className=t.className),null==t.rootNode&&(t.rootNode=document.body),t.rootNode.appendChild(n),t.canvas=n,t.noTicker=!0,t.halt=!0,t.noMouse=!0,t.noKeyboard=!0,t.noTouch=!0;var r=new Hs(t);return t.id=null,t.canvas=null,this.stages.push(r),r}},{key:"GetStages",value:function(){for(var t=this.stages,e=[],n=0;n<t.length;++n)for(var r=0;r<arguments.length;++r)t[n].id===arguments[r]&&e.push(t[n]);return e}},{key:"Process",value:function(t){for(var e=this.stages,n=0;n<e.length;++n)e[n].MixedProcess(t)}},{key:"Destroy",value:function(){for(var t=this.stages,e=0;e<t.length;++e)t[e].Destroy();return this.ticker.Stop(),this}}])&&Ws(e.prototype,n),r&&Ws(e,r),t}();function zs(t){return(zs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ks(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Js(t,e){return!e||"object"!==zs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qs(t){return(Qs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $s(t,e){return($s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zs=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Js(this,Qs(e).call(this,t,n))).anchor=new st.a(0,0),i.SetPath(r),i.alpha=1,i}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$s(t,e)}(e,ma),n=e,(r=[{key:"Render",value:function(t){if(this.PreRender(t),!0===this.render){this.ProcessTransform(this.parent),this.transform.ApplyGlobal(t);var e=this.path;e&&e.Render&&!0===this.display&&(t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,e.Render(t)),this.children.length>0&&this.RenderChildren(t)}this.PostRender(t)}},{key:"GLRender",value:function(t){if(this.GLPreRender(t),!0===this.render){this.ProcessTransform(this.parent);var e=this.path;e&&e.GLRender&&!0===this.display&&e.GLRender(t,this.transform),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchRenderChildren(t):this.GLRenderChildren(t))}this.GLPostRender(t)}},{key:"GetBufferData",value:function(){this.UpdateTransform(this.parent);var t=this.transform.globalTransform.AsArray(!0);null==this.bufferData&&(this.bufferData=[]);var e=this.bufferData;return e.length=0,e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this.path&&this.path.GetBufferData&&e.push.apply(e,this.path.GetBufferData()),e}},{key:"UpdateInBuffer",value:function(){this.UpdateTransform(this.parent);var t=this.transform.globalTransform.AsArray(!0),e=this.parent.childDataBuffer,n=this.bufferStartIndex;e[n]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=t[3],e[n+4]=t[4],e[n+5]=t[5],e[n+6]=t[6],e[n+7]=t[7],e[n+8]=t[8],this.path&&this.path.UpdateInBuffer&&this.path.UpdateInBuffer(e,n+9)}},{key:"IntersectsPoint2D",value:function(t){return!1!==this.interactive&&(tu.SetV(t),tu.SubtractV(this.position),this.path.shape.IntersectsPoint2D(tu))}},{key:"SetPath",value:function(t){var e=t.shape;void 0!==e&&(void 0!==e.w&&void 0!==e.h?(this.w=e.w,this.h=e.h):void 0!==e.GetLength?this.w=this.h=e.GetLength():void 0!==e.diameter?this.w=this.h=e.diameter:void 0!==e.aabb&&(this.w=e.aabb.w,this.h=e.aabb.h),this.path=t)}}])&&Ks(n.prototype,r),i&&Ks(n,i),e}(),tu=new st.a(0,0);function eu(t){return(eu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ru(t,e){return!e||"object"!==eu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function iu(t){return(iu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ou(t,e){return(ou=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var au=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=ru(this,iu(e).call(this,t,n,r,i))).animationController=null,null==r&&o.SetTexture(su),o}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ou(t,e)}(e,Ta),n=e,i=[{key:"BUILD_DEFAULT_TEXTURE",value:function(t){if(!0===uu)throw new Error("Function can only be called once!");su=new Rr(X(U(function(){var t=new Gn([0,0,64,0,64,64,0,64,0,0,32,32,64,0,32,32,64,64,32,32,0,64],{stroke:{lineWidth:3}});return t.shape.ComputeBounds(),new Zs(0,0,t)}),t,64,64),"__DEFAULT_SPRITE_TEXTURE__",64,64,64,64),uu=!0}},{key:"DEFAULT_TEXTURE",get:function(){return su}}],(r=[{key:"CreateAnimation",value:function(t){var e;null===this.animationController&&(this.animationController=new es(this));var n=this.animationController.CreateAnimation(t.id,t.frameDuration,t.dynamicSize);if(null!=t.spritesheet){var r=null;for(e=0;e<t.frames.length;++e)r=t.spritesheet.GetFrameById(t.frames[e].id||t.frames[e]),n.CreateFrame(r.x,r.y,r.w,r.h,t.frames[e].duration,r.offsetX,r.offsetY,r.originW,r.originH)}else for(e=0;e<t.frames.length;++e)n.AddFrame(t.frames[e]);return n.loop=!!t.loop,n.overrideFrameTimer=!!t.overrideFrameTimer,n.reverse=!!t.reverse,n}},{key:"PlayAnimation",value:function(t,e){return this.animationController.PlayAnimation(t,e),this}},{key:"StopCurrentAnimation",value:function(){return this.animationController.StopCurrentAnimation(),this}}])&&nu(n.prototype,r),i&&nu(n,i),e}(),su=null,uu=!1;function lu(t){return(lu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hu(t,e){return!e||"object"!==lu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fu(t){return(fu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function du(t,e){return(du=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pu=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=hu(this,fu(e).call(this,t,n,null==r?yu:r,i))).pattern=null,o.patternOffset=new st.a(0,0),o}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&du(t,e)}(e,Ta),n=e,i=[{key:"BUILD_DEFAULT_TEXTURE",value:function(t){if(!0===vu)throw new Error("Function can only be called once!");yu=new Rr(X(U(function(){var t=new Gn([0,0,64,0,64,64,0,64,0,0,32,32,64,0,32,32,64,64,32,32,0,64]);return t.shape.ComputeBounds(),t.style.stroke.lineWidth=3,new Zs(0,0,t)}),t,64,64),"__DEFAULT_TILESPRITE_TEXTURE__",64,64,64,64),vu=!0}},{key:"DEFAULT_TEXTURE",get:function(){return yu}}],(r=[{key:"Render",value:function(t){this.PreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),!0===this.display&&null!==this.pattern&&(this.transform.ApplyGlobal(t),t.globalAlpha=this.tint.channel[3],t.globalCompositeOperation=this.gco,t.fillStyle=this.pattern,t.beginPath(),t.rect(0,0,this.w,this.h),t.closePath(),t.translate(this.patternOffset.x,this.patternOffset.y),t.fill()),this.children.length>0&&this.RenderChildren(t)),this.PostRender(t)}},{key:"GeneratePattern",value:function(t,e,n){null==this.programController?(this.pattern=t.createPattern(this.texture.image,null),this.w=e,this.h=n,this.scale.SetSame(1)):(this.width=e,this.height=n,this.textureTransformation.SetTransform(0,0,this.scale.x,this.scale.y))}},{key:"OffsetPattern",value:function(t,e){this.patternOffset.Add(t,e),this.textureTransformation.Translate(-t/this.w,-e/this.h)}},{key:"SetPatternOffset",value:function(t,e){this.patternOffset.Set(t,e),this.textureTransformation.TranslateTo(-t/this.w,-e/this.h)}},{key:"GetPatternOffset",value:function(){return this.patternOffset}}])&&cu(n.prototype,r),i&&cu(n,i),e}(),yu=null,vu=!1;function mu(t){return(mu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bu(t,e){return!e||"object"!==mu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gu(t){return(gu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wu(t,e){return(wu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Au=function(t){function e(t,n,r,i,o,a,s,u,l,c,h,f){var d;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(d=bu(this,gu(e).call(this,n,r))).index=t,d.clipX=i,d.clipY=o,d.w=l,d.h=c,d.textureTranslation=new Ro,d.textureTransformation=new Ro,d.textureTransformation.SetTransform(h*i/l,f*o/c,h,f),a&&s&&u?(d.textureTranslation.SetTransform(-l,-c,h,f),d.rotation=90*-B.RADIAN,d.scale.y=-1):a&&s?(d.textureTranslation.SetTransform(-l,-c,h,f),d.scale.Set(-1,-1)):a&&u?(d.textureTranslation.SetTransform(0,-c,h,f),d.rotation=90*B.RADIAN):s&&u?(d.textureTranslation.SetTransform(-l,0,h,f),d.rotation=90*-B.RADIAN):a?(d.textureTranslation.SetTransform(-l,0,h,f),d.scale.x=-1):s?(d.textureTranslation.SetTransform(0,-c,h,f),d.scale.y=-1):u?(d.textureTranslation.SetTransform(0,0,h,f),d.rotation=90*B.RADIAN,d.scale.y=-1):d.textureTranslation.SetTransform(0,0,h,f),d}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wu(t,e)}(e,Ho),e}();function Su(t){return(Su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cu(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Tu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xu(t,e){return!e||"object"!==Su(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Eu(t){return(Eu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pu(t,e){return(Pu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ou=function(t){function e(t,n,r,i,o){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=xu(this,Eu(e).call(this,t,n,r.pc||r.basicTexture,o))).w=0,a.h=0,a.tileW=0,a.tileH=0,a.columns=0,a.cull=!1,a.tiles=[],a.tileset=r,a.Config(r.mapData),a.SetMapLayer(r.mapData.layers[i]),a}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pu(t,e)}(e,Ta),n=e,(r=[{key:"Config",value:function(t){this.tileW=t.tilewidth,this.tileH=t.tileheight,this.w=this.tileW*t.width,this.h=this.tileH*t.height,this.columns=this.w/this.tileW|0}},{key:"SetMapLayer",value:function(t){var e=t.data;if(t.width*t.height!==e.length)throw new Error(ku);this.tiles.length=0,this.alpha=t.opacity,this.tileset.mapData.orientation===Ru&&this.SetOrthogonal(e)}},{key:"Cull",value:function(t){this.culler=t,this.cull=!0}},{key:"SetOrthogonal",value:function(t){for(var e=this.tileset.setData.tileset.attributes,n=t.length,r=this.tileW,i=this.tileH,o=e.columns,a=parseInt(e.spacing),s=parseInt(e.margin),u=this.columns,l=r/this.texture.fw,c=i/this.texture.fh,h=0,f=0,d=0,p=0,y=0,v=0,m=0,b=0,g=0;g<n;++g)0!==(f=t[g])&&(d=g%u*r,p=(g/u|0)*i,y=(b=(h=Object(L.ClearBit)(31,Object(L.ClearBit)(30,Object(L.ClearBit)(29,f)))-1)%o)*r+b*a+s,v=(m=h/o|0)*i+m*a+s,this.tiles.push(new Au(h,d,p,y,v,Object(L.IsBitSet)(31,f),Object(L.IsBitSet)(30,f),Object(L.IsBitSet)(29,f),r,i,l,c)))}},{key:"Render",value:function(t){this.PreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),!0===this.display&&(!0===this.cull?this.CullRender(t):this.NoCullRender(t),this.children.length>0&&this.RenderChildren(t))),this.PostRender(t)}},{key:"GLRender",value:function(t){this.GLPreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),!0===this.display&&(!0===this.cull?this.GLCullRender(t):this.GLNoCullRender(t),this.children.length>0&&this.GLRenderChildren(t))),this.GLPostRender(t)}},{key:"CullRender",value:function(t){for(var e=this.texture.image,n=this.tiles,r=this.tileW,i=this.tileH,o=this.culler,a=o.bounds,s=o.conversionMatrix,u=Cu(n,1)[0],l=0;l<n.length;u=n[++l])u.ProcessTransform(this),a.IntersectsAABB2D(u.ComputeGlobalBounds(null,s))&&(u.transform.ApplyGlobal(t),t.drawImage(e,u.clipX,u.clipY,r,i,u.textureTranslation.e,u.textureTranslation.f,r,i))}},{key:"NoCullRender",value:function(t){for(var e=this.texture.image,n=this.tiles,r=this.tileW,i=this.tileH,o=Cu(n,1)[0],a=0;a<n.length;o=n[++a])o.ProcessTransform(this),o.transform.ApplyGlobal(t),t.drawImage(e,o.clipX,o.clipY,r,i,o.textureTranslation.e,o.textureTranslation.f,r,i)}},{key:"GLCullRender",value:function(){for(var t=this.programController,e=this.texture.uniformId,n=this.tint.channel,r=this.tiles,i=this.culler,o=i.bounds,a=i.conversionMatrix,s=Cu(r,1)[0],u=0;u<r.length;s=r[++u])s.ProcessTransform(this),o.IntersectsAABB2D(s.ComputeGlobalBounds(null,a))&&t.Execute(s.transform.globalTransform.AsArray(!0),s.textureTranslation.AsArray(!0),s.textureTransformation.AsArray(!0),n,e)}},{key:"GLNoCullRender",value:function(){for(var t=this.programController,e=this.texture.uniformId,n=this.tint.channel,r=this.tiles,i=Cu(r,1)[0],o=0;o<r.length;i=r[++o])i.ProcessTransform(this),t.Execute(i.transform.globalTransform.AsArray(!0),i.textureTranslation.AsArray(!0),i.textureTransformation.AsArray(!0),n,e)}}])&&Tu(n.prototype,r),i&&Tu(n,i),e}(),ku="Size error!",Ru="orthogonal";function _u(t){return(_u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Du(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Iu(t,e){return!e||"object"!==_u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lu(t){return(Lu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bu(t,e){return(Bu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ju=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Iu(this,Lu(e).call(this,t,n))).id=i.cx=i.cy=i.w=i.h=i.xoffset=i.yoffset=i.xadvance=i.yadvance=0,i.kernings=[],i.translation=new Ro,i.transformation=new Ro,null!=r&&i.SetData(r),i}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bu(t,e)}(e,Ho),n=e,i=[{key:"pool",get:function(){return Vu}}],(r=[{key:"Render",value:function(t,e){t.drawImage(e,this.cx,this.cy,this.width,this.height,this.position.x,this.position.y,this.width,this.height)}},{key:"SetData",value:function(t){return this.id=parseInt(t.id),this.cx=parseInt(t.x),this.cy=parseInt(t.y),this.w=parseInt(t.width),this.h=parseInt(t.height),this.xoffset=parseInt(t.xoffset),this.yoffset=parseInt(t.yoffset),this.xadvance=parseInt(t.xadvance),this}},{key:"GLRenderAuto",value:function(t,e,n){this.UpdateMatrices(),t.Execute(this.transform.globalTransform.AsArray(!0),this.translation.AsArray(!0),this.transformation.AsArray(!0),e,n)}},{key:"GLRender",value:function(t,e,n){t.Execute(this.transform.globalTransform.AsArray(!0),this.translation.AsArray(!0),this.transformation.AsArray(!0),e,n)}},{key:"ApplyKernings",value:function(t){for(var e,n=0;n<t.length;++n)e=t[n].attributes,parseInt(e.first)===this.id&&this.kernings.push(parseInt(e.first),parseInt(e.second),parseInt(e.amount));return this}},{key:"Crunch",value:function(t){if(this.position.SetSame(0),null!=t&&(this.x=t.x+t.xadvance,this.y=this.yadvance=t.yadvance,t.kernings&&t.kernings.length>0&&this.kernings.length>0))for(var e=this.kernings,n=0;n<e.length;n+=3)if(e[n+1]===t.id){this.x+=e[n+2];break}return this.position.Add(this.xoffset,this.yoffset),this}},{key:"UpdateMatrices",value:function(){if(null!=this.parent){var t=this.parent.texture,e=this.width/t.fw,n=this.height/t.fh;this.UpdateTransform(this.parent),this.translation.SetTransform(0,0,e,n),this.transformation.SetTransform(e*this.cx/this.width,n*this.cy/this.height,e,n)}return this}},{key:"Store",value:function(){return Vu.Store(this),this}}])&&Du(n.prototype,r),i&&Du(n,i),e}(),Vu=new mo.a;function Mu(t){return(Mu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Nu(t,e){return!e||"object"!==Mu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fu(t){return(Fu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Uu(t,e){return(Uu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Vu.Retrieve=function(t){return this.PreRetrieve(),this.objects.pop().SetData(t)},Vu.Flood(function(){return new ju(0,0)},200);var Xu=function(t){function e(t,n,r,i,o,a){var s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(s=Nu(this,Fu(e).call(this,t,n,r,a))).fontData=i,s.lineHeight=i.font.common.attributes.lineHeight,s.chars=[],s.maxWidth=1024,s.text="",s.autoUpdateChars=!0,null!=o&&(s.text=o),s.ComputeText(),s}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Uu(t,e)}(e,Ta),n=e,(r=[{key:"Render",value:function(t){this.PreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),this.transform.ApplyGlobal(t),!0===this.display&&(t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,this.RenderText(t)),this.children.length>0&&this.RenderChildren(t)),this.PostRender(t)}},{key:"GLRender",value:function(t){this.GLPreRender(t),!0===this.render&&(this.ProcessTransform(this.parent),!0===this.display&&null!==this.programController&&this.GLRenderText(t),this.children.length>0&&!0===this.display&&(!0===this.isBatchParent?this.GLBatchRenderChildren(t):this.GLRenderChildren(t))),this.GLPostRender(t)}},{key:"RenderText",value:function(t){for(var e=this.chars,n=this.texture.image,r=0;r<e.length;++r)e[r].Render(t,n)}},{key:"GLRenderText",value:function(){var t=this.chars;if(!0===this.autoUpdateChars)for(var e=0;e<t.length;++e)t[e].GLRenderAuto(this.programController,this.tint.channel,this.texture.uniformId);else for(e=0;e<t.length;++e)t[e].GLRender(this.programController,this.tint.channel,this.texture.uniformId)}},{key:"ComputeText",value:function(){var t,e,n,r=0,i=0,o=!1,a=0,s=0,u=0,l=0,c=this.chars,h=this.text;this.UpdateTransform(this.parent),0!==c.length&&this.StoreAllChars(),this.fontData.font.kernings&&(t=this.fontData.font.kernings.kerning);for(var f=0;f<h.length;++f){var d=h.charCodeAt(f);n=c[f-1-i],10!==d?(e=ju.pool.Retrieve(this.GetCharDataById(d)),null!=t&&e.ApplyKernings(t),e.Crunch(n),u=e.position.x+e.width,l=e.position.y+e.height,(u>this.maxWidth||!0===o)&&(e.position.SetSame(0),e.yadvance=this.lineHeight*++r,e.position.Add(e.xoffset,e.yoffset+e.yadvance),o=!1),u>a&&(a=u),l>s&&(s=l),e.parent=this,e.UpdateMatrices(),c.push(e)):(i++,o=!0)}this.w=a,this.h=s}},{key:"UpdateChars",value:function(){for(var t=this.chars,e=0;e<t.length;++e)t[e].UpdateMatrices()}},{key:"GetCharDataById",value:function(t){for(var e=this.fontData.font.chars.char,n=0;n<e.length;++n)if(parseInt(e[n].attributes.id)===t)return e[n].attributes}},{key:"StoreAllChars",value:function(){for(var t=this.chars,e=0;e<t.length;++e)t[e].Store();return t.length=0,this}},{key:"UpdateInBuffer",value:function(){throw new Error(Yu)}},{key:"GetBufferData",value:function(){throw new Error(Yu)}}])&&Gu(n.prototype,r),i&&Gu(n,i),e}(),Yu="Cannot access buffer data directly on BitmapText!";function Hu(t){return(Hu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qu(t,e){return!e||"object"!==Hu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zu(t){return(zu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ku(t,e){return(Ku=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ju=function(t){function e(t,n,r,i){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=qu(this,zu(e).call(this,t,n))).text=r,o.style=Rn(i),o.maxWidth=void 0,o.alpha=1,o.gco=Pe,o}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ku(t,e)}(e,ha),n=e,(r=[{key:"Render",value:function(t){if(this.PreRender(t),!0===this.render){if(this.ProcessTransform(this.parent),this.transform.ApplyGlobal(t),!0===this.display){var e=this.style;!0===e.shadow.applied&&e.shadow.Apply(t),!0===e.text.applied&&(e.text.Apply(t),t.globalAlpha=this.alpha,t.globalCompositeOperation=this.gco,t.fillText(this.text,0,0,this.maxWidth),t.strokeText(this.text,0,0,this.maxWidth))}this.children.length>0&&this.RenderChildren(t)}}},{key:"IntersectsPoint2D",value:function(){return!1}}])&&Wu(n.prototype,r),i&&Wu(n,i),e}();function Qu(t){return(Qu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zu(t,e){return!e||"object"!==Qu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tl(t){return(tl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function el(t,e){return(el=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nl=Math.cos,rl=Math.sin,il=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Zu(this,tl(e).call(this,0,0))).focus=t,r.target=n,r.velocity=new st.a(0,0),r.force=new st.a(1,1),r.maxX=null,r.maxY=null,r.minX=null,r.minY=null,r.stopRadiusSq=1e3,r.EPSILON=2e-4,r}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&el(t,e)}(e,ha),n=e,(r=[{key:"Process",value:function(){var t=this.target;if(null!=t){al.SetV(t.position).Invert().AddV(this.focus),ol.SetV(this.position).SubtractV(al);var e=ol.GetMagnitudeSquared();if(e<this.stopRadiusSq)return;e*=this.EPSILON;var n=ol.GetAngle();this.velocity.Set(e*nl(n),e*rl(n)).MultiplyV(this.force),this.position.SubtractV(this.velocity)}null!=this.maxX&&this.x>this.maxX&&(this.x=this.maxX),null!=this.minX&&this.x<this.minX&&(this.x=this.minX),null!=this.maxY&&this.y>this.maxY&&(this.y=this.maxY),null!=this.minY&&this.y<this.minY&&(this.y=this.minY)}},{key:"SetTarget",value:function(t){return this.target=t,this}},{key:"SetMax",value:function(t,e){return this.maxX=t,this.maxY=e,this}},{key:"SetMin",value:function(t,e){return this.minX=t,this.minY=e,this}}])&&$u(n.prototype,r),i&&$u(n,i),e}(),ol=new st.a(0,0),al=new st.a(0,0);function sl(t){return(sl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ul(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ll(t,e){return!e||"object"!==sl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cl(t){return(cl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hl(t,e){return(hl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fl=function(t){function e(t,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=ll(this,cl(e).call(this,t,n))).programController=r,i.w=128,i.h=128,i.time=0,i.timeInc=.1,i.transformShouldUpdate=!1,i.transformAutomaticUpdate=!1,i}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hl(t,e)}(e,Ho),n=e,(r=[{key:"GLPreRender",value:function(){}},{key:"GLPostRender",value:function(){}},{key:"GLRender",value:function(t){this.GLPreRender(t),this.ProcessTransform(this.parent);var e=this.bounds.local;this.programController.Execute(this.transform.globalTransform.AsArray(!0),e.tl.x,e.tl.y,e.w,e.h,this.time),this.time+=this.timeInc,this.GLPostRender(t)}}])&&ul(n.prototype,r),i&&ul(n,i),e}();function dl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function pl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var yl=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.bounds=new se(e,n,r,i),this.container=null,this.entities=null,this.conversionMatrix=null,this.onOut=new er,this.onIn=new er}var e,n,r;return e=t,(n=[{key:"BindContainer",value:function(t){return this.container=t,this.entities=t.children,this}},{key:"SetConversionMatrix",value:function(t){return this.conversionMatrix=t,this}},{key:"Process",value:function(){for(var t=this.entities,e=dl(t,1)[0],n=this.bounds,r=this.conversionMatrix,i=0;i<t.length;e=t[++i])!1===n.IntersectsAABB2D(e.ComputeGlobalBounds(e.anchor,r))?!1!==e.__inside__&&(e.__inside__=!1,this.onOut.Dispatch(e)):!0!==e.__inside__&&(e.__inside__=!0,this.onIn.Dispatch(e))}}])&&pl(e.prototype,n),r&&pl(e,r),t}();function vl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ml=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.defaultOptions=e}var e,n,r;return e=t,(n=[{key:"PreDrawBase",value:function(t){this.defaultOptions&&Object(L.AssignIfUndefined)(this.defaultOptions,t);var e=t.rc;return t.identity&&e.setTransform(1,0,0,1,0,0),e.fillStyle=t.fillStyle?t.fillStyle:"rgb(100, 150, 200)",e.globalAlpha=t.globalAlpha?t.globalAlpha:.7,e.shadowOffsetX=t.shadowOffsetX?t.shadowOffsetX:0,e.shadowOffsetY=t.shadowOffsetY?t.shadowOffsetY:0,e.shadowBlur=t.shadowBlur?t.shadowBlur:12,e.globalCompositeOperation=t.globalCompositeOperation?t.globalCompositeOperation:"source-over",e.imageSmoothingEnabled=t.imageSmoothingEnabled?t.imageSmoothingEnabled:"true",this}},{key:"PreDrawText",value:function(t){var e=t.rc;return e.font=t.font?t.font:"10px sans-serif",e.textAlign=t.textAlign?t.textAlign:"start",e.textBaseline=t.textBaseline?t.textBaseline:"alphabetic",e.direction=t.direction?t.direction:"inherit",this}},{key:"PreDrawStroke",value:function(t){var e=t.rc;return e.strokeStyle=t.strokeStyle?t.strokeStyle:"rgb(200, 150, 100)",e.lineWidth=t.lineWidth?t.lineWidth:3,e.linecap=t.lineCap?t.lineCap:"round",e.lineJoin=t.lineJoin?t.lineJoin:"round",e.miterLimit=t.miterLimit?t.miterLimit:10,e.lineDashOffset=t.lineDashOffset?t.lineDashOffset:0,e.setLineDash(t.lineDash?t.lineDash:bl),this}},{key:"Rectangle",value:function(t){this.PreDrawBase(t),t.stroke&&this.PreDrawStroke(t);var e=t.rc;return e.beginPath(),e.rect(t.x,t.y,t.w,t.h),t.stroke&&e.stroke(),t.fill&&e.fill(),this}},{key:"RoundRectangle",value:function(t){this.PreDrawBase(t),t.stroke&&this.PreDrawStroke(t);var e=t.rc;e.beginPath();var n=t.x,r=t.y,i=t.radius,o=n+t.w,a=r+t.h;return e.moveTo(n+i,r),e.lineTo(o-i,r),e.quadraticCurveTo(o,r,o,r+i),e.lineTo(o,a-i),e.quadraticCurveTo(o,a,o-i,a),e.lineTo(n+i,a),e.quadraticCurveTo(n,a,n,a-i),e.lineTo(n,r+i),e.quadraticCurveTo(n,r,n+i,r),t.stroke&&e.stroke(),t.fill&&e.fill(),this}},{key:"AABB",value:function(t){this.PreDrawBase(t),t.stroke&&this.PreDrawStroke(t);var e=t.rc;return e.beginPath(),e.moveTo(t.tl.x,t.tl.y),e.lineTo(t.br.x,t.tl.y),e.lineTo(t.br.x,t.br.y),e.lineTo(t.tl.x,t.br.y),e.closePath(),t.stroke&&e.stroke(),t.fill&&e.fill(),this}},{key:"Circle",value:function(t){this.PreDrawBase(t),t.stroke&&this.PreDrawStroke(t);var e=t.rc;return t.continue||e.beginPath(),e.arc(t.center.x,t.center.y,t.radius,0,B.PII,!1),t.stroke&&e.stroke(),t.fill&&e.fill(),this}},{key:"Ellipse",value:function(t){this.PreDrawBase(t),t.stroke&&this.PreDrawStroke(t);var e=t.rc;return t.continue||e.beginPath(),e.ellipse(t.center.x,t.center.y,t.radiusX,t.radiusY,0,B.PII,!1),t.stroke&&e.stroke(),t.fill&&e.fill(),this}},{key:"Line",value:function(t){this.PreDrawBase(t),t.stroke&&this.PreDrawStroke(t);var e=t.rc;return t.continue||(e.beginPath(),e.moveTo(t.s.x,t.s.y)),e.lineTo(t.e.x,t.e.y),t.stroke&&e.stroke(),this}},{key:"LineChain",value:function(t){this.PreDrawBase(t),t.stroke&&this.PreDrawStroke(t);var e=t.rc,n=t.points;e.beginPath(),e.moveTo(n[0].x,n[0].y);for(var r=1;r<n.length;++r)e.lineTo(n[r].x,n[r].y);return t.close&&e.closePath(),t.stroke&&e.stroke(),t.fill&&e.fill(),this}},{key:"Arc",value:function(t){this.PreDrawBase(t),t.stroke&&this.PreDrawStroke(t);var e=t.rc;return t.continue||e.beginPath(),e.arc(t.center.x,t.center.y,t.radius,t.startAngle,t.endAngle,t.anticlockwise),t.close&&e.closePath(),t.stroke&&e.stroke(),t.fill&&e.fill(),this}},{key:"EllipticArc",value:function(t){this.PreDrawBase(t),t.stroke&&this.PreDrawStroke(t);var e=t.rc;return t.continue||e.beginPath(),e.ellipse(t.center.x,t.center.y,t.radiusX,t.radiusY,t.startAngle,t.endAngle,t.anticlockwise),t.close&&e.closePath(),t.stroke&&e.stroke(),t.fill&&e.fill(),this}},{key:"Curve",value:function(t){this.PreDrawBase(t),t.stroke&&this.PreDrawStroke(t);var e=t.rc;return t.continue||(e.beginPath(),e.moveTo(t.s.x,t.s.y)),e.arcTo(t.c1.x,t.c1.y,t.e.x,t.e.y,t.radius),t.close&&e.closePath(),t.stroke&&e.stroke(),t.fill&&e.fill(),this}},{key:"BezierCurve",value:function(t){this.PreDrawBase(t),t.stroke&&this.PreDrawStroke(t);var e=t.rc;return t.continue||(e.beginPath(),e.moveTo(t.s.x,t.s.y)),e.bezierCurveTo(t.c1.x,t.c1.y,t.c2.x,t.c2.y,t.e.x,t.e.y),t.close&&e.closePath(),t.stroke&&e.stroke(),t.fill&&e.fill(),this}},{key:"QuadraticCurve",value:function(t){this.PreDrawBase(t),t.stroke&&this.PreDrawStroke(t);var e=t.rc;return t.continue||(e.beginPath(),e.moveTo(t.s.x,t.s.y)),e.quadraticCurveTo(t.c1.x,t.c1.y,t.e.x,t.e.y),t.close&&e.closePath(),t.stroke&&e.stroke(),t.fill&&e.fill(),this}}])&&vl(e.prototype,n),r&&vl(e,r),t}(),bl=[];n.d(e,"Math",function(){return B}),n.d(e,"Assert",function(){return Tr.a}),n.d(e,"Pool",function(){return mo.a}),n.d(e,"FlagList",function(){return vs}),n.d(e,"FlagEnum",function(){return bs}),n.d(e,"Cache",function(){return Pr}),n.d(e,"Glob",function(){return gs.a}),n.d(e,"Maker",function(){return Ss}),n.d(e,"ArrayHandler",function(){return Go}),n.d(e,"Color",function(){return Yn}),n.d(e,"Utility",function(){return L}),n.d(e,"Cipher",function(){return r}),n.d(e,"BrowserUtility",function(){return i}),n.d(e,"Style",function(){return b}),n.d(e,"Time",function(){return w}),n.d(e,"CharacterSets",function(){return Ts.a}),n.d(e,"CanvasManager",function(){return Es}),n.d(e,"Vector2D",function(){return st.a}),n.d(e,"Matrix2D",function(){return Ro}),n.d(e,"Transform2D",function(){return Bo}),n.d(e,"Bounds2D",function(){return Vo}),n.d(e,"QuadtreeNode",function(){return Is}),n.d(e,"Ease",function(){return o}),n.d(e,"Collision",function(){return f}),n.d(e,"Geom",function(){return p}),n.d(e,"Packing",function(){return _}),n.d(e,"Path",function(){return g}),n.d(e,"CoreEntity2D",function(){return Ho}),n.d(e,"Container2D",function(){return ia}),n.d(e,"VisualContainer2D",function(){return ha}),n.d(e,"BatchableContainer2D",function(){return ma}),n.d(e,"TextureEntity2D",function(){return Ta}),n.d(e,"Stage2D",function(){return Hs}),n.d(e,"Stadium",function(){return qs}),n.d(e,"Graphic2D",function(){return Zs}),n.d(e,"Sprite",function(){return au}),n.d(e,"Tilesprite",function(){return pu}),n.d(e,"Tile",function(){return Au}),n.d(e,"Tilemap",function(){return Ou}),n.d(e,"Char",function(){return ju}),n.d(e,"BitmapText",function(){return Xu}),n.d(e,"Text",function(){return Ju}),n.d(e,"Camera2D",function(){return il}),n.d(e,"GLEntity2D",function(){return fl}),n.d(e,"Culler2D",function(){return yl}),n.d(e,"Draw",function(){return ml}),n.d(e,"Shader",function(){return A}),n.d(e,"Load",function(){return S}),n.d(e,"Controller",function(){return T}),n.d(e,"CP",function(){return x}),n.d(e,"Motion",function(){return E}),n.d(e,"Particle",function(){return k}),n.d(e,"Texture",function(){return P}),n.d(e,"Animator",function(){return R}),n.d(e,"Input",function(){return D}),n.d(e,"Event",function(){return I}),n(16)},function(t,e,n){"use strict";n.r(e),n.d(e,"RandomInteger",function(){return c}),n.d(e,"RandomIntegerAvoid",function(){return h}),n.d(e,"RandomFloat",function(){return f}),n.d(e,"RandomFloatAvoid",function(){return d}),n.d(e,"IsInteger",function(){return p}),n.d(e,"IsFloat",function(){return y}),n.d(e,"IsArray",function(){return v}),n.d(e,"IsObject",function(){return m}),n.d(e,"IsFunction",function(){return b}),n.d(e,"Sign",function(){return g}),n.d(e,"IsBitSet",function(){return w}),n.d(e,"SetBit",function(){return A}),n.d(e,"ClearBit",function(){return S}),n.d(e,"ToggleBit",function(){return C}),n.d(e,"Clamp",function(){return T}),n.d(e,"InverseClamp",function(){return x}),n.d(e,"FlipACoin",function(){return E}),n.d(e,"NearestPow2Floor",function(){return P}),n.d(e,"NearestPow2Ceil",function(){return O}),n.d(e,"NearestPow2Round",function(){return k}),n.d(e,"GenerateSequence",function(){return R}),n.d(e,"RandomInArray",function(){return _}),n.d(e,"MinMaxOrValue",function(){return D}),n.d(e,"UUID",function(){return I}),n.d(e,"ApplyProperties",function(){return L}),n.d(e,"Nested",function(){return B}),n.d(e,"ArrayGetRandom",function(){return j}),n.d(e,"ArrayShuffle",function(){return V}),n.d(e,"Base16ToBase10",function(){return M}),n.d(e,"Base2ToBase10",function(){return G}),n.d(e,"IsObjectEmpty",function(){return N}),n.d(e,"DeepClone",function(){return F}),n.d(e,"CreateIteratorArgs",function(){return U}),n.d(e,"ReplaceArgumentWithObjectValue",function(){return X}),n.d(e,"AssignIfUndefined",function(){return Y}),n.d(e,"ValidateWithSchema",function(){return H}),n.d(e,"PRINT_VERSION",function(){return W});var r=n(4),i=n(10);function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var s=n(17).version,u=Math.random,l=Math.clz32;function c(t,e){return u()*(e-t+1)+t|0}function h(t,e,n,r){var i=c(t,e);if(t>n||e<r)throw new Error("Avoid causing infinite loops!");for(;i>n&&i<r;)i=c(t,e);return i}function f(t,e){return u()*(e-t)+t}function d(t,e,n,r){var i=f(t,e);if(t>n||e<r)throw new Error("Avoid causing infinite loops!");for(;i>n&&i<r;)i=f(t,e);return i}function p(t){return Number(t)===t&&t%1==0}function y(t){return Number(t)===t&&t%1!=0}function v(t){return"[object Array]"===Object.prototype.toString.call(t)}function m(t){return"[object Object]"===Object.prototype.toString.call(t)}function b(t){return"[object Function]"===Object.prototype.toString.call(t)}function g(t,e){return 0===t?!0===e?1:0:t>0?1:-1}function w(t,e){return 0!=(e&1<<t)}function A(t,e){return e|1<<t}function S(t,e){return e&~(1<<t)}function C(t,e){return e^1<<t}function T(t,e,n){return t<e?e:t>n?n:t}function x(t,e,n){return t<e?n:t>n?e:t}function E(t,e){return 1===c(1,2)?t:e}function P(t){return 1<<31-l(t)}function O(t){return 1<<31-l(2*t)}function k(t){return 1<<31-l(1.5*t)}function R(t,e,n,i){for(var o=[],a=0;a<e;a+=n)o.push(Object(r.PrecisionRound)(a,i));return o}function _(t){return t[c(0,t.length-1)]}function D(t,e){return null!=t.min&&null!=t.max?f(t.min,t.max):null!=t.values&&t.values.length>0?_(t.values):null!=e&&t[e].length>0?_(t[e]):t}function I(t,e,n,r){var o,a,s="",u=t/e;t=null==t?32:t,e=null==e?4:e,n=null==n?0:n,r=null==r?"-":r;for(var l=i.a[n],h=0;h<t;++h)0!==(a=h/u)&&p(a)?s+=r:(o=c(1,l.length-1),s+=l.charAt(o));return s}function L(t,e){var n;if(void 0!==e)for(n in e)void 0!==t[n]&&(t[n]=e[n])}function B(t,e,n,r,i,o){var a;if("string"==typeof e&&(o=null==o?".":o,e=e.split(o)),e.length>1){if(void 0!==t[a=e.shift()])return B(t[a],e,n,r,i,o)}else{if(void 0!==t[a=e.shift()])return!0===r?void(t[a]=i):!0===n?t:t[a];if(!0===r)return void(t[a]=i)}}function j(t,e){for(var n=[],r={},i=t.length,o=0;o<e;++o){var a=u()*i|0;void 0===r[a]?(r[a]=null,n.push(t[a])):o--}return n}function V(t){for(var e,n,r=t.length-1;r-- >=0;)n=u()*r|0,e=t[r],t[r]=t[n],t[n]=e}function M(t){return parseInt(t,16)}function G(t){return parseInt(t,2)}function N(t){var e;for(e in t)if(t.hasOwnProperty(e))return!1;return JSON.stringify(t)===JSON.stringify({})}function F(t){var e,n=null,r=!1;if("function"==typeof t)throw new TypeError("Object was of type: function. Not acceptable.");if(v(t))n=[],r=!0;else{if("object"!==a(t))return t;n={}}if(r)for(var i=0;i<t.length;++i)n[i]=F(t[i]);else for(e in t)t.hasOwnProperty(e)&&(n[e]=F(t[e]));return n}function U(t,e,n){for(var r,i,o,a,s=[],u=0;u<t.length;++u)"string"==typeof(r=t[u])&&0===r.indexOf(e)&&r.indexOf(n)===e.length&&(-1!==(a=r.indexOf("|"))?(i=r.slice(r.indexOf("(")+1,a),o=r.slice(a+1,r.indexOf(")")),s.push({mod:i,val:o,iteratorIndex:u})):s.push({iteratorIndex:u}));return s}function X(t,e,n){for(var r=o(e,1)[0],i=0;i<e.length;r=e[++i])"string"==typeof r&&0===r.indexOf(n)&&(e[i]=B(t,r.slice(n.length)))}function Y(t,e){for(var n in t)t.hasOwnProperty(n)&&void 0===e[n]&&(e[n]=t[n])}function H(t,e){var n,r=!0;for(n in e)null!=e[n]&&!0===e[n].required&&null==t[n]&&(console.error("Key: "+n+" is required!"),r=!1);for(n in t)null!=t[n]&&(null==e[n]?(console.error("Unknown key: "+n),r=!1):!1===e[n].typeCheck(t[n])&&(console.error("Type check failed for key: "+n),r=!1));return r}function W(t){t?console.log("nenkraft2 server version "+s):console.log("%cnenkraft2 %cversion %c"+s,"color:#c89664;background-color:#304860;font-family:Arial;font-size:18px;font-weight:900;padding:5px;","color:#c89664;background-color:#5078a0;font-family:Arial;font-size:18px;font-weight:900;padding:5px;","color:#c89664;background-color:#6496c8;font-family:Arial;font-size:18px;font-weight:900;padding:5px;")}},function(t,e,n){"use strict";n.d(e,"a",function(){return f});var r=n(6);function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=Math.ceil,a=Math.round,s=Math.abs,u=Math.sqrt,l=Math.atan2,c=Math.cos,h=Math.sin,f=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=n}var e,n,r;return e=t,r=[{key:"SortMinMag",value:function(t,e){return t.GetMagnitudeSquared()-e.GetMagnitudeSquared()}},{key:"pool",get:function(){return d}},{key:"USE_POOL",get:function(){return p},set:function(t){p=!!t}}],(n=[{key:"Copy",value:function(){return!0===p?d.Retrieve(this.x,this.y):new t(this.x,this.y)}},{key:"FromPool",value:function(e,n){return!0===p?d.Retrieve(e,n):new t(e,n)}},{key:"AbsoluteCopy",value:function(){return this.Copy().Positive()}},{key:"SetV",value:function(t){return this.x=t.x,this.y=t.y,this}},{key:"Set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"SetSame",value:function(t){return this.x=t,this.y=t,this}},{key:"Is0",value:function(){return 0===this.x&&0===this.y}},{key:"AddVC",value:function(t){return this.Copy().AddV(t)}},{key:"AddV",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"Add",value:function(t,e){return this.x+=t,this.y+=e,this}},{key:"SubtractVC",value:function(t){return this.Copy().SubtractV(t)}},{key:"SubtractV",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"Subtract",value:function(t,e){return this.x-=t,this.y-=e,this}},{key:"MultiplyVC",value:function(t){return this.Copy().MultiplyV(t)}},{key:"MultiplyV",value:function(t){return this.x*=t.x,this.y*=t.y,this}},{key:"Multiply",value:function(t,e){return this.x*=t,this.y*=e,this}},{key:"DivideVC",value:function(t){return this.Copy().DivideV(t)}},{key:"DivideV",value:function(t){return this.x/=t.x,this.y/=t.y,this}},{key:"Divide",value:function(t,e){return this.x/=t,this.y/=e,this}},{key:"Normalize",value:function(){var t=this.GetMagnitude();return this.Divide(t,t)}},{key:"Positive",value:function(){return this.x=s(this.x),this.y=s(this.y),this}},{key:"Negative",value:function(){return this.x=-s(this.x),this.y=-s(this.y),this}},{key:"Invert",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"Rotate",value:function(t){var e=h(t),n=c(t),r=this.x,i=this.y;return this.x=r*n-i*e,this.y=r*e+i*n,this}},{key:"RotateAroundV",value:function(t,e){return this.SubtractV(t).Rotate(e).AddV(t)}},{key:"RotateAround",value:function(t,e,n){return this.SubtractV(t,e).Rotate(n).AddV(t,e)}},{key:"RotateAbsolute",value:function(t){return this.Rotate(t-this.GetAngle())}},{key:"RotateAbsoluteAroundV",value:function(t,e){return this.SubtractV(t).RotateAbsolute(e).AddV(t)}},{key:"RotateAbsoluteAround",value:function(t,e,n){return this.SubtractV(t,e).RotateAbsolute(n).AddV(t,e)}},{key:"PushFromV",value:function(t,e){return y.SetV(this).SubtractV(t).Normalize().Multiply(e,e),this.AddV(y)}},{key:"PushFrom",value:function(t,e,n){return y.SetV(this).SubtractV(t,e).Normalize().Multiply(n,n),this.AddV(y)}},{key:"GetWeightedAverageV",value:function(t,e){return this.FromPool(this.x*(1-e)+t.x*e,this.y*(1-e)+t.y*e)}},{key:"GetWeightedAverage",value:function(t,e,n){return this.FromPool(this.x*(1-n)+t*n,this.y*(1-n)+e*n)}},{key:"GetAngle",value:function(){return l(this.y,this.x)}},{key:"GetAngleBetweenV",value:function(t){return l(this.y-t.y,this.x-t.x)}},{key:"GetAngleBetween",value:function(t,e){return l(this.y-e,this.x-t)}},{key:"GetDotV",value:function(t){return this.x*t.x+this.y*t.y}},{key:"GetDot",value:function(t,e){return this.x*t+this.y*e}},{key:"GetCrossV",value:function(t){return this.x*t.y+this.y*t.x}},{key:"GetCross",value:function(t,e){return this.x*e+this.y*t}},{key:"GetMagnitudeSquared",value:function(){return this.x*this.x+this.y*this.y}},{key:"GetMagnitude",value:function(){return u(this.x*this.x+this.y*this.y)}},{key:"GetDistanceSquaredV",value:function(t){return y.SetV(this).SubtractV(t).GetMagnitudeSquared()}},{key:"GetDistanceSquared",value:function(t,e){return y.SetV(this).Subtract(t,e).GetMagnitudeSquared()}},{key:"GetDistanceV",value:function(t){return y.SetV(this).SubtractV(t).GetMagnitude()}},{key:"GetDistance",value:function(t,e){return y.SetV(this).Subtract(t,e).GetMagnitude()}},{key:"GetPerpendicularCCWV",value:function(t){return this.FromPool(-(t.y-this.y),t.x-this.x)}},{key:"GetPerpendicularCCW",value:function(t,e){return this.FromPool(-(e-this.y),t-this.x)}},{key:"GetPerpendicularCWV",value:function(t){return this.FromPool(t.y-this.y,-(t.x-this.x))}},{key:"GetPerpendicularCW",value:function(t,e){return this.FromPool(e-this.y,-(t-this.x))}},{key:"GetNormalAV",value:function(t){return this.GetPerpendicularCCWV(t).Normalize()}},{key:"GetNormalA",value:function(t,e){return this.GetPerpendicularCCW(t,e).Normalize()}},{key:"GetNormalBV",value:function(t){return this.GetPerpendicularCWV(t).Normalize()}},{key:"GetNormalB",value:function(t,e){return this.GetPerpendicularCW(t,e).Normalize()}},{key:"GetMidpointV",value:function(t){return this.Copy().AddV(t).Multiply(.5,.5)}},{key:"GetMidpoint",value:function(t,e){return this.Copy().Add(t,e).Multiply(.5,.5)}},{key:"IsEqualToV",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"IsEqualTo",value:function(t,e){return this.x===t&&this.y===e}},{key:"GetProjectionOntoV",value:function(t){var e=this.GetDotV(t);if(0===e)return this.FromPool(0,0);var n=t.GetMagnitude(),r=e/(n*n);return t.Copy().Multiply(r,r)}},{key:"GetProjectionOnto",value:function(t,e){var n=this.Copy();n.Set(t,e);var r=this.GetDotV(n);if(0===r)return n.SetSame(0);var i=n.GetMagnitude(),o=r/(i*i);return n.Multiply(o,o)}},{key:"GetReflectionV",value:function(t){var e=t.Copy(),n=this.GetDotV(e);return e.Multiply(2,2).Multiply(n,n),this.SubtractVC(e)}},{key:"GetReflection",value:function(t,e){var n=this.Copy();n.Set(t,e);var r=this.GetDotV(n);return n.Multiply(2,2).Multiply(r,r),this.SubtractVC(n)}},{key:"Store",value:function(){return d.Store(this),this}},{key:"AddTo",value:function(t){for(var e=0;e<t.length;++e)t[e].AddV(this);return this}},{key:"Floor",value:function(){return this.x=0|this.x,this.y=0|this.y,this}},{key:"Ceil",value:function(){return this.x=o(this.x),this.y=o(this.y),this}},{key:"Round",value:function(){return this.x=a(this.x),this.y=a(this.y),this}},{key:"GetMinMaxDot",value:function(t){for(var e=1/0,n=-e,r=0,i=this.Copy(),o=0;o<t.length;++o)(r=t[o].GetDotV(this))>n&&(n=r),r<e&&(e=r);return i.Set(e,n),i}}])&&i(e.prototype,n),r&&i(e,r),t}(),d=new r.a,p=!0;d.Retrieve=function(t,e){return this.PreRetrieve(),this.objects.pop().Set(t,e)},d.Flood(function(){return new f(0,0)},1e3);var y=new f(0,0)},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(t,e){var n=document.getElementById("buttons"),r=document.createElement("input"),i=document.getElementById("back-button");r.setAttribute("value",t),r.setAttribute("type","button"),r.addEventListener("click",function(){n.style.display="none",i.onclick=a,e(o)}),n.appendChild(r);var o={canvas:null,stage:null,stadium:null,ticker:null};function a(){o.canvas&&o.canvas.parentNode.removeChild(o.canvas),o.stage&&o.stage.Destroy(),o.stadium&&(o.stadium.stages.forEach(function(t){t.canvas.parentNode.removeChild(t.canvas)}),o.stadium.Destroy()),o.canvasManager&&o.canvasManager.Destroy(),o.ticker&&o.ticker.Stop(),i.onclick=null,n.style.display=null}}},function(t,e,n){"use strict";n.r(e),n.d(e,"PII",function(){return h}),n.d(e,"TAU",function(){return f}),n.d(e,"PI5",function(){return d}),n.d(e,"DEGREES_TO_RADIANS",function(){return p}),n.d(e,"RADIANS_TO_DEGRESS",function(){return y}),n.d(e,"RADIAN",function(){return v}),n.d(e,"DegreesToRadians",function(){return m}),n.d(e,"RadiansToDegress",function(){return b}),n.d(e,"PrecisionRound",function(){return g}),n.d(e,"Spread",function(){return w}),n.d(e,"AttractRepel",function(){return A}),n.d(e,"Oscillate",function(){return S}),n.d(e,"LikeASquareGrid",function(){return C}),n.d(e,"TriRectArray",function(){return T}),n.d(e,"GreatestCommonDivisor",function(){return x}),n.d(e,"SimplifyAspectRatio",function(){return E}),n.d(e,"IntegerNotation",function(){return P});var r=n(7);function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n.d(e,"Misc",function(){return r});var o=Math.PI,a=Math.sin,s=Math.cos,u=Math.pow,l=Math.round,c=Math.ceil,h=2*o,f=h,d=.5*o,p=o/180,y=180/o,v=p;function m(t){return t*p}function b(t){return t*y}function g(t,e){if(null==e)return t;var n=u(10,e);return l(n*t)/n}function w(t,e,n,r){return t-n*(e-1)*.5+r*n}function A(t,e,n,r,i){var o=e.SubtractVC(t);if(o.GetMagnitudeSquared()<r*r){var u=o.GetAngle();n.Add(s(u)*i,a(u)*i)}}function S(t,e,n,r){var i=.5*(n-e);return e+i+a(m(t*r))*i}function C(t,e,n,r,o,a){o=o||0,a=a||0;for(var s=e/n|0,u=i(t,1)[0],l=0;l<t.length;u=t[++l])u.x=l%s*n+o,u.y=(l/s|0)*r+a}function T(t,e,n,r,i){return null!=i?(i[0]=t,i[1]=e,i[2]=t+n,i[3]=e,i[4]=t,i[5]=e+r,i[6]=t,i[7]=e+r,i[8]=t+n,i[9]=e,i[10]=t+n,i[11]=e+r,i):[t,e,t+n,e,t,e+r,t,e+r,t+n,e,t+n,e+r]}function x(t,e){return 0===e?t:x(e,t%e)}function E(t,e,n){var r=x(t,e),i=null==n?[]:n;return i[0]=t/r,i[1]=e/r,i}function P(t,e,n){var r=t%e,i=t/e;return c(0===r?i+1:i)+n+(1+r)}},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return o});var r=n(1);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e,n,s){if(null==s||"function"!=typeof t.Assert)switch(e){case o.IS:return void function(t,e,n){var r=!1;t!==e&&(r=!0);a(r,t,e,n)}(t,n,e);case o.IS_NOT:return void function(t,e,n){var r=!1;t===e&&(r=!0);a(r,t,e,n)}(t,n,e);case o.IS_SAME_TYPE:return void function(t,e,n){var o=!1;Object(r.IsArray)(t)||Object(r.IsArray)(e)?!Object(r.IsArray)(t)!=!Object(r.IsArray)(e)&&(o=!0):null===t||null===e?t!==e&&(o=!0):i(t)!==i(e)?o=!0:"number"!=typeof t&&"number"!=typeof e||(isNaN(t)||isNaN(e))&&t!==e&&(o=!0);a(o,t,e,n)}(t,n,e);case o.IS_NOT_SAME_TYPE:return void function(t,e,n){var o=!1;Object(r.IsArray)(t)||Object(r.IsArray)(e)?Object(r.IsArray)(t)&&Object(r.IsArray)(e)&&(o=!0):null===t||null===e?e===t&&(o=!0):i(t)===i(e)?o=!0:"number"!=typeof t&&"number"!=typeof e||(isNaN(t)||isNaN(e))&&isNaN(t)&&isNaN(e)&&(o=!0);a(o,t,e,n)}(t,n,e);case o.IS_INSTANCE_OF:return void function(t,e,n){var r=!1;t instanceof e||(r=!0);a(r,t,e.name,n)}(t,n,e);case o.IS_NOT_INSTANCE_OF:return void function(t,e,n){var r=!1;t instanceof e&&(r=!0);a(r,t,e.name,n)}(t,n,e);case o.IS_LESS_THAN:return void function(t,e,n){var r=!1;t>=e&&(r=!0);a(r,t,e,n)}(t,n,e);case o.IS_GREATER_THAN:return void function(t,e,n){var r=!1;t<=e&&(r=!0);a(r,t,e,n)}(t,n,e);case o.IS_LESS_THAN_OR_EQUAL:return void function(t,e,n){var r=!1;t>e&&(r=!0);a(r,t,e,n)}(t,n,e);case o.IS_GREATER_THAN_OR_EQUAL:return void function(t,e,n){var r=!1;t<e&&(r=!0);a(r,t,e,n)}(t,n,e);default:throw new Error("No comparison: "+e)}else t.Assert(e,n)}function a(t,e,n,r){if(t)throw function(t,e,n){switch(n){case o.IS:n=o.IS_NOT;break;case o.IS_NOT:n=o.IS;break;case o.IS_SAME_TYPE:n=o.IS_NOT_SAME_TYPE;break;case o.IS_NOT_SAME_TYPE:n=o.IS_SAME_TYPE;break;case o.IS_INSTANCE_OF:n=o.IS_NOT_INSTANCE_OF;break;case o.IS_NOT_INSTANCE_OF:n=o.IS_INSTANCE_OF;break;case o.IS_LESS_THAN:n=o.IS_GREATER_THAN_OR_EQUAL;break;case o.IS_GREATER_THAN:n=o.IS_LESS_THAN_OR_EQUAL;break;case o.IS_LESS_THAN_OR_EQUAL:n=o.IS_GREATER_THAN;break;case o.IS_GREATER_THAN_OR_EQUAL:n=o.IS_LESS_THAN;break;default:throw new Error("Unexpected error")}console.error(t,n,e)}(e,n,r),new Error("Assertion failed: "+r);o.LOG&&window&&function(t,e,n){console.log("%c<<||-?START?-||>>","background-color: black; color: #0FF; padding: 0px 25px;"),console.log("%cAssertion success: ","background-color: #333; color: #0F0; padding: 0px 25px;"),console.log(t),console.log(n),console.log(e),console.log("%c>>||-?END?-||<<","background-color: black; color: #FF0; padding: 0px 25px;")}(e,n,r)}o.IS="I",o.IS_NOT="IN",o.IS_SAME_TYPE="IST",o.IS_NOT_SAME_TYPE="INST",o.IS_INSTANCE_OF="IIO",o.IS_NOT_INSTANCE_OF="INIO",o.IS_LESS_THAN="ILT",o.IS_GREATER_THAN="IGT",o.IS_LESS_THAN_OR_EQUAL="ILTOE",o.IS_GREATER_THAN_OR_EQUAL="IGTOE",o.Assign=function(e){if(window&&!e?e=window:t&&!e&&(e=t),!e)throw new Error("No global namespace");e.IS=o.IS,e.IS_NOT=o.IS_NOT,e.IS_SAME_TYPE=o.IS_SAME_TYPE,e.IS_NOT_SAME_TYPE=o.IS_NOT_SAME_TYPE,e.IS_INSTANCE_OF=o.IS_INSTANCE_OF,e.IS_NOT_INSTANCE_OF=o.IS_NOT_INSTANCE_OF,e.IS_LESS_THAN=o.IS_LESS_THAN,e.IS_GREATER_THAN=o.IS_GREATER_THAN,e.IS_LESS_THAN_OR_EQUAL=o.IS_LESS_THAN_OR_EQUAL,e.IS_GREATER_THAN_OR_EQUAL=o.IS_GREATER_THAN_OR_EQUAL},o.LOG=!1}).call(this,n(9))},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,"a",function(){return i});var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.objects=[],this.floodFunction=null,this.floodAmount=null,this.context=null}var e,n,i;return e=t,(n=[{key:"Store",value:function(t){this.objects.push(t)}},{key:"PreRetrieve",value:function(){0===this.objects.length&&this.Flood()}},{key:"Retrieve",value:function(){return this.PreRetrieve(),this.objects.pop()}},{key:"Flood",value:function(t,e,n){t&&(this.floodFunction=t),e&&(this.floodAmount=e),n&&(this.context=n);for(var r=0;r<this.floodAmount;++r)this.Store(this.floodFunction.call(this.context))}},{key:"Flush",value:function(){this.objects.length=0}},{key:"Clean",value:function(){var t=this.objects.length;this.Flush(),this.Flood(void 0,t)}}])&&r(e.prototype,n),i&&r(e,i),t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"Line2DLine2DIntersection",function(){return i}),n.d(e,"ClosestPoint2DOnLine2D",function(){return o});var r=n(2);function i(t,e,n,r){a.SetV(e).SubtractV(t),s.SetV(r).SubtractV(n);var i=-s.x*a.y+a.x*s.y,o=t.x-n.x,u=t.y-n.y,l=(-a.y*o+a.x*u)/i,c=(s.x*u-s.y*o)/i;return l>=0&&l<=1&&c>=0&&c<=1}function o(t,e,n){var r=a.SetV(e).SubtractV(t),i=((n.x-t.x)*r.x+(n.y-t.y)*r.y)/r.GetMagnitudeSquared();return i<0?t:i>1?e:(r.Set(t.x+i*r.x,t.y+i*r.y),r)}var a=new r.a(0,0),s=new r.a(0,0)},function(t,e,n){"use strict";(function(t,r){n.d(e,"a",function(){return a});var i=n(4);function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function e(t,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.onProcess=t,this.intervalId=null,this.afId=null,this.immediateId=null,this.timeoutId=null,this.delta=0,this.then=0,this.now=0,this.desiredRate=0,this.type=null,this.issuedStop=!1,this.ProcessAccurate=this.ProcessAccurate.bind(this),this.SetDesiredRate(n),r||this.StartAF()}var n,a,d;return n=e,d=[{key:"LOG",get:function(){return s},set:function(t){s=!!t}}],(a=[{key:"Process",value:function(){this.onProcess(this.ComputeDelta())}},{key:"ProcessAccurate",value:function(){!0!==this.issuedStop&&(this.now=Date.now(),this.then+this.desiredRate<=this.now&&(this.delta=this.now-this.then,this.then=this.now,this.onProcess(this.delta)),Date.now()-this.then<this.desiredRate-16?this.timeoutId=setTimeout(this.ProcessAccurate):this.immediateId=t(this.ProcessAccurate))}},{key:"ProcessAF",value:function(){this.onProcess(this.ComputeDelta()),null!==this.afId&&(this.afId=requestAnimationFrame(this.ProcessAF))}},{key:"ComputeDelta",value:function(){return this.now=Date.now(),this.delta=this.now-this.then,this.then=this.now,this.delta}},{key:"GetTPS",value:function(){return Object(i.PrecisionRound)(1/this.delta*1e3,2)}},{key:"SetDesiredRate",value:function(t){this.desiredRate=void 0===t?16.66:1e3/t}},{key:"IsRunning",value:function(){return null!==this.type&&(f("%cTicker: "+this.type+" is running!","color:#F00;".concat(h)),!0)}},{key:"Start",value:function(){if(this.IsRunning())return null;this.now=this.then=Date.now(),this.intervalId=setInterval(this.Process.bind(this),this.desiredRate),this.type=l,f("%cTicker: Starting "+this.type,"color:#0F0;".concat(h))}},{key:"StartAccurate",value:function(){if(this.IsRunning())return null;this.issuedStop=!1,this.now=this.then=Date.now(),this.timeoutId=setTimeout(this.ProcessAccurate),this.type=c,f("%cTicker: Starting "+this.type,"color:#0F0;".concat(h))}},{key:"StartAF",value:function(){if(this.IsRunning())return null;this.now=this.then=Date.now(),this.ProcessAF=this.ProcessAF.bind(this),this.afId=requestAnimationFrame(this.ProcessAF),this.type=u,f("%cTicker: Starting "+this.type,"color:#0F0;".concat(h))}},{key:"Stop",value:function(){null!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),null!==this.afId&&(cancelAnimationFrame(this.afId),this.afId=null),null!==this.immediateId&&(r(this.immediateId),this.immediateId=null),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),null!==this.type&&f("%cTicker: Stopping "+this.type,"color:cyan;".concat(h)),this.issuedStop=!0,this.type=null}}])&&o(n.prototype,a),d&&o(n,d),e}(),s=!0,u="RAF",l="INTERVAL",c="ACCURATE INTERVAL",h="background-color:#304860;font-family:Arial;font-size:18px;font-weight:900;padding:5px;",f=function(){!1!==s&&console.log.apply(null,arguments)}}).call(this,n(11).setImmediate,n(11).clearImmediate)},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=["0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz!?#$%@&","0123456789","ABCDEFGHJIKLMNOPQRSTUWVXYZabcdefghijklmnopqrstuwvxyz","ABCDEFGHJIKLMNOPQRSTUWVXYZ","abcdefghijklmnopqrstuwvxyz","0123456789abcdefghijklmnopqrstuwvxyz","0123456789ABCDEFGHJIKLMNOPQRSTUWVXYZ"]},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(18),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(9))},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return a});var r=n(1);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.functions={},this.values={},this.constants={},this.components={},this.objects={},this.lists={}}var n,a,p;return n=e,p=[{key:"Assign",value:function(e){if(window&&!e?e=window:t&&!e&&(e=t),!e)throw new Error("No global namespace");e.FUNC=s,e.VAL=u,e.CONST=l,e.COMP=c,e.OBJ=h,e.LIST=f}},{key:"Create",value:function(n){var r=r||null;if(null==r){if(null==t)throw new Error("Neither window nor global exists!");if(void 0!==t[n])throw new Error("global."+n+" already exists!");t[n]=new e}else{if(void 0!==r[n])throw new Error("window."+n+" already exists!");r[n]=new e}}},{key:"FUNCTION",get:function(){return s}},{key:"VALUE",get:function(){return u}},{key:"CONSTANT",get:function(){return l}},{key:"COMPONENT",get:function(){return c}},{key:"OBJECT",get:function(){return h}},{key:"LIST",get:function(){return f}},{key:"AllowGetNullUndefined",get:function(){return d},set:function(t){(function(t){throw new Error('"'+t+'" is read-only')})("PS_AllowGetNullUndefined"),d=!!t}}],(a=[{key:"Define",value:function(t,e,n){this.Mark(t,e),this.Set(t,e,n)}},{key:"Mark",value:function(t,e){if("string"!=typeof t)throw new Error("Type needs to be a string!");if("string"!=typeof e)throw new Error("Id needs to be a string!");if(null==this[t])throw new Error("Type does not exist");if((t===l||t===c)&&void 0!==this[t][e])throw new Error("Constants cannot be reassigned!");this[t][e]=null}},{key:"Get",value:function(t,n){if("string"!=typeof t)throw new Error("Type needs to be a string!");if("string"!=typeof n)throw new Error("Id needs to be a string!");if(null==this[t])throw new Error("Type does not exist");if(!1===e.AllowGetNullUndefined&&null==this[t][n])throw new Error("Null or undefined!");return this[t][n]}},{key:"Set",value:function(t,e,n){if("string"!=typeof t)throw new Error("Type needs to be a string!");if("string"!=typeof e)throw new Error("Id needs to be a string!");switch(t){case s:if("function"!=typeof n)throw new Error("Needs to be a function!");if(null!==this.functions[e])throw new Error("No mark!");this.functions[e]=n;break;case u:if(n instanceof Object)throw new Error("Objects are not allowed!");if(null!==this.values[e])throw new Error("No mark!");this.values[e]=n;break;case l:if(n instanceof Object)throw new Error("Objects are not allowed!");if(null!==this.constants[e])throw new Error("No mark!");Object.defineProperty(this.constants,e,{writable:!1,configurable:!1,value:n});break;case c:if("function"!=typeof n)throw new Error("Needs to be a function!");if(null!==this.components[e])throw new Error("No mark!");Object.defineProperty(this.components,e,{writable:!1,configurable:!1,value:n});break;case h:if("object"!==i(n))throw new Error("Needs to be an object");if(!0===Object(r.IsArray)(n))throw new Error("Arrays are not allowed!");if(null!==this.objects[e])throw new Error("No mark!");this.objects[e]=n;break;case f:if(!1===Object(r.IsArray)(n))throw new Error("Needs to be an array!");if(null!==this.lists[e])throw new Error("No mark!");this.lists[e]=n;break;default:throw new Error("Unrecognized type!")}}}])&&o(n.prototype,a),p&&o(n,p),e}(),s="functions",u="values",l="constants",c="components",h="objects",f="lists",d=!1}).call(this,n(9))},function(t,e,n){t.exports=n(14)},function(t,e,n){n(15);var r=n(0);console.log(r,r.Shader.UN),r.Utility.PRINT_VERSION(),r.Sprite.BUILD_DEFAULT_TEXTURE(function(){r.Tilesprite.BUILD_DEFAULT_TEXTURE(function(){var t=new r.Load.LoaderCombiner([{loader:new r.Load.ImageLoader(null,null,function(){return console.log("IMAGE Finished")}),args:[[{id:"fontimg",src:"./assets/images/font.png"},{id:"fontNoK",src:"./assets/images/fontNoK.png"},{id:"1to8",src:"./assets/images/1to8.png"},{id:"4dots",src:"./assets/images/4dots.png"},{id:"colors",src:"./assets/images/colors.png"},{id:"glass-of-blueberryjuice",src:"./assets/images/glass-of-blueberryjuice.png"},{id:"raindrop",src:"./assets/images/raindrop.png"},{id:"smudge",src:"./assets/images/smudge.png"},{id:"watertest",src:"./assets/images/watertest.jpg"}],!0]},{loader:new r.Load.XHRLoader(null,function(){return console.log("XHR Finished")}),args:[[{id:"fontdataxml",src:"./assets/xhr/font.fnt",type:"xml"},{id:"fontdatajson",src:"./assets/xhr/font.json",type:"json"},{id:"fontNoK",src:"./assets/xhr/fontNoK.xml",type:"xml"},{id:"particleExplosion",src:"./assets/xhr/particle-explosion.json",type:"json"},{id:"particleFlare",src:"./assets/xhr/particle-flare.json",type:"json"},{id:"lorem",src:"./assets/xhr/lorem.json",type:"json"}]]},{loader:new r.Load.SpritesheetLoader(null,function(){return console.log("Spritesheet Finished")}),args:[[{id:"sheet-default",image:{src:"./../assets/images/invaders/invaders-sheet.png"},data:{src:"./../assets/xhr/invaders.json",type:"json"}},{id:"sheet-character",image:{src:"./../assets/images/spritesheet-character.png"},data:{src:"./../assets/xhr/spritesheet-character.json",type:"json"}}]]},{loader:new r.Load.TilesetLoader(null,function(){return console.log("Tileset Finished")}),args:[[{id:"tileset",image:{src:"./../assets/images/aseprite-tiles.png"},mapData:{src:"./../assets/xhr/aseprite-tiles.json",type:"json"},setData:{src:"./../assets/xhr/aseprite-tiles.tsx",type:"xml"}}]]}]);t.onComplete.Once(function(){console.log(t),function(){var e=[];window.testData={xhrloader:t.loaders[1],imgloader:t.loaders[0],ssloader:t.loaders[2],tsloader:t.loaders[3],invadersSpritesheet:t.loaders[2].GetSpritesheetById("sheet-default"),characterSheet:t.loaders[2].GetSpritesheetById("sheet-character"),tileset:t.loaders[3].GetTilesetById("tileset"),lorem:t.loaders[1].GetDataById("lorem").lorem},window.testData.invadersSpritesheet.GenerateFrames(),window.testData.characterSheet.GenerateFrames();var r=n(45);r.keys().forEach(function(t){e.push(r(t))});for(var i=0,o=e.length;i<o;++i)e[i].default()}()}),t.Load()})})},function(t,e,n){},function(t,e){function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}Array.prototype.indexPop=function(t){var e=this.length-1;if(e>1&&t<=e&&t>=0){var n=this[e];return this[e]=this[t],this[t]=n,this.pop()}return this.pop()},Array.prototype.indexShift=function(t){if(this.length>1&&t<=this.length-1&&t>=0){var e=n(this,1)[0];return this[0]=this[t],this[t]=e,this.shift()}return this.shift()},Array.prototype.popSplice=function(t){var e=this.length-1;if(!(e<1)){for(var n=this[t];t<e;)this[t]=this[t+1],t++;return this.pop(),n}},Array.prototype.shiftSplice=function(t){if(!(this.length<1)){for(var e=this[t];t>0;)this[t]=this[t-1],t--;return this.shift(),e}},Array.prototype.fickleSplice=function(t){return t>.5*this.length|0?this.popSplice(t):this.shiftSplice(t)}},function(t){t.exports={name:"nenkraft2",version:"2.4.0",description:"A small rendering tool",main:"./bundle-fe/nk2.js",devDependencies:{"@babel/core":"^7.0.0","@babel/preset-env":"^7.0.0","babel-loader":"^8.0.2","copy-webpack-plugin":"^5.0.3","css-loader":"^2.1.1",eslint:"^5.5.0","file-loader":"^4.0.0","html-loader":"^0.5.5","html-webpack-plugin":"^3.2.0","mini-css-extract-plugin":"^0.7.0","raw-loader":"^3.0.0",rimraf:"^2.6.2",webpack:"^4.17.2","webpack-cli":"^3.3.3","webpack-dev-server":"^3.7.1"},scripts:{"build-prod":"webpack --env production --mode production","build-bundle-fe":"webpack --env bundle-fe --mode production","build-bundle-be":"webpack --env bundle-be --mode production",start:"webpack-dev-server --env development --mode development","clear-bundle-fe":"rimraf bundle-fe/dist","clear-bundle-be":"rimraf bundle-be/dist","clear-dist":"rimraf dist",ce:"rimraf dist bundle-fe/dist bundle-be/dist",be:"yarn run ce && yarn run build-prod && yarn run build-bundle-be && yarn run build-bundle-fe","lint-f":"eslint src demos --fix",lint:"eslint src demos"},keywords:["2d","rendering","command","vector","game","graphic","tween","animation","collision","canvas","web","webgl","utilities"],author:"nuuf",license:"MIT"}},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i,o,a,s,u=1,l={},c=!1,h=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick(function(){p(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){p(t.data)},r=function(t){o.port2.postMessage(t)}):h&&"onreadystatechange"in h.createElement("script")?(i=h.documentElement,r=function(t){var e=h.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(p,0,t)}:(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&p(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),r=function(e){t.postMessage(a+e,"*")}),f.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return l[u]=i,r(u),u++},f.clearImmediate=d}function d(t){delete l[t]}function p(t){if(c)setTimeout(p,0,t);else{var e=l[t];if(e){c=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{d(t),c=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(9),n(19))},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,l=[],c=!1,h=-1;function f(){c&&u&&(c=!1,u.length?l=u.concat(l):h=-1,l.length&&d())}function d(){if(!c){var t=s(f);c=!0;for(var e=l.length;e;){for(u=l,l=[];++h<e;)u&&u[h].run();h=-1,e=l.length}u=null,c=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function y(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new p(t,e)),1!==l.length||c||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";n.r(e),e.default="precision highp float;\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\nvarying vec2 vTexCoord;\r\nvoid main() {\r\n    gl_Position = vec4( aPosition, 1.0, 1.0 );\r\n    vTexCoord = aTexCoord;\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="precision highp float;\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexCoord;\r\nuniform mat3 uProjection;\r\nuniform mat3 uTranslation;\r\nuniform mat3 uTransformation;\r\nvarying vec2 vTexCoord;\r\nvoid main() {\r\n    gl_Position = vec4( ( uProjection * uTranslation * vec3( aPosition, 1.0 ) ).xy, 0.0, 1.0 );\r\n    vTexCoord = ( uTransformation * vec3( aTexCoord, 1.0 ) ).xy;\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="#define PI 3.141592653589793\r\n"},function(t,e,n){"use strict";n.r(e),e.default="#define RADIAN 0.017453292519943295"},function(t,e,n){"use strict";n.r(e),e.default="#define RSEED1 46.1964987\r\n#define RSEED2 71.7294374\r\n#define RSEED3 94638.4836"},function(t,e,n){"use strict";n.r(e),e.default="#define VRSEED1 127.1\r\n#define VRSEED2 311.7\r\n#define VRSEED3 269.5\r\n#define VRSEED4 183.3\r\n#define VRSEED5 43758.5453123"},function(t,e,n){"use strict";n.r(e),e.default="float mod289( float n ) {\r\n     return ( n - floor( n * ( 1.0 / 289.0 ) ) * 289.0 );\r\n}\r\nvec2 mod289( vec2 p ) {\r\n     return ( p - floor( p * ( 1.0 / 289.0 ) ) * 289.0 );\r\n}\r\nvec3 mod289( vec3 p ) {\r\n     return ( p - floor( p * ( 1.0 / 289.0 ) ) * 289.0 );\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="float permute( float n ) { \r\n    return ( mod289( ( ( n * 34.0 ) +1.0 ) * n ) );\r\n}\r\nvec2 permute( vec2 p ) { \r\n    return ( mod289( ( ( p * 34.0 ) +1.0 ) * p ) );\r\n}\r\nvec3 permute( vec3 p ) { \r\n    return ( mod289( ( ( p * 34.0 ) +1.0 ) * p ) );\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="mat2 rotate2d ( float a ) {\r\n    float ca = cos( a );\r\n    float sa = sin( a );\r\n    return mat2( ca, sa, -sa, ca );\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="mat2 scale2d ( vec2 scl ) {\r\n    return mat2( scl.x, 0.0, 0.0, scl.y );\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="float plot ( float n, float pct, float prec ) {\r\n    return (\r\n        smoothstep( pct - prec, pct, n ) -\r\n        smoothstep( pct, pct + prec, n )\r\n    );\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="float ridge( float h, float offset ) {\r\n    h = abs( h );\r\n    h = offset - h;\r\n    h *= h;\r\n    return h;\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="vec2 pixelate( vec2 p, int pixels ) {\r\n    return floor( p * float( pixels ) );\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="float random( float n ) {\r\n    return ( fract( sin( n ) * RSEED3 ) );\r\n}\r\nfloat random( vec2 p ) {\r\n    return ( fract( sin( dot( p, vec2( RSEED1, RSEED2 ) ) ) * RSEED3 ) );\r\n}\r\n"},function(t,e,n){"use strict";n.r(e),e.default="vec2 vrandom( vec2 p ) {\r\n    p = vec2( \r\n        dot( p, vec2( VRSEED1, VRSEED2 ) ),\r\n        dot( p, vec2( VRSEED3, VRSEED4 ) )\r\n    );\r\n    return ( -1.0 + 2.0 * fract( sin ( p ) * VRSEED5 ) );\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="float noise( float n ) {\r\n    float fl = floor( n );\r\n    return( mix( random( fl ), random( fl + 1.0 ), fract( n ) ) );\r\n}\r\nfloat noise ( vec2 p ) {\r\n    vec2 fl = floor( p );\r\n    vec2 fr = fract( p );\r\n    float a = random( fl );\r\n    float b = random( fl + vec2( 1.0, 0.0 ) );\r\n    float c = random( fl + vec2( 0.0, 1.0 ) );\r\n    float d = random( fl + vec2( 1.0, 1.0 ) );\r\n    vec2 sm = fr * fr * ( 3.0 - 2.0 * fr );\r\n    return ( \r\n        mix( a, b, sm.x ) + \r\n        ( c -a ) * sm.y * \r\n        ( 1.0 - sm.x ) + \r\n        ( d - b ) * sm.x * sm.y\r\n    );\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="float gnoise( vec2 p ) {\r\n    vec2 fl = floor( p );\r\n    vec2 fr = fract( p );\r\n    vec2 sm = fr * fr * ( 3.0 - 2.0 * fr );\r\n    return ( mix( \r\n            mix( \r\n                dot( vrandom( fl ), fr ), \r\n                dot( vrandom( fl + vec2( 1.0, 0.0 ) ), fr - vec2( 1.0, 0.0 ) ), sm.x\r\n            ),\r\n            mix( \r\n                dot( vrandom( fl + vec2( 0.0, 1.0 ) ), fr - vec2( 0.0, 1.0 ) ), \r\n                dot( vrandom( fl + vec2( 1.0, 1.0 ) ), fr - vec2( 1.0, 1.0 ) ), sm.x\r\n            ),\r\n            sm.y\r\n        )\r\n    );\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="float snoise( vec2 v ) {\r\n    vec4 C = vec4(\r\n        0.211324865405187,\r\n        0.366025403784439,\r\n        -0.577350269189626,\r\n        0.024390243902439\r\n    );\r\n    vec2 i  = floor( v + dot( v, C.yy ) );\r\n    vec2 x0 = v - i + dot( i, C.xx );\r\n    vec2 i1 = vec2( 0.0 );\r\n    i1 = ( x0.x > x0.y ) ? vec2( 1.0, 0.0 ) : vec2( 0.0, 1.0 );\r\n    vec2 x1 = x0.xy + C.xx - i1;\r\n    vec2 x2 = x0.xy + C.zz;\r\n    i = mod289( i );\r\n    vec3 p = permute(\r\n        permute( i.y + vec3( 0.0, i1.y, 1.0 ) ) + i.x + vec3( 0.0, i1.x, 1.0 )\r\n    );\r\n    vec3 m = max( \r\n        0.5 - vec3(\r\n            dot( x0, x0 ),\r\n            dot( x1, x1 ),\r\n            dot( x2, x2 )\r\n        ),\r\n    0.0);\r\n    m = m * m ;\r\n    m = m * m ;\r\n    vec3 x = 2.0 * fract( p * C.www ) - 1.0;\r\n    vec3 h = abs( x ) - 0.5;\r\n    vec3 ox = floor( x + 0.5 );\r\n    vec3 a0 = x - ox;\r\n    m *= 1.79284291400159 - 0.85373472095314 * ( a0 * a0 + h * h );\r\n    vec3 g = vec3( 0.0 );\r\n    g.x  = a0.x  * x0.x  + h.x  * x0.y;\r\n    g.yz = a0.yz * vec2( x1.x, x2.x ) + h.yz * vec2( x1.y, x2.y );\r\n    return ( 130.0 * dot( m, g ) );\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="float fbm ( vec2 p ) {\r\n    float v = 0.0;\r\n    float AMP = 0.5;\r\n    float MULT = 2.0;\r\n    float AMP_MULT = 0.5;\r\n    const int OCTAVES = 3;\r\n    for ( int i = 0; i < OCTAVES; ++i ) {\r\n        v += AMP * NOISE( p );\r\n        AMP *= AMP_MULT;\r\n        p *= MULT;\r\n    }\r\n    return v;\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="float abs_fbm ( vec2 p ) {\r\n    float v = 0.0;\r\n    float AMP = 0.5;\r\n    float LACUNARITY = 2.0;\r\n    float GAIN = 0.5;\r\n    const int OCTAVES = 3;\r\n    for ( int i = 0; i < OCTAVES; ++i ) {\r\n        v += AMP * abs( NOISE( p ) );\r\n        AMP *= GAIN;\r\n        p *= LACUNARITY;\r\n    }\r\n    return v;\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="float rot_fbm_3 ( vec2 p, float a ) {\r\n    float v = 0.0;\r\n    vec2 s = vec2( 100.0 );\r\n    mat2 r = rotate2d( a );\r\n    v += 0.500000 * NOISE( p ); p = p * r * 2.0043 + s;\r\n    v += 0.250000 * NOISE( p ); p = p * r * 2.0310 + s;\r\n    v += 0.125000 * NOISE( p );\r\n    return v;\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="float rmf ( vec2 p ) {\r\n    float LACUNARITY = 2.0;\r\n    float GAIN = 0.5;\r\n    float OFFSET = 0.9;\r\n    float v = 0.0;\r\n    float f = 1.0;\r\n    float AMP = 0.5;\r\n    float prev = 1.0;\r\n    const int OCTAVES = 3;\r\n    for ( int i = 0; i < OCTAVES; ++i ) {\r\n        float n = ridge( snoise( p * f ), OFFSET );\r\n        v += ( n * AMP ) + ( n * AMP * prev );\r\n        prev = n;\r\n        f *= LACUNARITY;\r\n        AMP *= GAIN;\r\n    }\r\n    return v;\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="float aabb( vec2 pos, vec2 size, float blur ){\r\n    size = 0.5 - size * 0.5;\r\n    vec2 dim = smoothstep( size, size + blur, pos ) *\r\n               smoothstep( size - blur, size, 1.0 - pos - blur );\r\n    return dim.x * dim.y;\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="float cruciform( vec2 pos, float size, float armSize, float blur ) {\r\n  return aabb( pos, vec2( size, armSize ), blur ) +\r\n         aabb( pos, vec2( armSize, size ), blur );\r\n}"},function(t,e,n){"use strict";n.r(e),e.default="float circle( vec2 pos, float r, float blur ) {\r\n  return ( 1.0 - smoothstep( r - blur, r, dot( pos , pos ) * 4.0 ) );\r\n}"},function(t,e,n){var r={"./playground/pg.cameradrag.demo":46,"./playground/pg.draw.demo":47,"./playground/pg.packing.demo":48,"./playground/pg.play.demo":49,"./playground/pg.un.demo":50,"./playground/pg.watershader.demo":51,"./solid/1.0.sprite.demo":52,"./solid/1.1.graphic2d.demo":53,"./solid/1.10.text.demo":54,"./solid/1.11.geom.demo":55,"./solid/1.2.container2d.demo":56,"./solid/1.3.bitmap-text.demo":57,"./solid/1.4.stage2d.demo":58,"./solid/1.5.stadium.demo":59,"./solid/1.6.canvas-manager.demo":60,"./solid/1.7.camera2d.demo":61,"./solid/1.8.basic-setup.demo":62,"./solid/1.9.tilesprite.demo":63,"./solid/2.0.collision-aabb2d.demo":64,"./solid/2.1.collision-circle.demo":65,"./solid/2.2.collision-polygon2d.demo":66,"./solid/2.3.collision-aabb2d-line2d.demo":67,"./solid/2.4.collision-line2d-circle.demo":68,"./solid/3.0.create-texture.demo":69,"./solid/3.1.animation.demo":70,"./solid/4.0.quadtree.demo":71,"./solid/4.1.ray-casting.demo":72,"./solid/4.2.particle-system.demo":73,"./solid/4.3.motion.demo":74,"./solid/4.4.1.color.demo":75,"./solid/4.4.utilities.demo":76,"./solid/4.5.interaction.demo":77,"./solid/4.6.spritesheet.demo":78,"./solid/4.7.culler.demo":79,"./solid/4.8.tilemap.demo":80,"./solid/5.0.webgl-animation.demo":81,"./solid/5.1.webgl-circle.demo":82,"./solid/5.2.webgl-rectangle.demo":83,"./solid/5.3.webgl-line2d.demo":84,"./solid/5.4.webgl-pixelbatch.demo":85,"./solid/5.5.webgl-texture2dbatch.demo":86,"./solid/5.6.webgl-bitmap-text.demo":87,"./solid/5.6.webgl-tilesprite.demo":88,"./solid/6.0.stresstest.demo":89,"./solid/6.1.webgl-stresstest.demo":90,"./solid/6.2.webgl-rendertexture.demo":91};function i(t){var e=o(t);return n(e)}function o(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}i.keys=function(){return Object.keys(r)},i.resolve=o,t.exports=i,i.id=45},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("PGCAMERADRAG",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s={canvas:a,halt:!0},u=t.stage=new i.Stage2D(s),l=new i.Camera2D(new i.Vector2D(r,o),{position:new i.Vector2D(0,0)}),c=new i.VisualContainer2D(0,0),h=new i.Sprite(0,0),f=new i.Vector2D(0,0),d=new i.Vector2D(0,0),p=!1;u.AddChild(l).AddChild(c).AddChild(h),u.ticker.StartAF(),u.mouse.onDown.Add(function(t){p=!0,f.SetV(t.data.position),d.SetV(l.position)}),u.mouse.onUp.Add(function(){p=!1}),u.mouse.onMove.Add(function(t){p&&l.position.SetV(t.data.position).AddV(d).SubtractV(f)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("PGDRAW",function(t){var e=window.innerWidth,n=window.innerHeight,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!0},a=t.stage=new i.Stage2D(o);a.PreRender(a.rc);var s=new i.Draw({rc:a.rc,fill:!0,stroke:!0,startAngle:0,anticlockwise:!1,radiusX:100,radiusY:50,endAngle:Math.PI}),u=new i.Geom.AABB2D(350,350,450,450),l={tl:u.tl,br:u.br},c={x:350,y:350,w:100,h:100},h={x:350,y:150,w:100,h:100,radius:50},f=new i.Geom.Circle(400,320,50),d={center:f.center,radius:f.radius},p=new i.Geom.Line2D(400,100,400,500),y={s:p.s,e:p.e,fill:!1},v=new i.Geom.Polygon2D,m={points:v.vertices,close:!0},b={center:new i.Vector2D(400,500),radius:100,close:!0},g={center:new i.Vector2D(400,500)},w={center:new i.Vector2D(400,100),close:!0},A={s:new i.Vector2D(400,500),c1:new i.Vector2D(0,200),e:new i.Vector2D(400,100),radius:196,fill:!1},S={s:new i.Vector2D(400,500),c1:new i.Vector2D(0,200),c2:new i.Vector2D(0,100),e:new i.Vector2D(400,100),radius:200,fill:!1},C={points:[{x:350,y:0},{x:450,y:100},{x:350,y:200},{x:450,y:300},{x:350,y:400},{x:450,y:500},{x:350,y:600},{x:450,y:700}],fill:!1};i.Geom.PolygonConstruction.Rose2D(v,400,500,200,100,300,10),a.mouse.onDown.Add(function(){s.Rectangle(c).RoundRectangle(h).AABB(l).Circle(d).Line(y).LineChain(m).Ellipse(g).EllipticArc(w).Arc(b).Curve(A).BezierCurve(S).QuadraticCurve(S).LineChain(C),a.rc.translate(800,0),a.rc.scale(-1,1),s.Curve(A).BezierCurve(S).QuadraticCurve(S)}),a.mouse.onUp.Add(function(){a.PreRender(a.rc)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("PGPACKING",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";for(var s={canvas:a,halt:!0},u=t.stage=new i.Stage2D(s),l=new i.Camera2D(new i.Vector2D(r,o),{position:new i.Vector2D(0,0)}),c=new i.VisualContainer2D(0,0),h=new i.Vector2D(0,0),f=new i.Vector2D(0,0),d=!1,p=15,y=[];p--;){var v=new i.Sprite(0,0);v.w=100+100*Math.random()|0,v.h=100+10*Math.random()|0,y.push(v)}y.sort(function(t,e){return e.w-t.w}),(new i.Packing.RectanglePacker).SetPadding(10,10).PackDynamic(y).forEach(function(t,e){t&&y[e].position.SetV(t.tl)}),u.AddChild(l).AddChild(c).AddChildren(y),u.ticker.StartAF(),u.mouse.onDown.Add(function(t){d=!0,h.SetV(t.data.position),f.SetV(l.position)}),u.mouse.onUp.Add(function(){d=!1}),u.mouse.onMove.Add(function(t){d&&l.position.SetV(t.data.position).AddV(f).SubtractV(h)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("PLAYTEST",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!0},r=t.stage=new i.Stage2D(n),o=new i.Camera2D(new i.Vector2D(300,200),{position:new i.Vector2D(0,0)}),a=new i.VisualContainer2D(0,0),s=new i.Sprite(300,200);s.width*=2;var u=new i.Vector2D(0,0),l=new i.Vector2D(0,0),c=!1,h=new i.Draw({rc:r.rc,fill:!0,identity:!0});new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(a).Trigger(),s.anchor.SetSame(.5),s.UpdateTextureTransform(),r.AddChild(o).AddChild(a).AddChild(s),r.ticker.StartAF();var f=i.Input.Key,d=r.keyboard;d.NoProcessCapture(f.SHIFT,f.A,f.S),d.Capture(f.G,f.B);var p=d.GetKey(f.A),y=d.GetKey(f.S),v=d.GetKey(f.SHIFT),m=d.GetKey(f.G),b=d.GetKey(f.B),g=!0;d.onDown.Add(function(){g&&3===m.repetitions&&(g=!1,m.Reset(),console.log("Unlocked"))}),r.onProcess.Add(function(){d.Process();var t=s.ComputeGlobalBounds(s.anchor);h.AABB({tl:t.tl,br:t.br}),v.isDown&&!g&&(p.isDown?s.rotation-=10*i.Math.RADIAN:y.isDown&&(s.rotation+=10*i.Math.RADIAN)),!g&&b.duration>=30&&(g=!0,b.Reset(),console.log("Locked"),d.ReleaseAll(),console.log("Throwing away key"))}),r.mouse.onDown.Add(function(t){c=!0,u.SetV(t.data.position),l.SetV(o.position)}),r.mouse.onUp.Add(function(){c=!1}),r.mouse.onMove.Add(function(t){c&&o.position.SetV(t.data.position).AddV(l).SubtractV(u)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("PGUNDEMO",function(t){var e=600,n=400,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"WebGL"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(300,200);a.gl.clearColor(.9,.9,.9,1),u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();for(var c=new i.Controller.ProgramController.GLUnProgramController(a.gl,i.Shader.UN),h=1;h--;){var f=new i.GLEntity2D(0,0,c);f.transformAutomaticUpdate=!0,f.transformShouldUpdate=!0;f.w=f.h=384,f.w=e,f.h=n,f.timeInc=.05/12,f.ComputeLocalBounds({x:.5,y:.5}),f.position.Set(i.Utility.RandomInteger(-300,300),i.Utility.RandomInteger(-200,200)),f.position.Set(300,200),s.AddChild(f)}a.onProcess.Add(function(){u.Process()}),a.mouse.onDown.Add(function(t){u.target.position.SetV(l.GlobalToLocalPoint(t.data.position))})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("PGWATERSHADER",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"WebGL2"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540),c=new i.Controller.ProgramController.GLTexture2DProgramController(a.gl);c.BindBasicTexture(window.testData.imgloader.GetBasicTextureById("watertest"));var h=new i.Controller.ProgramController.GLRendertextureProgramController(a.gl,i.Shader.WT);h.Config(e,n,a.gl.LINEAR,0,0,e,n);var f=new i.Sprite(-960,-540,c);f.width=e,f.height=864,f.UpdateTextureTransform(),a.gl.clearColor(.3,.3,.3,1);var d=new i.TextureEntity2D(0,n,new i.Texture.BasicTexture2D(null,"noid",e,n,e,n)),p=new i.TextureEntity2D(0,864,new i.Texture.BasicTexture2D(null,"noid",e,n,e,n));d.scale.y=-1,p.textureTransformation.ApplyTranslation(0,.2),s.GLPreRender=function(t){a.SetFramebuffer(t,h)},s.GLPostRender=function(){a.SetFramebuffer(),d.UpdateTransform(s),p.UpdateTransform(s),h.Execute(d.transform.globalTransform.AsArray(!0),d.textureTranslation.AsArray(!0),d.textureTransformation.AsArray(!0)),h.Execute(p.transform.globalTransform.AsArray(!0),p.textureTranslation.AsArray(!0),p.textureTransformation.AsArray(!0))},u.force.SetSame(.5),a.AddChild(s).AddChild(u).Mount(l),l.Mount(f),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger()})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("Sprite",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new i.Sprite(r,o),u=new i.Graphic2D(r,o,new i.Path.Line2D(-r,0,r,0)),l=new i.Graphic2D(r,o,new i.Path.Line2D(0,-o,0,o));s.anchor.SetSame(.5),s.UpdateTextureTransform();var c=a.getContext("2d");s.Render(c),u.Render(c),l.Render(c)})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("Graphic2D",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new i.Path.Circle(0,0,50);new i.Graphic2D(r,o,s).Render(a.getContext("2d"))})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("Text",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute",a.style.backgroundColor="white";var s=a.getContext("2d"),u=new i.Text(r,o,window.testData.lorem);u.style.text.align=i.Style.TextConf.ALIGN_CENTER,u.style.text.baseline=i.Style.TextConf.BASELINE_MIDDLE,u.style.text.lineWidth=.3,u.style.text.font="40px Arial",u.Render(s)})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("Geom",function(t){var e=window.innerWidth,n=window.innerHeight,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o=r.getContext("2d"),a=new i.Path.Circle(0,0,50),s=new i.Path.AABB2D(0,0,100,100),u=new i.Path.Polygon2D,l=new i.Path.Line2D(0,0,100,100),c=new i.Path.Polygon2D,h=new i.Path.Polygon2D;i.Geom.PolygonConstruction.Butterfly2D(u.shape,0,0,1e3,50),i.Geom.PolygonConstruction.Star2D(c.shape,0,0,100,50,5),i.Geom.PolygonConstruction.Rose2D(h.shape,0,0,100,7/9,1e3,9);var f=new i.Graphic2D(100,100,a),d=new i.Graphic2D(200,100,s),p=new i.Graphic2D(350,100,l),y=new i.Graphic2D(600,200,u),v=new i.Graphic2D(100,300,c),m=new i.Graphic2D(400,400,h);f.Render(o),d.Render(o),p.Render(o),y.Render(o),v.Render(o),m.Render(o)})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("VisualContainer2D",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new i.Sprite(r,o);s.anchor.SetSame(.5),s.UpdateTextureTransform();var u=new i.VisualContainer2D(0,0);u.AddChild(s),u.Render(a.getContext("2d"))})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("BitmapText",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute",a.style.backgroundColor="white";var s=a.getContext("2d"),u=new i.BitmapText(0,0,window.testData.imgloader.GetBasicTextureById("fontNoK"),window.testData.xhrloader.GetDataById("fontNoK"),window.testData.lorem);u.scale.SetSame(.6),u.x=r-.5*u.width,u.y=o-.5*u.height,u.Render(s)})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("Stage2D",function(t){var e=window.innerWidth,n=window.innerHeight,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!0},a=t.stage=new i.Stage2D(o);a.ticker.StartAF(),a.onProcess.Add(function(){console.log("tick"),a.onProcess.Dump()})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("Stadium",function(t){var e={className:"mcnvs",width:600,height:400,mode:"2d",fill:!1},n=t.stadium=new i.Stadium(e);function r(){this.children.forEach(o)}function o(t){t.position.AddV(t.data.velocity),t.data.velocity.Rotate(t.data.torque)}n.CreateStage2D("stage1"),n.CreateStage2D("stage2"),n.CreateStage2D("stage3"),n.CreateStage2D("stage4"),n.GetStages("stage1","stage2","stage3").forEach(function(t){for(var e=10;e--;){var n=t.AddChild(new i.Graphic2D(i.Utility.RandomFloat(100,500),i.Utility.RandomFloat(50,350),new i.Path.Circle(0,0,i.Utility.RandomInteger(10,50))));n.data.velocity=new i.Vector2D(i.Utility.RandomFloat(-1,1),i.Utility.RandomFloat(-1,1)),n.data.torque=i.Utility.RandomFloat(-i.Math.RADIAN,i.Math.RADIAN)}t.onProcess.Add(r,t)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("CanvasManager",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",1920),e.setAttribute("height",1080),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0);(t.canvasManager=new i.CanvasManager(e,1920,1080,i.CanvasManager.KEEP_ASPECT_RATIO_FIT)).BindStage(r).BindRootContainer(o).Trigger()})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("Camera2D",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s={canvas:a,halt:!0},u=t.stage=new i.Stage2D(s),l=new i.Camera2D(new i.Vector2D(r,o),{position:new i.Vector2D(0,0)}),c=new i.VisualContainer2D(0,0),h=new i.Sprite(0,0);u.AddChild(l).AddChild(c).AddChild(h),u.ticker.StartAF(),u.onProcess.Add(function(){l.Process()}),u.mouse.SetCoordinateTranslationEntity(l),u.mouse.onDown.Add(function(t){l.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("BasicSetup",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200),u=new i.Sprite(0,0);a.force.SetSame(5),u.anchor.SetSame(.5),u.UpdateTextureTransform(),r.AddChild(o).AddChild(a).AddChild(s).AddChild(u),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger(),r.onProcess.Add(function(){a.Process()}),r.mouse.SetCoordinateTranslationEntity(s),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("Tilesprite",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=a.getContext("2d"),u=new i.Tilesprite(r,o,i.Tilesprite.DEFAULT_TEXTURE);u.GeneratePattern(s,640,640),u.x=r-.5*u.width,u.y=o-.5*u.height,u.Render(s)})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("CollisionAABB2D",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();var c=new i.Vector2D(0,0),h=new i.Vector2D(0,0),f=null,d=new i.Collision.Body2D(new i.Geom.AABB2D(0,0,50,200)),p=new i.Collision.Body2D(new i.Geom.AABB2D(0,0,100,200)),y=new i.Graphic2D(100,0,(new i.Path.AABB2D).SetShape(d.shape.Copy())),v=new i.Graphic2D(0,100,(new i.Path.AABB2D).SetShape(p.shape.Copy()));d.SetRelative(y.position),p.SetRelative(v.position);var m=i.Collision.AABB2DvsAABB2D.Collide,b=i.Collision.AABB2DvsAABB2D.SeparatingResponse,g=new i.Collision.AABB2DvsAABB2D.Result;l.Mount(y,v),a.onProcess.Add(function(){u.Process()}),a.mouse.SetCoordinateTranslationEntity(l),a.mouse.onDown.Add(function(t){for(var e=l.children.length,n=t.data.position;e--;)if(l.children[e].IntersectsPoint2D(n)){c.SetV(n),f=l.children[e],h.SetV(f.position),t.stopPropagation=!0,f.SendToFront();break}f||u.target.position.SetV(n)}),a.mouse.onMove.Add(function(t){if(f){var e=t.data.position;f.position.SetV(e).AddV(h).SubtractV(c),d.SetPositionV(y),p.SetPositionV(v),g.Reset(),m(d,p,g),g.occured&&b(d,p,g)}},a),a.mouse.onUp.Add(function(){f&&(f=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("CollisionCircle",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();var c=new i.Vector2D(0,0),h=new i.Vector2D(0,0),f=null,d=new i.Collision.Body2D(new i.Geom.Circle(0,0,25)),p=new i.Collision.Body2D(new i.Geom.Circle(0,0,50)),y=new i.Graphic2D(100,0,(new i.Path.Circle).SetShape(d.shape.Copy())),v=new i.Graphic2D(0,100,(new i.Path.Circle).SetShape(p.shape.Copy()));d.SetRelative(y.position).SetVelocity(10,10).SetMass(30),p.SetRelative(v.position).SetVelocity(10,10).SetMass(20);var m=i.Collision.CirclevsCircle.Collide,b=i.Collision.CirclevsCircle.ElasticResponse,g=new i.Collision.CirclevsCircle.Result;l.Mount(y,v),a.onProcess.Add(function(){u.Process()}),a.mouse.SetCoordinateTranslationEntity(l),a.mouse.onDown.Add(function(t){for(var e=l.children.length,n=t.data.position;e--;)if(l.children[e].IntersectsPoint2D(n)){c.SetV(n),f=l.children[e],h.SetV(f.position),t.stopPropagation=!0,f.SendToFront();break}f||u.target.position.SetV(n)}),a.mouse.onMove.Add(function(t){if(f){var e=t.data.position;f.position.SetV(e).AddV(h).SubtractV(c),d.SetPositionV(y),p.SetPositionV(v),g.Reset(),m(d,p,g),g.occured&&b(d,p,g)}},a),a.mouse.onUp.Add(function(){f&&(f=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("CollisionPolygon2D",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();var c=new i.Vector2D(0,0),h=new i.Vector2D(0,0),f=null,d=new i.Collision.Body2D(new i.Geom.Polygon2D),p=new i.Collision.Body2D(new i.Geom.Polygon2D);i.Geom.PolygonConstruction.Cyclic2D(d.shape,0,0,60,6),i.Geom.PolygonConstruction.Cyclic2D(p.shape,0,0,60,4);var y=new i.Graphic2D(0,0,(new i.Path.Polygon2D).SetShape(d.shape.Copy())),v=new i.Graphic2D(0,0,(new i.Path.Polygon2D).SetShape(p.shape.Copy()));d.SetRelative(y.position),p.SetRelative(v.position);var m=i.Collision.Polygon2DvsPolygon2D.Collide,b=new i.Collision.Polygon2DvsPolygon2D.Result;l.Mount(y,v),a.mouse.SetCoordinateTranslationEntity(l),a.onProcess.Add(function(){u.Process(),b.Reset(),m(d,p,b),b.occured&&(d.relative.SubtractV(b.mtv),p.relative.AddV(b.mtv))}),a.mouse.onDown.Add(function(t){for(var e=l.children.length,n=t.data.position;e--;)if(l.children[e].IntersectsPoint2D(n)){c.SetV(n),f=l.children[e],h.SetV(f.position),t.stopPropagation=!0,f.SendToFront();break}f||u.target.position.SetV(n)}),a.mouse.onMove.Add(function(t){if(f){var e=t.data.position;f.position.SetV(e).AddV(h).SubtractV(c)}},a),a.mouse.onUp.Add(function(){f&&(f=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("CollisionAABB2DLine2D",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();var c=new i.Vector2D(0,0),h=new i.Vector2D(0,0),f=null,d=new i.Collision.Body2D(new i.Geom.AABB2D(0,0,40,100)),p=new i.Collision.Body2D(new i.Geom.Line2D(0,0,100,100)),y=new i.Graphic2D(0,0,(new i.Path.AABB2D).SetShape(d.shape.Copy())),v=new i.Graphic2D(0,0,(new i.Path.Line2D).SetShape(p.shape.Copy())),m=i.Collision.AABB2DvsLine2D.Collide,b=new i.Collision.AABB2DvsLine2D.Result,g=new i.Graphic2D(0,0,new i.Path.Circle(0,0,10)),w=new i.Graphic2D(0,0,new i.Path.Circle(0,0,10)),A=new i.Graphic2D(0,0,new i.Path.Circle(0,0,10)),S=new i.Graphic2D(0,0,new i.Path.Circle(0,0,10));l.Mount(y,v,g,w,A,S),a.onProcess.Add(function(){u.Process()}),a.mouse.SetCoordinateTranslationEntity(l),a.mouse.onDown.Add(function(t){for(var e=l.children.length,n=t.data.position;e--;)if(l.children[e].IntersectsPoint2D(n)){c.SetV(n),f=l.children[e],h.SetV(f.position),t.stopPropagation=!0,f.SendToFront();break}f||u.target.position.SetV(n)}),a.mouse.onMove.Add(function(t){if(f){var e=t.data.position;f.position.SetV(e).AddV(h).SubtractV(c),d.SetPositionV(y),p.SetPositionV(v),m(d,p,b),b.top&&g.position.SetV(b.poc.a),b.right&&w.position.SetV(b.poc.b),b.bottom&&A.position.SetV(b.poc.c),b.left&&S.position.SetV(b.poc.d)}},a),a.mouse.onUp.Add(function(){f&&(f=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("CollisionLine2DCircle",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();var c=new i.Vector2D(0,0),h=new i.Vector2D(0,0),f=null,d=new i.Collision.Body2D(new i.Geom.Circle(0,0,50)),p=new i.Collision.Body2D(new i.Geom.Line2D(0,0,100,100)),y=new i.Graphic2D(0,0,(new i.Path.Circle).SetShape(d.shape.Copy())),v=new i.Graphic2D(0,0,(new i.Path.Line2D).SetShape(p.shape.Copy()));d.SetRelative(y.position);var m=i.Collision.CirclevsLine2D.Collide,b=i.Collision.CirclevsLine2D.ReflectingResponse,g=new i.Collision.CirclevsLine2D.Result;l.Mount(y,v),a.onProcess.Add(function(){u.Process()}),a.mouse.SetCoordinateTranslationEntity(l),a.mouse.onDown.Add(function(t){for(var e=l.children.length,n=t.data.position;e--;)if(l.children[e].IntersectsPoint2D(n)){c.SetV(n),f=l.children[e],h.SetV(f.position),t.stopPropagation=!0,f.SendToFront();break}f||u.target.position.SetV(n)}),a.mouse.onMove.Add(function(t){if(f){var e=t.data.position;f.position.SetV(e).AddV(h).SubtractV(c),d.SetPositionV(y),p.SetPositionV(v),g.Reset(),m(d,p,g),g.occured&&b(d,p,g)}},a),a.mouse.onUp.Add(function(){f&&(f=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("CreateTexture",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=new Image;s.onload=function(){var t=new i.Sprite(r,o,new i.Texture.BasicTexture2D(s));t.anchor.SetSame(.5),t.UpdateTextureTransform(),t.Render(a.getContext("2d"))},s.src=i.BrowserUtility.GenerateSimpleBase64PNG(function(){var t=new i.Path.Polygon2D;return i.Geom.PolygonConstruction.Supershape2D(t.shape,0,0,100,100,6,.3,.3,.3),new i.Graphic2D(Math.abs(t.shape.aabb.tl.x),Math.abs(t.shape.aabb.tl.y),t)},"white")})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("Animation",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.Sprite(0,0,window.testData.imgloader.GetBasicTextureById("1to8"));u.anchor.SetSame(.5),u.UpdateTextureTransform(),s.AddChild(u);var l=(u.animationController=new i.Animator.Controller(u)).CreateAnimation("play",25);u.width=64,u.height=64,l.GenerateFrames(64,64,512,64,8,{5:10,3:8,1:6}),l.reverse=!0,l.loop=!0,l.Start(),l.onEnd.Add(function(){console.log("end")}),r.onProcess.Add(function(){a.Process(),l.Process()}),r.mouse.SetCoordinateTranslationEntity(s),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("Quadtree",function(t){var e=window.innerWidth,n=window.innerHeight,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.Geom.AABB2D(0,0,e,n),u=new i.QuadtreeNode(s,0,4,5),l=[],c=[],h={},f=new i.Draw({rc:a.rc,fill:!0,stroke:!0,tl:null,br:null,globalAlpha:.2,identity:!0});a.onProcess.Add(function(){l.forEach(function(t){h.tl=t.aabb.tl,h.br=t.aabb.br,f.AABB(h)})}),a.mouse.onDown.Add(function(t){var e=new i.Graphic2D(t.data.position.x,t.data.position.y,new i.Path.AABB2D(0,0,10,10));e.ComputeLocalBounds(e.anchor),a.AddChild(e),c.push(e),u.Dump(),c.forEach(function(t){u.Add(t.bounds.local)}),console.log(u.Converge(s)),l.length=0,u.ConcatNodes(l)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("RayCasting",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();for(var c=[],h=[],f=25;f--;){var d=new i.Path.Polygon2D;i.Geom.PolygonConstruction.Cyclic2D(d.shape,i.Utility.RandomInteger(-e,e),i.Utility.RandomInteger(-n,n),i.Utility.RandomInteger(30,60),i.Utility.RandomInteger(3,8)),d.shape.Rotate(i.Utility.RandomFloat(0,i.Math.PII));var p=new i.Graphic2D(0,0,d);c.push(p)}for(var y=180,v=2*Math.PI/y;y--;){var m=v*y,b=new i.Path.Ray2D(0,0,0,0);b.style.stroke.lineWidth=1;var g=new i.Graphic2D(0,0,b);g.interactive=!1,g.data.angle=m,g.data.r=360,h.push(g)}l.Mount(c.concat(h));var w=new i.Vector2D(0,0);a.onProcess.Add(function(){u.Process(),h.forEach(function(t){var e=t.path.shape;e.s.SetV(a.mouse.position),e.e.SetV(e.s),e.e.Add(t.data.r,t.data.r),e.e.RotateAroundV(e.s,t.data.angle)});for(var t,e,n,r=0,o=0,s=0,l=0,f=h[r],d=h.length,p=c.length,y=0;r<d;f=h[++r])for(t=c[o=0];o<p;t=c[++o])for(s=0,l=(y=t.path.shape.vertices.length)-1;s<y;l=s++)e=t.path.shape.vertices[s],n=t.path.shape.vertices[l],i.Collision.Line2DvsLine2D.Line2DLine2DCollision(f.path.shape.s,f.path.shape.e,e,n,w)&&h[r].path.shape.e.SetV(w)}),a.mouse.SetCoordinateTranslationEntity(l),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("ParticleSystem",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"webgl2"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540),c=new i.Particle.P2D.System(0,0),h=new i.Time.Timer(10),f=new i.Geom.Polygon2D,d=window.testData.imgloader.GetBasicTextureById("colors"),p=window.testData.xhrloader.CloneDataById("particleExplosion"),y=window.testData.xhrloader.CloneDataById("particleFlare");i.Geom.PolygonConstruction.Cyclic2D(f,0,0,400,72);var v=f.Copy();v.vertices.forEach(function(t){t.Invert(),t.Multiply(.1,.1)}),h.onFinish.Add(function(){c.Emit(p),c.Emit(y),h.Start()}),h.Start();var m=new i.Controller.ProgramController.GLDynamicTexture2DProgramController(a.gl,2);if(m.BindBasicTexture(i.Sprite.DEFAULT_TEXTURE,0),m.BindBasicTexture(d,1),p.texture=m,p.unitId=0,p.position={points:f.vertices,moduloWrapper:f.vertices.length,indexGap:8},p.velocity={points:v.vertices,moduloWrapper:f.vertices.length,indexGap:4,scalar:{xy:{min:.1,max:1.9}}},p.oscillation={velocity:{x:{from:-20,to:20,amplitude:5}},torque:{from:-.5,to:.5,amplitude:.1}},y.texture=m,y.unitId=1,y.position={x:0,y:540},y.frames=i.Utility.GenerateSequence(0,16,1,1).map(function(t,e){return new i.Animator.Frame(64*e,0,64,64)}),!i.Particle.P2D.ValidateData(p)||!i.Particle.P2D.ValidateData(y))throw new Error("Invalid data");u.force.SetSame(.1),a.AddChild(s).AddChild(u).AddChild(l).AddChild(c),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger(),a.onProcess.Add(function(){u.Process(),c.Process(),h.Process()}),a.mouse.SetCoordinateTranslationEntity(l,a.glConvMatrix),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}e.default=function(){Object(r.a)("Motion",function(t){var e=function(t){function e(t,n,a){var l;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(l=function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?u(t):e}(this,s(e).call(this,0,0,new i.Path.Line2D(t.x,t.y,n.x,n.y)))).path.style.stroke.color=new i.Color(i.Utility.RandomInteger(l.w,200),i.Utility.RandomInteger(l.w,150),i.Utility.RandomInteger(0,20),1).value,l.path.style.stroke.lineWidth=l.w/12,a.AddChild(u(l)),l.x=i.Utility.RandomFloat(-c,c),l.y=i.Utility.RandomFloat(0,r),l.rotation=i.Utility.RandomInteger(0,i.Math.PII),l.rotation=i.Utility.FlipACoin(l.rotation,-l.rotation);var h=l.motionManager=new i.Motion.Manager(u(l)),f=h.Create("moveX","x",0,120,"SineInOut"),d=h.Create("moveY","y",0,120,"SineInOut"),p=h.Create("rotate","rotation",0,120,"SineInOut");return h.Start("moveX"),f.onEnd.Add(function(){p.Start()}),p.onEnd.Add(function(){d.Start()}),l.w>12&&l.Grow(),l}var n,h,f;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,i["Graphic2D"]),n=e,(h=[{key:"Grow",value:function(){var t=this.path.shape.e.SubtractVC(this.path.shape.s),n=t.Copy();t.Rotate(50*i.Math.RADIAN+i.Utility.RandomFloat(20*-i.Math.RADIAN,20*i.Math.RADIAN)),n.Rotate(50*-i.Math.RADIAN+i.Utility.RandomFloat(20*-i.Math.RADIAN,20*i.Math.RADIAN)),t.Multiply(.67,.67),n.Multiply(.67,.67),t.AddV(this.path.shape.e),n.AddV(this.path.shape.e),new e(this.path.shape.e,t,this.parent),new e(this.path.shape.e,n,this.parent)}}])&&a(n.prototype,h),f&&a(n,f),e}(),n=1920,r=1080,c=960,h=t.canvas=document.createElement("canvas");document.body.appendChild(h),h.setAttribute("width",n),h.setAttribute("height",r),h.style.display="initial",h.style.position="absolute";var f={canvas:h,halt:!1},d=t.stage=new i.Stage2D(f),p=new i.VisualContainer2D(0,0),y=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),v=new i.VisualContainer2D(c,r);v.scale.Set(1,-1),y.force.SetSame(5),d.AddChild(p).AddChild(y).AddChild(v),new i.CanvasManager(h,n,r,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(d).BindRootContainer(p).Trigger(),new e(new i.Vector2D(0,0),new i.Vector2D(0,300),v);var m=new i.Time.Timer(500);m.onFinish.Add(function(){d.ticker.Stop()}),m.Start(),d.onProcess.Add(function(){y.Process(),v.children.forEach(function(t){t.motionManager.Process()}),m.Process()}),d.mouse.SetCoordinateTranslationEntity(v),d.mouse.onDown.Add(function(t){y.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("Color",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200),u=i.BrowserUtility.ImageFromDataURL(i.BrowserUtility.GenerateSimpleBase64PNG(function(){for(var t=new i.Color(255,255,255,1),e=new i.VisualContainer2D(0,0),n=0;n<260;++n){var r=new i.Path.AABB2D(0,0,25,25);r.style.fill.color=new i.Color(n,0,0,1).Mix(t,.6).ComputeValueRGBA().value,r.style.stroke.color=new i.Color(0,255-n,0,1).Mix(t,.9).ComputeValueRGBA().value;var o=new i.Graphic2D(0,0,r);e.AddChild(o)}return i.Math.LikeASquareGrid(e.children,500,25,25),e.ClusterBind(),e},"white"),function(){s.AddChild(new i.Sprite(-300,-200,new i.Texture.BasicTexture2D(u,null,u.width,u.height)))});a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger(),r.onProcess.Add(function(){a.Process()}),r.mouse.SetCoordinateTranslationEntity(s),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}e.default=function(){Object(r.a)("Utilities",function(){var t=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mem1=e,this.mem2=n,this.mem3=null,this.mem4=null,this.deep={deeper:{deepest:0}}}var e,n,r;return e=t,(n=[{key:"Some",value:function(t){this.mem3=t,this.mem4=this.mem1+this.mem2}}])&&o(e.prototype,n),r&&o(e,r),t}(),e=new i.Maker;console.log(e.Many(15).Make(t,"@i(*|2)","@i(%|3)").Call(Math.random,null,"deep.deeper.deepest").Call("Some",["@i"]).Call(console.log,["$deep.deeper.deepest"]).Ship(!0)),console.log(e),i.Glob.Create("myGlob");var n=window.myGlob;n.Define(i.Glob.CONSTANT,"myConstant","someValue"),n.Define(i.Glob.FUNCTION,"myFunction",function(){}),n.Define(i.Glob.VALUE,"myValue","someValue");try{n.Mark(i.Glob.CONSTANT,"myConstant")}catch(t){console.error(t)}n.Mark(i.Glob.OBJECT,"myObject");try{n.Set(i.Glob.OBJECT,"myObject",0)}catch(t){console.error(t)}n.Set(i.Glob.OBJECT,"myObject",{}),console.log(n),window.myGlob=void 0,i.Assert.LOG=!0,i.Assert(0,i.Assert.IS_SAME_TYPE,1),i.Assert("myString",i.Assert.IS,"myString"),i.Assert(10,i.Assert.IS_GREATER_THAN,9);try{i.Assert(10,i.Assert.IS_LESS_THAN,9)}catch(t){console.error(t)}try{i.Assert([],i.Assert.IS_SAME_TYPE,Object)}catch(t){console.error(t)}i.Assert([],i.Assert.IS_INSTANCE_OF,Object);var r=new i.CP.Registry;i.CP.Command.OPTION_PREFIX="--",r.AddCommand(new i.CP.Command("myCommand mycmd",function(t,e,n){console.log(t,e,n,"prime")},"some info about this command",!0,!0).AddOption("anOption anopt",function(t,e,n){console.log(t,e,n,"priorty 0")},"some info about this option",0,!1).AddOption("op2",function(){console.log("op2 called.","priorty 99")},"brrrr",99,!1)),console.log(r),r.Parse('myCommand --anopt someData=myData someString --op2 (JSON)myJsonData={"someJsonData":"value"}',{someStatic:"data"}),null!=r.Parse("what?")&&console.error("Unknown command");var a=r.Parse("hmmm...");a&&console.error(a,"- is not a recognized command");var s=new i.Event.Dispatcher;s.Once(function(t){console.log(t.target,t.data)}),s.Dispatch("istarget",{myEventData:"something"});var u=[],l=[];i.ArrayHandler.Add("a1",u).Add("a2",l);var c={};c.arrayHandler=new i.ArrayHandler(c),console.log(c),c.arrayHandler.In("a1").In("a2"),console.log(u,l),c.arrayHandler.Out("a1").In("a1").OutAll(),console.log(u,l);var h=new i.FlagEnum;h.Add("red").Add("green").Add("blue");var f=new i.FlagList;console.log(h),f.Add(h.GREEN|h.BLUE),console.log(f.Holds(h.RED)),console.log(f.Holds(h.GREEN)),console.log(f.Holds(h.BLUE));for(var d=[],p=0;p<30;++p)d.push(i.Math.IntegerNotation(p,10,"."));console.log(d),console.log(i.Utility.UUID(16,1,1))})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("Interaction",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute",e.style.top="50%",e.style.transform="translateY(-50%)";var n={canvas:e,halt:!1,mode:"2d"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200),u=new i.Graphic2D(-100,-100,new i.Path.Circle(0,0,50)),l=new i.Graphic2D(100,100,new i.Path.Line2D(-100,0,100,0)),c=new i.Graphic2D(-100,100,new i.Path.Polygon2D),h=new i.Graphic2D(0,0,new i.Path.AABB2D(0,0,100,100)),f=new i.Vector2D(0,0),d=new i.Vector2D(0,0),p=null;i.Geom.PolygonConstruction.Cyclic2D(c.path.shape,0,0,50,5),l.path.shape.Rotate(23/180*Math.PI),a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s).AddChildren(u,l,h,c),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger(),r.onProcess.Add(function(){a.Process()}),s.rotation=2,r.mouse.SetCoordinateTranslationEntity(s),r.mouse.onDown.Add(function(t){for(var e=s.children.length,n=t.data.position;e--;)if(s.children[e].IntersectsPoint2D(n)){f.SetV(n),p=s.children[e],d.SetV(p.position),t.stopPropagation=!0,p.SendToFront();break}p||a.target.position.SetV(n)}),r.mouse.onMove.Add(function(t){if(p){var e=t.data.position;p.position.SetV(e).AddV(d).SubtractV(f)}},r),r.mouse.onUp.Add(function(){p&&(p=null)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("Spritesheet",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,backgroundColor:"white"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200),u=new i.Sprite(0,0,window.testData.invadersSpritesheet.basicTexture),l=new i.Sprite(0,50,window.testData.invadersSpritesheet.basicTexture);window.testData.invadersSpritesheet.GetFrameById("Ship").FullApply(u),window.testData.invadersSpritesheet.GetFrameById("Explo-f1").FullApply(l),l.CreateAnimation({spritesheet:window.testData.invadersSpritesheet,id:"explode",frames:[{id:"Explo-f1",duration:20},{id:"Explo-f2",duration:10},{id:"Explo-f3",duration:20},{id:"Explo-f4",duration:10}],loop:!0,reverse:!1}),l.PlayAnimation("explode"),l.anchor.SetSame(.5),l.UpdateTextureTransform(),l.scale.SetSame(5),a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s).AddChildren(u,l),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger(),r.onProcess.Add(function(){a.Process(),l.animationController.Process()}),r.mouse.SetCoordinateTranslationEntity(s),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("Culler",function(t){var e=600,n=400,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"webgl2"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(300,200),c=new i.Culler2D(0,0,e,n);c.conversionMatrix=a.glConvMatrix;var h=new i.Vector2D(0,0),f=new i.Vector2D(0,0),d=!1,p=new i.Controller.ProgramController.GLTexture2DProgramController(a.gl);p.BindBasicTexture(i.Sprite.DEFAULT_TEXTURE);var y=new i.Sprite(0,0,p);y.anchor.SetSame(.5),y.UpdateTextureTransform(),c.BindContainer(l),c.onIn.Add(function(t){t.target.display=!0,console.log("in")}),c.onOut.Add(function(t){t.target.display=!1,console.log("out")}),u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l).AddChildren(y),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).BindCuller(c).Trigger(),a.onProcess.Add(function(){c.Process()}),a.mouse.onDown.Add(function(t){d=!0,h.SetV(t.data.position),f.SetV(u.position)}),a.mouse.onUp.Add(function(){d=!1}),a.mouse.onMove.Add(function(t){d&&u.position.SetV(t.data.position).AddV(f).SubtractV(h)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("Tilemap",function(t){var e=600,n=400,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"webgl2",antialias:!1},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(300,200),c=new i.Vector2D(0,0),h=new i.Vector2D(0,0),f=!1,d=new i.Controller.ProgramController.GLTexture2DProgramController(a.gl);d.BindBasicTexture(window.testData.tileset.basicTexture,a.gl.LINEAR);var p=new i.Culler2D(0,0,e,n).SetConversionMatrix(a.glConvMatrix);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).BindCuller(p).Trigger(),window.testData.tileset.pc=d;var y=new i.Tilemap(-300,-200,window.testData.tileset,0);y.Cull(p),y.scale.SetSame(1),l.AddChild(y),a.mouse.onDown.Add(function(t){f=!0,c.SetV(t.data.position),h.SetV(u.position)}),a.mouse.onUp.Add(function(){f=!1}),a.mouse.onMove.Add(function(t){f&&u.position.SetV(t.data.position).AddV(h).SubtractV(c)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("WebGLAnimation",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,mode:"WebGL2",antialias:!0},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);a.force.SetSame(5),a.SetMax(100,100),a.SetMin(-100,-100),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.Controller.ProgramController.GLDynamicTexture2DProgramController(r.gl,3);u.BindBasicTexture(i.Sprite.DEFAULT_TEXTURE,0),u.BindBasicTexture(window.testData.imgloader.GetBasicTextureById("1to8"),1),u.BindBasicTexture(window.testData.characterSheet.basicTexture,2,r.gl.NEAREST);var l=new i.Sprite(0,0,u,1),c=new i.Sprite(0,0,u,0),h=new i.Sprite(0,0,u,2);h.CreateAnimation({spritesheet:window.testData.characterSheet,frames:["1","2","3","4","5","6","7","8","9"],loop:!0,overrideFrameTimer:!0,frameDuration:7,id:"run",dynamicSize:!0}),h.anchor.SetSame(.5),h.UpdateTextureTransform(),l.anchor.SetSame(.5),c.anchor.SetSame(.5),c.UpdateTextureTransform(),c.alpha=.5,s.AddChildren(l,c,h);var f=(l.animationController=new i.Animator.Controller(l)).CreateAnimation("play",25);l.width=64,l.height=64,h.PlayAnimation("run"),h.scale.SetSame(3),f.GenerateFrames(64,64,512,64,8,{5:10,3:8,1:6}),f.loop=!0,f.Start(),r.onProcess.Add(function(){a.Process(),f.Process(),h.animationController.Process()}),r.mouse.SetCoordinateTranslationEntity(s,r.glConvMatrix),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("WebGLCircle",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"WebGL"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();for(var c=new i.Controller.ProgramController.GLCircleProgramController(a.gl),h=1e3;h--;){var f=new i.Path.Circle(0,0,50);f.style.stroke.lineWidth=1,f.LinkProgramController(c);var d=new i.Graphic2D(i.Utility.RandomInteger(-960,960),i.Utility.RandomInteger(-540,540),f);l.Mount(d)}a.onProcess.Add(function(){u.Process()}),a.mouse.SetCoordinateTranslationEntity(l,a.glConvMatrix),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("WebGLRectangle",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.Controller.ProgramController.GLRectangleProgramController(r.gl),l=new i.Path.AABB2D(-100,-100,100,100);l.style.stroke.lineWidth=1,l.LinkProgramController(u);var c=new i.Graphic2D(0,0,l);s.Mount(c),r.onProcess.Add(function(){a.Process(),c.rotation+=i.Math.RADIAN}),r.mouse.SetCoordinateTranslationEntity(s,r.glConvMatrix),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("WebGLLine2D",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.Controller.ProgramController.GLLine2DProgramController(r.gl),l=new i.Path.Line2D(-100,-100,100,100);l.style.stroke.lineWidth=1,l.LinkProgramController(u);var c=new i.Graphic2D(0,0,l);s.Mount(c),r.onProcess.Add(function(){a.Process(),c.rotation+=i.Math.RADIAN}),r.mouse.SetCoordinateTranslationEntity(s,r.glConvMatrix),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("WebGLPixelBatch",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.BatchableContainer2D(0,0),l=new i.Controller.ProgramController.GLPixelBatchProgramController(r.gl);s.AddChild(u),u.UseAsBatchParent(l);for(var c=1e4;c--;){var h=new i.Path.Pixel(0,0);h.color.r=.2,h.color.g=Math.random(),h.color.b=.8,h.color.a=i.Utility.RandomFloat(.1,.6),h.style.pixel.size=i.Utility.RandomFloat(1,5);var f=new i.Graphic2D(0,0,h);f.data.velocity=new i.Vector2D(i.Utility.RandomFloat(-2,2),i.Utility.RandomFloat(-2,2)),f.data.torque=i.Utility.RandomFloat(20*-i.Math.RADIAN,20*i.Math.RADIAN),u.Mount(f),f.UpdateTransform(f.parent)}u.ComputeBatchBuffer(),r.onProcess.Add(function(){var t;a.Process();for(var e=0;e<u.children.length;++e)(t=u.children[e]).data.velocity.Rotate(t.data.torque),t.position.AddV(t.data.velocity),t.UpdateInBuffer()}),r.mouse.SetCoordinateTranslationEntity(s,r.glConvMatrix),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("WebGLTexture2DBatch",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200),u=new i.Sprite(0,0);a.force.SetSame(5),u.anchor.SetSame(.5),u.UpdateTextureTransform(),r.AddChild(o).AddChild(a).AddChild(s).AddChild(u),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var l=new i.BatchableContainer2D(0,0),c=new i.Controller.ProgramController.GLTexture2DBatchProgramController(r.gl);c.BindBasicTexture(window.testData.imgloader.GetBasicTextureById("colors")),s.AddChild(l),l.UseAsBatchParent(c);for(var h=2e4;h--;){var f=new i.Sprite(0,0,c.originalTexture);f.w=64,f.h=64,f.scale.SetSame(.05),f.anchor.SetSame(.5),f.animationController=new i.Animator.Controller(f);var d=f.animationController.CreateAnimation("animation",60);d.GenerateFrames(64,64,1024,64,16),d.SetFrame(i.Utility.RandomInteger(0,15)),f.data.velocity=new i.Vector2D(i.Utility.RandomFloatAvoid(-2,2,-1.9,1.9),i.Utility.RandomFloatAvoid(-2,2,-1.9,1.9));var p=20*i.Math.RADIAN;f.data.torque=i.Utility.RandomFloatAvoid(-p,p,-p/25,p/25),l.Mount(f),f.UpdateTransform(f.parent)}l.ComputeBatchBuffer(),r.onProcess.Add(function(){var t;a.Process();for(var e=0;e<l.children.length;++e)(t=l.children[e]).data.velocity.Rotate(t.data.torque),t.position.AddV(t.data.velocity),t.UpdateInBuffer()}),r.mouse.SetCoordinateTranslationEntity(s,r.glConvMatrix),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("WebGLBitmapText",function(t){var e=t.canvas=document.createElement("canvas");document.body.appendChild(e),e.setAttribute("width",600),e.setAttribute("height",400),e.style.display="initial",e.style.position="absolute";var n={canvas:e,halt:!1,mode:"WebGL"},r=t.stage=new i.Stage2D(n),o=new i.VisualContainer2D(0,0),a=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),s=new i.VisualContainer2D(300,200);r.gl.clearColor(1,1,1,1),a.force.SetSame(5),r.AddChild(o).AddChild(a).AddChild(s),new i.CanvasManager(e,600,400,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(r).BindRootContainer(o).Trigger();var u=new i.Controller.ProgramController.GLTexture2DProgramController(r.gl);u.BindBasicTexture(window.testData.imgloader.GetBasicTextureById("fontimg"));var l=new i.BitmapText(0,0,u,window.testData.xhrloader.GetDataById("fontdataxml"),window.testData.lorem);l.scale.SetSame(.3),l.x=.5*-l.width,l.y=.5*-l.height,s.AddChild(l),r.onProcess.Add(function(){a.Process()}),r.mouse.SetCoordinateTranslationEntity(s,r.glConvMatrix),r.mouse.onDown.Add(function(t){a.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("WebGLTilesprite",function(t){var e=960,n=540,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"WebGL"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(480,270);u.force.SetSame(5),a.AddChild(s).AddChild(u).AddChild(l),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();var c=new i.Controller.ProgramController.GLTexture2DProgramController(a.gl);c.BindBasicTexture(i.Tilesprite.DEFAULT_TEXTURE);var h=new i.Tilesprite(-240,-135,c);h.GeneratePattern(null,480,270),l.AddChild(h),a.onProcess.Add(function(){u.Process(),h.OffsetPattern(1,1)}),a.mouse.SetCoordinateTranslationEntity(l,a.glConvMatrix),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("Stresstest",function(t){var e=window.innerWidth,n=window.innerHeight,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o=r.getContext("2d"),a=new i.VisualContainer2D(0,0),s=t.ticker=new i.Time.Ticker(function(){o.setTransform(1,0,0,1,0,0),o.fillStyle="rgba(0,0,0,1)",o.fillRect(0,0,e,n),a.Render(o),d.Process()},1e3,!0),u=20,l=0,c=35,h=[],f=new i.Pool,d=new i.Time.Timer;f.Flood(function(){var t=new i.Sprite(Math.random()*e,Math.random()*n);return t.transformAutomaticUpdate=!1,t},1e4),d.onFinish.Add(function(){var t=c;for(c=c<3?3:c--;t--;)a.AddChild(f.Retrieve());if(s.GetTPS()>40||l++<20)this.Start(1);else{var e=a.children.length;console.log(e,s.GetTPS()),a.children.forEach(function(t){f.Store(t)}),a.Dump(),l=0,h.push(e),--u>0?this.Start(120):(h.sort(function(t,e){return t-e}),console.log(h,"\nMIN: "+h[0],"MED: "+h[Math.round(h.length/2)],"MAX: "+h[h.length-1]))}},d),s.Start(),d.Start(120)})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("WebGLStresstest",function(t){var e=window.innerWidth,n=window.innerHeight,r=.5*e,o=.5*n,a=t.canvas=document.createElement("canvas");document.body.appendChild(a),a.setAttribute("width",e),a.setAttribute("height",n),a.style.display="initial",a.style.position="absolute";var s=a.getContext("webgl2");s||(s=a.getContext("webgl")),s||(s=a.getContext("experimental-webgl"));var u=new i.VisualContainer2D(0,0),l=t.ticker=new i.Time.Ticker(function(){s.viewport(0,0,e,n),s.clear(s.COLOR_BUFFER_BIT),s.enable(s.BLEND),s.disable(s.DEPTH_TEST),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),u.GLRender(s),y.Process()},1e3,!0),c=20,h=0,f=35,d=[],p=new i.Pool(i.Sprite),y=new i.Time.Timer,v=new i.Controller.ProgramController.GLTexture2DProgramController(s);v.BindBasicTexture(i.Sprite.DEFAULT_TEXTURE,s.NEAREST),u.scale.Set(2/e,-2/n),u.position.Add(0,0),u.UpdateTransform(u.parent),p.Flood(function(){var t=new i.Sprite(Math.random()*e-r,Math.random()*n-o,v);return t.transformAutomaticUpdate=!1,t},4e4),y.onFinish.Add(function(){var t=f;for(f=f<3?3:f--;t--;)u.AddChild(p.Retrieve());if(l.GetTPS()>55||h++<20)this.Start(1);else{var e=u.children.length;console.log(e,l.GetTPS()),u.children.forEach(function(t){p.Store(t)}),u.Dump(),h=0,d.push(e),--c>0?this.Start(120):(d.sort(function(t,e){return t-e}),console.log(d,"\nMIN: "+d[0],"MED: "+d[Math.round(d.length/2)],"MAX: "+d[d.length-1]))}},y),l.StartAccurate(),y.Start(120)})}},function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(0);e.default=function(){Object(r.a)("Rendertexture",function(t){var e=1920,n=1080,r=t.canvas=document.createElement("canvas");document.body.appendChild(r),r.setAttribute("width",e),r.setAttribute("height",n),r.style.display="initial",r.style.position="absolute";var o={canvas:r,halt:!1,mode:"WebGL2"},a=t.stage=new i.Stage2D(o),s=new i.VisualContainer2D(0,0),u=new i.Camera2D(new i.Vector2D(0,0),{position:new i.Vector2D(0,0)}),l=new i.VisualContainer2D(960,540),c=new i.VisualContainer2D(960,540),h=new i.Controller.ProgramController.GLTexture2DProgramController(a.gl);h.BindBasicTexture(i.Sprite.DEFAULT_TEXTURE);var f=new i.Controller.ProgramController.GLRendertextureProgramController(a.gl,i.Shader.RENDERTEXTURE_INVERT);f.Config(e,n,a.gl.LINEAR);var d=new i.Sprite(0,0,h),p=new i.Sprite(0,0,h);d.anchor.SetSame(.5),p.anchor.SetSame(.5),d.alpha=.5,d.UpdateTextureTransform(),p.UpdateTextureTransform(),a.gl.clearColor(.3,.3,.3,1),s.GLPreRender=function(t){a.SetFramebuffer(t,f)},s.GLPostRender=function(){a.SetFramebuffer(),f.ExecuteClean()},u.force.SetSame(5),a.AddChild(s).AddChild(u).Mount(l,c),l.Mount(d),c.Mount(p),new i.CanvasManager(r,e,n,i.CanvasManager.KEEP_ASPECT_RATIO_FIT).BindStage(a).BindRootContainer(s).Trigger();var y=0;a.onProcess.Add(function(){u.Process(),d.x=128*Math.cos(y),d.y=128*Math.sin(y),y+=i.Math.RADIAN}),a.mouse.SetCoordinateTranslationEntity(l,a.glConvMatrix),a.mouse.onDown.Add(function(t){u.target.position.SetV(t.data.position)})})}}]);